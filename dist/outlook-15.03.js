/* Outlook specific API library */
/* Version: 15.0.4812.3000 */
/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/

/*
	Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.
*/

/*!
Copyright (c) Microsoft Corporation.  All rights reserved.
*/
/*!
Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.
*/
Type.registerNamespace("Microsoft.Office.WebExtension.MailboxEnums");Microsoft.Office.WebExtension.MailboxEnums.EntityType={MeetingSuggestion:"meetingSuggestion",TaskSuggestion:"taskSuggestion",Address:"address",EmailAddress:"emailAddress",Url:"url",PhoneNumber:"phoneNumber",Contact:"contact",FlightReservations:"flightReservations",ParcelDeliveries:"parcelDeliveries"};Microsoft.Office.WebExtension.MailboxEnums.ItemType={Message:"message",Appointment:"appointment"};Microsoft.Office.WebExtension.MailboxEnums.ResponseType={None:"none",Organizer:"organizer",Tentative:"tentative",Accepted:"accepted",Declined:"declined"};Microsoft.Office.WebExtension.MailboxEnums.RecipientType={Other:"other",DistributionList:"distributionList",User:"user",ExternalUser:"externalUser"};Microsoft.Office.WebExtension.MailboxEnums.AttachmentType={File:"file",Item:"item",Cloud:"cloud"};Microsoft.Office.WebExtension.MailboxEnums.BodyType={Text:"text",Html:"html"};Microsoft.Office.WebExtension.MailboxEnums.ItemNotificationMessageType={ProgressIndicator:"progressIndicator",InformationalMessage:"informationalMessage",ErrorMessage:"errorMessage"};Microsoft.Office.WebExtension.CoercionType={Text:"text",Html:"html"};Microsoft.Office.WebExtension.MailboxEnums.UserProfileType={Office365:"office365",OutlookCom:"outlookCom",Enterprise:"enterprise"};Microsoft.Office.WebExtension.MailboxEnums.RestVersion={v1_0:"v1.0",v2_0:"v2.0",Beta:"beta"};Type.registerNamespace("OSF.DDA");var OSF=window.OSF||{};OSF.DDA=OSF.DDA||{};window.OSF.DDA.OutlookAppOm=OSF.DDA.OutlookAppOm=function(n,t,i){this.$$d__callAppReadyCallback$p$0=Function.createDelegate(this,this._callAppReadyCallback$p$0);this.$$d_displayContactCardAsync=Function.createDelegate(this,this.displayContactCardAsync);this.$$d_displayNewMessageFormApi=Function.createDelegate(this,this.displayNewMessageFormApi);this.$$d__displayNewAppointmentFormApi$p$0=Function.createDelegate(this,this._displayNewAppointmentFormApi$p$0);this.$$d_windowOpenOverrideHandler=Function.createDelegate(this,this.windowOpenOverrideHandler);this.$$d__getEwsUrl$p$0=Function.createDelegate(this,this._getEwsUrl$p$0);this.$$d__getDiagnostics$p$0=Function.createDelegate(this,this._getDiagnostics$p$0);this.$$d__getUserProfile$p$0=Function.createDelegate(this,this._getUserProfile$p$0);this.$$d__getItem$p$0=Function.createDelegate(this,this._getItem$p$0);this.$$d__getInitialDataResponseHandler$p$0=Function.createDelegate(this,this._getInitialDataResponseHandler$p$0);window.OSF.DDA.OutlookAppOm._instance$p=this;this._officeAppContext$p$0=n;this._appReadyCallback$p$0=i;var u=this;var r=function(){i&&u.invokeHostMethod(1,null,u.$$d__getInitialDataResponseHandler$p$0)};this._areStringsLoaded$p$0()?r():this._loadLocalizedScript$p$0(r)};window.OSF.DDA.OutlookAppOm._throwOnPropertyAccessForRestrictedPermission$i=function(n){if(!n)throw Error.create(window._u.ExtensibilityStrings.l_ElevatedPermissionNeeded_Text);};window.OSF.DDA.OutlookAppOm._throwOnOutOfRange$i=function(n,t,i,r){if(n<t||n>i)throw Error.argumentOutOfRange(r);};window.OSF.DDA.OutlookAppOm._getHtmlBody$p=function(n){var t="";if("htmlBody"in n){window.OSF.DDA.OutlookAppOm._throwOnInvalidHtmlBody$p(n.htmlBody);t=n.htmlBody}return t};window.OSF.DDA.OutlookAppOm._getAttachments$p=function(n){var t=[];if("attachments"in n){t=n.attachments;window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentsArray$p(t)}return t};window.OSF.DDA.OutlookAppOm._getOptionsAndCallback$p=function(n){var t=[];"options"in n&&(t[0]=n.options);"callback"in n&&(t[t.length]=n.callback);return t};window.OSF.DDA.OutlookAppOm._createAttachmentsDataForHost$p=function(n){var r=new Array(0);if(Array.isInstanceOfType(n))for(var t=0;t<n.length;t++)if(Object.isInstanceOfType(n[t])){var i=n[t];window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachment$p(i);r[t]=window.OSF.DDA.OutlookAppOm._createAttachmentData$p(i)}else throw Error.argument("attachments");return r};window.OSF.DDA.OutlookAppOm._throwOnInvalidHtmlBody$p=function(n){if(!String.isInstanceOfType(n))throw Error.argument("htmlBody");if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argument("htmlBody");window.OSF.DDA.OutlookAppOm._throwOnOutOfRange$i(n.length,0,window.OSF.DDA.OutlookAppOm.maxBodyLength,"htmlBody")};window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentsArray$p=function(n){if(!Array.isInstanceOfType(n))throw Error.argument("attachments");};window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachment$p=function(n){if(!Object.isInstanceOfType(n))throw Error.argument("attachments");if(!("type"in n)||!("name"in n))throw Error.argument("attachments");if(!("url"in n||"itemId"in n))throw Error.argument("attachments");};window.OSF.DDA.OutlookAppOm._createAttachmentData$p=function(n){var i=null;if(n.type==="file"){var u=n.url;var t=n.name;window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentUrlOrName$p(u,t);i=window.OSF.DDA.OutlookAppOm._createFileAttachmentData$p(u,t)}else if(n.type==="item"){var r=window.OSF.DDA.OutlookAppOm.getItemIdBasedOnHost(n.itemId);var t=n.name;window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentItemIdOrName$p(r,t);i=window.OSF.DDA.OutlookAppOm._createItemAttachmentData$p(r,t)}else throw Error.argument("attachments");return i};window.OSF.DDA.OutlookAppOm._createFileAttachmentData$p=function(n,t){return["file",t,n]};window.OSF.DDA.OutlookAppOm._createItemAttachmentData$p=function(n,t){return["item",t,n]};window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentUrlOrName$p=function(n,t){if(!String.isInstanceOfType(n)||!String.isInstanceOfType(t))throw Error.argument("attachments");if(n.length>2048)throw Error.argumentOutOfRange("attachments",n.length,window._u.ExtensibilityStrings.l_AttachmentUrlTooLong_Text);window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentName$p(t)};window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentItemIdOrName$p=function(n,t){if(!String.isInstanceOfType(n)||!String.isInstanceOfType(t))throw Error.argument("attachments");if(n.length>200)throw Error.argumentOutOfRange("attachments",n.length,window._u.ExtensibilityStrings.l_AttachmentItemIdTooLong_Text);window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentName$p(t)};window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentName$p=function(n){if(n.length>255)throw Error.argumentOutOfRange("attachments",n.length,window._u.ExtensibilityStrings.l_AttachmentNameTooLong_Text);};window.OSF.DDA.OutlookAppOm._throwOnInvalidRestVersion$p=function(n){if(!n)throw Error.argumentNull("restVersion");if(n!==window.Microsoft.Office.WebExtension.MailboxEnums.RestVersion.v1_0&&n!==window.Microsoft.Office.WebExtension.MailboxEnums.RestVersion.v2_0&&n!==window.Microsoft.Office.WebExtension.MailboxEnums.RestVersion.Beta)throw Error.argument("restVersion");};window.OSF.DDA.OutlookAppOm.getItemIdBasedOnHost=function(n){return window.OSF.DDA.OutlookAppOm._instance$p._initialData$p$0&&window.OSF.DDA.OutlookAppOm._instance$p._initialData$p$0.get__isRestIdSupported$i$0()?window.OSF.DDA.OutlookAppOm._instance$p.convertToRestId(n,window.Microsoft.Office.WebExtension.MailboxEnums.RestVersion.v1_0):window.OSF.DDA.OutlookAppOm._instance$p.convertToEwsId(n,window.Microsoft.Office.WebExtension.MailboxEnums.RestVersion.v1_0)};window.OSF.DDA.OutlookAppOm._throwOnArgumentType$p=function(n,t,i){if(Object.getType(n)!==t)throw Error.argumentType(i);};window.OSF.DDA.OutlookAppOm._validateOptionalStringParameter$p=function(n,t,i,r){if(!$h.ScriptHelpers.isNullOrUndefined(n)){window.OSF.DDA.OutlookAppOm._throwOnArgumentType$p(n,String,r);var u=n;window.OSF.DDA.OutlookAppOm._throwOnOutOfRange$i(u.length,t,i,r)}};window.OSF.DDA.OutlookAppOm._convertToOutlookParameters$p=function(n,t){var i=null;switch(n){case 1:case 2:case 12:case 3:case 14:case 18:case 26:case 32:case 41:case 34:break;case 4:var r=window.JSON.stringify(t.customProperties);i=[r];break;case 5:i=[t.body];break;case 8:case 9:i=[t.itemId];break;case 7:i=[window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p(t.requiredAttendees),window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p(t.optionalAttendees),t.start,t.end,t.location,window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p(t.resources),t.subject,t.body];break;case 44:i=[window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p(t.toRecipients),window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p(t.ccRecipients),window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p(t.bccRecipients),t.subject,t.htmlBody,t.attachments];break;case 43:i=[t.ewsIdOrEmail];break;case 40:i=[t.extensionId,t.consentState];break;case 11:case 10:i=[t.htmlBody];break;case 31:case 30:i=[t.htmlBody,t.attachments];break;case 23:case 13:case 38:case 29:i=[t.data,t.coercionType];break;case 37:case 28:i=[t.coercionType];break;case 17:i=[t.subject];break;case 15:i=[t.recipientField];break;case 22:case 21:i=[t.recipientField,window.OSF.DDA.OutlookAppOm._convertComposeEmailDictionaryParameterForSetApi$p(t.recipientArray)];break;case 19:i=[t.itemId,t.name];break;case 16:i=[t.uri,t.name];break;case 20:i=[t.attachmentIndex];break;case 25:i=[t.TimeProperty,t.time];break;case 24:i=[t.TimeProperty];break;case 27:i=[t.location];break;case 33:case 35:i=[t.key,t.type,t.persistent,t.message,t.icon];break;case 36:i=[t.key];break;default:break}return i};window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p=function(n){return n?n.join(";"):null};window.OSF.DDA.OutlookAppOm._convertComposeEmailDictionaryParameterForSetApi$p=function(n){if(!n)return null;for(var i=new Array(n.length),t=0;t<n.length;t++)i[t]=[n[t].address,n[t].name];return i};window.OSF.DDA.OutlookAppOm._validateAndNormalizeRecipientEmails$p=function(n,t){if($h.ScriptHelpers.isNullOrUndefined(n))return null;window.OSF.DDA.OutlookAppOm._throwOnArgumentType$p(n,Array,t);var r=n;var u=null;var f=!1;window.OSF.DDA.OutlookAppOm._throwOnOutOfRange$i(r.length,0,window.OSF.DDA.OutlookAppOm._maxRecipients$p,String.format("{0}.length",t));for(var i=0;i<r.length;i++)if($h.EmailAddressDetails.isInstanceOfType(r[i])){f=!0;break}f&&(u=[]);for(var i=0;i<r.length;i++)if(f){u[i]=$h.EmailAddressDetails.isInstanceOfType(r[i])?r[i].emailAddress:r[i];window.OSF.DDA.OutlookAppOm._throwOnArgumentType$p(u[i],String,String.format("{0}[{1}]",t,i))}else window.OSF.DDA.OutlookAppOm._throwOnArgumentType$p(r[i],String,String.format("{0}[{1}]",t,i));return u};OSF.DDA.OutlookAppOm.prototype={_initialData$p$0:null,_item$p$0:null,_userProfile$p$0:null,_diagnostics$p$0:null,_officeAppContext$p$0:null,_appReadyCallback$p$0:null,_clientEndPoint$p$0:null,get_clientEndPoint:function(){this._clientEndPoint$p$0||(this._clientEndPoint$p$0=window.OSF._OfficeAppFactory.getClientEndPoint());return this._clientEndPoint$p$0},set_clientEndPoint:function(n){this._clientEndPoint$p$0=n;return n},get_initialData:function(){return this._initialData$p$0},get__appName$i$0:function(){return this._officeAppContext$p$0.get_appName()},initialize:function(n){var t="itemType";this._initialData$p$0=new $h.InitialData(n);1===n[t]?this._item$p$0=new $h.Message(this._initialData$p$0):3===n[t]?this._item$p$0=new $h.MeetingRequest(this._initialData$p$0):2===n[t]?this._item$p$0=new $h.Appointment(this._initialData$p$0):4===n[t]?this._item$p$0=new $h.MessageCompose(this._initialData$p$0):5===n[t]&&(this._item$p$0=new $h.AppointmentCompose(this._initialData$p$0));this._userProfile$p$0=new $h.UserProfile(this._initialData$p$0);this._diagnostics$p$0=new $h.Diagnostics(this._initialData$p$0,this._officeAppContext$p$0.get_appName());this._initializeMethods$p$0();$h.InitialData._defineReadOnlyProperty$i(this,"item",this.$$d__getItem$p$0);$h.InitialData._defineReadOnlyProperty$i(this,"userProfile",this.$$d__getUserProfile$p$0);$h.InitialData._defineReadOnlyProperty$i(this,"diagnostics",this.$$d__getDiagnostics$p$0);$h.InitialData._defineReadOnlyProperty$i(this,"ewsUrl",this.$$d__getEwsUrl$p$0);window.OSF.DDA.OutlookAppOm._instance$p.get__appName$i$0()===64&&this._initialData$p$0.get__overrideWindowOpen$i$0()&&(window.open=this.$$d_windowOpenOverrideHandler)},windowOpenOverrideHandler:function(n,t,i,r){this.invokeHostMethod(403,{launchUrl:n},null)},makeEwsRequestAsync:function(n){for(var r=[],i=1;i<arguments.length;++i)r[i-1]=arguments[i];if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("data");if(n.length>window.OSF.DDA.OutlookAppOm._maxEwsRequestSize$p)throw Error.argument("data",window._u.ExtensibilityStrings.l_EwsRequestOversized_Text);this._throwOnMethodCallForInsufficientPermission$i$0(3,"makeEwsRequestAsync");var u=$h.CommonParameters.parse(r,!0,!0);var t=new $h.EwsRequest(u._asyncContext$p$0);var f=this;t.onreadystatechange=function(){4===t.get__requestState$i$1()&&u._callback$p$0(t._asyncResult$p$0)};t.send(n)},recordDataPoint:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("data");this.invokeHostMethod(402,n,null)},recordTrace:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("data");this.invokeHostMethod(401,n,null)},trackCtq:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("data");this.invokeHostMethod(400,n,null)},convertToLocalClientTime:function(n){var t=new Date(n.getTime());var i=t.getTimezoneOffset()*-1;if(this._initialData$p$0&&this._initialData$p$0.get__timeZoneOffsets$i$0()){t.setUTCMinutes(t.getUTCMinutes()-i);i=this._findOffset$p$0(t);t.setUTCMinutes(t.getUTCMinutes()+i)}var r=this._dateToDictionary$i$0(t);r.timezoneOffset=i;return r},convertToUtcClientTime:function(n){var t=this._dictionaryToDate$i$0(n);if(this._initialData$p$0&&this._initialData$p$0.get__timeZoneOffsets$i$0()){var i=this._findOffset$p$0(t);t.setUTCMinutes(t.getUTCMinutes()-i);i=n.timezoneOffset?n.timezoneOffset:t.getTimezoneOffset()*-1;t.setUTCMinutes(t.getUTCMinutes()+i)}return t},convertToRestId:function(n,t){if(!n)throw Error.argumentNull("itemId");window.OSF.DDA.OutlookAppOm._throwOnInvalidRestVersion$p(t);return n.replace(new RegExp("[/]","g"),"-").replace(new RegExp("[+]","g"),"_")},convertToEwsId:function(n,t){if(!n)throw Error.argumentNull("itemId");window.OSF.DDA.OutlookAppOm._throwOnInvalidRestVersion$p(t);return n.replace(new RegExp("[-]","g"),"/").replace(new RegExp("[_]","g"),"+")},getUserIdentityTokenAsync:function(){for(var i=[],n=0;n<arguments.length;++n)i[n]=arguments[n];this._throwOnMethodCallForInsufficientPermission$i$0(1,"getUserIdentityTokenAsync");var t=$h.CommonParameters.parse(i,!0,!0);this._invokeGetTokenMethodAsync$p$0(2,"GetUserIdentityToken",t._callback$p$0,t._asyncContext$p$0)},getCallbackTokenAsync:function(){for(var i=[],n=0;n<arguments.length;++n)i[n]=arguments[n];this._throwOnMethodCallForInsufficientPermission$i$0(1,"getCallbackTokenAsync");var t=$h.CommonParameters.parse(i,!0,!0);this._invokeGetTokenMethodAsync$p$0(12,"GetCallbackToken",t._callback$p$0,t._asyncContext$p$0)},displayMessageForm:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("itemId");this.invokeHostMethod(8,{itemId:window.OSF.DDA.OutlookAppOm.getItemIdBasedOnHost(n)},null)},displayAppointmentForm:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("itemId");this.invokeHostMethod(9,{itemId:window.OSF.DDA.OutlookAppOm.getItemIdBasedOnHost(n)},null)},RegisterConsentAsync:function(n){if(n!==2&&n!==1&&n)throw Error.argumentOutOfRange("consentState");var t={};t.consentState=n.toString();t.extensionId=this.GetExtensionId();this.invokeHostMethod(40,t,null)},CloseApp:function(){thi