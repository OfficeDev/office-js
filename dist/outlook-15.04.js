/* Outlook specific API library */
/* Version: 15.0.4927.1000 */
/* Update: 3 */
/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/

/*
	Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.
*/

Type.registerNamespace("Microsoft.Office.WebExtension.MailboxEnums");Microsoft.Office.WebExtension.MailboxEnums.EntityType={MeetingSuggestion:"meetingSuggestion",TaskSuggestion:"taskSuggestion",Address:"address",EmailAddress:"emailAddress",Url:"url",PhoneNumber:"phoneNumber",Contact:"contact",FlightReservations:"flightReservations",ParcelDeliveries:"parcelDeliveries"};Microsoft.Office.WebExtension.MailboxEnums.ItemType={Message:"message",Appointment:"appointment"};Microsoft.Office.WebExtension.MailboxEnums.ResponseType={None:"none",Organizer:"organizer",Tentative:"tentative",Accepted:"accepted",Declined:"declined"};Microsoft.Office.WebExtension.MailboxEnums.RecipientType={Other:"other",DistributionList:"distributionList",User:"user",ExternalUser:"externalUser"};Microsoft.Office.WebExtension.MailboxEnums.AttachmentType={File:"file",Item:"item",Cloud:"cloud"};Microsoft.Office.WebExtension.MailboxEnums.BodyType={Text:"text",Html:"html"};Microsoft.Office.WebExtension.MailboxEnums.ItemNotificationMessageType={ProgressIndicator:"progressIndicator",InformationalMessage:"informationalMessage",ErrorMessage:"errorMessage"};Microsoft.Office.WebExtension.CoercionType={Text:"text",Html:"html"};Microsoft.Office.WebExtension.MailboxEnums.UserProfileType={Office365:"office365",OutlookCom:"outlookCom",Enterprise:"enterprise"};Microsoft.Office.WebExtension.MailboxEnums.RestVersion={v1_0:"v1.0",v2_0:"v2.0",Beta:"beta"};Type.registerNamespace("OSF.DDA");var OSF=window.OSF||{};OSF.DDA=OSF.DDA||{};window.OSF.DDA.OutlookAppOm=OSF.DDA.OutlookAppOm=function(d,e,c){this.$$d__callAppReadyCallback$p$0=Function.createDelegate(this,this._callAppReadyCallback$p$0);this.$$d_displayContactCardAsync=Function.createDelegate(this,this.displayContactCardAsync);this.$$d_displayNewMessageFormApi=Function.createDelegate(this,this.displayNewMessageFormApi);this.$$d__displayNewAppointmentFormApi$p$0=Function.createDelegate(this,this._displayNewAppointmentFormApi$p$0);this.$$d_windowOpenOverrideHandler=Function.createDelegate(this,this.windowOpenOverrideHandler);this.$$d__getEwsUrl$p$0=Function.createDelegate(this,this._getEwsUrl$p$0);this.$$d__getDiagnostics$p$0=Function.createDelegate(this,this._getDiagnostics$p$0);this.$$d__getUserProfile$p$0=Function.createDelegate(this,this._getUserProfile$p$0);this.$$d__getItem$p$0=Function.createDelegate(this,this._getItem$p$0);this.$$d__getInitialDataResponseHandler$p$0=Function.createDelegate(this,this._getInitialDataResponseHandler$p$0);window.OSF.DDA.OutlookAppOm._instance$p=this;this._officeAppContext$p$0=d;this._appReadyCallback$p$0=c;var a=this,b=function(){if(c)if(!d.get_isDialog())a.invokeHostMethod(1,null,a.$$d__getInitialDataResponseHandler$p$0);else window.setTimeout(a.$$d__callAppReadyCallback$p$0,0)};if(this._areStringsLoaded$p$0())b();else this._loadLocalizedScript$p$0(b)};window.OSF.DDA.OutlookAppOm._throwOnPropertyAccessForRestrictedPermission$i=function(a){if(!a)throw Error.create(window._u.ExtensibilityStrings.l_ElevatedPermissionNeeded_Text);};window.OSF.DDA.OutlookAppOm._throwOnOutOfRange$i=function(a,d,c,b){if(a<d||a>c)throw Error.argumentOutOfRange(b);};window.OSF.DDA.OutlookAppOm._getHtmlBody$p=function(a){var b="";if("htmlBody"in a){window.OSF.DDA.OutlookAppOm._throwOnInvalidHtmlBody$p(a.htmlBody);b=a.htmlBody}return b};window.OSF.DDA.OutlookAppOm._getAttachments$p=function(b){var a=[];if("attachments"in b){a=b.attachments;window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentsArray$p(a)}return a};window.OSF.DDA.OutlookAppOm._getOptionsAndCallback$p=function(b){var a=[];if("options"in b)a[0]=b.options;if("callback"in b)a[a.length]=b.callback;return a};window.OSF.DDA.OutlookAppOm._createAttachmentsDataForHost$p=function(b){var c=new Array(0);if(Array.isInstanceOfType(b))for(var a=0;a<b.length;a++)if(Object.isInstanceOfType(b[a])){var d=b[a];window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachment$p(d);c[a]=window.OSF.DDA.OutlookAppOm._createAttachmentData$p(d)}else throw Error.argument("attachments");return c};window.OSF.DDA.OutlookAppOm._throwOnInvalidHtmlBody$p=function(a){if(!String.isInstanceOfType(a))throw Error.argument("htmlBody");if($h.ScriptHelpers.isNullOrUndefined(a))throw Error.argument("htmlBody");window.OSF.DDA.OutlookAppOm._throwOnOutOfRange$i(a.length,0,window.OSF.DDA.OutlookAppOm.maxBodyLength,"htmlBody")};window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentsArray$p=function(a){if(!Array.isInstanceOfType(a))throw Error.argument("attachments");};window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachment$p=function(a){if(!Object.isInstanceOfType(a))throw Error.argument("attachments");if(!("type"in a)||!("name"in a))throw Error.argument("attachments");if(!("url"in a||"itemId"in a))throw Error.argument("attachments");};window.OSF.DDA.OutlookAppOm._createAttachmentData$p=function(a){var c=null;if(a.type==="file"){var e=a.url,b=a.name;window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentUrlOrName$p(e,b);c=window.OSF.DDA.OutlookAppOm._createFileAttachmentData$p(e,b)}else if(a.type==="item"){var d=window.OSF.DDA.OutlookAppOm.getItemIdBasedOnHost(a.itemId),b=a.name;window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentItemIdOrName$p(d,b);c=window.OSF.DDA.OutlookAppOm._createItemAttachmentData$p(d,b)}else throw Error.argument("attachments");return c};window.OSF.DDA.OutlookAppOm._createFileAttachmentData$p=function(b,a){return["file",a,b]};window.OSF.DDA.OutlookAppOm._createItemAttachmentData$p=function(a,b){return["item",b,a]};window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentUrlOrName$p=function(a,b){if(!String.isInstanceOfType(a)||!String.isInstanceOfType(b))throw Error.argument("attachments");if(a.length>2048)throw Error.argumentOutOfRange("attachments",a.length,window._u.ExtensibilityStrings.l_AttachmentUrlTooLong_Text);window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentName$p(b)};window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentItemIdOrName$p=function(a,b){if(!String.isInstanceOfType(a)||!String.isInstanceOfType(b))throw Error.argument("attachments");if(a.length>200)throw Error.argumentOutOfRange("attachments",a.length,window._u.ExtensibilityStrings.l_AttachmentItemIdTooLong_Text);window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentName$p(b)};window.OSF.DDA.OutlookAppOm._throwOnInvalidAttachmentName$p=function(a){if(a.length>255)throw Error.argumentOutOfRange("attachments",a.length,window._u.ExtensibilityStrings.l_AttachmentNameTooLong_Text);};window.OSF.DDA.OutlookAppOm._throwOnInvalidRestVersion$p=function(a){if(!a)throw Error.argumentNull("restVersion");if(a!==window.Microsoft.Office.WebExtension.MailboxEnums.RestVersion.v1_0&&a!==window.Microsoft.Office.WebExtension.MailboxEnums.RestVersion.v2_0&&a!==window.Microsoft.Office.WebExtension.MailboxEnums.RestVersion.Beta)throw Error.argument("restVersion");};window.OSF.DDA.OutlookAppOm.getItemIdBasedOnHost=function(a){return window.OSF.DDA.OutlookAppOm._instance$p._initialData$p$0&&window.OSF.DDA.OutlookAppOm._instance$p._initialData$p$0.get__isRestIdSupported$i$0()?window.OSF.DDA.OutlookAppOm._instance$p.convertToRestId(a,window.Microsoft.Office.WebExtension.MailboxEnums.RestVersion.v1_0):window.OSF.DDA.OutlookAppOm._instance$p.convertToEwsId(a,window.Microsoft.Office.WebExtension.MailboxEnums.RestVersion.v1_0)};window.OSF.DDA.OutlookAppOm._throwOnArgumentType$p=function(c,b,a){if(Object.getType(c)!==b)throw Error.argumentType(a);};window.OSF.DDA.OutlookAppOm._validateOptionalStringParameter$p=function(a,e,d,b){if($h.ScriptHelpers.isNullOrUndefined(a))return;window.OSF.DDA.OutlookAppOm._throwOnArgumentType$p(a,String,b);var c=a;window.OSF.DDA.OutlookAppOm._throwOnOutOfRange$i(c.length,e,d,b)};window.OSF.DDA.OutlookAppOm._convertToOutlookParameters$p=function(d,a){var b=null;switch(d){case 1:case 2:case 12:case 3:case 14:case 18:case 26:case 32:case 41:case 34:break;case 4:var c=window.JSON.stringify(a.customProperties);b=[c];break;case 5:b=[a.body];break;case 8:case 9:b=[a.itemId];break;case 7:b=[window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p(a.requiredAttendees),window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p(a.optionalAttendees),a.start,a.end,a.location,window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p(a.resources),a.subject,a.body];break;case 44:b=[window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p(a.toRecipients),window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p(a.ccRecipients),window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p(a.bccRecipients),a.subject,a.htmlBody,a.attachments];break;case 43:b=[a.ewsIdOrEmail];break;case 40:b=[a.extensionId,a.consentState];break;case 11:case 10:b=[a.htmlBody];break;case 31:case 30:b=[a.htmlBody,a.attachments];break;case 23:case 13:case 38:case 29:b=[a.data,a.coercionType];break;case 37:case 28:b=[a.coercionType];break;case 17:b=[a.subject];break;case 15:b=[a.recipientField];break;case 22:case 21:b=[a.recipientField,window.OSF.DDA.OutlookAppOm._convertComposeEmailDictionaryParameterForSetApi$p(a.recipientArray)];break;case 19:b=[a.itemId,a.name];break;case 16:b=[a.uri,a.name];break;case 20:b=[a.attachmentIndex];break;case 25:b=[a.TimeProperty,a.time];break;case 24:b=[a.TimeProperty];break;case 27:b=[a.location];break;case 33:case 35:b=[a.key,a.type,a.persistent,a.message,a.icon];break;case 36:b=[a.key];break;default:Sys.Debug.fail("Unexpected method dispid")}return b};window.OSF.DDA.OutlookAppOm._convertRecipientArrayParameterForOutlookForDisplayApi$p=function(a){return a?a.join(";"):null};window.OSF.DDA.OutlookAppOm._convertComposeEmailDictionaryParameterForSetApi$p=function(a){if(!a)return null;for(var c=new Array(a.length),b=0;b<a.length;b++)c[b]=[a[b].address,a[b].name];return c};window.OSF.DDA.OutlookAppOm._validateAndNormalizeRecipientEmails$p=function(f,d){if($h.ScriptHelpers.isNullOrUndefined(f))return null;window.OSF.DDA.OutlookAppOm._throwOnArgumentType$p(f,Array,d);var b=f,c=null,e=false;window.OSF.DDA.OutlookAppOm._throwOnOutOfRange$i(b.length,0,window.OSF.DDA.OutlookAppOm._maxRecipients$p,String.format("{0}.length",d));for(var a=0;a<b.length;a++)if($h.EmailAddressDetails.isInstanceOfType(b[a])){e=true;break}if(e)c=[];for(var a=0;a<b.length;a++)if(e){c[a]=$h.EmailAddressDetails.isInstanceOfType(b[a])?b[a].emailAddress:b[a];window.OSF.DDA.OutlookAppOm._throwOnArgumentType$p(c[a],String,String.format("{0}[{1}]",d,a))}else window.OSF.DDA.OutlookAppOm._throwOnArgumentType$p(b[a],String,String.format("{0}[{1}]",d,a));return c};OSF.DDA.OutlookAppOm.prototype={_initialData$p$0:null,_item$p$0:null,_userProfile$p$0:null,_diagnostics$p$0:null,_officeAppContext$p$0:null,_appReadyCallback$p$0:null,_clientEndPoint$p$0:null,get_clientEndPoint:function(){if(!this._clientEndPoint$p$0)this._clientEndPoint$p$0=window.OSF._OfficeAppFactory.getClientEndPoint();return this._clientEndPoint$p$0},set_clientEndPoint:function(a){this._clientEndPoint$p$0=a;return a},get_initialData:function(){return this._initialData$p$0},get__appName$i$0:function(){return this._officeAppContext$p$0.get_appName()},initialize:function(a){var b="itemType";this._initialData$p$0=new $h.InitialData(a);if(1===a[b])this._item$p$0=new $h.Message(this._initialData$p$0);else if(3===a[b])this._item$p$0=new $h.MeetingRequest(this._initialData$p$0);else if(2===a[b])this._item$p$0=new $h.Appointment(this._initialData$p$0);else if(4===a[b])this._item$p$0=new $h.MessageCompose(this._initialData$p$0);else if(5===a[b])this._item$p$0=new $h.AppointmentCompose(this._initialData$p$0);else Sys.Debug.trace("Unexpected item type was received from the host.");this._userProfile$p$0=new $h.UserProfile(this._initialData$p$0);this._diagnostics$p$0=new $h.Diagnostics(this._initialData$p$0,this._officeAppContext$p$0.get_appName());this._initializeMethods$p$0();$h.InitialData._defineReadOnlyProperty$i(this,"item",this.$$d__getItem$p$0);$h.InitialData._defineReadOnlyProperty$i(this,"userProfile",this.$$d__getUserProfile$p$0);$h.InitialData._defineReadOnlyProperty$i(this,"diagnostics",this.$$d__getDiagnostics$p$0);$h.InitialData._defineReadOnlyProperty$i(this,"ewsUrl",this.$$d__getEwsUrl$p$0);if(window.OSF.DDA.OutlookAppOm._instance$p.get__appName$i$0()===64)if(this._initialData$p$0.get__overrideWindowOpen$i$0())window.open=this.$$d_windowOpenOverrideHandler},windowOpenOverrideHandler:function(a){this.invokeHostMethod(403,{launchUrl:a},null)},makeEwsRequestAsync:function(c){for(var e=[],b=1;b<arguments.length;++b)e[b-1]=arguments[b];if($h.ScriptHelpers.isNullOrUndefined(c))throw Error.argumentNull("data");if(c.length>window.OSF.DDA.OutlookAppOm._maxEwsRequestSize$p)throw Error.argument("data",window._u.ExtensibilityStrings.l_EwsRequestOversized_Text);this._throwOnMethodCallForInsufficientPermission$i$0(3,"makeEwsRequestAsync");var d=$h.CommonParameters.parse(e,true,true),a=new $h.EwsRequest(d._asyncContext$p$0),f=this;a.onreadystatechange=function(){4===a.get__requestState$i$1()&&d._callback$p$0(a._asyncResult$p$0)};a.send(c)},recordDataPoint:function(a){if($h.ScriptHelpers.isNullOrUndefined(a))throw Error.argumentNull("data");this.invokeHostMethod(402,a,null)},recordTrace:function(a){if($h.ScriptHelpers.isNullOrUndefined(a))throw Error.argumentNull("data");this.invokeHostMethod(401,a,null)},trackCtq:function(a){if($h.ScriptHelpers.isNullOrUndefined(a))throw Error.argumentNull("data");this.invokeHostMethod(400,a,null)},convertToLocalClientTime:function(d){var a=new Date(d.getTime()),b=a.getTimezoneOffset()*-1;if(this._initialData$p$0&&this._initialData$p$0.get__timeZoneOffsets$i$0()){a.setUTCMinutes(a.getUTCMinutes()-b);b=this._findOffset$p$0(a);a.setUTCMinutes(a.getUTCMinutes()+b)}var c=this._dateToDictionary$i$0(a);c.timezoneOffset=b;return c},convertToUtcClientTime:function(c){var a=this._dictionaryToDate$i$0(c);if(this._initialData$p$0&&this._initialData$p$0.get__timeZoneOffsets$i$0()){var b=this._findOffset$p$0(a);a.setUTCMinutes(a.getUTCMinutes()-b);b=!c.timezoneOffset?a.getTimezoneOffset()*-1:c.timezoneOffset;a.setUTCMinutes(a.getUTCMinutes()+b)}return a},convertToRestId:function(a,b){if(!a)throw Error.argumentNull("itemId");window.OSF.DDA.OutlookAppOm._throwOnInvalidRestVersion$p(b);return a.replace(new RegExp("[/]","g"),"-").replace(new RegExp("[+]","g"),"_")},convertToEwsId:function(a,b){if(!a)throw Error.argumentNull("itemId");window.OSF.DDA.OutlookAppOm._throwOnInvalidRestVersion$p(b);return a.replace(new RegExp("[-]","g"),"/").replace(new RegExp("[_]","g"),"+")},getUserIdentityTokenAsync:function(){for(var c=[],a=0;a<arguments.length;++a)c[a]=arguments[a];this._throwOnMethodCallForInsufficientPermission$i$0(1,"getUserIdentityTokenAsync");var b=$h.CommonParameters.parse(c,true,true);this._invokeGetTokenMethodAsync$p$0(2,"GetUserIdentityToken",b._callback$p$0,b._asyncContext$p$0)},getCallbackTokenAsync:function(){for(var c=[],a=0;a<arguments.length;++a)c[a]=arguments[a];this._throwOnMethodCallForInsufficientPermission$i$0(1,"getCallbackTokenAsync");var b=$h.CommonParameters.parse(c,true,true);this._invokeGetTokenMethodAsync$p$0(12,"GetCallbackToken",b._callback$p$0,b._asyncContext$p$0)},displayMessageForm:function(a){if($h.ScriptHelpers.isNullOrUndefined(a))throw Error.argumentNull("itemId");this.invokeHostMethod(8,{itemId:window.OSF.DDA.OutlookAppOm.getItemIdBasedOnHost(a)},null)},displayAppointmentForm:function(a){if($h.ScriptHelpers.isNullOrUndefined(a))throw Error.argumentNull("itemId");this.invokeHostMethod(9,{itemId:window.OSF.DDA.OutlookAppOm.getItemIdBasedOnHost(a)},null)},RegisterConsentAsync:function(a){if(a!==2&&a!==1&&a)throw Error.argumentOutOfRange("consentState");var b={};b.consentState=a.toString();b.extensionId=this.GetExtensionId();this.invokeHostMet