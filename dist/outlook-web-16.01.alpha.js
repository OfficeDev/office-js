/* Outlook Web specific API library */
/* osfweb version: 16.0.12219.10000 */
/* office-js-api version: 20191022.2 */
/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/
/*
    Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.

    This file also contains the following Promise implementation (with a few small modifications):
        * @overview es6-promise - a tiny implementation of Promises/A+.
        * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
        * @license   Licensed under MIT license
        *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
        * @version   2.3.0
*/
var __extends=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function o(){this.constructor=e}e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};!function(e){var t=function(){var e=!0;function t(){}return t.prototype.isMsAjaxLoaded=function(){var t="function",n="undefined";return!!(typeof Sys!==n&&typeof Type!==n&&Sys.StringBuilder&&typeof Sys.StringBuilder===t&&Type.registerNamespace&&typeof Type.registerNamespace===t&&Type.registerClass&&typeof Type.registerClass===t&&typeof Function._validateParams===t&&Sys.Serialization&&Sys.Serialization.JavaScriptSerializer&&typeof Sys.Serialization.JavaScriptSerializer.serialize===t)&&e},t.prototype.loadMsAjaxFull=function(e){var t=("https:"===window.location.protocol.toLowerCase()?"https:":"http:")+"//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js";OSF.OUtil.loadScript(t,e)},Object.defineProperty(t.prototype,"msAjaxError",{get:function(){var e=this;return null==e._msAjaxError&&e.isMsAjaxLoaded()&&(e._msAjaxError=Error),e._msAjaxError},set:function(e){this._msAjaxError=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxString",{get:function(){var e=this;return null==e._msAjaxString&&e.isMsAjaxLoaded()&&(e._msAjaxString=String),e._msAjaxString},set:function(e){this._msAjaxString=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxDebug",{get:function(){var e=this;return null==e._msAjaxDebug&&e.isMsAjaxLoaded()&&(e._msAjaxDebug=Sys.Debug),e._msAjaxDebug},set:function(e){this._msAjaxDebug=e},enumerable:e,configurable:e}),t}();e.MicrosoftAjaxFactory=t}(OfficeExt||(OfficeExt={}));var OSFLog,Logger,OSFAriaLogger,OSFAppTelemetry,OSF_DDA_Marshaling_AppCommand_AppCommandInvokedEventKeys,OSF_DDA_Marshaling_AppCommand_AppCommandCompletedMethodParameterKeys,OfficeExt,OsfMsAjaxFactory=new OfficeExt.MicrosoftAjaxFactory,OSF=OSF||{};!function(e){var t=function(){function e(e){this._internalStorage=e}return e.prototype.getItem=function(e){try{return this._internalStorage&&this._internalStorage.getItem(e)}catch(e){return null}},e.prototype.setItem=function(e,t){try{this._internalStorage&&this._internalStorage.setItem(e,t)}catch(e){}},e.prototype.clear=function(){try{this._internalStorage&&this._internalStorage.clear()}catch(e){}},e.prototype.removeItem=function(e){try{this._internalStorage&&this._internalStorage.removeItem(e)}catch(e){}},e.prototype.getKeysWithPrefix=function(e){var t=[];try{for(var n=this._internalStorage&&this._internalStorage.length||0,o=0;o<n;o++){var r=this._internalStorage.key(o);0===r.indexOf(e)&&t.push(r)}}catch(e){}return t},e}();e.SafeStorage=t}(OfficeExt||(OfficeExt={})),OSF.XdmFieldName={ConversationUrl:"ConversationUrl",AppId:"AppId"},OSF.WindowNameItemKeys={BaseFrameName:"baseFrameName",HostInfo:"hostInfo",XdmInfo:"xdmInfo",SerializerVersion:"serializerVersion",AppContext:"appContext"},OSF.OUtil=function(){var e="focus",t="on",n="configurable",o="writable",r="enumerable",i="",a="undefined",s=!1,c=!0,d=2147483647,l=null,u=-1,f=u,p="&_xdm_Info=",m="&_serializer_version=",g="_xdm_",S="#",v="class",O={},A=l,D=l,h=(new Date).getTime();function y(){var e=d*Math.random();return(e^=h^(new Date).getMilliseconds()<<Math.floor(21*Math.random())).toString(16)}function C(){if(!A){try{var e=window.sessionStorage}catch(t){e=l}A=new OfficeExt.SafeStorage(e)}return A}function F(e){for(var t,n=[],o=[],r=e.length,i=0;i<r;i++)(t=e[i]).tabIndex?t.tabIndex>0?o.push(t):0===t.tabIndex&&n.push(t):n.push(t);return o=o.sort(function(e,t){var n=e.tabIndex-t.tabIndex;return 0===n&&(n=o.indexOf(e)-o.indexOf(t)),n}),[].concat(o,n)}return{set_entropy:function(e){if("string"==typeof e)for(var t=0;t<e.length;t+=4){for(var n=0,o=0;o<4&&t+o<e.length;o++)n=(n<<8)+e.charCodeAt(t+o);h^=n}else h^="number"==typeof e?e:d*Math.random();h&=d},extend:function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.uber=t.prototype,t.prototype.constructor===Object.prototype.constructor&&(t.prototype.constructor=t)},setNamespace:function(e,t){t&&e&&!t[e]&&(t[e]={})},unsetNamespace:function(e,t){t&&e&&t[e]&&delete t[e]},serializeSettings:function(e){var t={};for(var n in e){var o=e[n];try{o=JSON?JSON.stringify(o,function(e,t){return OSF.OUtil.isDate(this[e])?OSF.DDA.SettingsManager.DateJSONPrefix+this[e].getTime()+OSF.DDA.SettingsManager.DataJSONSuffix:t}):Sys.Serialization.JavaScriptSerializer.serialize(o),t[n]=o}catch(e){}}return t},deserializeSettings:function(e){var t={};for(var n in e=e||{}){var o=e[n];try{o=JSON?JSON.parse(o,function(e,t){var n;return"string"==typeof t&&t&&t.length>6&&t.slice(0,5)===OSF.DDA.SettingsManager.DateJSONPrefix&&t.slice(u)===OSF.DDA.SettingsManager.DataJSONSuffix&&(n=new Date(parseInt(t.slice(5,u))))?n:t}):Sys.Serialization.JavaScriptSerializer.deserialize(o,c),t[n]=o}catch(e){}}return t},loadScript:function(e,t,n){if(e&&t){var o=window.document,r=O[e];if(r)r.loaded?t():r.pendingCallbacks.push(t);else{var i=o.createElement("script");i.type="text/javascript",r={loaded:s,pendingCallbacks:[t],timer:l},O[e]=r;var a=function(){r.timer!=l&&(clearTimeout(r.timer),delete r.timer),r.loaded=c;for(var e=r.pendingCallbacks.length,t=0;t<e;t++){r.pendingCallbacks.shift()()}},d=function(){delete O[e],r.timer!=l&&(clearTimeout(r.timer),delete r.timer);for(var t=r.pendingCallbacks.length,n=0;n<t;n++){r.pendingCallbacks.shift()()}};i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=l,a())}:i.onload=a,i.onerror=d,n=n||3e4,r.timer=setTimeout(d,n),i.setAttribute("crossOrigin","anonymous"),i.src=e,o.getElementsByTagName("head")[0].appendChild(i)}}},loadCSS:function(e){if(e){var t=window.document,n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)}},parseEnum:function(e,t){var n=t[e.trim()];if(typeof n==a)throw OsfMsAjaxFactory.msAjaxDebug.trace("invalid enumeration string:"+e),OsfMsAjaxFactory.msAjaxError.argument("str");return n},delayExecutionAndCache:function(){var e={calc:arguments[0]};return function(){return e.calc&&(e.val=e.calc.apply(this,arguments),delete e.calc),e.val}},getUniqueId:function(){return(f+=1).toString()},formatString:function(){var e=arguments,t=e[0];return t.replace(/{(\d+)}/gm,function(t,n){var o=parseInt(n,10)+1;return void 0===e[o]?"{"+n+"}":e[o]})},generateConversationId:function(){return[y(),y(),(new Date).getTime().toString()].join("_")},getFrameName:function(e){return g+e+this.generateConversationId()},addXdmInfoAsHash:function(e,t){return OSF.OUtil.addInfoAsHash(e,p,t,s)},addSerializerVersionAsHash:function(e,t){return OSF.OUtil.addInfoAsHash(e,m,t,c)},addInfoAsHash:function(e,t,n,o){var r,a=(e=e.trim()||i).split(S),s=a.shift(),c=a.join(S);return r=o?[t,encodeURIComponent(n),c].join(i):[c,t,n].join(i),[s,S,r].join(i)},parseHostInfoFromWindowName:function(e,t){return OSF.OUtil.parseInfoFromWindowName(e,t,OSF.WindowNameItemKeys.HostInfo)},parseXdmInfo:function(e){var t=OSF.OUtil.parseXdmInfoWithGivenFragment(e,window.location.hash);return t||(t=OSF.OUtil.parseXdmInfoFromWindowName(e,window.name)),t},parseXdmInfoFromWindowName:function(e,t){return OSF.OUtil.parseInfoFromWindowName(e,t,OSF.WindowNameItemKeys.XdmInfo)},parseXdmInfoWithGivenFragment:function(e,t){return OSF.OUtil.parseInfoWithGivenFragment(p,g,s,e,t)},parseSerializerVersion:function(e){var t=OSF.OUtil.parseSerializerVersionWithGivenFragment(e,window.location.hash);return isNaN(t)&&(t=OSF.OUtil.parseSerializerVersionFromWindowName(e,window.name)),t},parseSerializerVersionFromWindowName:function(e,t){return parseInt(OSF.OUtil.parseInfoFromWindowName(e,t,OSF.WindowNameItemKeys.SerializerVersion))},parseSerializerVersionWithGivenFragment:function(e,t){return parseInt(OSF.OUtil.parseInfoWithGivenFragment(m,"_serializer_version=",c,e,t))},parseInfoFromWindowName:function(e,t,n){try{var o=JSON.parse(t),r=o!=l?o[n]:l,i=C();if(!e&&i&&o!=l){var a=o[OSF.WindowNameItemKeys.BaseFrameName]+n;r?i.setItem(a,r):r=i.getItem(a)}return r}catch(e){return l}},parseInfoWithGivenFragment:function(e,t,n,o,r){var i=r.split(e),a=i.length>1?i[i.length-1]:l;n&&a!=l&&(a.indexOf("&")>=0&&(a=a.split("&")[0]),a=decodeURIComponent(a));var s=C();if(!o&&s){var c=window.name.indexOf(t);if(c>u){var d=window.name.indexOf(";",c);d==u&&(d=window.name.length);var f=window.name.substring(c,d);a?s.setItem(f,a):a=s.getItem(f)}}return a},getConversationId:function(){var e=window.location.search,t=l;if(e){var n=e.indexOf("&");(t=n>0?e.substring(1,n):e.substr(1))&&"="===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1))&&(t=decodeURIComponent(t))}return t},getInfoItems:function(e){var t=e.split("$");return typeof t[1]==a&&(t=e.split("|")),typeof t[1]==a&&(t=e.split("%7C")),t},getXdmFieldValue:function(e,t){var n=i,o=OSF.OUtil.parseXdmInfo(t);if(o){var r=OSF.OUtil.getInfoItems(o);if(null!=r&&r.length>=3)switch(e){case OSF.XdmFieldName.ConversationUrl:n=r[2];break;case OSF.XdmFieldName.AppId:n=r[1]}}return n},validateParamObject:function(e,t){var n=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:s},{name:"expectedProperties",type:Object,mayBeNull:s},{name:"callback",type:Function,mayBeNull:c}]);if(n)throw n;for(var o in t)if(n=Function._validateParameter(e[o],t[o],o))throw n},writeProfilerMark:function(e){window.msWriteProfilerMark&&(window.msWriteProfilerMark(e),OsfMsAjaxFactory.msAjaxDebug.trace(e))},outputDebug:function(e){typeof OsfMsAjaxFactory!==a&&OsfMsAjaxFactory.msAjaxDebug&&OsfMsAjaxFactory.msAjaxDebug.trace&&OsfMsAjaxFactory.msAjaxDebug.trace(e)},defineNondefaultProperty:function(e,t,n,o){for(var r in n=n||{},o){var i=o[r];null==n[i]&&(n[i]=c)}return Object.defineProperty(e,t,n),e},defineNondefaultProperties:function(e,t,n){for(var o in t=t||{})OSF.OUtil.defineNondefaultProperty(e,o,t[o],n);return e},defineEnumerableProperty:function(e,t,n){return OSF.OUtil.defineNondefaultProperty(e,t,n,[r])},defineEnumerableProperties:function(e,t){return OSF.OUtil.defineNondefaultProperties(e,t,[r])},defineMutableProperty:function(e,t,i){return OSF.OUtil.defineNondefaultProperty(e,t,i,[o,r,n])},defineMutableProperties:function(e,t){return OSF.OUtil.defineNondefaultProperties(e,t,[o,r,n])},finalizeProperties:function(e,t){t=t||{};for(var n=Object.getOwnPropertyNames(e),o=n.length,r=0;r<o;r++){var i=n[r],a=Object.getOwnPropertyDescriptor(e,i);a.get||a.set||(a.writable=t.writable||s),a.configurable=t.configurable||s,a.enumerable=t.enumerable||c,Object.defineProperty(e,i,a)}return e},mapList:function(e,t){var n=[];if(e)for(var o in e)n.push(t(e[o]));return n},listContainsKey:function(e,t){for(var n in e)if(t==n)return c;return s},listContainsValue:function(e,t){for(var n in e)if(t==e[n])return c;return s},augmentList:function(e,t){var n=e.push?function(t,n){e.push(n)}:function(t,n){e[t]=n};for(var o in t)n(o,t[o])},redefineList:function(e,t){for(var n in e)delete e[n];for(var o in t)e[o]=t[o]},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.apply(e)},isDate:function(e){return"[object Date]"===Object.prototype.toString.apply(e)},addEventListener:function(e,n,o){e.addEventListener?e.addEventListener(n,o,s):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.attachEvent?e.attachEvent(t+n,o):e[t+n]=o},removeEventListener:function(e,n,o){e.removeEventListener?e.removeEventListener(n,o,s):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.detachEvent?e.detachEvent(t+n,o):e[t+n]=l},getCookieValue:function(e){return RegExp(e+"[^;]+").exec(document.cookie).toString().replace(/^[^=]+./,i)},xhrGet:function(e,t,n){var o;try{(o=new XMLHttpRequest).onreadystatechange=function(){4==o.readyState&&(200==o.status?t(o.responseText):n(o.status))},o.open("GET",e,c),o.send()}catch(e){n(e)}},xhrGetFull:function(e,t,n,o){var r,i=t;try{(r=new XMLHttpRequest).onreadystatechange=function(){4==r.readyState&&(200==r.status?n(r,i):o(r.status))},r.open("GET",e,c),r.send()}catch(e){o(e)}},encodeBase64:function(e){if(!e)return e;var t,n,o,r,a,s,c,d=[],l=[],u=0,f=e.length;do{t=e.charCodeAt(u++),n=e.charCodeAt(u++),o=e.charCodeAt(u++),c=0,r=255&t,a=t>>8,s=255&n,l[c++]=r>>2,l[c++]=(3&r)<<4|a>>4,l[c++]=(15&a)<<2|s>>6,l[c++]=63&s,isNaN(n)||(r=n>>8,a=255&o,s=o>>8,l[c++]=r>>2,l[c++]=(3&r)<<4|a>>4,l[c++]=(15&a)<<2|s>>6,l[c++]=63&s),isNaN(n)?l[c-1]=64:isNaN(o)&&(l[c-2]=64,l[c-1]=64);for(var p=0;p<c;p++)d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l[p]))}while(u<f);return d.join(i)},getSessionStorage:function(){return C()},getLocalStorage:function(){if(!D){try{var e=window.localStorage}catch(t){e=l}D=new OfficeExt.SafeStorage(e)}return D},convertIntToCssHexColor:function(e){return"#"+(Number(e)+16777216).toString(16).slice(-6)},attachClickHandler:function(e,t){e.onclick=function(){t()},e.ontouchend=function(e){t(),e.preventDefault()}},getQueryStringParamValue:function(e,t){var n=Function._validateParams(arguments,[{name:"queryString",type:String,mayBeNull:s},{name:"paramName",type:String,mayBeNull:s}]);if(n)return OsfMsAjaxFactory.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: Parameters cannot be null."),i;var o=new RegExp("[\\?&]"+t+"=([^&#]*)","i");return o.test(e)?o.exec(e)[1]:(OsfMsAjaxFactory.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: The parameter is not found."),i)},isiOS:function(){return window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?c:s},isChrome:function(){return window.navigator.userAgent.indexOf("Chrome")>0&&!OSF.OUtil.isEdge()},isEdge:function(){return window.navigator.userAgent.indexOf("Edge")>0},isIE:function(){return window.navigator.userAgent.indexOf("Trident")>0},isFirefox:function(){return window.navigator.userAgent.indexOf("Firefox")>0},shallowCopy:function(e){if(e==l)return l;if(e instanceof Object){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}var o=e.constructor();for(var r in e)e.hasOwnProperty(r)&&(o[r]=e[r]);return o}return e},createObject:function(e){var t=l;if(e){t={};for(var n=e.length,o=0;o<n;o++)t[e[o].name]=e[o].value}return t},addClass:function(e,t){if(!OSF.OUtil.hasClass(e,t)){var n=e.getAttribute(v);n?e.setAttribute(v,n+" "+t):e.setAttribute(v,t)}},removeClass:function(e,t){if(OSF.OUtil.hasClass(e,t)){var n=e.getAttribute(v),o=new RegExp("(\\s|^)"+t+"(\\s|$)");n=n.replace(o,i),e.setAttribute(v,n)}},hasClass:function(e,t){var n=e.getAttribute(v);return n&&n.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},focusToFirstTabbable:function(t,n){var o,r,i=s,a=function(){i=c},d=function(e,t,n){return t<0||t>e?u:0===t&&n?u:t!==e-1||n?n?t-1:t+1:u};if(t=F(t),o=n?t.length-1:0,0===t.length)return l;for(;!i&&o>=0&&o<t.length;)r=t[o],window.focus(),r.addEventListener(e,a),r.focus(),r.removeEventListener(e,a),o=d(t.length,o,n),i||r!==document.activeElement||(i=c);return i?r:l},focusToNextTabbable:function(t,n,o){var r,i,a,d=s,f=function(){d=c},p=function(e,t,n){return t<0||t>e?u:0===t&&n?u:t!==e-1||n?n?t-1:t+1:u};if(r=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return u}(t=F(t),n),(i=p(t.length,r,o))<0)return l;for(;!d&&i>=0&&i<t.length;)(a=t[i]).addEventListener(e,f),a.focus(),a.removeEventListener(e,f),i=p(t.length,i,o),d||a!==document.activeElement||(d=c);return d?a:l}}}(),OSF.OUtil.Guid=function(){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return{generateNewGuid:function(){for(var t="",n=(new Date).getTime(),o=0;o<32&&n>0;o++)8!=o&&12!=o&&16!=o&&20!=o||(t+="-"),t+=e[n%16],n=Math.floor(n/16);for(;o<32;o++)8!=o&&12!=o&&16!=o&&20!=o||(t+="-"),t+=e[Math.floor(16*Math.random())];return t}}}(),window.OSF=OSF,OSF.OUtil.setNamespace("OSF",window),OSF.MessageIDs={FetchBundleUrl:0,LoadReactBundle:1,LoadBundleSuccess:2,LoadBundleError:3},OSF.AppName={Unsupported:0,Excel:1,Word:2,PowerPoint:4,Outlook:8,ExcelWebApp:16,WordWebApp:32,OutlookWebApp:64,Project:128,AccessWebApp:256,PowerpointWebApp:512,ExcelIOS:1024,Sway:2048,WordIOS:4096,PowerPointIOS:8192,Access:16384,Lync:32768,OutlookIOS:65536,OneNoteWebApp:131072,OneNote:262144,ExcelWinRT:524288,WordWinRT:1048576,PowerpointWinRT:2097152,OutlookAndroid:4194304,OneNoteWinRT:8388608,ExcelAndroid:8388609,VisioWebApp:8388610,OneNoteIOS:8388611,WordAndroid:8388613,PowerpointAndroid:8388614,Visio:8388615,OneNoteAndroid:4194305},OSF.InternalPerfMarker={DataCoercionBegin:"Agave.HostCall.CoerceDataStart",DataCoercionEnd:"Agave.HostCall.CoerceDataEnd"},OSF.HostCallPerfMarker={IssueCall:"Agave.HostCall.IssueCall",ReceiveResponse:"Agave.HostCall.ReceiveResponse",RuntimeExceptionRaised:"Agave.HostCall.RuntimeExecptionRaised"},OSF.AgaveHostAction={Select:0,UnSelect:1,CancelDialog:2,InsertAgave:3,CtrlF6In:4,CtrlF6Exit:5,CtrlF6ExitShift:6,SelectWithError:7,NotifyHostError:8,RefreshAddinCommands:9,PageIsReady:10,TabIn:11,TabInShift:12,TabExit:13,TabExitShift:14,EscExit:15,F2Exit:16,ExitNoFocusable:17,ExitNoFocusableShift:18,MouseEnter:19,MouseLeave:20,UpdateTargetUrl:21,InstallCustomFunctions:22,SendTelemetryEvent:23,UninstallCustomFunctions:24,SendMessage:25,LaunchExtensionComponent:26,StopExtensionComponent:27,RestartExtensionComponent:28,EnableTaskPaneHeaderButton:29,DisableTaskPaneHeaderButton:30,TaskPaneHeaderButtonClicked:31,RemoveAppCommandsAddin:32},OSF.SharedConstants={NotificationConversationIdSuffix:"_ntf"},OSF.DialogMessageType={DialogMessageReceived:0,DialogParentMessageReceived:1,DialogClosed:12006},OSF.OfficeAppContext=function(e,t,n,o,r,i,a,s,c,d,l,u,f,p,m,g,S,v,O,A,D,h,y,C,F,E){var M=this;M._id=e,M._appName=t,M._appVersion=n,M._appUILocale=o,M._dataLocale=r,M._docUrl=i,M._clientMode=a,M._settings=s,M._reason=c,M._osfControlType=d,M._eToken=l,M._correlationId=u,M._appInstanceId=f,M._touchEnabled=p,M._commerceAllowed=m,M._appMinorVersion=g,M._requirementMatrix=S,M._hostCustomMessage=v,M._hostFullVersion=O,M._isDialog=!1,M._clientWindowHeight=A,M._clientWindowWidth=D,M._addinName=h,M._appDomains=y,M._dialogRequirementMatrix=C,M._featureGates=F,M._officeTheme=E,M.get_id=function(){return this._id},M.get_appName=function(){return this._appName},M.get_appVersion=function(){return this._appVersion},M.get_appUILocale=function(){return this._appUILocale},M.get_dataLocale=function(){return this._dataLocale},M.get_docUrl=function(){return this._docUrl},M.get_clientMode=function(){return this._clientMode},M.get_bindings=function(){return this._bindings},M.get_settings=function(){return this._settings},M.get_reason=function(){return this._reason},M.get_osfControlType=function(){return this._osfControlType},M.get_eToken=function(){return this._eToken},M.get_correlationId=function(){return this._correlationId},M.get_appInstanceId=function(){return this._appInstanceId},M.get_touchEnabled=function(){return this._touchEnabled},M.get_commerceAllowed=function(){return this._commerceAllowed},M.get_appMinorVersion=function(){return this._appMinorVersion},M.get_requirementMatrix=function(){return this._requirementMatrix},M.get_dialogRequirementMatrix=function(){return this._dialogRequirementMatrix},M.get_hostCustomMessage=function(){return this._hostCustomMessage},M.get_hostFullVersion=function(){return this._hostFullVersion},M.get_isDialog=function(){return this._isDialog},M.get_clientWindowHeight=function(){return this._clientWindowHeight},M.get_clientWindowWidth=function(){return this._clientWindowWidth},M.get_addinName=function(){return this._addinName},M.get_appDomains=function(){return this._appDomains},M.get_featureGates=function(){return this._featureGates},M.get_officeTheme=function(){return this._officeTheme}},OSF.OsfControlType={DocumentLevel:0,ContainerLevel:1},OSF.ClientMode={ReadOnly:0,ReadWrite:1},OSF.OUtil.setNamespace("Microsoft",window),OSF.OUtil.setNamespace("Office",Microsoft),OSF.OUtil.setNamespace("Client",Microsoft.Office),OSF.OUtil.setNamespace("WebExtension",Microsoft.Office),Microsoft.Office.WebExtension.InitializationReason={Inserted:"inserted",DocumentOpened:"documentOpened"},Microsoft.Office.WebExtension.ValueFormat={Unformatted:"unformatted",Formatted:"formatted"},Microsoft.Office.WebExtension.FilterType={All:"all"},Microsoft.Office.WebExtension.Parameters={BindingType:"bindingType",CoercionType:"coercionType",ValueFormat:"valueFormat",FilterType:"filterType",Columns:"columns",SampleData:"sampleData",GoToType:"goToType",SelectionMode:"selectionMode",Id:"id",PromptText:"promptText",ItemName:"itemName",FailOnCollision:"failOnCollision",StartRow:"startRow",StartColumn:"startColumn",RowCount:"rowCount",ColumnCount:"columnCount",Callback:"callback",AsyncContext:"asyncContext",Data:"data",Rows:"rows",OverwriteIfStale:"overwriteIfStale",FileType:"fileType",EventType:"eventType",Handler:"handler",SliceSize:"sliceSize",SliceIndex:"sliceIndex",ActiveView:"activeView",Status:"status",PlatformType:"platformType",HostType:"hostType",ForceConsent:"forceConsent",ForceAddAccount:"forceAddAccount",AuthChallenge:"authChallenge",AllowConsentPrompt:"allowConsentPrompt",ForMSGraphAccess:"forMSGraphAccess",AllowSignInPrompt:"allowSignInPrompt",Reserved:"reserved",Tcid:"tcid",Xml:"xml",Namespace:"namespace",Prefix:"prefix",XPath:"xPath",Text:"text",ImageLeft:"imageLeft",ImageTop:"imageTop",ImageWidth:"imageWidth",ImageHeight:"imageHeight",TaskId:"taskId",FieldId:"fieldId",FieldValue:"fieldValue",ServerUrl:"serverUrl",ListName:"listName",ResourceId:"resourceId",ViewType:"viewType",ViewName:"viewName",GetRawValue:"getRawValue",CellFormat:"cellFormat",TableOptions:"tableOptions",TaskIndex:"taskIndex",ResourceIndex:"resourceIndex",CustomFieldId:"customFieldId",Url:"url",MessageHandler:"messageHandler",Width:"width",Height:"height",RequireHTTPs:"requireHTTPS",MessageToParent:"messageToParent",DisplayInIframe:"displayInIframe",MessageContent:"messageContent",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen",EnforceAppDomain:"enforceAppDomain",AppCommandInvocationCompletedData:"appCommandInvocationCompletedData",Base64:"base64",FormId:"formId"},OSF.OUtil.setNamespace("DDA",OSF),OSF.DDA.DocumentMode={ReadOnly:1,ReadWrite:0},OSF.DDA.PropertyDescriptors={AsyncResultStatus:"AsyncResultStatus"},OSF.DDA.EventDescriptors={},OSF.DDA.ListDescriptors={},OSF.DDA.UI={},OSF.DDA.getXdmEventName=function(e,t){return t==Microsoft.Office.WebExtension.EventType.BindingSelectionChanged||t==Microsoft.Office.WebExtension.EventType.BindingDataChanged||t==Microsoft.Office.WebExtension.EventType.DataNodeDeleted||t==Microsoft.Office.WebExtension.EventType.DataNodeInserted||t==Microsoft.Office.WebExtension.EventType.DataNodeReplaced?e+"_"+t:t},OSF.DDA.MethodDispId={dispidMethodMin:64,dispidGetSelectedDataMethod:64,dispidSetSelectedDataMethod:65,dispidAddBindingFromSelectionMethod:66,dispidAddBindingFromPromptMethod:67,dispidGetBindingMethod:68,dispidReleaseBindingMethod:69,dispidGetBindingDataMethod:70,dispidSetBindingDataMethod:71,dispidAddRowsMethod:72,dispidClearAllRowsMethod:73,dispidGetAllBindingsMethod:74,dispidLoadSettingsMethod:75,dispidSaveSettingsMethod:76,dispidGetDocumentCopyMethod:77,dispidAddBindingFromNamedItemMethod:78,dispidAddColumnsMethod:79,dispidGetDocumentCopyChunkMethod:80,dispidReleaseDocumentCopyMethod:81,dispidNavigateToMethod:82,dispidGetActiveViewMethod:83,dispidGetDocumentThemeMethod:84,dispidGetOfficeThemeMethod:85,dispidGetFilePropertiesMethod:86,dispidClearFormatsMethod:87,dispidSetTableOptionsMethod:88,dispidSetFormatsMethod:89,dispidExecuteRichApiRequestMethod:93,dispidAppCommandInvocationCompletedMethod:94,dispidCloseContainerMethod:97,dispidGetAccessTokenMethod:98,dispidGetAuthContextMethod:99,dispidOpenBrowserWindow:102,dispidCreateDocumentMethod:105,dispidInsertFormMethod:106,dispidDisplayRibbonCalloutAsyncMethod:109,dispidGetSelectedTaskMethod:110,dispidGetSelectedResourceMethod:111,dispidGetTaskMethod:112,dispidGetResourceFieldMethod:113,dispidGetWSSUrlMethod:114,dispidGetTaskFieldMethod:115,dispidGetProjectFieldMethod:116,dispidGetSelectedViewMethod:117,dispidGetTaskByIndexMethod:118,dispidGetResourceByIndexMethod:119,dispidSetTaskFieldMethod:120,dispidSetResourceFieldMethod:121,dispidGetMaxTaskIndexMethod:122,dispidGetMaxResourceIndexMethod:123,dispidCreateTaskMethod:124,dispidAddDataPartMethod:128,dispidGetDataPartByIdMethod:129,dispidGetDataPartsByNamespaceMethod:130,dispidGetDataPartXmlMethod:131,dispidGetDataPartNodesMethod:132,dispidDeleteDataPartMethod:133,dispidGetDataNodeValueMethod:134,dispidGetDataNodeXmlMethod:135,dispidGetDataNodesMethod:136,dispidSetDataNodeValueMethod:137,dispidSetDataNodeXmlMethod:138,dispidAddDataNamespaceMethod:139,dispidGetDataUriByPrefixMethod:140,dispidGetDataPrefixByUriMethod:141,dispidGetDataNodeTextMethod:142,dispidSetDataNodeTextMethod:143,dispidMessageParentMethod:144,dispidSendMessageMethod:145,dispidExecuteFeature:146,dispidQueryFeature:147,dispidMethodMax:147},OSF.DDA.EventDispId={dispidEventMin:0,dispidInitializeEvent:0,dispidSettingsChangedEvent:1,dispidDocumentSelectionChangedEvent:2,dispidBindingSelectionChangedEvent:3,dispidBindingDataChangedEvent:4,dispidDocumentOpenEvent:5,dispidDocumentCloseEvent:6,dispidActiveViewChangedEvent:7,dispidDocumentThemeChangedEvent:8,dispidOfficeThemeChangedEvent:9,dispidDialogMessageReceivedEvent:10,dispidDialogNotificationShownInAddinEvent:11,dispidDialogParentMessageReceivedEvent:12,dispidObjectDeletedEvent:13,dispidObjectSelectionChangedEvent:14,dispidObjectDataChangedEvent:15,dispidContentControlAddedEvent:16,dispidActivationStatusChangedEvent:32,dispidRichApiMessageEvent:33,dispidAppCommandInvokedEvent:39,dispidOlkItemSelectedChangedEvent:46,dispidOlkRecipientsChangedEvent:47,dispidOlkAppointmentTimeChangedEvent:48,dispidOlkRecurrenceChangedEvent:49,dispidOlkAttachmentsChangedEvent:50,dispidOlkEnhancedLocationsChangedEvent:51,dispidOlkInfobarClickedEvent:52,dispidTaskSelectionChangedEvent:56,dispidResourceSelectionChangedEvent:57,dispidViewSelectionChangedEvent:58,dispidDataNodeAddedEvent:60,dispidDataNodeReplacedEvent:61,dispidDataNodeDeletedEvent:62,dispidEventMax:63},OSF.DDA.ErrorCodeManager=function(){var e={};return{getErrorArgs:function(t){var n=e[t];return n?(n.name||(n.name=e[this.errorCodes.ooeInternalError].name),n.message||(n.message=e[this.errorCodes.ooeInternalError].message)):n=e[this.errorCodes.ooeInternalError],n},addErrorMessage:function(t,n){e[t]=n},errorCodes:{ooeSuccess:0,ooeChunkResult:1,ooeCoercionTypeNotSupported:1e3,ooeGetSelectionNotMatchDataType:1001,ooeCoercionTypeNotMatchBinding:1002,ooeInvalidGetRowColumnCounts:1003,ooeSelectionNotSupportCoercionType:1004,ooeInvalidGetStartRowColumn:1005,ooeNonUniformPartialGetNotSupported:1006,ooeGetDataIsTooLarge:1008,ooeFileTypeNotSupported:1009,ooeGetDataParametersConflict:1010,ooeInvalidGetColumns:1011,ooeInvalidGetRows:1012,ooeInvalidReadForBlankRow:1013,ooeUnsupportedDataObject:2e3,ooeCannotWriteToSelection:2001,ooeDataNotMatchSelection:2002,ooeOverwriteWorksheetData:2003,ooeDataNotMatchBindingSize:2004,ooeInvalidSetStartRowColumn:2005,ooeInvalidDataFormat:2006,ooeDataNotMatchCoercionType:2007,ooeDataNotMatchBindingType:2008,ooeSetDataIsTooLarge:2009,ooeNonUniformPartialSetNotSupported:2010,ooeInvalidSetColumns:2011,ooeInvalidSetRows:2012,ooeSetDataParametersConflict:2013,ooeCellDataAmountBeyondLimits:2014,ooeSelectionCannotBound:3e3,ooeBindingNotExist:3002,ooeBindingToMultipleSelection:3003,ooeInvalidSelectionForBindingType:3004,ooeOperationNotSupportedOnThisBindingType:3005,ooeNamedItemNotFound:3006,ooeMultipleNamedItemFound:3007,ooeInvalidNamedItemForBindingType:3008,ooeUnknownBindingType:3009,ooeOperationNotSupportedOnMatrixData:3010,ooeInvalidColumnsForBinding:3011,ooeSettingNameNotExist:4e3,ooeSettingsCannotSave:4001,ooeSettingsAreStale:4002,ooeOperationNotSupported:5e3,ooeInternalError:5001,ooeDocumentReadOnly:5002,ooeEventHandlerNotExist:5003,ooeInvalidApiCallInContext:5004,ooeShuttingDown:5005,ooeUnsupportedEnumeration:5007,ooeIndexOutOfRange:5008,ooeBrowserAPINotSupported:5009,ooeInvalidParam:5010,ooeRequestTimeout:5011,ooeInvalidOrTimedOutSession:5012,ooeInvalidApiArguments:5013,ooeOperationCancelled:5014,ooeWorkbookHidden:5015,ooeTooManyIncompleteRequests:5100,ooeRequestTokenUnavailable:5101,ooeActivityLimitReached:5102,ooeCustomXmlNodeNotFound:6e3,ooeCustomXmlError:6100,ooeCustomXmlExceedQuota:6101,ooeCustomXmlOutOfDate:6102,ooeNoCapability:7e3,ooeCannotNavTo:7001,ooeSpecifiedIdNotExist:7002,ooeNavOutOfBound:7004,ooeElementMissing:8e3,ooeProtectedError:8001,ooeInvalidCellsValue:8010,ooeInvalidTableOptionValue:8011,ooeInvalidFormatValue:8012,ooeRowIndexOutOfRange:8020,ooeColIndexOutOfRange:8021,ooeFormatValueOutOfRange:8022,ooeCellFormatAmountBeyondLimits:8023,ooeMemoryFileLimit:11e3,ooeNetworkProblemRetrieveFile:11001,ooeInvalidSliceSize:11002,ooeInvalidCallback:11101,ooeInvalidWidth:12e3,ooeInvalidHeight:12001,ooeNavigationError:12002,ooeInvalidScheme:12003,ooeAppDomains:12004,ooeRequireHTTPS:12005,ooeWebDialogClosed:12006,ooeDialogAlreadyOpened:12007,ooeEndUserAllow:12008,ooeEndUserIgnore:12009,ooeNotUILessDialog:12010,ooeCrossZone:12011,ooeNotSSOAgave:13e3,ooeSSOUserNotSignedIn:13001,ooeSSOUserAborted:13002,ooeSSOUnsupportedUserIdentity:13003,ooeSSOInvalidResourceUrl:13004,ooeSSOInvalidGrant:13005,ooeSSOClientError:13006,ooeSSOServerError:13007,ooeAddinIsAlreadyRequestingToken:13008,ooeSSOUserConsentNotSupportedByCurrentAddinCategory:13009,ooeSSOConnectionLost:13010,ooeResourceNotAllowed:13011,ooeSSOUnsupportedPlatform:13012,ooeAccessDenied:13990,ooeGeneralException:13991},initializeErrorMessages:function(t){e[OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported]={name:t.L_InvalidCoercion,message:t.L_CoercionTypeNotSupported},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType]={name:t.L_DataReadError,message:t.L_GetSelectionNotSupported},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding]={name:t.L_InvalidCoercion,message:t.L_CoercionTypeNotMatchBinding},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetRowColumnCounts]={name:t.L_DataReadError,message:t.L_InvalidGetRowColumnCounts},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSelectionNotSupportCoercionType]={name:t.L_DataReadError,message:t.L_SelectionNotSupportCoercionType},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetStartRowColumn]={name:t.L_DataReadError,message:t.L_InvalidGetStartRowColumn},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialGetNotSupported]={name:t.L_DataReadError,message:t.L_NonUniformPartialGetNotSupported},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeGetDataIsTooLarge]={name:t.L_DataReadError,message:t.L_GetDataIsTooLarge},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported]={name:t.L_DataReadError,message:t.L_FileTypeNotSupported},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeGetDataParametersConflict]={name:t.L_DataReadError,message:t.L_GetDataParametersConflict},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetColumns]={name:t.L_DataReadError,message:t.L_InvalidGetColumns},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetRows]={name:t.L_DataReadError,message:t.L_InvalidGetRows},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidReadForBlankRow]={name:t.L_DataReadError,message:t.L_InvalidReadForBlankRow},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedDataObject]={name:t.L_DataWriteError,message:t.L_UnsupportedDataObject},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection]={name:t.L_DataWriteError,message:t.L_CannotWriteToSelection},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchSelection]={name:t.L_DataWriteError,message:t.L_DataNotMatchSelection},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeOverwriteWorksheetData]={name:t.L_DataWriteError,message:t.L_OverwriteWorksheetData},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize]={name:t.L_DataWriteError,message:t.L_DataNotMatchBindingSize},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSetStartRowColumn]={name:t.L_DataWriteError,message:t.L_InvalidSetStartRowColumn},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidDataFormat]={name:t.L_InvalidFormat,message:t.L_InvalidDataFormat},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType]={name:t.L_InvalidDataObject,message:t.L_DataNotMatchCoercionType},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingType]={name:t.L_InvalidDataObject,message:t.L_DataNotMatchBindingType},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataIsTooLarge]={name:t.L_DataWriteError,message:t.L_SetDataIsTooLarge},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialSetNotSupported]={name:t.L_DataWriteError,message:t.L_NonUniformPartialSetNotSupported},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSetColumns]={name:t.L_DataWriteError,message:t.L_InvalidSetColumns},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSetRows]={name:t.L_DataWriteError,message:t.L_InvalidSetRows},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataParametersConflict]={name:t.L_DataWriteError,message:t.L_SetDataParametersConflict},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSelectionCannotBound]={name:t.L_BindingCreationError,message:t.L_SelectionCannotBound},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist]={name:t.L_InvalidBindingError,message:t.L_BindingNotExist},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingToMultipleSelection]={name:t.L_BindingCreationError,message:t.L_BindingToMultipleSelection},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType]={name:t.L_BindingCreationError,message:t.L_InvalidSelectionForBindingType},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnThisBindingType]={name:t.L_InvalidBindingOperation,message:t.L_OperationNotSupportedOnThisBindingType},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeNamedItemNotFound]={name:t.L_BindingCreationError,message:t.L_NamedItemNotFound},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeMultipleNamedItemFound]={name:t.L_BindingCreationError,message:t.L_MultipleNamedItemFound},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidNamedItemForBindingType]={name:t.L_BindingCreationError,message:t.L_InvalidNamedItemForBindingType},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeUnknownBindingType]={name:t.L_InvalidBinding,message:t.L_UnknownBindingType},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnMatrixData]={name:t.L_InvalidBindingOperation,message:t.L_OperationNotSupportedOnMatrixData},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidColumnsForBinding]={name:t.L_InvalidBinding,message:t.L_InvalidColumnsForBinding},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSettingNameNotExist]={name:t.L_ReadSettingsError,message:t.L_SettingNameNotExist},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSettingsCannotSave]={name:t.L_SaveSettingsError,message:t.L_SettingsCannotSave},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSettingsAreStale]={name:t.L_SettingsStaleError,message:t.L_SettingsAreStale},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupported]={name:t.L_HostError,message:t.L_OperationNotSupported},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError]={name:t.L_InternalError,message:t.L_InternalErrorDescription},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeDocumentReadOnly]={name:t.L_PermissionDenied,message:t.L_DocumentReadOnly},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeEventHandlerNotExist]={name:t.L_EventRegistrationError,message:t.L_EventHandlerNotExist},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext]={name:t.L_InvalidAPICall,message:t.L_InvalidApiCallInContext},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeShuttingDown]={name:t.L_ShuttingDown,message:t.L_ShuttingDown},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration]={name:t.L_UnsupportedEnumeration,message:t.L_UnsupportedEnumerationMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange]={name:t.L_IndexOutOfRange,message:t.L_IndexOutOfRange},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported]={name:t.L_APINotSupported,message:t.L_BrowserAPINotSupported},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout]={name:t.L_APICallFailed,message:t.L_RequestTimeout},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidOrTimedOutSession]={name:t.L_InvalidOrTimedOutSession,message:t.L_InvalidOrTimedOutSessionMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests]={name:t.L_APICallFailed,message:t.L_TooManyIncompleteRequests},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTokenUnavailable]={name:t.L_APICallFailed,message:t.L_RequestTokenUnavailable},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeActivityLimitReached]={name:t.L_APICallFailed,message:t.L_ActivityLimitReached},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiArguments]={name:t.L_APICallFailed,message:t.L_InvalidApiArgumentsMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeWorkbookHidden]={name:t.L_APICallFailed,message:t.L_WorkbookHiddenMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlNodeNotFound]={name:t.L_InvalidNode,message:t.L_CustomXmlNodeNotFound},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError]={name:t.L_CustomXmlError,message:t.L_CustomXmlError},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlExceedQuota]={name:t.L_CustomXmlExceedQuotaName,message:t.L_CustomXmlExceedQuotaMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlOutOfDate]={name:t.L_CustomXmlOutOfDateName,message:t.L_CustomXmlOutOfDateMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeNoCapability]={name:t.L_PermissionDenied,message:t.L_NoCapability},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo]={name:t.L_CannotNavigateTo,message:t.L_CannotNavigateTo},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist]={name:t.L_SpecifiedIdNotExist,message:t.L_SpecifiedIdNotExist},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeNavOutOfBound]={name:t.L_NavOutOfBound,message:t.L_NavOutOfBound},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeCellDataAmountBeyondLimits]={name:t.L_DataWriteReminder,message:t.L_CellDataAmountBeyondLimits},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeElementMissing]={name:t.L_MissingParameter,message:t.L_ElementMissing},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeProtectedError]={name:t.L_PermissionDenied,message:t.L_NoCapability},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidCellsValue]={name:t.L_InvalidValue,message:t.L_InvalidCellsValue},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidTableOptionValue]={name:t.L_InvalidValue,message:t.L_InvalidTableOptionValue},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidFormatValue]={name:t.L_InvalidValue,message:t.L_InvalidFormatValue},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeRowIndexOutOfRange]={name:t.L_OutOfRange,message:t.L_RowIndexOutOfRange},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeColIndexOutOfRange]={name:t.L_OutOfRange,message:t.L_ColIndexOutOfRange},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeFormatValueOutOfRange]={name:t.L_OutOfRange,message:t.L_FormatValueOutOfRange},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeCellFormatAmountBeyondLimits]={name:t.L_FormattingReminder,message:t.L_CellFormatAmountBeyondLimits},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit]={name:t.L_MemoryLimit,message:t.L_CloseFileBeforeRetrieve},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile]={name:t.L_NetworkProblem,message:t.L_NetworkProblemRetrieveFile},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize]={name:t.L_InvalidValue,message:t.L_SliceSizeNotSupported},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeDialogAlreadyOpened]={name:t.L_DisplayDialogError,message:t.L_DialogAlreadyOpened},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidWidth]={name:t.L_IndexOutOfRange,message:t.L_IndexOutOfRange},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidHeight]={name:t.L_IndexOutOfRange,message:t.L_IndexOutOfRange},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeNavigationError]={name:t.L_DisplayDialogError,message:t.L_NetworkProblem},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidScheme]={name:t.L_DialogNavigateError,message:t.L_DialogInvalidScheme},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains]={name:t.L_DisplayDialogError,message:t.L_DialogAddressNotTrusted},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeRequireHTTPS]={name:t.L_DisplayDialogError,message:t.L_DialogRequireHTTPS},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeEndUserIgnore]={name:t.L_DisplayDialogError,message:t.L_UserClickIgnore},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeCrossZone]={name:t.L_DisplayDialogError,message:t.L_NewWindowCrossZoneErrorString},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave]={name:t.L_APINotSupported,message:t.L_InvalidSSOAddinMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserNotSignedIn]={name:t.L_UserNotSignedIn,message:t.L_UserNotSignedIn},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted]={name:t.L_UserAborted,message:t.L_UserAbortedMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity]={name:t.L_UnsupportedUserIdentity,message:t.L_UnsupportedUserIdentityMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl]={name:t.L_InvalidResourceUrl,message:t.L_InvalidResourceUrlMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant]={name:t.L_InvalidGrant,message:t.L_InvalidGrantMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError]={name:t.L_SSOClientError,message:t.L_SSOClientErrorMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError]={name:t.L_SSOServerError,message:t.L_SSOServerErrorMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeAddinIsAlreadyRequestingToken]={name:t.L_AddinIsAlreadyRequestingToken,message:t.L_AddinIsAlreadyRequestingTokenMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserConsentNotSupportedByCurrentAddinCategory]={name:t.L_SSOUserConsentNotSupportedByCurrentAddinCategory,message:t.L_SSOUserConsentNotSupportedByCurrentAddinCategoryMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost]={name:t.L_SSOConnectionLostError,message:t.L_SSOConnectionLostErrorMessage},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform]={name:t.L_APINotSupported,message:t.L_SSOUnsupportedPlatform},e[OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationCancelled]={name:t.L_OperationCancelledError,message:t.L_OperationCancelledErrorMessage}}}}(),function(e){!function(e){var t=1.1,n=function(){};e.RequirementVersion=n;var o=function(e){var t=this;t.isSetSupported=function(e,t){if(null==e)return!1;null==t&&(t=0);var n=this._setMap._sets;if(n.hasOwnProperty(e.toLowerCase())){var o=n[e.toLowerCase()];try{var r=this._getVersion(o);t+="";var i=this._getVersion(t);if(r.major>0&&r.major>i.major)return!0;if(r.major>0&&r.minor>=0&&r.major==i.major&&r.minor>=i.minor)return!0}catch(e){return!1}}return!1},t._getVersion=function(e){var t="version format incorrect",n=(e+="").split("."),o=0,r=0;if(n.length<2&&isNaN(Number(e)))throw t;if(o=Number(n[0]),n.length>=2&&(r=Number(n[1])),isNaN(o)||isNaN(r))throw t;return{minor:r,major:o}},t._setMap=e,t.isSetSupported=t.isSetSupported.bind(t)};e.RequirementMatrix=o;var r=function(e){this._addSetMap=function(e){for(var t in e)this._sets[t]=e[t]},this._sets=e};e.DefaultSetRequirement=r;var i=function(e){function n(){e.call(this,{dialogapi:t})}return __extends(n,e),n}(r);e.DefaultDialogSetRequirement=i;var a=function(e){function n(){e.call(this,{bindingevents:t,documentevents:t,excelapi:t,matrixbindings:t,matrixcoercion:t,selection:t,settings:t,tablebindings:t,tablecoercion:t,textbindings:t,textcoercion:t})}return __extends(n,e),n}(r);e.ExcelClientDefaultSetRequirement=a;var s=function(e){function n(){e.call(this),this._addSetMap({imagecoercion:t})}return __extends(n,e),n}(a);e.ExcelClientV1DefaultSetRequirement=s;var c=function(e){function t(){e.call(this,{mailbox:1.3})}return __extends(t,e),t}(r);e.OutlookClientDefaultSetRequirement=c;var d=function(e){function n(){e.call(this,{bindingevents:t,compressedfile:t,customxmlparts:t,documentevents:t,file:t,htmlcoercion:t,matrixbindings:t,matrixcoercion:t,ooxmlcoercion:t,pdffile:t,selection:t,settings:t,tablebindings:t,tablecoercion:t,textbindings:t,textcoercion:t,textfile:t,wordapi:t})}return __extends(n,e),n}(r);e.WordClientDefaultSetRequirement=d;var l=function(e){function n(){e.call(this),this._addSetMap({customxmlparts:1.2,wordapi:1.2,imagecoercion:t})}return __extends(n,e),n}(d);e.WordClientV1DefaultSetRequirement=l;var u=function(e){function n(){e.call(this,{activeview:t,compressedfile:t,documentevents:t,file:t,pdffile:t,selection:t,settings:t,textcoercion:t})}return __extends(n,e),n}(r);e.PowerpointClientDefaultSetRequirement=u;var f=function(e){function n(){e.call(this),this._addSetMap({imagecoercion:t})}return __extends(n,e),n}(u);e.PowerpointClientV1DefaultSetRequirement=f;var p=function(e){function n(){e.call(this,{selection:t,textcoercion:t})}return __extends(n,e),n}(r);e.ProjectClientDefaultSetRequirement=p;var m=function(e){function n(){e.call(this,{bindingevents:t,documentevents:t,matrixbindings:t,matrixcoercion:t,selection:t,settings:t,tablebindings:t,tablecoercion:t,textbindings:t,textcoercion:t,file:t})}return __extends(n,e),n}(r);e.ExcelWebDefaultSetRequirement=m;var g=function(e){function n(){e.call(this,{compressedfile:t,documentevents:t,file:t,imagecoercion:t,matrixcoercion:t,ooxmlcoercion:t,pdffile:t,selection:t,settings:t,tablecoercion:t,textcoercion:t,textfile:t})}return __extends(n,e),n}(r);e.WordWebDefaultSetRequirement=g;var S=function(e){function n(){e.call(this,{activeview:t,settings:t})}return __extends(n,e),n}(r);e.PowerpointWebDefaultSetRequirement=S;var v=function(e){function t(){e.call(this,{mailbox:1.3})}return __extends(t,e),t}(r);e.OutlookWebDefaultSetRequirement=v;var O=function(e){function n(){e.call(this,{activeview:t,documentevents:t,selection:t,settings:t,textcoercion:t})}return __extends(n,e),n}(r);e.SwayWebDefaultSetRequirement=O;var A=function(e){function n(){e.call(this,{bindingevents:t,partialtablebindings:t,settings:t,tablebindings:t,tablecoercion:t})}return __extends(n,e),n}(r);e.AccessWebDefaultSetRequirement=A;var D=function(e){function n(){e.call(this,{bindingevents:t,documentevents:t,matrixbindings:t,matrixcoercion:t,selection:t,settings:t,tablebindings:t,tablecoercion:t,textbindings:t,textcoercion:t})}return __extends(n,e),n}(r);e.ExcelIOSDefaultSetRequirement=D;var h=function(e){function n(){e.call(this,{bindingevents:t,compressedfile:t,customxmlparts:t,documentevents:t,file:t,htmlcoercion:t,matrixbindings:t,matrixcoercion:t,ooxmlcoercion:t,pdffile:t,selection:t,settings:t,tablebindings:t,tablecoercion:t,textbindings:t,textcoercion:t,textfile:t})}return __extends(n,e),n}(r);e.WordIOSDefaultSetRequirement=h;var y=function(e){function t(){e.call(this),this._addSetMap({customxmlparts:1.2,wordapi:1.2})}return __extends(t,e),t}(h);e.WordIOSV1DefaultSetRequirement=y;var C=function(e){function n(){e.call(this,{activeview:t,compressedfile:t,documentevents:t,file:t,pdffile:t,selection:t,settings:t,textcoercion:t})}return __extends(n,e),n}(r);e.PowerpointIOSDefaultSetRequirement=C;var F=function(e){function n(){e.call(this,{mailbox:t})}return __extends(n,e),n}(r);e.OutlookIOSDefaultSetRequirement=F;var E=function(){var e="undefined";function t(){}return t.initializeOsfDda=function(){OSF.OUtil.setNamespace("Requirement",OSF.DDA)},t.getDefaultRequirementMatrix=function(n){this.initializeDefaultSetMatrix();var i=void 0,a=n.get_requirementMatrix();if(null!=a&&a.length>0&&typeof JSON!==e){var s=JSON.parse(n.get_requirementMatrix().toLowerCase());i=new o(new r(s))}else{var c=t.getClientFullVersionString(n);i=null!=t.DefaultSetArrayMatrix&&null!=t.DefaultSetArrayMatrix[c]?new o(t.DefaultSetArrayMatrix[c]):new o(new r({}))}return i},t.getDefaultDialogRequirementMatrix=function(t){var n=void 0,a=t.get_dialogRequirementMatrix();if(null!=a&&a.length>0&&typeof JSON!==e){var s=JSON.parse(t.get_requirementMatrix().toLowerCase());n=new o(new r(s))}else n=new o(new i);return n},t.getClientFullVersionString=function(e){var t=e.get_appMinorVersion(),n="",o="",r=e.get_appName();return(1024==r||4096==r||8192==r||65536==r)&&1==e.get_appVersion()?o=4096==r&&t>=15?"16.00.01":"16.00":64==e.get_appName()?o=e.get_appVersion():(n=t<10?"0"+t:""+t,o=e.get_appVersion()+"."+n),e.get_appName()+"-"+o},t.initializeDefaultSetMatrix=function(){t.DefaultSetArrayMatrix[t.Excel_RCLIENT_1600]=new a,t.DefaultSetArrayMatrix[t.Word_RCLIENT_1600]=new d,t.DefaultSetArrayMatrix[t.PowerPoint_RCLIENT_1600]=new u,t.DefaultSetArrayMatrix[t.Excel_RCLIENT_1601]=new s,t.DefaultSetArrayMatrix[t.Word_RCLIENT_1601]=new l,t.DefaultSetArrayMatrix[t.PowerPoint_RCLIENT_1601]=new f,t.DefaultSetArrayMatrix[t.Outlook_RCLIENT_1600]=new c,t.DefaultSetArrayMatrix[t.Excel_WAC_1600]=new m,t.DefaultSetArrayMatrix[t.Word_WAC_1600]=new g,t.DefaultSetArrayMatrix[t.Outlook_WAC_1600]=new v,t.DefaultSetArrayMatrix[t.Outlook_WAC_1601]=new v,t.DefaultSetArrayMatrix[t.Project_RCLIENT_1600]=new p,t.DefaultSetArrayMatrix[t.Access_WAC_1600]=new A,t.DefaultSetArrayMatrix[t.PowerPoint_WAC_1600]=new S,t.DefaultSetArrayMatrix[t.Excel_IOS_1600]=new D,t.DefaultSetArrayMatrix[t.SWAY_WAC_1600]=new O,t.DefaultSetArrayMatrix[t.Word_IOS_1600]=new h,t.DefaultSetArrayMatrix[t.Word_IOS_16001]=new y,t.DefaultSetArrayMatrix[t.PowerPoint_IOS_1600]=new C,t.DefaultSetArrayMatrix[t.Outlook_IOS_1600]=new F},t.Excel_RCLIENT_1600="1-16.00",t.Excel_RCLIENT_1601="1-16.01",t.Word_RCLIENT_1600="2-16.00",t.Word_RCLIENT_1601="2-16.01",t.PowerPoint_RCLIENT_1600="4-16.00",t.PowerPoint_RCLIENT_1601="4-16.01",t.Outlook_RCLIENT_1600="8-16.00",t.Excel_WAC_1600="16-16.00",t.Word_WAC_1600="32-16.00",t.Outlook_WAC_1600="64-16.00",t.Outlook_WAC_1601="64-16.01",t.Project_RCLIENT_1600="128-16.00",t.Access_WAC_1600="256-16.00",t.PowerPoint_WAC_1600="512-16.00",t.Excel_IOS_1600="1024-16.00",t.SWAY_WAC_1600="2048-16.00",t.Word_IOS_1600="4096-16.00",t.Word_IOS_16001="4096-16.00.01",t.PowerPoint_IOS_1600="8192-16.00",t.Outlook_IOS_1600="65536-16.00",t.DefaultSetArrayMatrix={},t}();e.RequirementsMatrixFactory=E}(e.Requirement||(e.Requirement={}))}(OfficeExt||(OfficeExt={})),OfficeExt.Requirement.RequirementsMatrixFactory.initializeOsfDda(),Microsoft.Office.WebExtension.ApplicationMode={WebEditor:"webEditor",WebViewer:"webViewer",Client:"client"},Microsoft.Office.WebExtension.DocumentMode={ReadOnly:"readOnly",ReadWrite:"readWrite"},OSF.NamespaceManager=function(){var e,t=!1;return{enableShortcut:function(){t||(window.Office?e=window.Office:OSF.OUtil.setNamespace("Office",window),window.Office=Microsoft.Office.WebExtension,t=!0)},disableShortcut:function(){t&&(e?window.Office=e:OSF.OUtil.unsetNamespace("Office",window),t=!1)}}}(),OSF.NamespaceManager.enableShortcut(),Microsoft.Office.WebExtension.useShortNamespace=function(e){e?OSF.NamespaceManager.enableShortcut():OSF.NamespaceManager.disableShortcut()},Microsoft.Office.WebExtension.select=function(e,t){var n;if(e&&"string"==typeof e){var o=e.indexOf("#");if(-1!=o){var r=e.substring(0,o),i=e.substring(o+1);switch(r){case"binding":case"bindings":i&&(n=new OSF.DDA.BindingPromise(i))}}}if(n)return n.onFail=t,n;if(t){var a=typeof t;if("function"!=a)throw OSF.OUtil.formatString(Strings.OfficeOM.L_CallbackNotAFunction,a);var s={};s[Microsoft.Office.WebExtension.Parameters.Callback]=t,OSF.DDA.issueAsyncResult(s,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext,OSF.DDA.ErrorCodeManager.getErrorArgs(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext))}},OSF.DDA.Context=function(e,t,n,o,r){var i="officeTheme",a="requirements",s=this;if(OSF.OUtil.defineEnumerableProperties(s,{contentLanguage:{value:e.get_dataLocale()},displayLanguage:{value:e.get_appUILocale()},touchEnabled:{value:e.get_touchEnabled()},commerceAllowed:{value:e.get_commerceAllowed()},host:{value:OfficeExt.HostName.Host.getInstance().getHost()},platform:{value:OfficeExt.HostName.Host.getInstance().getPlatform()},isDialog:{value:OSF._OfficeAppFactory.getHostInfo().isDialog},diagnostics:{value:OfficeExt.HostName.Host.getInstance().getDiagnostics(e.get_hostFullVersion())}}),n&&OSF.OUtil.defineEnumerableProperty(s,"license",{value:n}),e.ui&&OSF.OUtil.defineEnumerableProperty(s,"ui",{value:e.ui}),e.auth&&OSF.OUtil.defineEnumerableProperty(s,"auth",{value:e.auth}),e.webAuth&&OSF.OUtil.defineEnumerableProperty(s,"webAuth",{value:e.webAuth}),e.application&&OSF.OUtil.defineEnumerableProperty(s,"application",{value:e.application}),e.extensionLifeCycle&&OSF.OUtil.defineEnumerableProperty(s,"extensionLifeCycle",{value:e.extensionLifeCycle}),e.messaging&&OSF.OUtil.defineEnumerableProperty(s,"messaging",{value:e.messaging}),e.ui&&e.ui.taskPaneAction&&OSF.OUtil.defineEnumerableProperty(s,"taskPaneAction",{value:e.ui.taskPaneAction}),e.get_isDialog()){var c=OfficeExt.Requirement.RequirementsMatrixFactory.getDefaultDialogRequirementMatrix(e);OSF.OUtil.defineEnumerableProperty(s,a,{value:c})}else{if(t&&OSF.OUtil.defineEnumerableProperty(s,"document",{value:t}),o){var d=o.displayName||"appOM";delete o.displayName,OSF.OUtil.defineEnumerableProperty(s,d,{value:o})}e.get_officeTheme()?OSF.OUtil.defineEnumerableProperty(s,i,{get:function(){return e.get_officeTheme()}}):r&&OSF.OUtil.defineEnumerableProperty(s,i,{get:function(){return r()}});c=OfficeExt.Requirement.RequirementsMatrixFactory.getDefaultRequirementMatrix(e);OSF.OUtil.defineEnumerableProperty(s,a,{value:c})}},OSF.DDA.OutlookContext=function(e,t,n,o,r){OSF.DDA.OutlookContext.uber.constructor.call(this,e,null,n,o,r),t&&OSF.OUtil.defineEnumerableProperty(this,"roamingSettings",{value:t})},OSF.OUtil.extend(OSF.DDA.OutlookContext,OSF.DDA.Context),OSF.DDA.OutlookAppOm=function(){},OSF.DDA.Application=function(){},OSF.DDA.Document=function(e,t){var n;switch(e.get_clientMode()){case OSF.ClientMode.ReadOnly:n=Microsoft.Office.WebExtension.DocumentMode.ReadOnly;break;case OSF.ClientMode.ReadWrite:n=Microsoft.Office.WebExtension.DocumentMode.ReadWrite}t&&OSF.OUtil.defineEnumerableProperty(this,"settings",{value:t}),OSF.OUtil.defineMutableProperties(this,{mode:{value:n},url:{value:e.get_docUrl()}})},OSF.DDA.JsomDocument=function(e,t,n){var o=this;OSF.DDA.JsomDocument.uber.constructor.call(o,e,n),t&&OSF.OUtil.defineEnumerableProperty(o,"bindings",{get:function(){return t}});var r=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(o,[r.GetSelectedDataAsync,r.SetSelectedDataAsync]),OSF.DDA.DispIdHost.addEventSupport(o,new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.DocumentSelectionChanged]))},OSF.OUtil.extend(OSF.DDA.JsomDocument,OSF.DDA.Document),OSF.OUtil.defineEnumerableProperty(Microsoft.Office.WebExtension,"context",{get:function(){var e;return OSF&&OSF._OfficeAppFactory&&(e=OSF._OfficeAppFactory.getContext()),e}}),OSF.DDA.License=function(e){OSF.OUtil.defineEnumerableProperty(this,"value",{value:e})},OSF.DDA.ApiMethodCall=function(e,t,n,o,r){var i=this,a=e.length,s=OSF.OUtil.delayExecutionAndCache(function(){return OSF.OUtil.formatString(Strings.OfficeOM.L_InvalidParameters,r)});i.verifyArguments=function(e,t){for(var n in e){var o=e[n],r=t[n];if(o.enum)switch(typeof r){case"string":if(OSF.OUtil.listContainsValue(o.enum,r))break;case"undefined":throw OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration;default:throw s()}if(o.types&&!OSF.OUtil.listContainsValue(o.types,typeof r))throw s()}},i.extractRequiredArguments=function(t,n,o){if(t.length<a)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_MissingRequiredArguments);for(var r=[],i=0;i<a;i++)r.push(t[i]);this.verifyArguments(e,r);var c={};for(i=0;i<a;i++){var d=e[i],l=r[i];if(d.verify)if(!d.verify(l,n,o))throw s();c[d.name]=l}return c},i.fillOptions=function(e,n,o,r){for(var i in e=e||{},t)if(!OSF.OUtil.listContainsKey(e,i)){var a=void 0,s=t[i];s.calculate&&n&&(a=s.calculate(n,o,r)),a||void 0===s.defaultValue||(a=s.defaultValue),e[i]=a}return e},i.constructCallArgs=function(e,t,r,i){var a={};for(var s in e)a[s]=e[s];for(var c in t)a[c]=t[c];for(var d in n)a[d]=n[d](r,i);return o&&(a=o(a,r,i)),a}},OSF.OUtil.setNamespace("AsyncResultEnum",OSF.DDA),OSF.DDA.AsyncResultEnum.Properties={Context:"Context",Value:"Value",Status:"Status",Error:"Error"},Microsoft.Office.WebExtension.AsyncResultStatus={Succeeded:"succeeded",Failed:"failed"},OSF.DDA.AsyncResultEnum.ErrorCode={Success:0,Failed:1},OSF.DDA.AsyncResultEnum.ErrorProperties={Name:"Name",Message:"Message",Code:"Code"},OSF.DDA.AsyncMethodNames={},OSF.DDA.AsyncMethodNames.addNames=function(e){for(var t in e){var n={};OSF.OUtil.defineEnumerableProperties(n,{id:{value:t},displayName:{value:e[t]}}),OSF.DDA.AsyncMethodNames[t]=n}},OSF.DDA.AsyncMethodCall=function(e,t,n,o,r,i,a){var s="function",c=e.length,d=new OSF.DDA.ApiMethodCall(e,t,n,i,a);function l(e,n,o,r){if(e.length>c+2)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyArguments);for(var i,a,l=e.length-1;l>=c;l--){var u=e[l];switch(typeof u){case"object":if(i)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyOptionalObjects);i=u;break;case s:if(a)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyOptionalFunction);a=u;break;default:throw OsfMsAjaxFactory.msAjaxError.argument(Strings.OfficeOM.L_InValidOptionalArgument)}}if(i=d.fillOptions(i,n,o,r),a){if(i[Microsoft.Office.WebExtension.Parameters.Callback])throw Strings.OfficeOM.L_RedundantCallbackSpecification;i[Microsoft.Office.WebExtension.Parameters.Callback]=a}return d.verifyArguments(t,i),i}this.verifyAndExtractCall=function(e,t,n){var o=d.extractRequiredArguments(e,t,n),r=l(e,o,t,n);return d.constructCallArgs(o,r,t,n)},this.processResponse=function(e,t,n,i){return e==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?o?o(t,n,i):t:r?r(e,t):OSF.DDA.ErrorCodeManager.getErrorArgs(e)},this.getCallArgs=function(e){for(var t,n,o=e.length-1;o>=c;o--){var r=e[o];switch(typeof r){case"object":t=r;break;case s:n=r}}return t=t||{},n&&(t[Microsoft.Office.WebExtension.Parameters.Callback]=n),t}},OSF.DDA.AsyncMethodCallFactory={manufacture:function(e){var t=e.supportedOptions?OSF.OUtil.createObject(e.supportedOptions):[],n=e.privateStateCallbacks?OSF.OUtil.createObject(e.privateStateCallbacks):[];return new OSF.DDA.AsyncMethodCall(e.requiredArguments||[],t,n,e.onSucceeded,e.onFailed,e.checkCallArgs,e.method.displayName)}},OSF.DDA.AsyncMethodCalls={},OSF.DDA.AsyncMethodCalls.define=function(e){OSF.DDA.AsyncMethodCalls[e.method.id]=OSF.DDA.AsyncMethodCallFactory.manufacture(e)},OSF.DDA.Error=function(e,t,n){OSF.OUtil.defineEnumerableProperties(this,{name:{value:e},message:{value:t},code:{value:n}})},OSF.DDA.AsyncResult=function(e,t){OSF.OUtil.defineEnumerableProperties(this,{value:{value:e[OSF.DDA.AsyncResultEnum.Properties.Value]},status:{value:t?Microsoft.Office.WebExtension.AsyncResultStatus.Failed:Microsoft.Office.WebExtension.AsyncResultStatus.Succeeded}}),e[OSF.DDA.AsyncResultEnum.Properties.Context]&&OSF.OUtil.defineEnumerableProperty(this,"asyncContext",{value:e[OSF.DDA.AsyncResultEnum.Properties.Context]}),t&&OSF.OUtil.defineEnumerableProperty(this,"error",{value:new OSF.DDA.Error(t[OSF.DDA.AsyncResultEnum.ErrorProperties.Name],t[OSF.DDA.AsyncResultEnum.ErrorProperties.Message],t[OSF.DDA.AsyncResultEnum.ErrorProperties.Code])})},OSF.DDA.issueAsyncResult=function(e,t,n){var o=e[Microsoft.Office.WebExtension.Parameters.Callback];if(o){var r,i={};i[OSF.DDA.AsyncResultEnum.Properties.Context]=e[Microsoft.Office.WebExtension.Parameters.AsyncContext],t==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?i[OSF.DDA.AsyncResultEnum.Properties.Value]=n:(r={},n=n||OSF.DDA.ErrorCodeManager.getErrorArgs(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),r[OSF.DDA.AsyncResultEnum.ErrorProperties.Code]=t||OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,r[OSF.DDA.AsyncResultEnum.ErrorProperties.Name]=n.name||n,r[OSF.DDA.AsyncResultEnum.ErrorProperties.Message]=n.message||n),o(new OSF.DDA.AsyncResult(i,r))}},OSF.DDA.SyncMethodNames={},OSF.DDA.SyncMethodNames.addNames=function(e){for(var t in e){var n={};OSF.OUtil.defineEnumerableProperties(n,{id:{value:t},displayName:{value:e[t]}}),OSF.DDA.SyncMethodNames[t]=n}},OSF.DDA.SyncMethodCall=function(e,t,n,o,r){var i=e.length,a=new OSF.DDA.ApiMethodCall(e,t,n,o,r);function s(e,n,o,r){if(e.length>i+1)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyArguments);for(var s,c=e.length-1;c>=i;c--){var d=e[c];switch(typeof d){case"object":if(s)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyOptionalObjects);s=d;break;default:throw OsfMsAjaxFactory.msAjaxError.argument(Strings.OfficeOM.L_InValidOptionalArgument)}}return s=a.fillOptions(s,n,o,r),a.verifyArguments(t,s),s}this.verifyAndExtractCall=function(e,t,n){var o=a.extractRequiredArguments(e,t,n),r=s(e,o,t,n);return a.constructCallArgs(o,r,t,n)}},OSF.DDA.SyncMethodCallFactory={manufacture:function(e){var t=e.supportedOptions?OSF.OUtil.createObject(e.supportedOptions):[];return new OSF.DDA.SyncMethodCall(e.requiredArguments||[],t,e.privateStateCallbacks,e.checkCallArgs,e.method.displayName)}},OSF.DDA.SyncMethodCalls={},OSF.DDA.SyncMethodCalls.define=function(e){OSF.DDA.SyncMethodCalls[e.method.id]=OSF.DDA.SyncMethodCallFactory.manufacture(e)},OSF.DDA.ListType=function(){var e={};return{setListType:function(t,n){e[t]=n},isListType:function(t){return OSF.OUtil.listContainsKey(e,t)},getDescriptor:function(t){return e[t]}}}(),OSF.DDA.HostParameterMap=function(e,t){var n="fromHost",o=this,r="toHost",i=n,a="sourceData",s="self",c={};function d(n,o){var r=n?{}:void 0;for(var a in n){var s,l=n[a];if(OSF.DDA.ListType.isListType(a))for(var u in s=[],l)s.push(d(l[u],o));else if(OSF.OUtil.listContainsKey(c,a))s=c[a][o](l);else if(o==i&&e.preserveNesting(a))s=d(l,o);else{var f=t[a];if(f){var p=f[o];p&&void 0===(s=p[l])&&(s=l)}else s=l}r[a]=s}return r}function l(n,o){var i;for(var a in o){var c;if(null!=(c=e.isComplexType(a)?l(n,t[a][r]):n[a])){i||(i={});var d=o[a];d==s&&(d=a),i[d]=e.pack(a,c)}}return i}function u(n,o,r){for(var c in r||(r={}),o){var d,l,f=o[c];if(f==s)d=n;else{if(f==a){r[c]=n.toArray();continue}d=n[f]}if(null==d)r[c]=void 0;else if(d=e.unpack(c,d),e.isComplexType(c))l=t[c][i],e.preserveNesting(c)?r[c]=u(d,l):u(d,l,r);else if(OSF.DDA.ListType.isListType(c)){(l={})[OSF.DDA.ListType.getDescriptor(c)]=s;var p=new Array(d.length);for(var m in d)p[m]=u(d[m],l);r[c]=p}else r[c]=d}return r}function f(e,o,r){var i,a=t[e][r];if("toHost"==r)i=l(d(o,r),a);else if(r==n){i=d(u(o,a),r)}return i}c[Microsoft.Office.WebExtension.Parameters.Data]={toHost:function(e){if(null!=e&&void 0!==e.rows){var t={};t[OSF.DDA.TableDataProperties.TableRows]=e.rows,t[OSF.DDA.TableDataProperties.TableHeaders]=e.headers,e=t}return e},fromHost:function(e){return e}},c[Microsoft.Office.WebExtension.Parameters.SampleData]=c[Microsoft.Office.WebExtension.Parameters.Data],t||(t={}),o.addMapping=function(e,n){var o,a;if(n.map)for(var c in a={},o=n.map){var d=o[c];d==s&&(d=c),a[d]=c}else o=n.toHost,a=n.fromHost;var l=t[e];if(l){var u=l[r];for(var f in u)o[f]=u[f];for(var p in u=l[i])a[p]=u[p]}else l=t[e]={};l[r]=o,l[i]=a},o.toHost=function(e,t){return f(e,t,r)},o.fromHost=function(e,t){return f(e,t,i)},o.self=s,o.sourceData=a,o.addComplexType=function(t){e.addComplexType(t)},o.getDynamicType=function(t){return e.getDynamicType(t)},o.setDynamicType=function(t,n){e.setDynamicType(t,n)},o.dynamicTypes=c,o.doMapValues=function(e,t){return d(e,t)}},OSF.DDA.SpecialProcessor=function(e,t){var n=this;n.addComplexType=function(t){e.push(t)},n.getDynamicType=function(e){return t[e]},n.setDynamicType=function(e,n){t[e]=n},n.isComplexType=function(t){return OSF.OUtil.listContainsValue(e,t)},n.isDynamicType=function(e){return OSF.OUtil.listContainsKey(t,e)},n.preserveNesting=function(e){var t=[];return OSF.DDA.PropertyDescriptors&&t.push(OSF.DDA.PropertyDescriptors.Subset),OSF.DDA.DataNodeEventProperties&&(t=t.concat([OSF.DDA.DataNodeEventProperties.OldNode,OSF.DDA.DataNodeEventProperties.NewNode,OSF.DDA.DataNodeEventProperties.NextSiblingNode])),OSF.OUtil.listContainsValue(t,e)},n.pack=function(e,n){return this.isDynamicType(e)?t[e].toHost(n):n},n.unpack=function(e,n){return this.isDynamicType(e)?t[e].fromHost(n):n}},OSF.DDA.getDecoratedParameterMap=function(e,t){var n=new OSF.DDA.HostParameterMap(e);n.self;function o(e){var t=null;if(e){t={};for(var n=e.length,o=0;o<n;o++)t[e[o].name]=e[o].value}return t}for(var r in n.define=function(e){var t={},r=o(e.toHost);e.invertible?t.map=r:e.canonical?t.toHost=t.fromHost=r:(t.toHost=r,t.fromHost=o(e.fromHost)),n.addMapping(e.type,t),e.isComplexType&&n.addComplexType(e.type)},t)n.define(t[r]);return n},OSF.OUtil.setNamespace("DispIdHost",OSF.DDA),OSF.DDA.DispIdHost.Methods={InvokeMethod:"invokeMethod",AddEventHandler:"addEventHandler",RemoveEventHandler:"removeEventHandler",OpenDialog:"openDialog",CloseDialog:"closeDialog",MessageParent:"messageParent",SendMessage:"sendMessage"},OSF.DDA.DispIdHost.Delegates={ExecuteAsync:"executeAsync",RegisterEventAsync:"registerEventAsync",UnregisterEventAsync:"unregisterEventAsync",ParameterMap:"parameterMap",OpenDialog:"openDialog",CloseDialog:"closeDialog",MessageParent:"messageParent",SendMessage:"sendMessage"},OSF.DDA.DispIdHost.Facade=function(e,t){var n=!1,o=null,r=this,i={},a=OSF.DDA.AsyncMethodNames,s=OSF.DDA.MethodDispId,c={GoToByIdAsync:s.dispidNavigateToMethod,GetSelectedDataAsync:s.dispidGetSelectedDataMethod,SetSelectedDataAsync:s.dispidSetSelectedDataMethod,GetDocumentCopyChunkAsync:s.dispidGetDocumentCopyChunkMethod,ReleaseDocumentCopyAsync:s.dispidReleaseDocumentCopyMethod,GetDocumentCopyAsync:s.dispidGetDocumentCopyMethod,AddFromSelectionAsync:s.dispidAddBindingFromSelectionMethod,AddFromPromptAsync:s.dispidAddBindingFromPromptMethod,AddFromNamedItemAsync:s.dispidAddBindingFromNamedItemMethod,GetAllAsync:s.dispidGetAllBindingsMethod,GetByIdAsync:s.dispidGetBindingMethod,ReleaseByIdAsync:s.dispidReleaseBindingMethod,GetDataAsync:s.dispidGetBindingDataMethod,SetDataAsync:s.dispidSetBindingDataMethod,AddRowsAsync:s.dispidAddRowsMethod,AddColumnsAsync:s.dispidAddColumnsMethod,DeleteAllDataValuesAsync:s.dispidClearAllRowsMethod,RefreshAsync:s.dispidLoadSettingsMethod,SaveAsync:s.dispidSaveSettingsMethod,GetActiveViewAsync:s.dispidGetActiveViewMethod,GetFilePropertiesAsync:s.dispidGetFilePropertiesMethod,GetOfficeThemeAsync:s.dispidGetOfficeThemeMethod,GetDocumentThemeAsync:s.dispidGetDocumentThemeMethod,ClearFormatsAsync:s.dispidClearFormatsMethod,SetTableOptionsAsync:s.dispidSetTableOptionsMethod,SetFormatsAsync:s.dispidSetFormatsMethod,GetAccessTokenAsync:s.dispidGetAccessTokenMethod,GetAuthContextAsync:s.dispidGetAuthContextMethod,ExecuteRichApiRequestAsync:s.dispidExecuteRichApiRequestMethod,AppCommandInvocationCompletedAsync:s.dispidAppCommandInvocationCompletedMethod,CloseContainerAsync:s.dispidCloseContainerMethod,OpenBrowserWindow:s.dispidOpenBrowserWindow,CreateDocumentAsync:s.dispidCreateDocumentMethod,InsertFormAsync:s.dispidInsertFormMethod,ExecuteFeature:s.dispidExecuteFeature,QueryFeature:s.dispidQueryFeature,AddDataPartAsync:s.dispidAddDataPartMethod,GetDataPartByIdAsync:s.dispidGetDataPartByIdMethod,GetDataPartsByNameSpaceAsync:s.dispidGetDataPartsByNamespaceMethod,GetPartXmlAsync:s.dispidGetDataPartXmlMethod,GetPartNodesAsync:s.dispidGetDataPartNodesMethod,DeleteDataPartAsync:s.dispidDeleteDataPartMethod,GetNodeValueAsync:s.dispidGetDataNodeValueMethod,GetNodeXmlAsync:s.dispidGetDataNodeXmlMethod,GetRelativeNodesAsync:s.dispidGetDataNodesMethod,SetNodeValueAsync:s.dispidSetDataNodeValueMethod,SetNodeXmlAsync:s.dispidSetDataNodeXmlMethod,AddDataPartNamespaceAsync:s.dispidAddDataNamespaceMethod,GetDataPartNamespaceAsync:s.dispidGetDataUriByPrefixMethod,GetDataPartPrefixAsync:s.dispidGetDataPrefixByUriMethod,GetNodeTextAsync:s.dispidGetDataNodeTextMethod,SetNodeTextAsync:s.dispidSetDataNodeTextMethod,GetSelectedTask:s.dispidGetSelectedTaskMethod,GetTask:s.dispidGetTaskMethod,GetWSSUrl:s.dispidGetWSSUrlMethod,GetTaskField:s.dispidGetTaskFieldMethod,GetSelectedResource:s.dispidGetSelectedResourceMethod,GetResourceField:s.dispidGetResourceFieldMethod,GetProjectField:s.dispidGetProjectFieldMethod,GetSelectedView:s.dispidGetSelectedViewMethod,GetTaskByIndex:s.dispidGetTaskByIndexMethod,GetResourceByIndex:s.dispidGetResourceByIndexMethod,SetTaskField:s.dispidSetTaskFieldMethod,SetResourceField:s.dispidSetResourceFieldMethod,GetMaxTaskIndex:s.dispidGetMaxTaskIndexMethod,GetMaxResourceIndex:s.dispidGetMaxResourceIndexMethod,CreateTask:s.dispidCreateTaskMethod};for(var d in c)a[d]&&(i[a[d].id]=c[d]);a=OSF.DDA.SyncMethodNames;var l={MessageParent:(s=OSF.DDA.MethodDispId).dispidMessageParentMethod,SendMessage:s.dispidSendMessageMethod};for(var d in l)a[d]&&(i[a[d].id]=l[d]);a=Microsoft.Office.WebExtension.EventType;var u={SettingsChanged:(s=OSF.DDA.EventDispId).dispidSettingsChangedEvent,DocumentSelectionChanged:s.dispidDocumentSelectionChangedEvent,BindingSelectionChanged:s.dispidBindingSelectionChangedEvent,BindingDataChanged:s.dispidBindingDataChangedEvent,ActiveViewChanged:s.dispidActiveViewChangedEvent,OfficeThemeChanged:s.dispidOfficeThemeChangedEvent,DocumentThemeChanged:s.dispidDocumentThemeChangedEvent,AppCommandInvoked:s.dispidAppCommandInvokedEvent,DialogMessageReceived:s.dispidDialogMessageReceivedEvent,DialogParentMessageReceived:s.dispidDialogParentMessageReceivedEvent,ObjectDeleted:s.dispidObjectDeletedEvent,ObjectSelectionChanged:s.dispidObjectSelectionChangedEvent,ObjectDataChanged:s.dispidObjectDataChangedEvent,ContentControlAdded:s.dispidContentControlAddedEvent,RichApiMessage:s.dispidRichApiMessageEvent,ItemChanged:s.dispidOlkItemSelectedChangedEvent,RecipientsChanged:s.dispidOlkRecipientsChangedEvent,AppointmentTimeChanged:s.dispidOlkAppointmentTimeChangedEvent,RecurrenceChanged:s.dispidOlkRecurrenceChangedEvent,AttachmentsChanged:s.dispidOlkAttachmentsChangedEvent,EnhancedLocationsChanged:s.dispidOlkEnhancedLocationsChangedEvent,InfobarClicked:s.dispidOlkInfobarClickedEvent,TaskSelectionChanged:s.dispidTaskSelectionChangedEvent,ResourceSelectionChanged:s.dispidResourceSelectionChangedEvent,ViewSelectionChanged:s.dispidViewSelectionChangedEvent,DataNodeInserted:s.dispidDataNodeAddedEvent,DataNodeReplaced:s.dispidDataNodeReplacedEvent,DataNodeDeleted:s.dispidDataNodeDeletedEvent};for(var f in u)a[f]&&(i[a[f]]=u[f]);function p(e){return e==OSF.DDA.EventDispId.dispidObjectDeletedEvent||e==OSF.DDA.EventDispId.dispidObjectSelectionChangedEvent||e==OSF.DDA.EventDispId.dispidObjectDataChangedEvent||e==OSF.DDA.EventDispId.dispidContentControlAddedEvent}function m(e,t,n,o){if("number"!=typeof e)throw e;o||(o=t.getCallArgs(n)),OSF.DDA.issueAsyncResult(o,e,OSF.DDA.ErrorCodeManager.getErrorArgs(e))}r[OSF.DDA.DispIdHost.Methods.InvokeMethod]=function(n,r,a,s){var c;try{var d=n.id,l=OSF.DDA.AsyncMethodCalls[d];c=l.verifyAndExtractCall(r,a,s);var u=i[d],f=e(d),p=o;if(window.Excel&&window.Office.context.requirements.isSetSupported("RedirectV1Api")&&(window.Excel._RedirectV1APIs=!0),window.Excel&&window.Excel._RedirectV1APIs&&(p=window.Excel._V1APIMap[d])){var g=OSF.OUtil.shallowCopy(c);delete g[Microsoft.Office.WebExtension.Parameters.AsyncContext],p.preprocess&&(g=p.preprocess(g));var S=new window.Excel.RequestContext,v=p.call(S,g);S.sync().then(function(){var e=v.value,t=e.status;delete e.status,delete e["@odata.type"],p.postprocess&&(e=p.postprocess(e,g)),0!=t&&(e=OSF.DDA.ErrorCodeManager.getErrorArgs(t)),OSF.DDA.issueAsyncResult(c,t,e)}).catch(function(){OSF.DDA.issueAsyncResult(c,OSF.DDA.ErrorCodeManager.errorCodes.ooeFailure,o)})}else{var O;O=t.toHost?t.toHost(u,c):c;var A=(new Date).getTime();f[OSF.DDA.DispIdHost.Delegates.ExecuteAsync]({dispId:u,hostCallArgs:O,onCalling:function(){},onReceiving:function(){},onComplete:function(e,n){var o;o=e==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&t.fromHost?t.fromHost(u,n):n;var r=l.processResponse(e,o,a,c);OSF.DDA.issueAsyncResult(c,e,r),OSF.AppTelemetry&&(!OSF.ConstantNames||!OSF.ConstantNames.IsCustomFunctionsRuntime)&&OSF.AppTelemetry.onMethodDone(u,O,Math.abs((new Date).getTime()-A),e)}})}}catch(e){m(e,l,r,c)}},r[OSF.DDA.DispIdHost.Methods.AddEventHandler]=function(o,r,a,s){var c,d,l,u=n;function f(e){var t;e==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&((u?r.addObjectEventHandler(d,c[Microsoft.Office.WebExtension.Parameters.Id],l):r.addEventHandler(d,l))||(e=OSF.DDA.ErrorCodeManager.errorCodes.ooeEventHandlerAdditionFailed));e!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(t=OSF.DDA.ErrorCodeManager.getErrorArgs(e)),OSF.DDA.issueAsyncResult(c,e,t)}try{var g=OSF.DDA.AsyncMethodCalls[OSF.DDA.AsyncMethodNames.AddHandlerAsync.id];if(c=g.verifyAndExtractCall(o,a,r),d=c[Microsoft.Office.WebExtension.Parameters.EventType],l=c[Microsoft.Office.WebExtension.Parameters.Handler],s)return void f(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);var S=i[d],v=(u=p(S))?c[Microsoft.Office.WebExtension.Parameters.Id]:a.id||"";if(0==(u?r.getObjectEventHandlerCount(d,v):r.getEventHandlerCount(d)))(0,e(d)[OSF.DDA.DispIdHost.Delegates.RegisterEventAsync])({eventType:d,dispId:S,targetId:v,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)},onComplete:f,onEvent:function(e){var n=t.fromHost(S,e);u?r.fireObjectEvent(v,OSF.DDA.OMFactory.manufactureEventArgs(d,v,n)):r.fireEvent(OSF.DDA.OMFactory.manufactureEventArgs(d,a,n))}});else f(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(e){m(e,g,o,c)}},r[OSF.DDA.DispIdHost.Methods.RemoveEventHandler]=function(t,r,a){var s,c,d,l=n;function u(e){var t;e!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(t=OSF.DDA.ErrorCodeManager.getErrorArgs(e)),OSF.DDA.issueAsyncResult(s,e,t)}try{var f=OSF.DDA.AsyncMethodCalls[OSF.DDA.AsyncMethodNames.RemoveHandlerAsync.id];c=(s=f.verifyAndExtractCall(t,a,r))[Microsoft.Office.WebExtension.Parameters.EventType],d=s[Microsoft.Office.WebExtension.Parameters.Handler];var g,S,v=i[c],O=(l=p(v))?s[Microsoft.Office.WebExtension.Parameters.Id]:a.id||"";d===o?(S=l?r.clearObjectEventHandlers(c,O):r.clearEventHandlers(c),g=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):g=(S=l?r.removeObjectEventHandler(c,O,d):r.removeEventHandler(c,d))?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeEventHandlerNotExist;var A=l?r.getObjectEventHandlerCount(c,O):r.getEventHandlerCount(c);if(S&&0==A)(0,e(c)[OSF.DDA.DispIdHost.Delegates.UnregisterEventAsync])({eventType:c,dispId:v,targetId:O,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)},onComplete:u});else u(g)}catch(e){m(e,f,t,s)}},r[OSF.DDA.DispIdHost.Methods.OpenDialog]=function(r,a,s){var c,d,l=Microsoft.Office.WebExtension.EventType.DialogMessageReceived,u=Microsoft.Office.WebExtension.EventType.DialogEventReceived;function f(e){if(e!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)n=OSF.DDA.ErrorCodeManager.getErrorArgs(e);else{var t={};t[Microsoft.Office.WebExtension.Parameters.Id]=d,t[Microsoft.Office.WebExtension.Parameters.Data]=a;var n=p.processResponse(e,t,s,c);OSF.DialogShownStatus.hasDialogShown=!0,a.clearEventHandlers(l),a.clearEventHandlers(u)}OSF.DDA.issueAsyncResult(c,e,n)}try{if((null==l||null==u)&&f(OSF.DDA.ErrorCodeManager.ooeOperationNotSupported),OSF.DDA.AsyncMethodNames.DisplayDialogAsync==o)return void f(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);var p=OSF.DDA.AsyncMethodCalls[OSF.DDA.AsyncMethodNames.DisplayDialogAsync.id];c=p.verifyAndExtractCall(r,s,a);var g=i[l],S=e(l),v=null!=S[OSF.DDA.DispIdHost.Delegates.OpenDialog]?S[OSF.DDA.DispIdHost.Delegates.OpenDialog]:S[OSF.DDA.DispIdHost.Delegates.RegisterEventAsync];d=JSON.stringify(c),OSF.DialogShownStatus.hasDialogShown||(a.clearQueuedEvent(l),a.clearQueuedEvent(u),a.clearQueuedEvent(Microsoft.Office.WebExtension.EventType.DialogParentMessageReceived)),v({eventType:l,dispId:g,targetId:d,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)},onComplete:f,onEvent:function(e){var o=t.fromHost(g,e),r=OSF.DDA.OMFactory.manufactureEventArgs(l,s,o);if(r.type==u){var i=OSF.DDA.ErrorCodeManager.getErrorArgs(r.error),c={};c[OSF.DDA.AsyncResultEnum.ErrorProperties.Code]=status||OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,c[OSF.DDA.AsyncResultEnum.ErrorProperties.Name]=i.name||i,c[OSF.DDA.AsyncResultEnum.ErrorProperties.Message]=i.message||i,r.error=new OSF.DDA.Error(c[OSF.DDA.AsyncResultEnum.ErrorProperties.Name],c[OSF.DDA.AsyncResultEnum.ErrorProperties.Message],c[OSF.DDA.AsyncResultEnum.ErrorProperties.Code])}a.fireOrQueueEvent(r),o[OSF.DDA.PropertyDescriptors.MessageType]==OSF.DialogMessageType.DialogClosed&&(a.clearEventHandlers(l),a.clearEventHandlers(u),a.clearEventHandlers(Microsoft.Office.WebExtension.EventType.DialogParentMessageReceived),OSF.DialogShownStatus.hasDialogShown=n)}})}catch(e){m(e,p,r,c)}},r[OSF.DDA.DispIdHost.Methods.CloseDialog]=function(t,o,r,a){var s,c,d,l=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;try{var u=OSF.DDA.AsyncMethodCalls[OSF.DDA.AsyncMethodNames.CloseAsync.id];s=u.verifyAndExtractCall(t,a,r),c=Microsoft.Office.WebExtension.EventType.DialogMessageReceived,d=Microsoft.Office.WebExtension.EventType.DialogEventReceived,r.clearEventHandlers(c),r.clearEventHandlers(d);var f=i[c],p=e(c);(null!=p[OSF.DDA.DispIdHost.Delegates.CloseDialog]?p[OSF.DDA.DispIdHost.Delegates.CloseDialog]:p[OSF.DDA.DispIdHost.Delegates.UnregisterEventAsync])({eventType:c,dispId:f,targetId:o,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)},onComplete:function(e){l=e,OSF.DialogShownStatus.hasDialogShown=n}})}catch(e){m(e,u,t,s)}if(l!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)throw OSF.OUtil.formatString(Strings.OfficeOM.L_FunctionCallFailed,OSF.DDA.AsyncMethodNames.CloseAsync.displayName,l)},r[OSF.DDA.DispIdHost.Methods.MessageParent]=function(t,n){var o=OSF.DDA.SyncMethodCalls[OSF.DDA.SyncMethodNames.MessageParent.id].verifyAndExtractCall(t,n,{});return(0,e(OSF.DDA.SyncMethodNames.MessageParent.id)[OSF.DDA.DispIdHost.Delegates.MessageParent])({dispId:i[OSF.DDA.SyncMethodNames.MessageParent.id],hostCallArgs:o,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)}})},r[OSF.DDA.DispIdHost.Methods.SendMessage]=function(t,n,o){var r=OSF.DDA.SyncMethodCalls[OSF.DDA.SyncMethodNames.SendMessage.id].verifyAndExtractCall(t,o,{});return(0,e(OSF.DDA.SyncMethodNames.SendMessage.id)[OSF.DDA.DispIdHost.Delegates.SendMessage])({dispId:i[OSF.DDA.SyncMethodNames.SendMessage.id],hostCallArgs:r,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)}})}},OSF.DDA.DispIdHost.addAsyncMethods=function(e,t,n){for(var o in t){var r=t[o],i=r.displayName;!e[i]&&OSF.OUtil.defineEnumerableProperty(e,i,{value:function(t){return function(){var o=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.InvokeMethod];o(t,arguments,e,n)}}(r)})}},OSF.DDA.DispIdHost.addEventSupport=function(e,t,n){var o=OSF.DDA.AsyncMethodNames.AddHandlerAsync.displayName,r=OSF.DDA.AsyncMethodNames.RemoveHandlerAsync.displayName;!e[o]&&OSF.OUtil.defineEnumerableProperty(e,o,{value:function(){var o=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.AddEventHandler];o(arguments,t,e,n)}}),!e[r]&&OSF.OUtil.defineEnumerableProperty(e,r,{value:function(){var n=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.RemoveEventHandler];n(arguments,t,e)}})},OSF.ShowWindowDialogParameterKeys={Url:"url",Width:"width",Height:"height",DisplayInIframe:"displayInIframe",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen",EnforceAppDomain:"enforceAppDomain"},OSF.HostThemeButtonStyleKeys={ButtonBorderColor:"buttonBorderColor",ButtonBackgroundColor:"buttonBackgroundColor"},OSF.OmexPageParameterKeys={AppName:"client",AppVersion:"cv",AppUILocale:"ui",AppDomain:"appDomain",StoreLocator:"rs",AssetId:"assetid",NotificationType:"notificationType",AppCorrelationId:"corr",AuthType:"authType",AppId:"appid",Scopes:"scopes"},OSF.AuthType={Anonymous:0,MSA:1,OrgId:2,ADAL:3},OSF.OmexMessageKeys={MessageType:"messageType",MessageValue:"messageValue"},OSF.OmexRemoveAddinMessageKeys={RemoveAddinResultCode:"resultCode",RemoveAddinResultValue:"resultValue"},OSF.OmexRemoveAddinResultCode={Success:0,ClientError:400,ServerError:500,UnknownError:600},function(e){!function(e){var t="^https://[a-z0-9-]+.(officeapps.live|officeapps-df.live|partner.officewebapps).com/";function n(e){if("undefined"!=typeof JSON)try{return JSON.stringify(e)}catch(e){}return""}function o(){try{var e=window.navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1||e.indexOf("Edge/")>-1}catch(e){return r("Error happens in isInternetExplorer.",e),!1}}function r(e,t){OsfMsAjaxFactory.msAjaxDebug.trace(e+" Exception details: "+n(t))}e.parseAppContextFromWindowName=function(e,t){return OSF.OUtil.parseInfoFromWindowName(e,t,OSF.WindowNameItemKeys.AppContext)},e.serializeObjectToString=n,e.isHostTrusted=function(){return new RegExp(t).test(OSF.getClientEndPoint()._targetUrl.toLowerCase())},e.addHostInfoAsQueryParam=function(e,t){if(!e)return null;var n,o="#",r=(e=e.trim()||"").split(o),i=r.shift(),a=r.join(o),s=i.split("?");return s.length>1?n=i+"&_host_Info="+t:s.length>0&&(n=i+"?_host_Info="+t),a?[n,o,a].join(""):n},e.getDomainForUrl=function(e){if(!e)return null;var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host},e.shouldUseLocalStorageToPassMessage=function(){try{for(var e=["Windows NT 6.1","Windows NT 6.2","Windows NT 6.3","Windows NT 10.0"],t=window.navigator.userAgent,n=0,i=e.length;n<i;n++)if(t.indexOf(e[n])>-1)return o();return!1}catch(e){return r("Error happens in shouldUseLocalStorageToPassMessage.",e),!1}},e.isInternetExplorer=o,e.removeMatchesFromLocalStorage=function(e){for(var t=OSF.OUtil.getLocalStorage(),n=t.getKeysWithPrefix(""),o=0,r=n.length;o<r;o++)for(var i=n[o],a=0,s=e.length;a<s;a++)if(e[a].test(i)){t.removeItem(i);break}},e.logExceptionToBrowserConsole=r;var i=function(){function e(){}return e.GatedCacheKeyPrefix="__OSF_GATED_OMEX.",e.AnonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.",e.UngatedCacheKeyPrefix="__OSF_OMEX.",e.ActivatedCacheKeyPrefix="__OSF_RUNTIME_.Activated.",e.AppinstallAuthenticated="appinstall_authenticated.",e.Entitlement="entitle.",e.AppState="appState.",e.AppDetails="appDetails.",e.AppInstallInfo="appInstallInfo.",e.AuthenticatedAppInstallInfoCacheKey=e.GatedCacheKeyPrefix+e.AppinstallAuthenticated+"{0}.{1}.{2}.{3}",e.EntitlementsKey=e.Entitlement+"{0}.{1}",e.AppStateCacheKey="{0}"+e.AppState+"{1}.{2}",e.AppDetailKey="{0}"+e.AppDetails+"{1}",e.AppInstallInfoKey="{0}"+e.AppInstallInfo+"{1}.{2}",e.ActivatedCacheKey=e.ActivatedCacheKeyPrefix+"{0}.{1}.{2}",e}();e.CacheConstants=i}(e.WACUtils||(e.WACUtils={}))}(OfficeExt||(OfficeExt={})),OSF.OUtil.setNamespace("Microsoft",window),OSF.OUtil.setNamespace("Office",Microsoft),OSF.OUtil.setNamespace("Common",Microsoft.Office),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},OSF.SerializerVersion={MsAjax:0,Browser:1},(OfficeExt||(OfficeExt={})).appSpecificCheckOrigin=function(){return!1},Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},Microsoft.Office.Common.InvokeResultCode={noError:0,errorInRequest:-1,errorHandlingRequest:-2,errorInResponse:-3,errorHandlingResponse:-4,errorHandlingRequestAccessDenied:-5,errorHandlingMethodCallTimedout:-6},Microsoft.Office.Common.MessageType={request:0,response:1},Microsoft.Office.Common.ActionType={invoke:0,registerEvent:1,unregisterEvent:2},Microsoft.Office.Common.ResponseType={forCalling:0,forEventing:1},Microsoft.Office.Common.MethodObject=function(e,t,n){this._method=e,this._invokeType=t,this._blockingOthers=n},Microsoft.Office.Common.MethodObject.prototype={getMethod:function(){return this._method},getInvokeType:function(){return this._invokeType},getBlockingFlag:function(){return this._blockingOthers}},Microsoft.Office.Common.EventMethodObject=function(e,t){this._registerMethodObject=e,this._unregisterMethodObject=t},Microsoft.Office.Common.EventMethodObject.prototype={getRegisterMethodObject:function(){return this._registerMethodObject},getUnregisterMethodObject:function(){return this._unregisterMethodObject}},Microsoft.Office.Common.ServiceEndPoint=function(e){var t=this,n=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:!1}]);if(n)throw n;t._methodObjectList={},t._eventHandlerProxyList={},t._Id=e,t._conversations={},t._policyManager=null,t._appDomains={},t._onHandleRequestError=null},Microsoft.Office.Common.ServiceEndPoint.prototype={registerMethod:function(e,t,n,o){var r="invokeType",i=!1,a=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:i},{name:"method",type:Function,mayBeNull:i},{name:r,type:Number,mayBeNull:i},{name:"blockingOthers",type:Boolean,mayBeNull:i}]);if(a)throw a;if(n!==Microsoft.Office.Common.InvokeType.async&&n!==Microsoft.Office.Common.InvokeType.sync)throw OsfMsAjaxFactory.msAjaxError.argument(r);var s=new Microsoft.Office.Common.MethodObject(t,n,o);this._methodObjectList[e]=s},unregisterMethod:function(e){var t=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:!1}]);if(t)throw t;delete this._methodObjectList[e]},registerEvent:function(e,t,n){var o=!1,r=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:o},{name:"registerMethod",type:Function,mayBeNull:o},{name:"unregisterMethod",type:Function,mayBeNull:o}]);if(r)throw r;var i=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,Microsoft.Office.Common.InvokeType.syncRegisterEvent,o),new Microsoft.Office.Common.MethodObject(n,Microsoft.Office.Common.InvokeType.syncUnregisterEvent,o));this._methodObjectList[e]=i},registerEventEx:function(e,t,n,o,r){var i=!1,a=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:i},{name:"registerMethod",type:Function,mayBeNull:i},{name:"registerMethodInvokeType",type:Number,mayBeNull:i},{name:"unregisterMethod",type:Function,mayBeNull:i},{name:"unregisterMethodInvokeType",type:Number,mayBeNull:i}]);if(a)throw a;var s=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,n,i),new Microsoft.Office.Common.MethodObject(o,r,i));this._methodObjectList[e]=s},unregisterEvent:function(e){var t=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:!1}]);if(t)throw t;this.unregisterMethod(e)},registerConversation:function(e,t,n,o){var r="appDomains",i=!0,a=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1},{name:"conversationUrl",type:String,mayBeNull:!1,optional:i},{name:r,type:Object,mayBeNull:i,optional:i},{name:"serializerVersion",type:Number,mayBeNull:i,optional:i}]);if(a)throw a;if(n){if(!(n instanceof Array))throw OsfMsAjaxFactory.msAjaxError.argument(r);this._appDomains[e]=n}this._conversations[e]={url:t,serializerVersion:o}},unregisterConversation:function(e){var t=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1}]);if(t)throw t;delete this._conversations[e]},setPolicyManager:function(e){var t="policyManager",n=Function._validateParams(arguments,[{name:t,type:Object,mayBeNull:!1}]);if(n)throw n;if(!e.checkPermission)throw OsfMsAjaxFactory.msAjaxError.argument(t);this._policyManager=e},getPolicyManager:function(){return this._policyManager},dispose:function(){var e=null,t=this;t._methodObjectList=e,t._eventHandlerProxyList=e,t._Id=e,t._conversations=e,t._policyManager=e,t._appDomains=e,t._onHandleRequestError=e}},Microsoft.Office.Common.ClientEndPoint=function(e,t,n,o){var r="targetWindow",i=this,a=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1},{name:r,mayBeNull:!1},{name:"targetUrl",type:String,mayBeNull:!1},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(a)throw a;try{if(!t.postMessage)throw OsfMsAjaxFactory.msAjaxError.argument(r)}catch(e){if(!Object.prototype.hasOwnProperty.call(t,"postMessage"))throw OsfMsAjaxFactory.msAjaxError.argument(r)}i._conversationId=e,i._targetWindow=t,i._targetUrl=n,i._callingIndex=0,i._callbackList={},i._eventHandlerList={},i._serializerVersion=null!=o?o:OSF.SerializerVersion.Browser,i._onSenderOriginNotTrusted=null},Microsoft.Office.Common.ClientEndPoint.prototype={invoke:function(e,t,n){var o=this,r=Function._validateParams(arguments,[{name:"targetMethodName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"param",mayBeNull:!0}]);if(r)throw r;var i=o._callingIndex++,a=new Date,s={callback:t,createdOn:a.getTime()};n&&"object"==typeof n&&"number"==typeof n.__timeout__&&(s.timeout=n.__timeout__,delete n.__timeout__),o._callbackList[i]=s;try{var c=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.invoke,o._conversationId,i,n),d=Microsoft.Office.Common.MessagePackager.envelope(c,o._serializerVersion);o._targetWindow.postMessage(d,o._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete o._callbackList[i]}}},registerForEvent:function(e,t,n,o){var r=this,i=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"eventHandler",type:Function,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(i)throw i;var a=r._callingIndex++,s=new Date;r._callbackList[a]={callback:n,createdOn:s.getTime()};try{var c=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.registerEvent,r._conversationId,a,o),d=Microsoft.Office.Common.MessagePackager.envelope(c,r._serializerVersion);r._targetWindow.postMessage(d,r._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer(),r._eventHandlerList[e]=t}catch(e){try{null!==n&&n(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete r._callbackList[a]}}},unregisterForEvent:function(e,t,n){var o=this,r=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(r)throw r;var i=o._callingIndex++,a=new Date;o._callbackList[i]={callback:t,createdOn:a.getTime()};try{var s=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.unregisterEvent,o._conversationId,i,n),c=Microsoft.Office.Common.MessagePackager.envelope(s,o._serializerVersion);o._targetWindow.postMessage(c,o._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete o._callbackList[i]}}finally{delete o._eventHandlerList[e]}}},Microsoft.Office.Common.XdmCommunicationManager=function(){var e="serviceEndPointId",t="a",n="null",o="channel is not ready.",r="conversationId",i="Unknown conversation Id.",a=!1,s=null,c=[],d=s,l=s,u=10,f=a,p=s,m=65e3,g=m,S={},v={},O=a;function A(e){for(var t in S)if(S[t]._conversations[e])return S[t];throw OsfMsAjaxFactory.msAjaxDebug.trace(i),OsfMsAjaxFactory.msAjaxError.argument(r)}function D(e){var t=v[e];return!t&&OsfMsAjaxFactory.msAjaxDebug.trace(i),t}function h(e){c.push(e)}function y(){if(l!==s){if(!f)if(c.length>0){C(c.shift())}else clearInterval(l),l=s}else OsfMsAjaxFactory.msAjaxDebug.trace(o)}function C(e){f=e.getInvokeBlockingFlag(),e.invoke(),d=(new Date).getTime()}function F(){if(p){var e,t,n=0,r=new Date;for(var i in v)for(var a in(e=v[i])._callbackList){var c=e._callbackList[a];if((t=c.timeout?c.timeout:g)>=0&&Math.abs(r.getTime()-c.createdOn)>=t)try{c.callback&&c.callback(Microsoft.Office.Common.InvokeResultCode.errorHandlingMethodCallTimedout,s)}finally{delete e._callbackList[a]}else n++}0===n&&(clearInterval(p),p=s)}else OsfMsAjaxFactory.msAjaxDebug.trace(o)}function E(){f=a}function M(e,o){var r,i,s=a;return e&&o&&e!==n&&o!==n&&e.length&&o.length?(r=document.createElement(t),i=document.createElement(t),r.href=e,i.href=o,s=w(r,i),delete r,s):s}function b(e,o){var r=a;if(!(o&&o!==n&&o.length&&e&&e instanceof Array&&e.length))return r;var i=document.createElement(t),s=document.createElement(t);i.href=o;for(var c=0;c<e.length&&!r;c++)-1!==e[c].indexOf("://")&&(s.href=e[c],r=w(i,s));return delete i,r}function T(e){if(!e||e===n)return a;var t=["^office-int\\.com$","^officeapps\\.live-int\\.com$","^.*\\.dod\\.online\\.office365\\.us$","^.*\\.gov\\.online\\.office365\\.us$","^.*\\.officeapps\\.live\\.com$","^.*\\.officeapps\\.live-int\\.com$","^.*\\.officeapps-df\\.live\\.com$","^.*\\.online\\.office\\.de$","^.*\\.partner\\.officewebapps\\.cn$","^"+document.domain.replace(new RegExp("\\.","g"),"\\.")+"$"];return new RegExp(t.join("|")).test(e)}function _(e,o){if(!e||!o||e===n||o===n)return a;var r=document.createElement(t);r.href=e;var i=document.createElement(t);i.href=o;var s=r.protocol===i.protocol,c=r.port===i.port,d=i.hostname,l=r.hostname,u=d===l,f=a;return!u&&d.length>l.length+1&&(f=d.slice(-(l.length+1))==="."+l),c&&s&&(u||f)}function w(e,t){return e.hostname==t.hostname&&e.protocol==t.protocol&&e.port==t.port}function I(e){var o="Access Denied";if(OSF&&""!=e.data){var r,i=OSF.SerializerVersion.Browser,c=e.data;try{i=(r=Microsoft.Office.Common.MessagePackager.unenvelope(c,OSF.SerializerVersion.Browser))._serializerVersion!=s?r._serializerVersion:i}catch(e){return}if(r._messageType===Microsoft.Office.Common.MessageType.request){var p=e.origin==s||e.origin===n?r._origin:e.origin;try{var m=A(r._conversationId),g=m._conversations[r._conversationId];i=g.serializerVersion!=s?g.serializerVersion:i;var S=[g.url].concat(m._appDomains[r._conversationId]);if(!b(S,e.origin)&&!OfficeExt.appSpecificCheckOrigin(S,e,r._origin,b))if(!_(g.url,e.origin))throw"Failed origin check";var v=m.getPolicyManager();if(v&&!v.checkPermission(r._conversationId,r._actionName,r._data))throw o;var O=function(e,t){var n=e._methodObjectList[t._actionName];if(!n)throw OsfMsAjaxFactory.msAjaxDebug.trace("The specified method is not registered on service endpoint:"+t._actionName),OsfMsAjaxFactory.msAjaxError.argument("messageObject");return t._actionType===Microsoft.Office.Common.ActionType.invoke?n:t._actionType===Microsoft.Office.Common.ActionType.registerEvent?n.getRegisterMethodObject():n.getUnregisterMethodObject()}(m,r),F=new Microsoft.Office.Common.InvokeCompleteCallback(e.source,p,r._actionName,r._conversationId,r._correlationId,E,i),w=new Microsoft.Office.Common.Invoker(O,r._data,F,m._eventHandlerProxyList,r._conversationId,r._actionName,i),I=!0;l==s&&((d==s||(new Date).getTime()-d>u)&&!f?(C(w),I=a):l=setInterval(y,u)),I&&h(w)}catch(s){m&&m._onHandleRequestError&&m._onHandleRequestError(r,s);var x=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequest;s==o&&(x=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied);var P=new Microsoft.Office.Common.Response(r._actionName,r._conversationId,r._correlationId,x,Microsoft.Office.Common.ResponseType.forCalling,s),N=Microsoft.Office.Common.MessagePackager.envelope(P,i),k=a;try{k=!(!e.source||!e.source.postMessage)}catch(e){}var R=a;if(window.location.href&&e.origin&&e.origin!==n&&_(window.location.href,e.origin))R=!0;else if(e.origin&&e.origin!==n){(L=document.createElement(t)).href=e.origin,R=T(L.hostname)}k&&R&&e.source.postMessage(N,p)}}else{if(r._messageType!==Microsoft.Office.Common.MessageType.response)return;var W=D(r._conversationId);if("ContextActivationManager_getAppContextAsync"==r._actionName)try{var L,H=e.origin;(L=document.createElement(t)).href=H;var U=(R=T(L.hostname))?1:0,j=OSF._OfficeAppFactory.getHostInfo();OSF.AppTelemetry.onCheckWACHost(U,r._data._id,j.hostType,j.hostPlatform,r._data._correlationId,H),U||W&&W._onSenderOriginNotTrusted&&W._onSenderOriginNotTrusted()}catch(e){}if(!W)return;if(W._serializerVersion=i,!M(W._targetUrl,e.origin))throw"Failed orgin check";if(r._responseType===Microsoft.Office.Common.ResponseType.forCalling){var B=W._callbackList[r._correlationId];if(B)try{B.callback&&B.callback(r._errorCode,r._data)}finally{delete W._callbackList[r._correlationId]}}else{var z=W._eventHandlerList[r._actionName];void 0!==z&&z!==s&&z(r._data)}}}}function x(){O||(!function(e){if(window.addEventListener)window.addEventListener("message",e,a);else{if(!(navigator.userAgent.indexOf("MSIE")>-1&&window.attachEvent))throw OsfMsAjaxFactory.msAjaxDebug.trace("Browser doesn't support the required API."),OsfMsAjaxFactory.msAjaxError.argument("Browser");window.attachEvent("onmessage",e)}}(I),O=!0)}return{connect:function(e,t,n,o){var r=v[e];return r||(x(),r=new Microsoft.Office.Common.ClientEndPoint(e,t,n,o),v[e]=r),r},getClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:r,type:String,mayBeNull:a}]);if(t)throw t;return v[e]},createServiceEndPoint:function(e){x();var t=new Microsoft.Office.Common.ServiceEndPoint(e);return S[e]=t,t},getServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:a}]);if(n)throw n;return S[t]},deleteClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:r,type:String,mayBeNull:a}]);if(t)throw t;delete v[e]},deleteServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:a}]);if(n)throw n;delete S[t]},checkUrlWithAppDomains:function(e,t){return b(e,t)},isTargetSubdomainOfSourceLocation:function(e,t){return _(e,t)},_setMethodTimeout:function(e){var t=Function._validateParams(arguments,[{name:"methodTimeout",type:Number,mayBeNull:a}]);if(t)throw t;g=e<=0?m:e},_startMethodTimeoutTimer:function(){p||(p=setInterval(F,2e3))}}}(),Microsoft.Office.Common.Message=function(e,t,n,o,r){var i=!1,a=this,s=Function._validateParams(arguments,[{name:"messageType",type:Number,mayBeNull:i},{name:"actionName",type:String,mayBeNull:i},{name:"conversationId",type:String,mayBeNull:i},{name:"correlationId",mayBeNull:i},{name:"data",mayBeNull:!0,optional:!0}]);if(s)throw s;a._messageType=e,a._actionName=t,a._conversationId=n,a._correlationId=o,a._origin=window.location.href,a._data=void 0===r?null:r},Microsoft.Office.Common.Message.prototype={getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getOrigin:function(){return this._origin},getData:function(){return this._data},getMessageType:function(){return this._messageType}},Microsoft.Office.Common.Request=function(e,t,n,o,r){Microsoft.Office.Common.Request.uber.constructor.call(this,Microsoft.Office.Common.MessageType.request,e,n,o,r),this._actionType=t},OSF.OUtil.extend(Microsoft.Office.Common.Request,Microsoft.Office.Common.Message),Microsoft.Office.Common.Request.prototype.getActionType=function(){return this._actionType},Microsoft.Office.Common.Response=function(e,t,n,o,r,i){Microsoft.Office.Common.Response.uber.constructor.call(this,Microsoft.Office.Common.MessageType.response,e,t,n,i),this._errorCode=o,this._responseType=r},OSF.OUtil.extend(Microsoft.Office.Common.Response,Microsoft.Office.Common.Message),Microsoft.Office.Common.Response.prototype.getErrorCode=function(){return this._errorCode},Microsoft.Office.Common.Response.prototype.getResponseType=function(){return this._responseType},Microsoft.Office.Common.MessagePackager={envelope:function(e){return"object"==typeof e&&(e._serializerVersion=OSF.SerializerVersion.Browser),JSON.stringify(e)},unenvelope:function(e){return JSON.parse(e)}},Microsoft.Office.Common.ResponseSender=function(e,t,n,o,r,i,a){var s=!1,c=this,d=Function._validateParams(arguments,[{name:"requesterWindow",mayBeNull:s},{name:"requesterUrl",type:String,mayBeNull:s},{name:"actionName",type:String,mayBeNull:s},{name:"conversationId",type:String,mayBeNull:s},{name:"correlationId",mayBeNull:s},{name:"responsetype",type:Number,maybeNull:s},{name:"serializerVersion",type:Number,maybeNull:!0,optional:!0}]);if(d)throw d;c._requesterWindow=e,c._requesterUrl=t,c._actionName=n,c._conversationId=o,c._correlationId=r,c._invokeResultCode=Microsoft.Office.Common.InvokeResultCode.noError,c._responseType=i;var l=c;c._send=function(e){try{var t=new Microsoft.Office.Common.Response(l._actionName,l._conversationId,l._correlationId,l._invokeResultCode,l._responseType,e),n=Microsoft.Office.Common.MessagePackager.envelope(t,a);l._requesterWindow.postMessage(n,l._requesterUrl)}catch(e){OsfMsAjaxFactory.msAjaxDebug.trace("ResponseSender._send error:"+e.message)}}},Microsoft.Office.Common.ResponseSender.prototype={getRequesterWindow:function(){return this._requesterWindow},getRequesterUrl:function(){return this._requesterUrl},getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getSend:function(){return this._send},setResultCode:function(e){this._invokeResultCode=e}},Microsoft.Office.Common.InvokeCompleteCallback=function(e,t,n,o,r,i,a){var s=this;Microsoft.Office.Common.InvokeCompleteCallback.uber.constructor.call(s,e,t,n,o,r,Microsoft.Office.Common.ResponseType.forCalling,a),s._postCallbackHandler=i;var c=s;s._send=function(e,t){null!=t&&(c._invokeResultCode=t);try{var n=new Microsoft.Office.Common.Response(c._actionName,c._conversationId,c._correlationId,c._invokeResultCode,c._responseType,e),o=Microsoft.Office.Common.MessagePackager.envelope(n,a);c._requesterWindow.postMessage(o,c._requesterUrl),c._postCallbackHandler()}catch(e){OsfMsAjaxFactory.msAjaxDebug.trace("InvokeCompleteCallback._send error:"+e.message)}}},OSF.OUtil.extend(Microsoft.Office.Common.InvokeCompleteCallback,Microsoft.Office.Common.ResponseSender),Microsoft.Office.Common.Invoker=function(e,t,n,o,r,i,a){var s=!0,c=!1,d=this,l=Function._validateParams(arguments,[{name:"methodObject",mayBeNull:c},{name:"paramValue",mayBeNull:s},{name:"invokeCompleteCallback",mayBeNull:c},{name:"eventHandlerProxyList",mayBeNull:s},{name:"conversationId",type:String,mayBeNull:c},{name:"eventName",type:String,mayBeNull:c},{name:"serializerVersion",type:Number,mayBeNull:s,optional:s}]);if(l)throw l;d._methodObject=e,d._param=t,d._invokeCompleteCallback=n,d._eventHandlerProxyList=o,d._conversationId=r,d._eventName=i,d._serializerVersion=a},Microsoft.Office.Common.Invoker.prototype={invoke:function(){var e=this;try{var t;switch(e._methodObject.getInvokeType()){case Microsoft.Office.Common.InvokeType.async:e._methodObject.getMethod()(e._param,e._invokeCompleteCallback.getSend());break;case Microsoft.Office.Common.InvokeType.sync:t=e._methodObject.getMethod()(e._param),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncRegisterEvent:var n=e._createEventHandlerProxyObject(e._invokeCompleteCallback);t=e._methodObject.getMethod()(n.getSend(),e._param),e._eventHandlerProxyList[e._conversationId+e._eventName]=n.getSend(),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncUnregisterEvent:var o=e._eventHandlerProxyList[e._conversationId+e._eventName];t=e._methodObject.getMethod()(o,e._param),delete e._eventHandlerProxyList[e._conversationId+e._eventName],e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.asyncRegisterEvent:var r=e._createEventHandlerProxyObject(e._invokeCompleteCallback);e._methodObject.getMethod()(r.getSend(),e._invokeCompleteCallback.getSend(),e._param),e._eventHandlerProxyList[e._callerId+e._eventName]=r.getSend();break;case Microsoft.Office.Common.InvokeType.asyncUnregisterEvent:var i=e._eventHandlerProxyList[e._callerId+e._eventName];e._methodObject.getMethod()(i,e._invokeCompleteCallback.getSend(),e._param),delete e._eventHandlerProxyList[e._callerId+e._eventName]}}catch(t){e._invokeCompleteCallback.setResultCode(Microsoft.Office.Common.InvokeResultCode.errorInResponse),e._invokeCompleteCallback.getSend()(t)}},getInvokeBlockingFlag:function(){return this._methodObject.getBlockingFlag()},_createEventHandlerProxyObject:function(e){return new Microsoft.Office.Common.ResponseSender(e.getRequesterWindow(),e.getRequesterUrl(),e.getActionName(),e.getConversationId(),e.getCorrelationId(),Microsoft.Office.Common.ResponseType.forEventing,this._serializerVersion)}},OSF.OUtil.setNamespace("WAC",OSF.DDA),OSF.DDA.WAC.UniqueArguments={Data:"Data",Properties:"Properties",BindingRequest:"DdaBindingsMethod",BindingResponse:"Bindings",SingleBindingResponse:"singleBindingResponse",GetData:"DdaGetBindingData",AddRowsColumns:"DdaAddRowsColumns",SetData:"DdaSetBindingData",ClearFormats:"DdaClearBindingFormats",SetFormats:"DdaSetBindingFormats",SettingsRequest:"DdaSettingsMethod",BindingEventSource:"ddaBinding",ArrayData:"ArrayData"},OSF.OUtil.setNamespace("Delegate",OSF.DDA.WAC),OSF.DDA.WAC.Delegate.SpecialProcessor=function(){var e=[OSF.DDA.WAC.UniqueArguments.SingleBindingResponse,OSF.DDA.WAC.UniqueArguments.BindingRequest,OSF.DDA.WAC.UniqueArguments.BindingResponse,OSF.DDA.WAC.UniqueArguments.GetData,OSF.DDA.WAC.UniqueArguments.AddRowsColumns,OSF.DDA.WAC.UniqueArguments.SetData,OSF.DDA.WAC.UniqueArguments.ClearFormats,OSF.DDA.WAC.UniqueArguments.SetFormats,OSF.DDA.WAC.UniqueArguments.SettingsRequest,OSF.DDA.WAC.UniqueArguments.BindingEventSource];OSF.DDA.WAC.Delegate.SpecialProcessor.uber.constructor.call(this,e,{})},OSF.OUtil.extend(OSF.DDA.WAC.Delegate.SpecialProcessor,OSF.DDA.SpecialProcessor),OSF.DDA.WAC.Delegate.ParameterMap=OSF.DDA.getDecoratedParameterMap(new OSF.DDA.WAC.Delegate.SpecialProcessor,[]),OSF.OUtil.setNamespace("WAC",OSF.DDA),OSF.OUtil.setNamespace("Delegate",OSF.DDA.WAC),OSF.DDA.WAC.getDelegateMethods=function(){var e={};return e[OSF.DDA.DispIdHost.Delegates.ExecuteAsync]=OSF.DDA.WAC.Delegate.executeAsync,e[OSF.DDA.DispIdHost.Delegates.RegisterEventAsync]=OSF.DDA.WAC.Delegate.registerEventAsync,e[OSF.DDA.DispIdHost.Delegates.UnregisterEventAsync]=OSF.DDA.WAC.Delegate.unregisterEventAsync,e[OSF.DDA.DispIdHost.Delegates.OpenDialog]=OSF.DDA.WAC.Delegate.openDialog,e[OSF.DDA.DispIdHost.Delegates.MessageParent]=OSF.DDA.WAC.Delegate.messageParent,e[OSF.DDA.DispIdHost.Delegates.SendMessage]=OSF.DDA.WAC.Delegate.sendMessage,e[OSF.DDA.DispIdHost.Delegates.CloseDialog]=OSF.DDA.WAC.Delegate.closeDialog,e},OSF.DDA.WAC.Delegate.version=1,OSF.DDA.WAC.Delegate.executeAsync=function(e){e.hostCallArgs||(e.hostCallArgs={}),e.hostCallArgs.DdaMethod={ControlId:OSF._OfficeAppFactory.getId(),Version:OSF.DDA.WAC.Delegate.version,DispatchId:e.dispId},e.hostCallArgs.__timeout__=-1,e.onCalling&&e.onCalling(),OSF.getClientEndPoint()&&OSF.getClientEndPoint().invoke("executeMethod",function(t,n){var o;if(e.onReceiving&&e.onReceiving(),t==Microsoft.Office.Common.InvokeResultCode.noError)OSF.DDA.WAC.Delegate.version=n.Version,o=n.Error;else switch(t){case Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied:o=OSF.DDA.ErrorCodeManager.errorCodes.ooeNoCapability;break;default:o=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}e.onComplete&&e.onComplete(o,n)},e.hostCallArgs)},OSF.DDA.WAC.Delegate._getOnAfterRegisterEvent=function(e,t){var n=(new Date).getTime();return function(o,r){var i;if(t.onReceiving&&t.onReceiving(),o!=Microsoft.Office.Common.InvokeResultCode.noError)switch(o){case Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied:i=OSF.DDA.ErrorCodeManager.errorCodes.ooeNoCapability;break;default:i=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else i=r?r.Error?r.Error:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;t.onComplete&&t.onComplete(i),OSF.AppTelemetry&&OSF.AppTelemetry.onRegisterDone(e,t.dispId,Math.abs((new Date).getTime()-n),i)}},OSF.DDA.WAC.Delegate.registerEventAsync=function(e){e.onCalling&&e.onCalling(),OSF.getClientEndPoint()&&OSF.getClientEndPoint().registerForEvent(OSF.DDA.getXdmEventName(e.targetId,e.eventType),function(t){e.onEvent&&e.onEvent(t),OSF.AppTelemetry&&OSF.AppTelemetry.onEventDone(e.dispId)},OSF.DDA.WAC.Delegate._getOnAfterRegisterEvent(!0,e),{controlId:OSF._OfficeAppFactory.getId(),eventDispId:e.dispId,targetId:e.targetId})},OSF.DDA.WAC.Delegate.unregisterEventAsync=function(e){e.onCalling&&e.onCalling(),OSF.getClientEndPoint()&&OSF.getClientEndPoint().unregisterForEvent(OSF.DDA.getXdmEventName(e.targetId,e.eventType),OSF.DDA.WAC.Delegate._getOnAfterRegisterEvent(!1,e),{controlId:OSF._OfficeAppFactory.getId(),eventDispId:e.dispId,targetId:e.targetId})},OSF.OUtil.setNamespace("WebApp",OSF),OSF.OUtil.setNamespace("Messaging",OSF),OSF.OUtil.setNamespace("ExtensionLifeCycle",OSF),OSF.OUtil.setNamespace("TaskPaneAction",OSF),OSF.WebApp.AddHostInfoAndXdmInfo=function(e){return OSF._OfficeAppFactory.getWindowLocationSearch&&OSF._OfficeAppFactory.getWindowLocationHash?e+OSF._OfficeAppFactory.getWindowLocationSearch()+OSF._OfficeAppFactory.getWindowLocationHash():e},OSF.WebApp._UpdateLinksForHostAndXdmInfo=function(){for(var e=document.querySelectorAll("a[data-officejs-navigate]"),t=0;t<e.length;t++)OSF.WebApp._isGoodUrl(e[t].href)&&(e[t].href=OSF.WebApp.AddHostInfoAndXdmInfo(e[t].href));var n=document.querySelectorAll("form[data-officejs-navigate]");for(t=0;t<n.length;t++){var o=n[t];OSF.WebApp._isGoodUrl(o.action)&&(o.action=OSF.WebApp.AddHostInfoAndXdmInfo(o.action))}},OSF.WebApp._isGoodUrl=function(e){if(void 0===e)return!1;var t=(e=e.trim()).indexOf(":"),n=t>0?e.substr(0,t):null,o=null===n||("http"===n.toLowerCase()||"https"===n.toLowerCase());return o=o&&"#"!=e&&"/"!=e&&""!=e&&e!=OSF._OfficeAppFactory.getWebAppState().webAppUrl},OSF.InitializationHelper=function(e,t,n,o,r){var i=this;i._hostInfo=e,i._webAppState=t,i._context=n,i._settings=o,i._hostFacade=r,i._appContext={},i._tabbableElements="a[href]:not([tabindex='-1']),area[href]:not([tabindex='-1']),button:not([disabled]):not([tabindex='-1']),input:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']),textarea:not([disabled]):not([tabindex='-1']),*[tabindex]:not([tabindex='-1']),*[contenteditable]:not([disabled]):not([tabindex='-1'])",i._initializeSettings=function(e,t){var n=e.get_settings(),o=OSF.OUtil.getSessionStorage();if(o){var r=o.getItem(OSF._OfficeAppFactory.getCachedSessionSettingsKey());r?n=JSON.parse(r):(r=JSON.stringify(n),o.setItem(OSF._OfficeAppFactory.getCachedSessionSettingsKey(),r))}var i=OSF.DDA.SettingsManager.deserializeSettings(n);return t?new OSF.DDA.RefreshableSettings(i):new OSF.DDA.Settings(i)};!function(e){var t=window.open;e.open=function(e,n,o){var r=null;try{r=t(e,n,o)}catch(e){OSF.AppTelemetry&&OSF.AppTelemetry.logAppCommonMessage("Exception happens at windowOpen."+e)}if(!r){var i={strUrl:e,strWindowName:n,strWindowFeatures:o};OSF._OfficeAppFactory.getClientEndPoint()&&OSF._OfficeAppFactory.getClientEndPoint().invoke("ContextActivationManager_openWindowInHost",null,i)}return r}}(window)},OSF.InitializationHelper.prototype.saveAndSetDialogInfo=function(e){var t="IsDialog",n=OSF.OUtil.getSessionStorage();if(n){if(e||(e=OSF.OUtil.parseHostInfoFromWindowName(!0,OSF._OfficeAppFactory.getWindowName())),e&&e.indexOf("isDialog")>-1){var o=function(){var e=OSF.OUtil.parseXdmInfo(!0);return e?e.split("|")[1]:null}();return null!=o&&n.setItem(o+t,"true"),void(this._hostInfo.isDialog=!0)}this._hostInfo.isDialog=null!=n.getItem(OSF.OUtil.getXdmFieldValue(OSF.XdmFieldName.AppId,!1)+t)}},OSF.InitializationHelper.prototype.getAppContext=function(e,t){var n=this,o=n,r=function(e,n){var r,i="undefined";if(n._appName===OSF.AppName.ExcelWebApp){var a=n._settings;for(var s in r={},a){var c=a[s];r[c[0]]=c[1]}}else r=n._settings;if(n._appName===OSF.AppName.OutlookWebApp&&n._requirementMatrix&&-1==n._requirementMatrix.indexOf("react")&&(OSF.AgaveHostAction.SendTelemetryEvent=void 0),!o._hostInfo.isDialog||null==window.opener){var d=window.location.href;o._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[o._webAppState.id,OSF.AgaveHostAction.UpdateTargetUrl,d])}if(0!==e||null==n._id||null==n._appName||null==n._appVersion||null==n._appUILocale||null==n._dataLocale||null==n._docUrl||null==n._clientMode||null==n._settings||null==n._reason){var l="Function ContextActivationManager_getAppContextAsync call failed. ErrorCode is "+e+", exception: "+n;throw OSF.AppTelemetry&&OSF.AppTelemetry.logAppException(l),l}o._appContext=n;var u=n._appInstanceId?n._appInstanceId:n._id,f=0;null!=n._appMinorVersion&&(f=n._appMinorVersion);var p=void 0;null!=n._requirementMatrix&&(p=n._requirementMatrix),n.eToken=n.eToken?n.eToken:"";var m=new OSF.OfficeAppContext(n._id,n._appName,n._appVersion,n._appUILocale,n._dataLocale,n._docUrl,n._clientMode,r,n._reason,n._osfControlType,n._eToken,n._correlationId,u,!1,!0,f,p,n._hostCustomMessage,n._hostFullVersion,n._clientWindowHeight,n._clientWindowWidth,n._addinName,n._appDomains,n._dialogRequirementMatrix,n._featureGates);m._wacHostEnvironment=n._wacHostEnvironment||"0",m._isFromWacAutomation=!!n._isFromWacAutomation,OSF.AppTelemetry&&OSF.AppTelemetry.initialize(m),t(m),typeof CustomEvent!==i&&typeof dispatchEvent!==i&&dispatchEvent(new CustomEvent("JSPerfFinished"))};try{if(n._hostInfo.isDialog&&null!=window.opener)r(0,OfficeExt.WACUtils.parseAppContextFromWindowName(!1,OSF._OfficeAppFactory.getWindowName()));else n._webAppState.clientEndPoint.invoke("ContextActivationManager_getAppContextAsync",r,n._webAppState.id)}catch(e){throw OSF.AppTelemetry&&OSF.AppTelemetry.logAppException("Exception thrown when trying to invoke getAppContextAsync. Exception:["+e+"]"),e}},OSF.InitializationHelper.prototype.setAgaveHostCommunication=function(){var e=null,t=!1;try{var n=this,o=OSF.OUtil.parseXdmInfoWithGivenFragment(t,OSF._OfficeAppFactory.getWindowLocationHash());if(!o&&OSF._OfficeAppFactory.getWindowName&&(o=OSF.OUtil.parseXdmInfoFromWindowName(t,OSF._OfficeAppFactory.getWindowName())),o){var r=OSF.OUtil.getInfoItems(o);null!=r&&r.length>=3&&(n._webAppState.conversationID=r[0],n._webAppState.id=r[1],n._webAppState.webAppUrl=r[2].indexOf(":")>=0?r[2]:decodeURIComponent(r[2]))}n._webAppState.wnd=window.opener!=e?window.opener:window.parent;var i=OSF.OUtil.parseSerializerVersionWithGivenFragment(t,OSF._OfficeAppFactory.getWindowLocationHash());if(isNaN(i)&&OSF._OfficeAppFactory.getWindowName&&(i=OSF.OUtil.parseSerializerVersionFromWindowName(t,OSF._OfficeAppFactory.getWindowName())),n._webAppState.serializerVersion=i,this._hostInfo.isDialog&&window.opener!=e)return;n._webAppState.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(n._webAppState.conversationID,n._webAppState.wnd,n._webAppState.webAppUrl,n._webAppState.serializerVersion),n._webAppState.serviceEndPoint=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(n._webAppState.id);var a=n._webAppState.conversationID+OSF.SharedConstants.NotificationConversationIdSuffix;n._webAppState.serviceEndPoint.registerConversation(a,n._webAppState.webAppUrl);n._webAppState.serviceEndPoint.registerMethod("Office_notifyAgave",function(o){var r,i="ContextActivationManager_notifyHost";switch(r="string"==typeof o?o:o[0]){case OSF.AgaveHostAction.Select:n._webAppState.focused=!0;break;case OSF.AgaveHostAction.UnSelect:n._webAppState.focused=t;break;case OSF.AgaveHostAction.TabIn:case OSF.AgaveHostAction.CtrlF6In:window.focus();var a=document.querySelectorAll(n._tabbableElements);OSF.OUtil.focusToFirstTabbable(a,t)||(window.blur(),n._webAppState.focused=t,n._webAppState.clientEndPoint.invoke(i,e,[n._webAppState.id,OSF.AgaveHostAction.ExitNoFocusable]));break;case OSF.AgaveHostAction.TabInShift:window.focus();a=document.querySelectorAll(n._tabbableElements);OSF.OUtil.focusToFirstTabbable(a,!0)||(window.blur(),n._webAppState.focused=t,n._webAppState.clientEndPoint.invoke(i,e,[n._webAppState.id,OSF.AgaveHostAction.ExitNoFocusableShift]));break;case OSF.AgaveHostAction.SendMessage:if(window.Office.context.messaging.onMessage){var s=o[1];window.Office.context.messaging.onMessage(s)}break;case OSF.AgaveHostAction.TaskPaneHeaderButtonClicked:window.Office.context.ui.taskPaneAction.onHeaderButtonClick&&window.Office.context.ui.taskPaneAction.onHeaderButtonClick();break;default:OsfMsAjaxFactory.msAjaxDebug.trace("actionId "+r+" notifyAgave is wrong.")}},Microsoft.Office.Common.InvokeType.async,t),n.addOrRemoveEventListenersForWindow(!0)}catch(e){throw OSF.AppTelemetry&&OSF.AppTelemetry.logAppException("Exception thrown in setAgaveHostCommunication. Exception:["+e+"]"),e}},OSF.InitializationHelper.prototype.addOrRemoveEventListenersForWindow=function(e){var t="keypress",n=null,o="ContextActivationManager_notifyHost",r=this,i=function(){r._webAppState.focused||(r._webAppState.focused=!0),r._webAppState.clientEndPoint.invoke(o,n,[r._webAppState.id,OSF.AgaveHostAction.Select])},a=function(){OSF&&(r._webAppState.focused&&(r._webAppState.focused=!1),r._webAppState.clientEndPoint.invoke(o,n,[r._webAppState.id,OSF.AgaveHostAction.UnSelect]))},s=function(e){if(e.preventDefault=e.preventDefault||function(){e.returnValue=!1},117==e.keyCode&&(e.ctrlKey||e.metaKey)){var t=OSF.AgaveHostAction.CtrlF6Exit;e.shiftKey&&(t=OSF.AgaveHostAction.CtrlF6ExitShift),r._webAppState.clientEndPoint.invoke(o,n,[r._webAppState.id,t])}else if(9==e.keyCode){e.preventDefault();var i=document.querySelectorAll(r._tabbableElements);OSF.OUtil.focusToNextTabbable(i,e.target||e.srcElement,e.shiftKey)||(r._hostInfo.isDialog?OSF.OUtil.focusToFirstTabbable(i,e.shiftKey):e.shiftKey?r._webAppState.clientEndPoint.invoke(o,n,[r._webAppState.id,OSF.AgaveHostAction.TabExitShift]):r._webAppState.clientEndPoint.invoke(o,n,[r._webAppState.id,OSF.AgaveHostAction.TabExit]))}else 27==e.keyCode?(e.preventDefault(),r.dismissDialogNotification&&r.dismissDialogNotification(),r._webAppState.clientEndPoint.invoke(o,n,[r._webAppState.id,OSF.AgaveHostAction.EscExit])):113==e.keyCode&&(e.preventDefault(),r._webAppState.clientEndPoint.invoke(o,n,[r._webAppState.id,OSF.AgaveHostAction.F2Exit]))},c=function(e){117==e.keyCode&&e.ctrlKey&&(e.preventDefault?e.preventDefault():e.returnValue=!1)};e?(OSF.OUtil.addEventListener(window,"focus",i),OSF.OUtil.addEventListener(window,"blur",a),OSF.OUtil.addEventListener(window,"keydown",s),OSF.OUtil.addEventListener(window,t,c)):(OSF.OUtil.removeEventListener(window,"focus",i),OSF.OUtil.removeEventListener(window,"blur",a),OSF.OUtil.removeEventListener(window,"keydown",s),OSF.OUtil.removeEventListener(window,t,c))},OSF.InitializationHelper.prototype.initWebDialog=function(e){if(e.get_isDialog()){if(OSF.DDA.UI.ChildUI){var t=null!=window.opener;e.ui=new OSF.DDA.UI.ChildUI(t),t&&this.registerMessageReceivedEventForWindowDialog&&this.registerMessageReceivedEventForWindowDialog()}}else OSF.DDA.UI.ParentUI&&(e.ui=new OSF.DDA.UI.ParentUI,OfficeExt.Container&&OSF.DDA.DispIdHost.addAsyncMethods(e.ui,[OSF.DDA.AsyncMethodNames.CloseContainerAsync]))},OSF.InitializationHelper.prototype.initWebAuth=function(e){OSF.DDA.Auth&&(e.auth=new OSF.DDA.Auth,OSF.DDA.DispIdHost.addAsyncMethods(e.auth,[OSF.DDA.AsyncMethodNames.GetAccessTokenAsync]))},OSF.InitializationHelper.prototype.initWebAuthImplicit=function(e){OSF.DDA.WebAuth&&(e.webAuth=new OSF.DDA.WebAuth,OSF.DDA.DispIdHost.addAsyncMethods(e.webAuth,[OSF.DDA.AsyncMethodNames.GetAuthContextAsync]))},OSF.getClientEndPoint=function(){return OSF._OfficeAppFactory.getInitializationHelper()._webAppState.clientEndPoint},OSF.InitializationHelper.prototype.prepareRightAfterWebExtensionInitialize=function(){var e=this;if(e._hostInfo.isDialog){window.focus();var t=document.querySelectorAll(e._tabbableElements);OSF.OUtil.focusToFirstTabbable(t,!1)||(window.blur(),e._webAppState.focused=!1,e._webAppState.clientEndPoint&&e._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[e._webAppState.id,OSF.AgaveHostAction.ExitNoFocusable]))}},OSF.Messaging.sendMessage=function(e){OSF.getClientEndPoint().invoke("ContextActivationManager_notifyHost",null,[OSF._OfficeAppFactory.getWebAppState().id,OSF.AgaveHostAction.SendMessage,e])},OSF.ExtensionLifeCycle.launchExtensionComponent=function(e){OSF.getClientEndPoint().invoke("ContextActivationManager_notifyHost",null,[OSF._OfficeAppFactory.getWebAppState().id,OSF.AgaveHostAction.LaunchExtensionComponent,e])},OSF.ExtensionLifeCycle.stopExtensionComponent=function(e){OSF.getClientEndPoint().invoke("ContextActivationManager_notifyHost",null,[OSF._OfficeAppFactory.getWebAppState().id,OSF.AgaveHostAction.StopExtensionComponent,e])},OSF.ExtensionLifeCycle.restartExtensionComponent=function(e){OSF.getClientEndPoint().invoke("ContextActivationManager_notifyHost",null,[OSF._OfficeAppFactory.getWebAppState().id,OSF.AgaveHostAction.RestartExtensionComponent,e])},OSF.TaskPaneAction.enableHeaderButton=function(e){OSF.getClientEndPoint().invoke("ContextActivationManager_notifyHost",null,[OSF._OfficeAppFactory.getWebAppState().id,OSF.AgaveHostAction.EnableTaskPaneHeaderButton,e])},OSF.TaskPaneAction.disableHeaderButton=function(){OSF.getClientEndPoint().invoke("ContextActivationManager_notifyHost",null,[OSF._OfficeAppFactory.getWebAppState().id,OSF.AgaveHostAction.DisableTaskPaneHeaderButton])},function(){var e=function(){var e,t,n,o=null,r=OSF.OUtil.parseXdmInfo();if(r&&(n=OSF.OUtil.getInfoItems(r))&&n.length>=3){e=n[0],t=n[2];var i=OSF.OUtil.parseSerializerVersionWithGivenFragment(!1,OSF._OfficeAppFactory.getWindowLocationHash());isNaN(i)&&OSF._OfficeAppFactory.getWindowName&&(i=OSF.OUtil.parseSerializerVersionFromWindowName(!1,OSF._OfficeAppFactory.getWindowName())),o=Microsoft.Office.Common.XdmCommunicationManager.connect(e,window.parent,t,i)}var a=null;if(!o){try{window.external&&void 0!==window.external.getCustomizedScriptPath&&(a=window.external.getCustomizedScriptPath())}catch(e){OsfMsAjaxFactory.msAjaxDebug.trace("no script override through window.external.")}!function(e){e&&OSF.OUtil.loadScript(e,function(){OsfMsAjaxFactory.msAjaxDebug.trace("loaded customized script:"+e)})}(a)}};OsfMsAjaxFactory.isMsAjaxLoaded()?e():OSF._OfficeAppFactory&&OSF._OfficeAppFactory&&OSF._OfficeAppFactory.getLoadScriptHelper&&OSF._OfficeAppFactory.getLoadScriptHelper().isScriptLoading(OSF.ConstantNames.MicrosoftAjaxId)?OSF._OfficeAppFactory.getLoadScriptHelper().waitForScripts([OSF.ConstantNames.MicrosoftAjaxId],e):OsfMsAjaxFactory.loadMsAjaxFull(function(){if(!OsfMsAjaxFactory.isMsAjaxLoaded())throw"Not able to load MicrosoftAjax.js.";e()})}(),function(e){var t="ResponseTime",n="Message",o="SessionId",r="CorrelationId",i=!0,a=function(){function e(e){this._table=e,this._fields={}}return Object.defineProperty(e.prototype,"Fields",{get:function(){return this._fields},enumerable:i,configurable:i}),Object.defineProperty(e.prototype,"Table",{get:function(){return this._table},enumerable:i,configurable:i}),e.prototype.SerializeFields=function(){},e.prototype.SetSerializedField=function(e,t){null!=t&&(this._serializedFields[e]=t.toString())},e.prototype.SerializeRow=function(){var e=this;return e._serializedFields={},e.SetSerializedField("Table",e._table),e.SerializeFields(),JSON.stringify(e._serializedFields)},e}();e.BaseUsageData=a;var s=function(e){var t="IsFromWacAutomation",a="WacHostEnvironment",s="HostJSVersion",c="OfficeJSVersion",d="DocUrl",l="AppSizeHeight",u="AppSizeWidth",f="ClientId",p="HostVersion",m="Host",g="UserId",S="Browser",v="AssetId",O="AppURL",A="AppInstanceId",D="AppId";function h(){e.call(this,"AppActivated")}return __extends(h,e),Object.defineProperty(h.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,D,{get:function(){return this.Fields[D]},set:function(e){this.Fields[D]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,A,{get:function(){return this.Fields[A]},set:function(e){this.Fields[A]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,O,{get:function(){return this.Fields[O]},set:function(e){this.Fields[O]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,v,{get:function(){return this.Fields[v]},set:function(e){this.Fields[v]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,S,{get:function(){return this.Fields[S]},set:function(e){this.Fields[S]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,g,{get:function(){return this.Fields[g]},set:function(e){this.Fields[g]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,m,{get:function(){return this.Fields[m]},set:function(e){this.Fields[m]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,p,{get:function(){return this.Fields[p]},set:function(e){this.Fields[p]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,f,{get:function(){return this.Fields[f]},set:function(e){this.Fields[f]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,u,{get:function(){return this.Fields[u]},set:function(e){this.Fields[u]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,l,{get:function(){return this.Fields[l]},set:function(e){this.Fields[l]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,d,{get:function(){return this.Fields[d]},set:function(e){this.Fields[d]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,c,{get:function(){return this.Fields[c]},set:function(e){this.Fields[c]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:i,configurable:i}),Object.defineProperty(h.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:i,configurable:i}),h.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.CorrelationId),e.SetSerializedField(o,e.SessionId),e.SetSerializedField(D,e.AppId),e.SetSerializedField(A,e.AppInstanceId),e.SetSerializedField(O,e.AppURL),e.SetSerializedField(v,e.AssetId),e.SetSerializedField(S,e.Browser),e.SetSerializedField(g,e.UserId),e.SetSerializedField(m,e.Host),e.SetSerializedField(p,e.HostVersion),e.SetSerializedField(f,e.ClientId),e.SetSerializedField(u,e.AppSizeWidth),e.SetSerializedField(l,e.AppSizeHeight),e.SetSerializedField(n,e.Message),e.SetSerializedField(d,e.DocUrl),e.SetSerializedField(c,e.OfficeJSVersion),e.SetSerializedField(s,e.HostJSVersion),e.SetSerializedField(a,e.WacHostEnvironment),e.SetSerializedField(t,e.IsFromWacAutomation)},h}(a);e.AppActivatedUsageData=s;var c=function(e){var n="StartTime",a="ScriptId";function s(){e.call(this,"ScriptLoad")}return __extends(s,e),Object.defineProperty(s.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:i,configurable:i}),Object.defineProperty(s.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:i,configurable:i}),Object.defineProperty(s.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:i,configurable:i}),Object.defineProperty(s.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:i,configurable:i}),Object.defineProperty(s.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:i,configurable:i}),s.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.CorrelationId),e.SetSerializedField(o,e.SessionId),e.SetSerializedField(a,e.ScriptId),e.SetSerializedField(n,e.StartTime),e.SetSerializedField(t,e.ResponseTime)},s}(a);e.ScriptLoadUsageData=c;var d=function(e){var t="CloseMethod",n="OpenTime",a="AppSizeFinalHeight",s="AppSizeFinalWidth",c="FocusTime";function d(){e.call(this,"AppClosed")}return __extends(d,e),Object.defineProperty(d.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:i,configurable:i}),Object.defineProperty(d.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:i,configurable:i}),Object.defineProperty(d.prototype,c,{get:function(){return this.Fields[c]},set:function(e){this.Fields[c]=e},enumerable:i,configurable:i}),Object.defineProperty(d.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:i,configurable:i}),Object.defineProperty(d.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:i,configurable:i}),Object.defineProperty(d.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:i,configurable:i}),Object.defineProperty(d.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:i,configurable:i}),d.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.CorrelationId),e.SetSerializedField(o,e.SessionId),e.SetSerializedField(c,e.FocusTime),e.SetSerializedField(s,e.AppSizeFinalWidth),e.SetSerializedField(a,e.AppSizeFinalHeight),e.SetSerializedField(n,e.OpenTime),e.SetSerializedField(t,e.CloseMethod)},d}(a);e.AppClosedUsageData=d;var l=function(e){var n="ErrorType",a="Parameters",s="APIID",c="APIType";function d(){e.call(this,"APIUsage")}return __extends(d,e),Object.defineProperty(d.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:i,configurable:i}),Object.defineProperty(d.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:i,configurable:i}),Object.defineProperty(d.prototype,c,{get:function(){return this.Fields[c]},set:function(e){this.Fields[c]=e},enumerable:i,configurable:i}),Object.defineProperty(d.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:i,configurable:i}),Object.defineProperty(d.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:i,configurable:i}),Object.defineProperty(d.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:i,configurable:i}),Object.defineProperty(d.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:i,configurable:i}),d.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.CorrelationId),e.SetSerializedField(o,e.SessionId),e.SetSerializedField(c,e.APIType),e.SetSerializedField(s,e.APIID),e.SetSerializedField(a,e.Parameters),e.SetSerializedField(t,e.ResponseTime),e.SetSerializedField(n,e.ErrorType)},d}(a);e.APIUsageUsageData=l;var u=function(e){var t="SuccessCode";function a(){e.call(this,"AppInitialization")}return __extends(a,e),Object.defineProperty(a.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:i,configurable:i}),Object.defineProperty(a.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:i,configurable:i}),Object.defineProperty(a.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:i,configurable:i}),Object.defineProperty(a.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:i,configurable:i}),a.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.CorrelationId),e.SetSerializedField(o,e.SessionId),e.SetSerializedField(t,e.SuccessCode),e.SetSerializedField(n,e.Message)},a}(a);e.AppInitializationUsageData=u;var f=function(e){var t="correlationId",n="wacDomain",o="hostPlatform",r="hostType",a="solutionId",s="isWacKnownHost";function c(){e.call(this,"CheckWACHost")}return __extends(c,e),Object.defineProperty(c.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:i,configurable:i}),Object.defineProperty(c.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:i,configurable:i}),Object.defineProperty(c.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:i,configurable:i}),Object.defineProperty(c.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:i,configurable:i}),Object.defineProperty(c.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:i,configurable:i}),Object.defineProperty(c.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:i,configurable:i}),c.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.isWacKnownHost),e.SetSerializedField(a,e.solutionId),e.SetSerializedField(r,e.hostType),e.SetSerializedField(o,e.hostPlatform),e.SetSerializedField(n,e.wacDomain),e.SetSerializedField(t,e.correlationId)},c}(a);e.CheckWACHostUsageData=f}(OSFLog||(OSFLog={})),function(e){"use strict";!function(e){e[e.info=0]="info",e[e.warning=1]="warning",e[e.error=2]="error"}(e.TraceLevel||(e.TraceLevel={}));e.TraceLevel;!function(e){e[e.none=0]="none",e[e.flush=1]="flush"}(e.SendFlag||(e.SendFlag={}));e.SendFlag;e.allowUploadingData=function(){},e.sendLog=function(){};var t=function(){function e(){}return e.prototype.writeLog=function(){},e.prototype.loadProxyFrame=function(){},e}();OSF.Logger||(OSF.Logger=e),e.ulsEndpoint=function(){try{return new t}catch(e){return null}}()}(Logger||(Logger={})),function(e){var t="undefined",n="hostPlatform",o="ResponseTime",r="double",i=!1,a="int64",s="string",c=!0,d=[{name:"AppActivated",enabled:c,basic:c,critical:c,points:[{name:"Browser",type:s},{name:"Message",type:s},{name:"AppURL",type:s},{name:"Host",type:s},{name:"AppSizeWidth",type:a},{name:"AppSizeHeight",type:a},{name:"IsFromWacAutomation",type:s}]},{name:"ScriptLoad",enabled:c,basic:i,critical:i,points:[{name:"ScriptId",type:s},{name:"StartTime",type:r},{name:o,type:r}]},{name:"APIUsage",enabled:i,basic:i,critical:i,points:[{name:"APIType",type:s},{name:"APIID",type:a},{name:"Parameters",type:s},{name:o,type:a},{name:"ErrorType",type:a}]},{name:"AppInitialization",enabled:c,basic:i,critical:i,points:[{name:"SuccessCode",type:a},{name:"Message",type:s}]},{name:"AppClosed",enabled:c,basic:i,critical:i,points:[{name:"FocusTime",type:a},{name:"AppSizeFinalWidth",type:a},{name:"AppSizeFinalHeight",type:a},{name:"OpenTime",type:a}]},{name:"CheckWACHost",enabled:c,basic:i,critical:i,points:[{name:"isWacKnownHost",type:a},{name:"solutionId",type:s},{name:"hostType",type:s},{name:n,type:s},{name:"correlationId",type:s},{name:"wacDomain",type:s}]}];function l(e,t){var n=void 0===t.rename?t.name:t.rename,o=void 0;switch(t.type){case s:o=oteljs.makeStringDataField(n,e);break;case r:typeof e===s&&(e=parseFloat(e)),o=oteljs.makeDoubleDataField(n,e);break;case a:typeof e===s&&(e=parseInt(e)),o=oteljs.makeInt64DataField(n,e);break;case"boolean":typeof e===s&&(e="true"===e),o=oteljs.makeBooleanDataField(n,e)}return o}function u(e){for(var t=0;t<d.length;t++){var n=d[t];if(n.name===e)return n}}function f(e){var t=u(e);return void 0===t?i:t.enabled}function p(e,n){f(e)&&typeof OTel!==t&&OTel.OTelLogger.onTelemetryLoaded(function(){var t=function(e,t){var n=u(e);if(void 0!==n){for(var o=[],r=0,i=n.points;r<i.length;r++){var a=i[r],s=t[a.name];if(void 0!==s){var c=l(s,a);void 0!==c&&o.push(c)}}var d={dataCategories:oteljs.DataCategories.ProductServiceUsage};return n.critical&&(d.samplingPolicy=oteljs.SamplingPolicy.CriticalBusinessImpact),n.basic&&(d.diagnosticLevel=oteljs.DiagnosticLevel.BasicEvent),{eventName:"Office.Extensibility.OfficeJs."+e+"X",dataFields:o,eventFlags:d}}}(e,n);void 0!==t&&Microsoft.Office.WebExtension.sendTelemetryEvent(t)})}var m=function(){function e(){}return e.prototype.getAriaCDNLocation=function(){return OSF._OfficeAppFactory.getLoadScriptHelper().getOfficeJsBasePath()+"ariatelemetry/aria-web-telemetry.js"},e.getInstance=function(){return void 0===e.AriaLoggerObj&&(e.AriaLoggerObj=new e),e.AriaLoggerObj},e.prototype.isIUsageData=function(e){return void 0!==e.Fields},e.prototype.shouldSendDirectToAria=function(e,t){var n;if(!e)return i;if("win32"===e.toLowerCase())n=[16,0,11601];else{if("mac"!==e.toLowerCase())return c;n=[16,28]}if(!t)return i;for(var o=t.split("."),r=0;r<n.length&&r<o.length;r++){var a=parseInt(o[r],10);if(isNaN(a))return i;if(a<n[r])return c;if(a>n[r])return i}return i},e.prototype.isDirectToAriaEnabled=function(){var e,o,r=this;void 0!==r.EnableDirectToAria&&null!==r.EnableDirectToAria||(OSF._OfficeAppFactory&&OSF._OfficeAppFactory.getHostInfo&&(e=OSF._OfficeAppFactory.getHostInfo()[n]),window.external&&typeof window.external.GetContext!==t&&typeof window.external.GetContext().GetHostFullVersion!==t&&(o=window.external.GetContext().GetHostFullVersion()),r.EnableDirectToAria=r.shouldSendDirectToAria(e,o));return r.EnableDirectToAria},e.prototype.sendTelemetry=function(t,n){e.EnableSendingTelemetryWithLegacyAria&&this.isDirectToAriaEnabled()&&OSF.OUtil.loadScript(this.getAriaCDNLocation(),function(){try{if(!this.ALogger){this.ALogger=AWTLogManager.initialize("db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439")}var e=new AWTEventProperties;for(var o in e.setName("Office.Extensibility.OfficeJS."+t),n)"table"!==o.toLowerCase()&&e.setProperty(o,n[o]);var r=new Date;e.setProperty("Date",r.toISOString()),this.ALogger.logEvent(e)}catch(e){}},1e3),e.EnableSendingTelemetryWithOTel&&p(t,n)},e.prototype.logData=function(e){this.isIUsageData(e)?this.sendTelemetry(e.Table,e.Fields):this.sendTelemetry(e.Table,e)},e.EnableSendingTelemetryWithOTel=c,e.EnableSendingTelemetryWithLegacyAria=i,e}();e.AriaLogger=m}(OSFAriaLogger||(OSFAriaLogger={})),function(e){var t,n=null,o=!0,r="",i=OSF.OUtil.Guid.generateNewGuid(),a=r,s=new RegExp("^https?://store\\.office(ppe|-int)?\\.com/","i");e.enableTelemetry=o;var c=function(){};e.AppInfo=c;var d=function(e,t){this.name=e,this.handler=t},l=function(){function e(){this.clientIDKey="Office API client",this.logIdSetKey="Office App Log Id Set"}return e.prototype.getClientId=function(){var e=this,t=e.getValue(e.clientIDKey);return(!t||t.length<=0||t.length>40)&&(t=OSF.OUtil.Guid.generateNewGuid(),e.setValue(e.clientIDKey,t)),t},e.prototype.saveLog=function(e,t){var n=this,o=n.getValue(n.logIdSetKey);o=(o&&o.length>0?o+";":r)+e,n.setValue(n.logIdSetKey,o),n.setValue(e,t)},e.prototype.enumerateLog=function(e,t){var n=this,o=n.getValue(n.logIdSetKey);if(o){var r=o.split(";");for(var i in r){var a=r[i],s=n.getValue(a);s&&(e&&e(a,s),t&&n.remove(a))}t&&n.remove(n.logIdSetKey)}},e.prototype.getValue=function(e){var t=OSF.OUtil.getLocalStorage(),n=r;return t&&(n=t.getItem(e)),n},e.prototype.setValue=function(e,t){var n=OSF.OUtil.getLocalStorage();n&&n.setItem(e,t)},e.prototype.remove=function(e){var t=OSF.OUtil.getLocalStorage();if(t)try{t.removeItem(e)}catch(e){}},e}(),u=function(){function t(){}return t.prototype.LogData=function(t){if(e.enableTelemetry)try{OSFAriaLogger.AriaLogger.getInstance().logData(t)}catch(e){}},t.prototype.LogRawData=function(t){if(e.enableTelemetry)try{OSFAriaLogger.AriaLogger.getInstance().logData(JSON.parse(t))}catch(e){}},t}();function f(e){return e&&(e=e.replace(/[{}]/g,r).toLowerCase()),e||r}var p=function(){function e(){}return e.hashString=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t},e.stringToHash=function(t){var n=e.hashString(t),o=n.toString();return o=n<0?"1"+o.substring(1):"0"+o},e.startsWith=function(e,t){return 0==e.indexOf(t)},e.isFileUrl=function(t){return e.startsWith(t.toLowerCase(),"file:")},e.removeHttpPrefix=function(t){var n=r;return e.startsWith(t.toLowerCase(),e.httpsPrefix)?n=e.httpsPrefix:e.startsWith(t.toLowerCase(),e.httpPrefix)&&(n=e.httpPrefix),t.slice(n.length)},e.getUrlDomain=function(t){var n=e.removeHttpPrefix(t);return n=(n=n.split("/")[0]).split(":")[0]},e.isIp4Address=function(e){return/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)},e.filter=function(t){if(e.isFileUrl(t))return"file://"+(o=e.stringToHash(t));var n=e.getUrlDomain(t);if(e.isIp4Address(n)){var o=e.stringToHash(t);return e.startsWith(n,"10.")?"IP10Range_"+o:e.startsWith(n,"192.")?"IP192Range_"+o:e.startsWith(n,"127.")?"IP127Range_"+o:"IPOther_"+o}return n},e.httpPrefix="http://",e.httpsPrefix="https://",e}();function m(e,t){var n=new OSFLog.AppInitializationUsageData;n.CorrelationId=f(a),n.SessionId=i,n.SuccessCode=e?1:0,n.Message=t,(new u).LogData(n)}e.initialize=function(a){if(e.enableTelemetry&&!t){t=new c,a.get_hostFullVersion()?t.hostVersion=a.get_hostFullVersion():t.hostVersion=a.get_appVersion(),t.appId=a.get_id(),t.host=a.get_appName(),t.browser=window.navigator.userAgent,t.correlationId=f(a.get_correlationId()),t.clientId=(new l).getClientId(),t.appInstanceId=a.get_appInstanceId(),t.appInstanceId&&(t.appInstanceId=t.appInstanceId.replace(/[{}]/g,r).toLowerCase()),t.message=a.get_hostCustomMessage(),t.officeJSVersion=OSF.ConstantNames.FileVersion,t.hostJSVersion="16.0.12219.10000",a._wacHostEnvironment&&(t.wacHostEnvironment=a._wacHostEnvironment),void 0!==a._isFromWacAutomation&&a._isFromWacAutomation!==n&&(t.isFromWacAutomation=a._isFromWacAutomation.toString().toLowerCase());var u=a.get_docUrl();t.docUrl=s.test(u)?u:r;var m=location.href;m&&(m=m.split("?")[0].split("#")[0]),t.appURL=p.filter(m),function(e,t){var o,i;t.assetId=r,t.userId=r;try{o=decodeURIComponent(e);var a=(i=(new DOMParser).parseFromString(o,"text/xml")).getElementsByTagName("t")[0].attributes.getNamedItem("cid"),s=i.getElementsByTagName("t")[0].attributes.getNamedItem("oid");a&&a.nodeValue?t.userId=a.nodeValue:s&&s.nodeValue&&(t.userId=s.nodeValue),t.assetId=i.getElementsByTagName("t")[0].attributes.getNamedItem("aid").nodeValue}catch(e){}finally{o=n,i=n,n}}(a.get_eToken(),t),t.sessionId=i,t.name=a.get_addinName(),"undefined"!=typeof OTel&&OTel.OTelLogger.initialize(t),function(){var t=new Date,r=n,i=0,a=!1,s=function(){document.hasFocus()?r==n&&(r=new Date):r&&(i+=Math.abs((new Date).getTime()-r.getTime()),r=n)},c=[];c.push(new d("focus",s)),c.push(new d("blur",s)),c.push(new d("focusout",s)),c.push(new d("focusin",s));var l=function(){for(var s=0;s<c.length;s++)OSF.OUtil.removeEventListener(window,c[s].name,c[s].handler);c.length=0,a||(document.hasFocus()&&r&&(i+=Math.abs((new Date).getTime()-r.getTime()),r=n),e.onAppClosed(Math.abs((new Date).getTime()-t.getTime()),i),a=o)};c.push(new d("beforeunload",l)),c.push(new d("unload",l));for(var u=0;u<c.length;u++)OSF.OUtil.addEventListener(window,c[u].name,c[u].handler);s()}(),e.onAppActivated()}},e.onAppActivated=function(){if(t){(new l).enumerateLog(function(e,t){return(new u).LogRawData(t)},o);var e=new OSFLog.AppActivatedUsageData;e.SessionId=i,e.AppId=t.appId,e.AssetId=t.assetId,e.AppURL=t.appURL,e.UserId=r,e.ClientId=t.clientId,e.Browser=t.browser,e.Host=t.host,e.HostVersion=t.hostVersion,e.CorrelationId=f(t.correlationId),e.AppSizeWidth=window.innerWidth,e.AppSizeHeight=window.innerHeight,e.AppInstanceId=t.appInstanceId,e.Message=t.message,e.DocUrl=t.docUrl,e.OfficeJSVersion=t.officeJSVersion,e.HostJSVersion=t.hostJSVersion,t.wacHostEnvironment&&(e.WacHostEnvironment=t.wacHostEnvironment),void 0!==t.isFromWacAutomation&&t.isFromWacAutomation!==n&&(e.IsFromWacAutomation=t.isFromWacAutomation),(new u).LogData(e)}},e.onScriptDone=function(e,t,n,o){var r=new OSFLog.ScriptLoadUsageData;r.CorrelationId=f(o),r.SessionId=i,r.ScriptId=e,r.StartTime=t,r.ResponseTime=n,(new u).LogData(r)},e.onCallDone=function(e,n,o,r,s){if(t){var c=new OSFLog.APIUsageUsageData;c.CorrelationId=f(a),c.SessionId=i,c.APIType=e,c.APIID=n,c.Parameters=o,c.ResponseTime=r,c.ErrorType=s,(new u).LogData(c)}},e.onMethodDone=function(e,t,o,i){var a=n;if(t)if("number"==typeof t)a=String(t);else if("object"==typeof t)for(var s in t)a!==n?a+=",":a=r,"number"==typeof t[s]&&(a+=String(t[s]));else a=r;OSF.AppTelemetry.onCallDone("method",e,a,o,i)},e.onPropertyDone=function(e,t){OSF.AppTelemetry.onCallDone("property",-1,e,t)},e.onCheckWACHost=function(e,t,n,o,r,i){var a=new OSFLog.CheckWACHostUsageData;a.isWacKnownHost=e,a.solutionId=t,a.hostType=n,a.hostPlatform=o,a.correlationId=r,a.wacDomain=p.filter(i),(new u).LogData(a)},e.onEventDone=function(e,t){OSF.AppTelemetry.onCallDone("event",e,n,0,t)},e.onRegisterDone=function(e,t,o,r){OSF.AppTelemetry.onCallDone(e?"registerevent":"unregisterevent",t,n,o,r)},e.onAppClosed=function(e,n){if(t){var o=new OSFLog.AppClosedUsageData;o.CorrelationId=f(a),o.SessionId=i,o.FocusTime=n,o.OpenTime=e,o.AppSizeFinalWidth=window.innerWidth,o.AppSizeFinalHeight=window.innerHeight,(new l).saveLog(i,o.SerializeRow())}},e.setOsfControlAppCorrelationId=function(e){a=f(e)},e.doAppInitializationLogging=m,e.logAppCommonMessage=function(e){m(!1,e)},e.logAppException=function(e){m(o,e)},OSF.AppTelemetry=e}(OSFAppTelemetry||(OSFAppTelemetry={})),Microsoft.Office.WebExtension.EventType={},OSF.EventDispatch=function(e){var t=this;if(t._eventHandlers={},t._objectEventHandlers={},t._queuedEventsArgs={},null!=e)for(var n=0;n<e.length;n++){var o=e[n];"objectDeleted"==o||"objectSelectionChanged"==o||"objectDataChanged"==o||"contentControlAdded"==o?t._objectEventHandlers[o]={}:t._eventHandlers[o]=[],t._queuedEventsArgs[o]=[]}},OSF.EventDispatch.prototype={getSupportedEvents:function(){var e=[];for(var t in this._eventHandlers)e.push(t);for(var t in this._objectEventHandlers)e.push(t);return e},supportsEvent:function(e){for(var t in this._eventHandlers)if(e==t)return!0;for(var t in this._objectEventHandlers)if(e==t)return!0;return!1},hasEventHandler:function(e,t){var n=this._eventHandlers[e];if(n&&n.length>0)for(var o=0;o<n.length;o++)if(n[o]===t)return!0;return!1},hasObjectEventHandler:function(e,t,n){var o=this._objectEventHandlers[e];if(null!=o)for(var r=o[t],i=0;null!=r&&i<r.length;i++)if(r[i]===n)return!0;return!1},addEventHandler:function(e,t){if("function"!=typeof t)return!1;var n=this._eventHandlers[e];return!(!n||this.hasEventHandler(e,t))&&(n.push(t),!0)},addObjectEventHandler:function(e,t,n){if("function"!=typeof n)return!1;var o=this._objectEventHandlers[e];return!(!o||this.hasObjectEventHandler(e,t,n))&&(null==o[t]&&(o[t]=[]),o[t].push(n),!0)},addEventHandlerAndFireQueuedEvent:function(e,t){var n=0==this._eventHandlers[e].length,o=this.addEventHandler(e,t);return n&&o&&this.fireQueuedEvent(e),o},removeEventHandler:function(e,t){var n=this._eventHandlers[e];if(n&&n.length>0)for(var o=0;o<n.length;o++)if(n[o]===t)return n.splice(o,1),!0;return!1},removeObjectEventHandler:function(e,t,n){var o=this._objectEventHandlers[e];if(null!=o)for(var r=o[t],i=0;null!=r&&i<r.length;i++)if(r[i]===n)return r.splice(i,1),!0;return!1},clearEventHandlers:function(e){return void 0!==this._eventHandlers[e]&&this._eventHandlers[e].length>0&&(this._eventHandlers[e]=[],!0)},clearObjectEventHandlers:function(e,t){return null!=this._objectEventHandlers[e]&&null!=this._objectEventHandlers[e][t]&&(this._objectEventHandlers[e][t]=[],!0)},getEventHandlerCount:function(e){return null!=this._eventHandlers[e]?this._eventHandlers[e].length:-1},getObjectEventHandlerCount:function(e,t){return null==this._objectEventHandlers[e]||null==this._objectEventHandlers[e][t]?0:this._objectEventHandlers[e][t].length},fireEvent:function(e){if(null==e.type)return!1;var t=e.type;if(t&&this._eventHandlers[t]){for(var n=this._eventHandlers[t],o=0;o<n.length;o++)n[o](e);return!0}return!1},fireObjectEvent:function(e,t){if(null==t.type)return!1;var n=t.type;if(n&&this._objectEventHandlers[n]){var o=this._objectEventHandlers[n][e];if(null!=o){for(var r=0;r<o.length;r++)o[r](t);return!0}}return!1},fireOrQueueEvent:function(e){var t=this,n=e.type;if(n&&t._eventHandlers[n]){var o=t._eventHandlers[n],r=t._queuedEventsArgs[n];return 0==o.length?r.push(e):t.fireEvent(e),!0}return!1},fireQueuedEvent:function(e){if(e&&this._eventHandlers[e]){var t=this._eventHandlers[e],n=this._queuedEventsArgs[e];if(t.length>0){for(var o=t[0];n.length>0;){o(n.shift())}return!0}}return!1},clearQueuedEvent:function(e){e&&this._eventHandlers[e]&&(this._queuedEventsArgs[e]&&(this._queuedEventsArgs[e]=[]))}},OSF.DDA.OMFactory=OSF.DDA.OMFactory||{},OSF.DDA.OMFactory.manufactureEventArgs=function(e,t,n){var o,r="hostPlatform",i="outlook",a="hostType",s=this;switch(e){case Microsoft.Office.WebExtension.EventType.DocumentSelectionChanged:o=new OSF.DDA.DocumentSelectionChangedEventArgs(t);break;case Microsoft.Office.WebExtension.EventType.BindingSelectionChanged:o=new OSF.DDA.BindingSelectionChangedEventArgs(s.manufactureBinding(n,t.document),n[OSF.DDA.PropertyDescriptors.Subset]);break;case Microsoft.Office.WebExtension.EventType.BindingDataChanged:o=new OSF.DDA.BindingDataChangedEventArgs(s.manufactureBinding(n,t.document));break;case Microsoft.Office.WebExtension.EventType.SettingsChanged:o=new OSF.DDA.SettingsChangedEventArgs(t);break;case Microsoft.Office.WebExtension.EventType.ActiveViewChanged:o=new OSF.DDA.ActiveViewChangedEventArgs(n);break;case Microsoft.Office.WebExtension.EventType.OfficeThemeChanged:o=new OSF.DDA.Theming.OfficeThemeChangedEventArgs(n);break;case Microsoft.Office.WebExtension.EventType.DocumentThemeChanged:o=new OSF.DDA.Theming.DocumentThemeChangedEventArgs(n);break;case Microsoft.Office.WebExtension.EventType.AppCommandInvoked:o=OSF.DDA.AppCommand.AppCommandInvokedEventArgs.create(n);break;case Microsoft.Office.WebExtension.EventType.ObjectDeleted:case Microsoft.Office.WebExtension.EventType.ObjectSelectionChanged:case Microsoft.Office.WebExtension.EventType.ObjectDataChanged:case Microsoft.Office.WebExtension.EventType.ContentControlAdded:o=new OSF.DDA.ObjectEventArgs(e,n[Microsoft.Office.WebExtension.Parameters.Id]);break;case Microsoft.Office.WebExtension.EventType.RichApiMessage:o=new OSF.DDA.RichApiMessageEventArgs(e,n);break;case Microsoft.Office.WebExtension.EventType.DataNodeInserted:o=new OSF.DDA.NodeInsertedEventArgs(s.manufactureDataNode(n[OSF.DDA.DataNodeEventProperties.NewNode]),n[OSF.DDA.DataNodeEventProperties.InUndoRedo]);break;case Microsoft.Office.WebExtension.EventType.DataNodeReplaced:o=new OSF.DDA.NodeReplacedEventArgs(s.manufactureDataNode(n[OSF.DDA.DataNodeEventProperties.OldNode]),s.manufactureDataNode(n[OSF.DDA.DataNodeEventProperties.NewNode]),n[OSF.DDA.DataNodeEventProperties.InUndoRedo]);break;case Microsoft.Office.WebExtension.EventType.DataNodeDeleted:o=new OSF.DDA.NodeDeletedEventArgs(s.manufactureDataNode(n[OSF.DDA.DataNodeEventProperties.OldNode]),s.manufactureDataNode(n[OSF.DDA.DataNodeEventProperties.NextSiblingNode]),n[OSF.DDA.DataNodeEventProperties.InUndoRedo]);break;case Microsoft.Office.WebExtension.EventType.TaskSelectionChanged:o=new OSF.DDA.TaskSelectionChangedEventArgs(t);break;case Microsoft.Office.WebExtension.EventType.ResourceSelectionChanged:o=new OSF.DDA.ResourceSelectionChangedEventArgs(t);break;case Microsoft.Office.WebExtension.EventType.ViewSelectionChanged:o=new OSF.DDA.ViewSelectionChangedEventArgs(t);break;case Microsoft.Office.WebExtension.EventType.DialogMessageReceived:o=new OSF.DDA.DialogEventArgs(n);break;case Microsoft.Office.WebExtension.EventType.DialogParentMessageReceived:o=new OSF.DDA.DialogParentEventArgs(n);break;case Microsoft.Office.WebExtension.EventType.ItemChanged:if(OSF._OfficeAppFactory.getHostInfo()[a]!=i)throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,e));o=new OSF.DDA.OlkItemSelectedChangedEventArgs(n),t.initialize(o.initialData),("win32"==OSF._OfficeAppFactory.getHostInfo()[r]||"mac"==OSF._OfficeAppFactory.getHostInfo()[r])&&t.setCurrentItemNumber(o.itemNumber.itemNumber);break;case Microsoft.Office.WebExtension.EventType.RecipientsChanged:if(OSF._OfficeAppFactory.getHostInfo()[a]!=i)throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,e));o=new OSF.DDA.OlkRecipientsChangedEventArgs(n);break;case Microsoft.Office.WebExtension.EventType.AppointmentTimeChanged:if(OSF._OfficeAppFactory.getHostInfo()[a]!=i)throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,e));o=new OSF.DDA.OlkAppointmentTimeChangedEventArgs(n);break;case Microsoft.Office.WebExtension.EventType.RecurrenceChanged:if(OSF._OfficeAppFactory.getHostInfo()[a]!=i)throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,e));o=new OSF.DDA.OlkRecurrenceChangedEventArgs(n);break;case Microsoft.Office.WebExtension.EventType.AttachmentsChanged:if(OSF._OfficeAppFactory.getHostInfo()[a]!=i)throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,e));o=new OSF.DDA.OlkAttachmentsChangedEventArgs(n);break;case Microsoft.Office.WebExtension.EventType.EnhancedLocationsChanged:if(OSF._OfficeAppFactory.getHostInfo()[a]!=i)throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,e));o=new OSF.DDA.OlkEnhancedLocationsChangedEventArgs(n);break;case Microsoft.Office.WebExtension.EventType.InfobarClicked:if(OSF._OfficeAppFactory.getHostInfo()[a]!=i)throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,e));o=new OSF.DDA.OlkInfobarClickedEventArgs(n);break;default:throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,e))}return o},OSF.DDA.AsyncMethodNames.addNames({AddHandlerAsync:"addHandlerAsync",RemoveHandlerAsync:"removeHandlerAsync"}),OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.AddHandlerAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.EventType,enum:Microsoft.Office.WebExtension.EventType,verify:function(e,t,n){return n.supportsEvent(e)}},{name:Microsoft.Office.WebExtension.Parameters.Handler,types:["function"]}],supportedOptions:[],privateStateCallbacks:[]}),OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.RemoveHandlerAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.EventType,enum:Microsoft.Office.WebExtension.EventType,verify:function(e,t,n){return n.supportsEvent(e)}}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.Handler,value:{types:["function","object"],defaultValue:null}}],privateStateCallbacks:[]}),function(e){!function(t){var n=function(){var n="object",o="string",i=null;function a(){var e=this,t=e;e._pseudoDocument=i,e._eventDispatch=i,e._processAppCommandInvocation=function(e){var n=t._verifyManifestCallback(e.callbackName);if(n.errorCode==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){var o=t._constructEventObjectForCallback(e);o?window.setTimeout(function(){n.callback(o)},0):t._invokeAppCommandCompletedMethod(e.appCommandId,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,"")}else t._invokeAppCommandCompletedMethod(e.appCommandId,n.errorCode,"")}}return a.initializeOsfDda=function(){OSF.DDA.AsyncMethodNames.addNames({AppCommandInvocationCompletedAsync:"appCommandInvocationCompletedAsync"}),OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.AppCommandInvocationCompletedAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Id,types:[o]},{name:Microsoft.Office.WebExtension.Parameters.Status,types:["number"]},{name:Microsoft.Office.WebExtension.Parameters.AppCommandInvocationCompletedData,types:[o]}]}),OSF.OUtil.augmentList(OSF.DDA.EventDescriptors,{AppCommandInvokedEvent:"AppCommandInvokedEvent"}),OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{AppCommandInvoked:"appCommandInvoked"}),OSF.OUtil.setNamespace("AppCommand",OSF.DDA),OSF.DDA.AppCommand.AppCommandInvokedEventArgs=e.AppCommand.AppCommandInvokedEventArgs},a.prototype.initializeAndChangeOnce=function(e){var n=this;t.registerDdaFacade(),n._pseudoDocument={},OSF.DDA.DispIdHost.addAsyncMethods(n._pseudoDocument,[OSF.DDA.AsyncMethodNames.AppCommandInvocationCompletedAsync]),n._eventDispatch=new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.AppCommandInvoked]);OSF.DDA.DispIdHost.addEventSupport(n._pseudoDocument,n._eventDispatch),n._pseudoDocument.addHandlerAsync(Microsoft.Office.WebExtension.EventType.AppCommandInvoked,n._processAppCommandInvocation,function(t){e&&("succeeded"==t.status?e(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):e(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))})},a.prototype._verifyManifestCallback=function(e){var t="function",o={callback:i,errorCode:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidCallback};e=e.trim();try{for(var r=e.split("."),a=window,s=0;s<r.length-1;s++){if(!a[r[s]]||typeof a[r[s]]!=n&&typeof a[r[s]]!=t)return o;a=a[r[s]]}var c=a[r[r.length-1]];if(typeof c!=t)return o}catch(e){return o}return{callback:c,errorCode:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}},a.prototype._invokeAppCommandCompletedMethod=function(e,t,n){this._pseudoDocument.appCommandInvocationCompletedAsync(e,t,n)},a.prototype._constructEventObjectForCallback=function(e){var t=this,n=new r;try{var o=JSON.parse(e.eventObjStr);this._translateEventObjectInternal(o,n),Object.defineProperty(n,"completed",{value:function(o){n.completedContext=o;var r=JSON.stringify(n);t._invokeAppCommandCompletedMethod(e.appCommandId,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,r)},enumerable:!0})}catch(e){n=i}return n},a.prototype._translateEventObjectInternal=function(e,t){for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];typeof r==n&&r!=i?(OSF.OUtil.defineEnumerableProperty(t,o,{value:{}}),this._translateEventObjectInternal(r,t[o])):Object.defineProperty(t,o,{value:r,enumerable:!0,writable:!0})}},a.prototype._constructObjectByTemplate=function(e,t){var r={};if(!e||!t)return r;for(var a in e)if(e.hasOwnProperty(a)&&(r[a]=i,t[a]!=i)){var s=e[a],c=t[a],d=typeof c;typeof s==n&&s!=i?r[a]=this._constructObjectByTemplate(s,c):"number"!=d&&d!=o&&"boolean"!=d||(r[a]=c)}return r},a.instance=function(){return a._instance==i&&(a._instance=new a),a._instance},a._instance=i,a}();t.AppCommandManager=n;var o=function(){function e(e,t,n){var o=this;o.type=Microsoft.Office.WebExtension.EventType.AppCommandInvoked,o.appCommandId=e,o.callbackName=t,o.eventObjStr=n}return e.create=function(n){return new e(n[t.AppCommandInvokedEventEnums.AppCommandId],n[t.AppCommandInvokedEventEnums.CallbackName],n[t.AppCommandInvokedEventEnums.EventObjStr])},e}();t.AppCommandInvokedEventArgs=o;var r=function(){};t.AppCommandCallbackEventArgs=r,t.AppCommandInvokedEventEnums={AppCommandId:"appCommandId",CallbackName:"callbackName",EventObjStr:"eventObjStr"}}(e.AppCommand||(e.AppCommand={}))}(OfficeExt||(OfficeExt={})),OfficeExt.AppCommand.AppCommandManager.initializeOsfDda(),OSF.OUtil.setNamespace("Marshaling",OSF.DDA),OSF.OUtil.setNamespace("AppCommand",OSF.DDA.Marshaling),function(e){var t="EventObjStr",n="CallbackName",o="AppCommandId";e[e[o]=0]=o,e[e[n]=1]=n,e[e[t]=2]=t}(OSF_DDA_Marshaling_AppCommand_AppCommandInvokedEventKeys||(OSF_DDA_Marshaling_AppCommand_AppCommandInvokedEventKeys={})),OSF.DDA.Marshaling.AppCommand.AppCommandInvokedEventKeys=OSF_DDA_Marshaling_AppCommand_AppCommandInvokedEventKeys,function(e){e[e.Id=0]="Id",e[e.Status=1]="Status",e[e.Data=2]="Data"}(OSF_DDA_Marshaling_AppCommand_AppCommandCompletedMethodParameterKeys||(OSF_DDA_Marshaling_AppCommand_AppCommandCompletedMethodParameterKeys={})),OSF.DDA.Marshaling.AppCommand.AppCommandCompletedMethodParameterKeys=OSF_DDA_Marshaling_AppCommand_AppCommandCompletedMethodParameterKeys,function(e){(e.AppCommand||(e.AppCommand={})).registerDdaFacade=function(){if(OSF.DDA.WAC){var t=OSF.DDA.WAC.Delegate.ParameterMap;t.define({type:OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,toHost:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:OSF.DDA.Marshaling.AppCommand.AppCommandCompletedMethodParameterKeys.Id},{name:Microsoft.Office.WebExtension.Parameters.Status,value:OSF.DDA.Marshaling.AppCommand.AppCommandCompletedMethodParameterKeys.Status},{name:Microsoft.Office.WebExtension.Parameters.AppCommandInvocationCompletedData,value:OSF.DDA.Marshaling.AppCommand.AppCommandCompletedMethodParameterKeys.Data}]}),t.define({type:OSF.DDA.EventDispId.dispidAppCommandInvokedEvent,fromHost:[{name:OSF.DDA.EventDescriptors.AppCommandInvokedEvent,value:t.self}]}),t.addComplexType(OSF.DDA.EventDescriptors.AppCommandInvokedEvent),t.define({type:OSF.DDA.EventDescriptors.AppCommandInvokedEvent,fromHost:[{name:e.AppCommand.AppCommandInvokedEventEnums.AppCommandId,value:OSF.DDA.Marshaling.AppCommand.AppCommandInvokedEventKeys.AppCommandId},{name:e.AppCommand.AppCommandInvokedEventEnums.CallbackName,value:OSF.DDA.Marshaling.AppCommand.AppCommandInvokedEventKeys.CallbackName},{name:e.AppCommand.AppCommandInvokedEventEnums.EventObjStr,value:OSF.DDA.Marshaling.AppCommand.AppCommandInvokedEventKeys.EventObjStr}]})}}}(OfficeExt||(OfficeExt={})),OSF.DialogShownStatus={hasDialogShown:!1,isWindowDialog:!1},OSF.OUtil.augmentList(OSF.DDA.EventDescriptors,{DialogMessageReceivedEvent:"DialogMessageReceivedEvent"}),OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{DialogMessageReceived:"dialogMessageReceived",DialogEventReceived:"dialogEventReceived"}),OSF.OUtil.augmentList(OSF.DDA.PropertyDescriptors,{MessageType:"messageType",MessageContent:"messageContent"}),OSF.DDA.DialogEventType={},OSF.OUtil.augmentList(OSF.DDA.DialogEventType,{DialogClosed:"dialogClosed",NavigationFailed:"naviationFailed"}),OSF.DDA.AsyncMethodNames.addNames({DisplayDialogAsync:"displayDialogAsync",CloseAsync:"close"}),OSF.DDA.SyncMethodNames.addNames({MessageParent:"messageParent",AddMessageHandler:"addEventHandler",SendMessage:"sendMessage"}),OSF.DDA.UI.ParentUI=function(){var e;e=null!=Microsoft.Office.WebExtension.EventType.DialogParentMessageReceived?new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.DialogMessageReceived,Microsoft.Office.WebExtension.EventType.DialogEventReceived,Microsoft.Office.WebExtension.EventType.DialogParentMessageReceived]):new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.DialogMessageReceived,Microsoft.Office.WebExtension.EventType.DialogEventReceived]);var t=OSF.DDA.AsyncMethodNames.DisplayDialogAsync.displayName,n=this;!n[t]&&OSF.OUtil.defineEnumerableProperty(n,t,{value:function(){var t=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.OpenDialog];t(arguments,e,n)}}),OSF.OUtil.finalizeProperties(this)},OSF.DDA.UI.ChildUI=function(e){var t=OSF.DDA.SyncMethodNames.MessageParent.displayName,n=this;!n[t]&&OSF.OUtil.defineEnumerableProperty(n,t,{value:function(){var e=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.MessageParent];return e(arguments,n)}});var o=OSF.DDA.SyncMethodNames.AddMessageHandler.displayName;!n[o]&&void 0!==OSF.DialogParentMessageEventDispatch&&OSF.DDA.DispIdHost.addEventSupport(n,OSF.DialogParentMessageEventDispatch,e),OSF.OUtil.finalizeProperties(this)},OSF.DialogHandler=function(){},OSF.DDA.DialogEventArgs=function(e){e[OSF.DDA.PropertyDescriptors.MessageType]==OSF.DialogMessageType.DialogMessageReceived?OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.DialogMessageReceived},message:{value:e[OSF.DDA.PropertyDescriptors.MessageContent]}}):OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.DialogEventReceived},error:{value:e[OSF.DDA.PropertyDescriptors.MessageType]}})},OSF.DDA.DialogParentEventArgs=function(e){OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.DialogParentMessageReceived},message:{value:e[OSF.DDA.PropertyDescriptors.MessageContent]}})},OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.DisplayDialogAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Url,types:["string"]}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.Width,value:{types:["number"],defaultValue:99}},{name:Microsoft.Office.WebExtension.Parameters.Height,value:{types:["number"],defaultValue:99}},{name:Microsoft.Office.WebExtension.Parameters.RequireHTTPs,value:{types:["boolean"],defaultValue:!0}},{name:Microsoft.Office.WebExtension.Parameters.DisplayInIframe,value:{types:["boolean"],defaultValue:!1}},{name:Microsoft.Office.WebExtension.Parameters.HideTitle,value:{types:["boolean"],defaultValue:!1}},{name:Microsoft.Office.WebExtension.Parameters.UseDeviceIndependentPixels,value:{types:["boolean"],defaultValue:!1}},{name:Microsoft.Office.WebExtension.Parameters.PromptBeforeOpen,value:{types:["boolean"],defaultValue:!0}},{name:Microsoft.Office.WebExtension.Parameters.EnforceAppDomain,value:{types:["boolean"],defaultValue:!1}}],privateStateCallbacks:[],onSucceeded:function(e){var t=e[Microsoft.Office.WebExtension.Parameters.Id],n=e[Microsoft.Office.WebExtension.Parameters.Data],o=new OSF.DialogHandler,r=OSF.DDA.AsyncMethodNames.CloseAsync.displayName;OSF.OUtil.defineEnumerableProperty(o,r,{value:function(){var e=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.CloseDialog];e(arguments,t,n,o)}});var i=OSF.DDA.SyncMethodNames.AddMessageHandler.displayName;OSF.OUtil.defineEnumerableProperty(o,i,{value:function(){var e=OSF.DDA.SyncMethodCalls[OSF.DDA.SyncMethodNames.AddMessageHandler.id],t=e.verifyAndExtractCall(arguments,o,n),r=t[Microsoft.Office.WebExtension.Parameters.EventType],i=t[Microsoft.Office.WebExtension.Parameters.Handler];return n.addEventHandlerAndFireQueuedEvent(r,i)}});var a=OSF.DDA.SyncMethodNames.SendMessage.displayName;return OSF.OUtil.defineEnumerableProperty(o,a,{value:function(){var e=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.SendMessage];return e(arguments,n,o)}}),o},checkCallArgs:function(e){return e[Microsoft.Office.WebExtension.Parameters.Width]<=0&&(e[Microsoft.Office.WebExtension.Parameters.Width]=1),!e[Microsoft.Office.WebExtension.Parameters.UseDeviceIndependentPixels]&&e[Microsoft.Office.WebExtension.Parameters.Width]>100&&(e[Microsoft.Office.WebExtension.Parameters.Width]=99),e[Microsoft.Office.WebExtension.Parameters.Height]<=0&&(e[Microsoft.Office.WebExtension.Parameters.Height]=1),!e[Microsoft.Office.WebExtension.Parameters.UseDeviceIndependentPixels]&&e[Microsoft.Office.WebExtension.Parameters.Height]>100&&(e[Microsoft.Office.WebExtension.Parameters.Height]=99),e[Microsoft.Office.WebExtension.Parameters.RequireHTTPs]||(e[Microsoft.Office.WebExtension.Parameters.RequireHTTPs]=!0),e}}),OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.CloseAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[]}),OSF.DDA.SyncMethodCalls.define({method:OSF.DDA.SyncMethodNames.MessageParent,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.MessageToParent,types:["string","number","boolean"]}],supportedOptions:[]}),OSF.DDA.SyncMethodCalls.define({method:OSF.DDA.SyncMethodNames.AddMessageHandler,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.EventType,enum:Microsoft.Office.WebExtension.EventType,verify:function(e,t,n){return n.supportsEvent(e)}},{name:Microsoft.Office.WebExtension.Parameters.Handler,types:["function"]}],supportedOptions:[]}),OSF.DDA.SyncMethodCalls.define({method:OSF.DDA.SyncMethodNames.SendMessage,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.MessageContent,types:["string"]}],supportedOptions:[],privateStateCallbacks:[]}),OSF.OUtil.setNamespace("Marshaling",OSF.DDA),OSF.OUtil.setNamespace("Dialog",OSF.DDA.Marshaling),OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys={MessageType:"messageType",MessageContent:"messageContent"},OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys={MessageType:"messageType",MessageContent:"messageContent"},OSF.DDA.Marshaling.MessageParentKeys={MessageToParent:"messageToParent"},OSF.DDA.Marshaling.DialogNotificationShownEventType={DialogNotificationShown:"dialogNotificationShown"},OSF.DDA.Marshaling.SendMessageKeys={MessageContent:"messageContent"},function(e){!function(e){var t={Excel:"excel",Word:"word",PowerPoint:"powerpoint",Outlook:"outlook",Visio:"visio"};e.getDialogCssManager=function(e){switch(e){case t.Excel:case t.Word:case t.PowerPoint:case t.Outlook:case t.Visio:default:return new n}return null};var n=function(){var e=";";function t(){var e="height: 100px",t="font-size: 14px",n="font-family: Segoe UI,Arial,Verdana,sans-serif",o="margin: 20px 14px",r="width: 100%",i="position: absolute",a=this;a.overlayElementCSS=[i,"top: 0","left: 0",r,"height: 100%","background-color: rgba(198, 198, 198, 0.5)","z-index: 99998"],a.dialogNotificationPanelCSS=[r,"height: 190px",i,"z-index: 99999","background-color: rgba(255, 255, 255, 1)","left: 0px","top: 50%","margin-top: -95px"],a.newWindowNotificationTextPanelCSS=[o,n,t,e,"line-height: 100px"],a.newWindowNotificationTextSpanCSS=["display: inline-block","line-height: normal","vertical-align: middle"],a.crossZoneNotificationTextPanelCSS=[o,n,t,e],a.dialogNotificationButtonPanelCSS="margin:0px 9px",a.buttonStyleCSS=["text-align: center","width: 70px","height: 25px",t,n,"margin: 0px 5px","border-width: 1px","border-style: solid"]}return t.prototype.getOverlayElementCSS=function(){return this.overlayElementCSS.join(e)},t.prototype.getDialogNotificationPanelCSS=function(){return this.dialogNotificationPanelCSS.join(e)},t.prototype.getNewWindowNotificationTextPanelCSS=function(){return this.newWindowNotificationTextPanelCSS.join(e)},t.prototype.getNewWindowNotificationTextSpanCSS=function(){return this.newWindowNotificationTextSpanCSS.join(e)},t.prototype.getCrossZoneNotificationTextPanelCSS=function(){return this.crossZoneNotificationTextPanelCSS.join(e)},t.prototype.getDialogNotificationButtonPanelCSS=function(){return this.dialogNotificationButtonPanelCSS},t.prototype.getDialogButtonCSS=function(){return this.buttonStyleCSS.join(e)},t}();e.DefaultDialogCSSManager=n}(e.WacCommonUICssManager||(e.WacCommonUICssManager={}))}(OfficeExt||(OfficeExt={})),function(e){!function(t){!function(t){var n="div",o="string",r="message",i="storage",a="keydown",s=!1,c=null,d=c,l=c,u=c,f=c,p="osfDialogInternal:action=closeDialog",m=c,g=s,S=-1,v="messageParentKey",O=c,A="#ababab",D="#ffffff",h="#ccc",y="newWindowNotificaiton",C="crossZoneNotification",F="configureBrowserLink",E="dialogNotificationTextPanel",M=e.WACUtils.shouldUseLocalStorageToPassMessage(),b={dispId:OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,eventType:OSF.DDA.Marshaling.DialogNotificationShownEventType.DialogNotificationShown,onComplete:c};function T(t,n){var o=s,r=e.WacCommonUICssManager.getDialogCssManager(n);u=W(r),document.body.insertBefore(u,document.body.firstChild),(f=j(r,t)).id=C;var i=H(r),c=x(r,Strings.OfficeOM.L_DialogOK?Strings.OfficeOM.L_DialogOK:"OK");i.appendChild(c),f.appendChild(i),document.body.insertBefore(f,document.body.firstChild),g=!0,c.onclick=function(){k()},c.addEventListener(a,function(e){9==e.keyCode?(document.getElementById(F).focus(),e.preventDefault(),e.stopPropagation()):13==e.keyCode&&(o=!0,e.preventDefault(),e.stopPropagation())},s),c.addEventListener("keyup",function(e){13==e.keyCode&&o&&(o=s,k(),e.preventDefault(),e.stopPropagation())},s),document.getElementById(F).addEventListener(a,function(e){9==e.keyCode&&(c.focus(),e.preventDefault(),e.stopPropagation())},s),window.focus(),c.focus()}function _(e){if(e.source==d)try{var t={};t[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=OSF.DialogMessageType.DialogMessageReceived,t[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=e.data,l(t)}catch(e){OSF.AppTelemetry&&OSF.AppTelemetry.logAppException("Error happened during receive message handler."+e)}}function w(e){var t=OSF._OfficeAppFactory.getInitializationHelper()._webAppState.id+v;if(e.key==t)try{var n={};n[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=OSF.DialogMessageType.DialogMessageReceived,n[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=e.newValue,l(n)}catch(e){OSF.AppTelemetry&&OSF.AppTelemetry.logAppException("Error happened during storage changed handler."+e)}}function I(t){var n=OSF._OfficeAppFactory.getInitializationHelper()._hostInfo,o=[n.hostType,n.hostPlatform,n.hostSpecificFileVersion,n.hostLocale,n.osfControlAppCorrelationId,"isDialog",n.disableLogging?"disableLogging":""].join("|"),a=OSF._OfficeAppFactory.getInitializationHelper()._appContext,s=t[OSF.ShowWindowDialogParameterKeys.Url];s=e.WACUtils.addHostInfoAsQueryParam(s,o);var u=JSON.parse(window.name);u[OSF.WindowNameItemKeys.HostInfo]=o,u[OSF.WindowNameItemKeys.AppContext]=a;var f=t[OSF.ShowWindowDialogParameterKeys.Width]*screen.width/100,p=t[OSF.ShowWindowDialogParameterKeys.Height]*screen.height/100,g="width="+f+", height="+p+", left="+(a._clientWindowWidth/2-f/2)+", top="+(a._clientWindowHeight/2-p/2)+",channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no";if((d=window.open(s,e.WACUtils.serializeObjectToString(u),g))==c)return OSF.AppTelemetry.logAppCommonMessage("Encountered cross zone issue in displayDialogAsync api."),R(),T(s,n.hostType),void m(OSF.DDA.ErrorCodeManager.errorCodes.ooeCrossZone);M?window.addEventListener(i,w):window.addEventListener(r,_),S=window.setInterval(function(){try{if(d==c||d.closed){window.clearInterval(S),M?window.removeEventListener(i,w):window.removeEventListener(r,_);var e={};e[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=OSF.DialogMessageType.DialogClosed,l(e)}}catch(e){OSF.AppTelemetry&&OSF.AppTelemetry.logAppException("Error happened during check or handle window close."+e)}},1e3),m!=c?m(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):OSF.AppTelemetry&&OSF.AppTelemetry.logAppException("showDialogCallback can not be null.")}function x(e,t){var n=document.createElement("input");n.setAttribute("type","button"),n.style.cssText=e.getDialogButtonCSS(),n.style.borderColor=A,n.style.backgroundColor=D,n.setAttribute("value",t);var o=function(){P(n)},r=function(){N(n)};return n.addEventListener("mouseover",o),n.addEventListener("focus",o),n.addEventListener("mouseout",r),n.addEventListener("focusout",r),n}function P(e){O!=c?(e.style.borderColor=O.HostButtonBorderColor,e.style.backgroundColor=O.HostButtonBackgroundColor):OSF.CommonUI&&OSF.CommonUI.HostButtonBorderColor&&OSF.CommonUI.HostButtonBackgroundColor?(e.style.borderColor=OSF.CommonUI.HostButtonBorderColor,e.style.backgroundColor=OSF.CommonUI.HostButtonBackgroundColor):e.style.backgroundColor=h}function N(e){e.style.borderColor=A,e.style.backgroundColor=D}function k(){b.onComplete=function(e){R(),U(e)},OSF.DDA.WAC.Delegate.unregisterEventAsync(b)}function R(){f!=c&&(document.body.removeChild(f),f=c),u!=c&&(document.body.removeChild(u),u=c)}function W(e){var t=document.createElement(n);return t.style.cssText=e.getOverlayElementCSS(),t}function L(e,t){var o=document.createElement(n);o.style.cssText=e.getDialogNotificationPanelCSS(),B(o);var r=document.createElement(n);r.style.cssText=e.getNewWindowNotificationTextPanelCSS(),r.id=E,"rtl"==document.documentElement.getAttribute("dir")?r.style.paddingRight="30px":r.style.paddingLeft="30px";var i=document.createElement("span");return i.style.cssText=e.getNewWindowNotificationTextSpanCSS(),i.innerText=t,r.appendChild(i),o.appendChild(r),o}function H(e){var t=document.createElement(n);return t.style.cssText=e.getDialogNotificationButtonPanelCSS(),"rtl"==document.documentElement.getAttribute("dir")?t.style.cssFloat="left":t.style.cssFloat="right",t}function U(e){if(e!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){var t=document.querySelectorAll(OSF._OfficeAppFactory.getInitializationHelper()._tabbableElements);OSF.OUtil.focusToFirstTabbable(t,s)}}function j(t,o){var r=document.createElement(n);r.style.cssText=t.getDialogNotificationPanelCSS(),B(r);var i=document.createElement(n);i.style.cssText=t.getCrossZoneNotificationTextPanelCSS(),i.id=E;var a=document.createElement("a");a.id=F,a.href="#",a.innerText=Strings.OfficeOM.L_NewWindowCrossZoneConfigureBrowserLink,a.setAttribute("onclick","window.open('https://support.microsoft.com/en-us/help/17479/windows-internet-explorer-11-change-security-privacy-settings', '_blank', 'fullscreen=1')");var s=document.createElement("span");return Strings.OfficeOM.L_NewWindowCrossZone&&(s.innerHTML=OSF.OUtil.formatString(Strings.OfficeOM.L_NewWindowCrossZone,a.outerHTML,e.WACUtils.getDomainForUrl(o))),i.appendChild(s),r.appendChild(i),r}function B(e){e.setAttribute("role","dialog"),e.setAttribute("aria-describedby",E)}t.setHostThemeButtonStyle=function(e){var t=e.input;t!=c&&(O={HostButtonBorderColor:t[OSF.HostThemeButtonStyleKeys.ButtonBorderColor],HostButtonBackgroundColor:t[OSF.HostThemeButtonStyleKeys.ButtonBackgroundColor]}),e.completed()},t.removeEventListenersForDialog=function(e){OSF._OfficeAppFactory.getInitializationHelper().addOrRemoveEventListenersForWindow(s),e.completed()},t.handleNewWindowDialog=function(t){try{if(t[OSF.ShowWindowDialogParameterKeys.EnforceAppDomain]&&!function(e){var t=OSF._OfficeAppFactory.getInitializationHelper()._appContext._appDomains,n=e[OSF.ShowWindowDialogParameterKeys.Url],o=Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(t,n);return o||OSF._OfficeAppFactory.getInitializationHelper()._appContext._addInSourceUrl&&Microsoft.Office.Common.XdmCommunicationManager.isTargetSubdomainOfSourceLocation(OSF._OfficeAppFactory.getInitializationHelper()._appContext._addInSourceUrl,n)}(t))return void m(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains);if(!t[OSF.ShowWindowDialogParameterKeys.PromptBeforeOpen])return void I(t);g=s;var n=s,o=OSF._OfficeAppFactory.getInitializationHelper()._hostInfo,r=e.WacCommonUICssManager.getDialogCssManager(o.hostType),i=OSF.OUtil.formatString(Strings.OfficeOM.L_ShowWindowDialogNotification,OSF._OfficeAppFactory.getInitializationHelper()._appContext._addinName);u=W(r),document.body.insertBefore(u,document.body.firstChild),(f=L(r,i)).id=y;var c=H(r),d=x(r,Strings.OfficeOM.L_ShowWindowDialogNotificationAllow),l=x(r,Strings.OfficeOM.L_ShowWindowDialogNotificationIgnore);function p(e){b.onComplete=function(e){R(),U(e),m(OSF.DDA.ErrorCodeManager.errorCodes.ooeEndUserIgnore)},OSF.DDA.WAC.Delegate.unregisterEventAsync(b),e.preventDefault(),e.stopPropagation()}c.appendChild(d),c.appendChild(l),f.appendChild(c),document.body.insertBefore(f,document.body.firstChild),d.onclick=function(e){I(t),!g&&k(),e.preventDefault(),e.stopPropagation()},l.onclick=p,d.addEventListener(a,function(e){e.shiftKey&&9==e.keyCode&&(N(d),P(l),l.focus(),e.preventDefault(),e.stopPropagation())},s),l.addEventListener(a,function(e){e.shiftKey||9!=e.keyCode?13==e.keyCode&&(n=!0,e.preventDefault(),e.stopPropagation()):(N(l),P(d),d.focus(),e.preventDefault(),e.stopPropagation())},s),l.addEventListener("keyup",function(e){13==e.keyCode&&n&&(n=s,p(e))},s),window.focus(),b.onComplete=function(){d.focus()},OSF.DDA.WAC.Delegate.registerEventAsync(b)}catch(e){OSF.AppTelemetry&&OSF.AppTelemetry.logAppException("Exception happens at new window dialog."+e),m(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},t.closeDialog=function(e){try{if(d!=c){var t=OSF._OfficeAppFactory.getInitializationHelper()._appContext._appDomains;if(t)for(var n=0;n<t.length&&-1!==t[n].indexOf("://");n++)d.postMessage(p,t[n]);d!=c&&!d.closed&&d.close(),M?window.removeEventListener(i,w):window.removeEventListener(r,_),window.clearInterval(S),d=c,e(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else e(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}catch(t){OSF.AppTelemetry&&OSF.AppTelemetry.logAppException("Exception happens at close window dialog."+t),e(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},t.messageParent=function(e){var t=e.hostCallArgs[Microsoft.Office.WebExtension.Parameters.MessageToParent];if(M)try{var n=OSF._OfficeAppFactory.getInitializationHelper()._webAppState.id+v;window.localStorage.setItem(n,t)}catch(e){OSF.AppTelemetry&&OSF.AppTelemetry.logAppException("Error happened during messageParent method:"+e)}else{var o=OSF._OfficeAppFactory.getInitializationHelper()._appContext._appDomains;if(o)for(var r=0;r<o.length&&-1!==o[r].indexOf("://");r++)window.opener.postMessage(t,o[r]);var i=window.location.origin;i||(i=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),!Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(o,i)&&window.opener.postMessage(t,i)}},t.sendMessage=function(e){if(d!=c){var t=e.hostCallArgs,n=OSF._OfficeAppFactory.getInitializationHelper()._appContext._appDomains;if(n)for(var r=0;r<n.length&&-1!==n[r].indexOf("://");r++)typeof t!=o&&(t=JSON.stringify(t)),d.postMessage(t,n[r])}},t.registerMessageReceivedEvent=function(){window.addEventListener(r,function(e){if(e.source==window.opener)if(typeof e.data===o&&e.data.indexOf(p)>-1)window.close();else{var t=e.data,n=typeof t;if(t&&("object"==n||n==o)){n==o&&(t=JSON.parse(t));var r=OSF.DDA.OMFactory.manufactureEventArgs(Microsoft.Office.WebExtension.EventType.DialogParentMessageReceived,c,t);OSF.DialogParentMessageEventDispatch.fireEvent(r)}}})},t.setHandlerAndShowDialogCallback=function(e,t){l=e,m=t},t.escDismissDialogNotification=function(){try{f&&f.id==y&&m&&m(OSF.DDA.ErrorCodeManager.errorCodes.ooeEndUserIgnore)}catch(e){OSF.AppTelemetry&&OSF.AppTelemetry.logAppException("Error happened during executing displayDialogAsync callback."+e)}k()},t.showCrossZoneNotification=T}(t.Dialog||(t.Dialog={}))}(e.AddinNativeAction||(e.AddinNativeAction={}))}(OfficeExt||(OfficeExt={})),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,fromHost:[{name:OSF.DDA.EventDescriptors.DialogMessageReceivedEvent,value:OSF.DDA.WAC.Delegate.ParameterMap.self}]}),OSF.DDA.WAC.Delegate.ParameterMap.addComplexType(OSF.DDA.EventDescriptors.DialogMessageReceivedEvent),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.EventDescriptors.DialogMessageReceivedEvent,fromHost:[{name:OSF.DDA.PropertyDescriptors.MessageType,value:OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType},{name:OSF.DDA.PropertyDescriptors.MessageContent,value:OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent}]}),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,fromHost:[{name:OSF.DDA.EventDescriptors.DialogParentMessageReceivedEvent,value:OSF.DDA.WAC.Delegate.ParameterMap.self}]}),OSF.DDA.WAC.Delegate.ParameterMap.addComplexType(OSF.DDA.EventDescriptors.DialogParentMessageReceivedEvent),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.EventDescriptors.DialogParentMessageReceivedEvent,fromHost:[{name:OSF.DDA.PropertyDescriptors.MessageType,value:OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType},{name:OSF.DDA.PropertyDescriptors.MessageContent,value:OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent}]}),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidMessageParentMethod,toHost:[{name:Microsoft.Office.WebExtension.Parameters.MessageToParent,value:OSF.DDA.Marshaling.MessageParentKeys.MessageToParent}]}),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidSendMessageMethod,toHost:[{name:Microsoft.Office.WebExtension.Parameters.MessageContent,value:OSF.DDA.Marshaling.SendMessageKeys.MessageContent}]}),OSF.DDA.WAC.Delegate.openDialog=function(e){var t="https://",n="http://",o=JSON.parse(e.targetId),r=OSF.DDA.WAC.Delegate._getOnAfterRegisterEvent(!0,e);function i(e){var t={Error:e};try{r(Microsoft.Office.Common.InvokeResultCode.noError,t)}catch(e){OSF.AppTelemetry&&OSF.AppTelemetry.logAppException("Exception happens at showDialogCallback."+e)}}if(OSF.DialogShownStatus.hasDialogShown)i(OSF.DDA.ErrorCodeManager.errorCodes.ooeDialogAlreadyOpened);else{var a=o[OSF.ShowWindowDialogParameterKeys.Url].toLowerCase();null!=a&&a.substr(0,t.length)===t?o[OSF.ShowWindowDialogParameterKeys.DisplayInIframe]?(OSF.DialogShownStatus.isWindowDialog=!1,OSF.DDA.WAC.Delegate.registerEventAsync(e)):(OSF.DialogShownStatus.isWindowDialog=!0,OfficeExt.AddinNativeAction.Dialog.setHandlerAndShowDialogCallback(function(t){e.onEvent&&e.onEvent(t),OSF.AppTelemetry&&OSF.AppTelemetry.onEventDone(e.dispId)},i),OfficeExt.AddinNativeAction.Dialog.handleNewWindowDialog(o)):a.substr(0,n.length)===n?i(OSF.DDA.ErrorCodeManager.errorCodes.ooeRequireHTTPS):i(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidScheme)}},OSF.DDA.WAC.Delegate.messageParent=function(e){null!=window.opener?OfficeExt.AddinNativeAction.Dialog.messageParent(e):OSF.DDA.WAC.Delegate.executeAsync(e)},OSF.DDA.WAC.Delegate.sendMessage=function(e){OSF.DialogShownStatus.hasDialogShown&&(OSF.DialogShownStatus.isWindowDialog?OfficeExt.AddinNativeAction.Dialog.sendMessage(e):OSF.DDA.WAC.Delegate.executeAsync(e))},OSF.DDA.WAC.Delegate.closeDialog=function(e){var t=OSF.DDA.WAC.Delegate._getOnAfterRegisterEvent(!1,e);function n(e){var n={Error:e};try{t(Microsoft.Office.Common.InvokeResultCode.noError,n)}catch(e){OSF.AppTelemetry&&OSF.AppTelemetry.logAppException("Exception happens at closeDialogCallback."+e)}}OSF.DialogShownStatus.hasDialogShown?OSF.DialogShownStatus.isWindowDialog?(e.onCalling&&e.onCalling(),OfficeExt.AddinNativeAction.Dialog.closeDialog(n)):OSF.DDA.WAC.Delegate.unregisterEventAsync(e):n(OSF.DDA.ErrorCodeManager.errorCodes.ooeWebDialogClosed)},OSF.InitializationHelper.prototype.dismissDialogNotification=function(){OfficeExt.AddinNativeAction.Dialog.escDismissDialogNotification()},OSF.InitializationHelper.prototype.registerMessageReceivedEventForWindowDialog=function(){OfficeExt.AddinNativeAction.Dialog.registerMessageReceivedEvent()},OSF.DDA.AsyncMethodNames.addNames({CloseContainerAsync:"closeContainer"}),function(e){var t=function(){};(OfficeExt||(OfficeExt={})).Container=t}(),OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.CloseContainerAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[]}),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidCloseContainerMethod,fromHost:[],toHost:[]}),OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{ItemChanged:"olkItemSelectedChanged"}),OSF.OUtil.augmentList(OSF.DDA.EventDescriptors,{OlkItemSelectedData:"OlkItemSelectedData"}),OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{RecipientsChanged:"olkRecipientsChanged"}),OSF.OUtil.augmentList(OSF.DDA.EventDescriptors,{OlkRecipientsData:"OlkRecipientsData"}),OSF.DDA.OlkRecipientsChangedEventArgs=function(e){var t=e[OSF.DDA.EventDescriptors.OlkRecipientsData][0];""===t&&(t=null),OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.RecipientsChanged},changedRecipientFields:{value:JSON.parse(t)}})},OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{AppointmentTimeChanged:"olkAppointmentTimeChanged"}),OSF.OUtil.augmentList(OSF.DDA.EventDescriptors,{OlkAppointmentTimeChangedData:"OlkAppointmentTimeChangedData"}),OSF.DDA.OlkAppointmentTimeChangedEventArgs=function(e){var t,n,o=e[OSF.DDA.EventDescriptors.OlkAppointmentTimeChangedData][0];try{var r=JSON.parse(o);t=new Date(r.start).toISOString(),n=new Date(r.end).toISOString()}catch(e){t=null,n=null}OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.AppointmentTimeChanged},start:{value:t},end:{value:n}})},OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{RecurrenceChanged:"olkRecurrenceChanged"}),OSF.OUtil.augmentList(OSF.DDA.EventDescriptors,{OlkRecurrenceData:"OlkRecurrenceData"}),OSF.DDA.OlkRecurrenceChangedEventArgs=function(e){var t=null;try{var n=JSON.parse(e[OSF.DDA.EventDescriptors.OlkRecurrenceChangedData][0]);null!=n.recurrence&&(t=JSON.parse(n.recurrence),t=Microsoft.Office.WebExtension.OutlookBase.SeriesTimeJsonConverter(t))}catch(e){t=null}OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.RecurrenceChanged},recurrence:{value:t}})},OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{OfficeThemeChanged:"officeThemeChanged"}),OSF.OUtil.augmentList(OSF.DDA.EventDescriptors,{OfficeThemeData:"OfficeThemeData"}),OSF.OUtil.setNamespace("Theming",OSF.DDA),OSF.DDA.Theming.OfficeThemeChangedEventArgs=function(e){var t=JSON.parse(e.OfficeThemeData[0]),n={};for(var o in t)n[o]=OSF.OUtil.convertIntToCssHexColor(t[o]);OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.OfficeThemeChanged},officeTheme:{value:n}})},OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{AttachmentsChanged:"olkAttachmentsChanged"}),OSF.OUtil.augmentList(OSF.DDA.EventDescriptors,{OlkAttachmentsChangedData:"OlkAttachmentsChangedData"}),OSF.DDA.OlkAttachmentsChangedEventArgs=function(e){var t,n;try{var o=JSON.parse(e[OSF.DDA.EventDescriptors.OlkAttachmentsChangedData][0]);t=o.attachmentStatus,n=Microsoft.Office.WebExtension.OutlookBase.CreateAttachmentDetails(o.attachmentDetails)}catch(e){t=null,n=null}OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.AttachmentsChanged},attachmentStatus:{value:t},attachmentDetails:{value:n}})},OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{EnhancedLocationsChanged:"olkEnhancedLocationsChanged"}),OSF.OUtil.augmentList(OSF.DDA.EventDescriptors,{OlkEnhancedLocationsChangedData:"OlkEnhancedLocationsChangedData"}),OSF.DDA.OlkEnhancedLocationsChangedEventArgs=function(e){var t;try{t=JSON.parse(e[OSF.DDA.EventDescriptors.OlkEnhancedLocationsChangedData][0]).enhancedLocations}catch(e){t=null}OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.EnhancedLocationsChanged},enhancedLocations:{value:t}})},OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{InfobarClicked:"olkInfobarClicked"}),OSF.OUtil.augmentList(OSF.DDA.EventDescriptors,{OlkInfobarClickedData:"OlkInfobarClickedData"}),OSF.DDA.OlkInfobarClickedEventArgs=function(e){var t;try{t=e[OSF.DDA.EventDescriptors.OlkInfobarClickedData][0]}catch(e){t=null}OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.InfobarClicked},infobarDetails:{value:t}})},OSF.DDA.OlkItemSelectedChangedEventArgs=function(e){var t=e[OSF.DDA.EventDescriptors.OlkItemSelectedData];""===t&&(t=null),OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.ItemChanged},initialData:{value:t}})},OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.EventDispId.dispidOlkItemSelectedChangedEvent,fromHost:[{name:OSF.DDA.EventDescriptors.OlkItemSelectedData,value:OSF.DDA.WAC.Delegate.ParameterMap.self}],isComplexType:!0}),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.EventDispId.dispidOlkRecipientsChangedEvent,fromHost:[{name:OSF.DDA.EventDescriptors.OlkRecipientsData,value:OSF.DDA.WAC.Delegate.ParameterMap.self}],isComplexType:!0}),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.EventDispId.dispidOlkAppointmentTimeChangedEvent,fromHost:[{name:OSF.DDA.EventDescriptors.OlkAppointmentTimeChangedData,value:OSF.DDA.WAC.Delegate.ParameterMap.self}],isComplexType:!0}),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.EventDispId.dispidOlkRecurrenceChangedEvent,fromHost:[{name:OSF.DDA.EventDescriptors.OlkRecurrenceChangedData,value:OSF.DDA.WAC.Delegate.ParameterMap.self}],isComplexType:!0}),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,fromHost:[{name:OSF.DDA.EventDescriptors.OfficeThemeData,value:OSF.DDA.WAC.Delegate.ParameterMap.self}],isComplexType:!0}),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.EventDispId.dispidOlkAttachmentsChangedEvent,fromHost:[{name:OSF.DDA.EventDescriptors.OlkAttachmentsChangedData,value:OSF.DDA.WAC.Delegate.ParameterMap.self}],isComplexType:!0}),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.EventDispId.dispidOlkEnhancedLocationsChangedEvent,fromHost:[{name:OSF.DDA.EventDescriptors.OlkEnhancedLocationsChangedData,value:OSF.DDA.WAC.Delegate.ParameterMap.self}],isComplexType:!0}),OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.EventDispId.dispidOlkInfobarClickedEvent,fromHost:[{name:OSF.DDA.EventDescriptors.OlkInfobarClickedData,value:OSF.DDA.WAC.Delegate.ParameterMap.self}],isComplexType:!0}),OSF.DDA.AsyncMethodNames.addNames({GetAccessTokenAsync:"getAccessTokenAsync"}),OSF.DDA.Auth=function(){},OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.GetAccessTokenAsync,requiredArguments:[],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.ForceConsent,value:{types:["boolean"],defaultValue:!1}},{name:Microsoft.Office.WebExtension.Parameters.ForceAddAccount,value:{types:["boolean"],defaultValue:!1}},{name:Microsoft.Office.WebExtension.Parameters.AuthChallenge,value:{types:["string"],defaultValue:""}},{name:Microsoft.Office.WebExtension.Parameters.AllowConsentPrompt,value:{types:["boolean"],defaultValue:!1}},{name:Microsoft.Office.WebExtension.Parameters.ForMSGraphAccess,value:{types:["boolean"],defaultValue:!1}},{name:Microsoft.Office.WebExtension.Parameters.AllowSignInPrompt,value:{types:["boolean"],defaultValue:!1}}],onSucceeded:function(e){return e[Microsoft.Office.WebExtension.Parameters.Data]}}),OSF.OUtil.setNamespace("Marshaling",OSF.DDA),OSF.OUtil.setNamespace("SingleSignOn",OSF.DDA.Marshaling),OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys={ForceConsent:"forceConsent",ForceAddAccount:"forceAddAccount",AuthChallenge:"authChallenge",AllowConsentPrompt:"allowConsentPrompt",ForMSGraphAccess:"forMSGraphAccess",AllowSignInPrompt:"allowSignInPrompt"},OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys={AccessToken:"accessToken"},OSF.DDA.WAC.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,toHost:[{name:Microsoft.Office.WebExtension.Parameters.ForceConsent,value:OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForceConsent},{name:Microsoft.Office.WebExtension.Parameters.ForceAddAccount,value:OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForceAddAccount},{name:Microsoft.Office.WebExtension.Parameters.AuthChallenge,value:OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge},{name:Microsoft.Office.WebExtension.Parameters.AllowConsentPrompt,value:OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt},{name:Microsoft.Office.WebExtension.Parameters.ForMSGraphAccess,value:OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.forMSGraphAccess},{name:Microsoft.Office.WebExtension.Parameters.AllowSignInPrompt,value:OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt}],fromHost:[{name:Microsoft.Office.WebExtension.Parameters.Data,value:OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken}]}),window.OfficeRuntime=window.OfficeRuntime||{},window.OfficeRuntime.auth={getAccessToken:function(e){return new window.Promise(function(t,n){try{window.Office.context.auth.getAccessTokenAsync(e||{},function(e){"succeeded"===e.status?t(e.value):n(e.error)})}catch(e){e&&e.message?n(e.message):n(e)}})}},OSF.InitializationHelper.prototype.prepareRightBeforeWebExtensionInitialize=function(){OSF.WebApp._UpdateLinksForHostAndXdmInfo()},OSF.InitializationHelper.prototype.prepareRightAfterWebExtensionInitialize=function(){OfficeExt.AppCommand.AppCommandManager.instance().initializeAndChangeOnce()},OSF.InitializationHelper.prototype.getInitializationReason=function(e){return e.get_reason()};var executeAsyncBase=OSF.DDA.WAC.Delegate.executeAsync;OSF.DDA.WAC.Delegate.executeAsync=function(e){var t=e.onCalling;e.onCalling=function(){e.hostCallArgs=OSF.DDA.OutlookAppOm.addAdditionalArgs(e.dispId,e.hostCallArgs),t&&t()},executeAsyncBase(e)},OSF.InitializationHelper.prototype.prepareApiSurface=function(e){var t=new OSF.DDA.License(e.get_eToken());e.get_appName()==OSF.AppName.OutlookWebApp?(OSF.WebApp._UpdateLinksForHostAndXdmInfo(),this.initWebDialog(e),this.initWebAuth(e),OSF._OfficeAppFactory.setContext(new OSF.DDA.OutlookContext(e,this._settings,t,e.appOM)),OSF._OfficeAppFactory.setHostFacade(new OSF.DDA.DispIdHost.Facade(OSF.DDA.WAC.getDelegateMethods,OSF.DDA.WAC.Delegate.ParameterMap))):(OfficeJsClient_OutlookWin32.prepareApiSurface(e),OSF._OfficeAppFactory.setContext(new OSF.DDA.OutlookContext(e,this._settings,t,e.appOM,OSF.DDA.OfficeTheme?OSF.DDA.OfficeTheme.getOfficeTheme:null,e.ui)),OSF._OfficeAppFactory.setHostFacade(new OSF.DDA.DispIdHost.Facade(OSF.DDA.DispIdHost.getClientDelegateMethods,OSF.DDA.SafeArray.Delegate.ParameterMap)))},OSF.DDA.SettingsManager={SerializedSettings:"serializedSettings",DateJSONPrefix:"Date(",DataJSONSuffix:")",serializeSettings:function(e){var t={};for(var n in e){var o=e[n];try{o=JSON?JSON.stringify(o,function(e,t){return OSF.OUtil.isDate(this[e])?OSF.DDA.SettingsManager.DateJSONPrefix+this[e].getTime()+OSF.DDA.SettingsManager.DataJSONSuffix:t}):Sys.Serialization.JavaScriptSerializer.serialize(o),t[n]=o}catch(e){}}return t},deserializeSettings:function(e){var t={};for(var n in e=e||{}){var o=e[n];try{o=JSON?JSON.parse(o,function(e,t){var n;return"string"==typeof t&&t&&t.length>6&&t.slice(0,5)===OSF.DDA.SettingsManager.DateJSONPrefix&&t.slice(-1)===OSF.DDA.SettingsManager.DataJSONSuffix&&(n=new Date(parseInt(t.slice(5,-1))))?n:t}):Sys.Serialization.JavaScriptSerializer.deserialize(o,!0),t[n]=o}catch(e){}}return t}},OSF.InitializationHelper.prototype.loadAppSpecificScriptAndCreateOM=function(e,t,n){var o="object"==typeof o?o:{};o.OutlookAppOm=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=2)}([function(e,t){e.exports=OSF},function(e,t){e.exports=Microsoft},function(e,t,n){"use strict";function o(e){return null==e}n.r(t);var r,i="office_strings.js",a="office_strings.debug.js",s="outlook_strings.js",c=window;function d(e){return r[e]}var l,u="",f="",p=null,m=!1;function g(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t}function S(){m=!0,o(l)||!o(p.readyState)&&(o(p.readyState)||"loaded"!==p.readyState&&"complete"!==p.readyState)||(p.onload=null,p.onreadystatechange=null,void 0!==c._u&&(r=c._u.ExtensibilityStrings),l())}function v(){if(!m){var e=document.getElementsByTagName("head")[0],t=f+"en-us/"+s;p.onload=null,p.onreadystatechange=null,(p=g(t)).onload=S,p.onreadystatechange=S,e.appendChild(p)}}function O(e,t,n){var o=n.substring(0,t),r=o.lastIndexOf("/",o.length-2);return-1===r&&(r=o.lastIndexOf("\\",o.length-2)),-1!==r&&o.length>r+1&&(e=o.substring(0,r+1)),e}var A;!function(e){e[e.noError=0]="noError",e[e.errorInRequest=-1]="errorInRequest",e[e.errorHandlingRequest=-2]="errorHandlingRequest",e[e.errorInResponse=-3]="errorInResponse",e[e.errorHandlingResponse=-4]="errorHandlingResponse",e[e.errorHandlingRequestAccessDenied=-5]="errorHandlingRequestAccessDenied",e[e.errorHandlingMethodCallTimedout=-6]="errorHandlingMethodCallTimedout"}(A||(A={}));var D=n(0),h=!1;function y(e){return h||(E(9e3,"AttachmentSizeExceeded",d("l_AttachmentExceededSize_Text")),E(9001,"NumberOfAttachmentsExceeded",d("l_ExceededMaxNumberOfAttachments_Text")),E(9002,"InternalFormatError",d("l_InternalFormatError_Text")),E(9003,"InvalidAttachmentId",d("l_InvalidAttachmentId_Text")),E(9004,"InvalidAttachmentPath",d("l_InvalidAttachmentPath_Text")),E(9005,"CannotAddAttachmentBeforeUpgrade",d("l_CannotAddAttachmentBeforeUpgrade_Text")),E(9006,"AttachmentDeletedBeforeUploadCompletes",d("l_AttachmentDeletedBeforeUploadCompletes_Text")),E(9007,"AttachmentUploadGeneralFailure",d("l_AttachmentUploadGeneralFailure_Text")),E(9008,"AttachmentToDeleteDoesNotExist",d("l_DeleteAttachmentDoesNotExist_Text")),E(9009,"AttachmentDeleteGeneralFailure",d("l_AttachmentDeleteGeneralFailure_Text")),E(9010,"InvalidEndTime",d("l_InvalidEndTime_Text")),E(9011,"HtmlSanitizationFailure",d("l_HtmlSanitizationFailure_Text")),E(9012,"NumberOfRecipientsExceeded",d("l_NumberOfRecipientsExceeded_Text").replace("{0}",F)),E(9013,"NoValidRecipientsProvided",d("l_NoValidRecipientsProvided_Text")),E(9014,"CursorPositionChanged",d("l_CursorPositionChanged_Text")),E(9016,"InvalidSelection",d("l_InvalidSelection_Text")),E(9017,"AccessRestricted",""),E(9018,"GenericTokenError",""),E(9019,"GenericSettingsError",""),E(9020,"GenericResponseError",""),E(9021,"SaveError",d("l_SaveError_Text")),E(9022,"MessageInDifferentStoreError",d("l_MessageInDifferentStoreError_Text")),E(9023,"DuplicateNotificationKey",d("l_DuplicateNotificationKey_Text")),E(9024,"NotificationKeyNotFound",d("l_NotificationKeyNotFound_Text")),E(9025,"NumberOfNotificationsExceeded",d("l_NumberOfNotificationsExceeded_Text")),E(9026,"PersistedNotificationArrayReadError",d("l_PersistedNotificationArrayReadError_Text")),E(9027,"PersistedNotificationArraySaveError",d("l_PersistedNotificationArraySaveError_Text")),E(9028,"CannotPersistPropertyInUnsavedDraftError",d("l_CannotPersistPropertyInUnsavedDraftError_Text")),E(9029,"CanOnlyGetTokenForSavedItem",d("l_CallSaveAsyncBeforeToken_Text")),E(9030,"APICallFailedDueToItemChange",d("l_APICallFailedDueToItemChange_Text")),E(9031,"InvalidParameterValueError",d("l_InvalidParameterValueError_Text")),E(9033,"SetRecurrenceOnInstanceError",d("l_Recurrence_Error_Instance_SetAsync_Text")),E(9034,"InvalidRecurrenceError",d("l_Recurrence_Error_Properties_Invalid_Text")),E(9035,"RecurrenceZeroOccurrences",d("l_RecurrenceErrorZeroOccurrences_Text")),E(9036,"RecurrenceMaxOccurrences",d("l_RecurrenceErrorMaxOccurrences_Text")),E(9037,"RecurrenceInvalidTimeZone",d("l_RecurrenceInvalidTimeZone_Text")),E(9038,"InsufficientItemPermissionsError",d("l_Insufficient_Item_Permissions_Text")),E(9039,"RecurrenceUnsupportedAlternateCalendar",d("l_RecurrenceUnsupportedAlternateCalendar_Text")),E(9040,"HTTPRequestFailure",d("l_Olk_Http_Error_Text")),E(9041,"NetworkError",d("l_Internet_Not_Connected_Error_Text")),E(9042,"InternalServerError",d("l_Internal_Server_Error_Text")),E(9043,"AttachmentTypeNotSupported",d("l_AttachmentNotSupported_Text")),E(9044,"InvalidCategory",d("l_Invalid_Category_Error_Text")),E(9045,"DuplicateCategory",d("l_Duplicate_Category_Error_Text")),E(9046,"ItemNotSaved",d("l_Item_Not_Saved_Error_Text")),h=!0),D.DDA.ErrorCodeManager.getErrorArgs(e)}var C,F=500;function E(e,t,n){D.DDA.ErrorCodeManager.addErrorMessage(e,{name:t,message:n})}var M=function(){return C},b=function(e){return(C=new T).parameterBlobSupported=!0,C},T=function(){function e(){this._parameterBlobSupported=!0,this._itemNumber=0,C=this}return Object.defineProperty(e.prototype,"parameterBlobSupported",{set:function(e){this._parameterBlobSupported=e},enumerable:!0,configurable:!0}),e.prototype.setActionsDefinition=function(e){this._actionsDefinition=e},e.prototype.setCurrentItemNumber=function(e){e>0&&(this._itemNumber=e)},Object.defineProperty(e.prototype,"itemNumber",{get:function(){return this._itemNumber},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actionsDefinition",{get:function(){return this._actionsDefinition},enumerable:!0,configurable:!0}),e.prototype.updateOutlookExecuteParameters=function(e,t){if(this._parameterBlobSupported){if(this._itemNumber>0&&(t.itemNumber=this._itemNumber.toString()),null!=this._actionsDefinition&&(t.actions=this.actionsDefinition),0===Object.keys(t).length)return;null==e&&(e=new Array),e.push(JSON.stringify(t))}},e}(),_=n(0),w=function(e,t){var n=[],o={};switch(e){case 12:o.isRest=t.isRest;break;case 4:n=[JSON.stringify(t.customProperties)];break;case 5:n=new Array(t.body);break;case 8:case 9:n=new Array(t.itemId);break;case 7:n=new Array(I(t.requiredAttendees),I(t.optionalAttendees),t.start,t.end,t.location,I(t.resources),t.subject,t.body);break;case 44:n=[I(t.toRecipients),I(t.ccRecipients),I(t.bccRecipients),t.subject,t.htmlBody,t.attachments];break;case 43:n=[t.ewsIdOrEmail];break;case 45:n=[t.module,t.queryString];break;case 40:n=[t.extensionId,t.consentState];break;case 11:case 10:n=[t.htmlBody];break;case 31:case 30:n=[t.htmlBody,t.attachments];break;case 23:case 13:case 38:case 29:n=[t.data,t.coercionType];break;case 37:case 28:n=[t.coercionType];break;case 17:n=[t.subject];break;case 15:n=[t.recipientField];break;case 22:case 21:n=[t.recipientField,x(t.recipientArray)];break;case 19:n=[t.itemId,t.name];break;case 16:n=[t.uri,t.name,t.isInline];break;case 148:n=[t.base64String,t.name,t.isInline];break;case 20:n=[t.attachmentIndex];break;case 25:n=[t.TimeProperty,t.time];break;case 24:n=[t.TimeProperty];break;case 27:n=[t.location];break;case 33:case 35:n=[t.key,t.type,t.persistent,t.message,t.icon],M().setActionsDefinition(t.actions);break;case 36:n=[t.key];break;default:o=t||{}}return 1!==e&&M().updateOutlookExecuteParameters(n,o),n},I=function(e){return null!=e?e.join(";"):""},x=function(e){var t=[];if(null==e)return t;for(var n=0;n<e.length;n++){var o=[e[n].address,e[n].name];t.push(o)}return t},P=function(e){var t=0;if(e.length>2){var n=JSON.parse(e[2]);n&&"object"==typeof n&&(t=n.itemNumber)}return t},N=function(e,t){var n=null,o=JSON.parse(e[0]);if("number"==typeof o)n=R(e,t);else{if(!o||"object"!=typeof o)throw new Error("Return data type from host must be Object or Number");n=k(e,t)}return n},k=function(e,t){var n=JSON.parse(e[0]);if(t)n.error=!0,n.errorCode=9030;else if(e.length>1&&0!==e[1]){if(n.error=!0,n.errorCode=e[1],e.length>2){var o=JSON.parse(e[2]);n.diagnostics=o.Diagnostics}}else n.error=!1;return n},R=function(e,t){var n={error:!0};return n.errorCode=e[0],n},W=n(0);function L(e,t,n,o,r,i){j(e,o,function(e,o){if(n){var a=void 0,s=!0;if("object"==typeof o&&null!==o){if(void 0!==o.wasSuccessful&&(s=o.wasSuccessful),void 0!==o.error||void 0!==o.errorCode||void 0!==o.data)if(o.error){var c=o.errorCode;a=H(void 0,W.DDA.AsyncResultEnum.ErrorCode.Failed,c,t)}else{a=H(r?r(o.data):o.data,W.DDA.AsyncResultEnum.ErrorCode.Success,0,t)}i&&(a=i(o,t,e)),a||e===A.noError||(a=H(void 0,W.DDA.AsyncResultEnum.ErrorCode.Failed,W.DDA.ErrorCodes.InternalFormatError,t)),a||e!==A.noError||!1!==s||(a=H(void 0,W.DDA.AsyncResultEnum.ErrorCode.Failed,W.DDA.ErrorCodes.OoeOperationNotSupported,t)),n(a)}}})}function H(e,t,n,o,r){var i,a={};if(a[W.DDA.AsyncResultEnum.Properties.Value]=e,a[W.DDA.AsyncResultEnum.Properties.Context]=o,W.DDA.AsyncResultEnum.ErrorCode.Success!==t){i={};var s=y(n);i[W.DDA.AsyncResultEnum.ErrorProperties.Name]=s.name,i[W.DDA.AsyncResultEnum.ErrorProperties.Message]=r||s.message,i[W.DDA.AsyncResultEnum.ErrorProperties.Code]=n}return new W.DDA.AsyncResult(a,i)}var U,j=function(e,t,n){var o=performance&&performance.now(),r=function(t,r){if(W.AppTelemetry){var i=function(e,t){return e}(t),a=performance.now();W.AppTelemetry.onMethodDone(e,null,a-o,i)}n&&n(t,r)};if(W.AppName.OutlookWebApp===Jr()){var i={ApiParams:t,MethodData:{ControlId:W._OfficeAppFactory.getId(),DispatchId:e}};1===e?W._OfficeAppFactory.getClientEndPoint().invoke("GetInitialData",r,i):W._OfficeAppFactory.getClientEndPoint().invoke("ExecuteMethod",r,i)}else!function(e){switch(e){case 402:case 401:case 400:case 403:return!0;default:return!1}}(e)?function(e,t,n){var o=w(e,t);_.ClientHostController.execute(e,o,function(e,t){var o=null,r=e.toArray();if(r.length>0){var i=P(r),a=i>0&&i>M().itemNumber;o=N(r,a)}null!=n&&n(t,o)})}(e,t,n):n(A.errorHandlingRequest,null)},B=function(){return Kr("permissionLevel")};function z(e,t){var n=new Error(e);if(n.message=e||"",t)for(var o in t)n[o]=t[o];return n}function V(e,t){var n="Sys.ArgumentException: "+(t||"Value does not fall within the expected range.");return e&&(n+="\n"+"Parameter name: {0}".replace("{0}",e)),z(n,{name:"Sys.ArgumentException",paramName:e})}function G(e,t){var n="Sys.ArgumentNullException: "+(t||"Value cannot be null.");return e&&(n+="\n"+"Parameter name: {0}".replace("{0}",e)),z(n,{name:"Sys.ArgumentNullException",paramName:e})}function q(e,t,n){var o="Sys.ArgumentOutOfRangeException: "+(n||"Specified argument was out of the range of valid values.");return e&&(o+="\n"+"Parameter name: {0}".replace("{0}",e)),null!=t&&(o+="\n"+"Actual value was {0}.".replace("{0}",t)),z(o,{name:"Sys.ArgumentOutOfRangeException",paramName:e,actualValue:t})}function K(e,t,n,o){var r="Sys.ArgumentTypeException: ";return r+=o||(t&&n?"Object of type '{0}' cannot be converted to type '{1}'.".replace("{0}",t.getName?t.getName():t).replace("{1}",n.getName?n.getName():n):"Object cannot be converted to the required type."),e&&(r+="\n"+"Parameter name: {0}".replace("{0}",e)),z(r,{name:"Sys.ArgumentTypeException",paramName:e,actualType:t,expectedType:n})}function J(e,t){B()<e&&z(d("l_ElevatedPermissionNeededForMethod_Text").replace("{0}",t))}function X(e,t,n){var o={};if(n&&(o=function(e){var t={};if(1===e.length||2===e.length)return"function"!=typeof e[0]?t:(t.callback=e[0],2===e.length&&(t.asyncContext=e[1]),t);return t}(e)).callback)return o;if(1===e.length)if("function"==typeof e[0])o.callback=e[0];else{if("object"!=typeof e[0])throw K();o.options=e[0]}else if(2===e.length){if("object"!=typeof e[0])throw V("options");if("function"!=typeof e[1])throw V("callback");o.callback=e[1],o.options=e[0]}else if(0!==e.length)throw z("Sys.ParameterCountException: "+(d("l_ParametersNotAsExpected_Text")||"Parameter count mismatch."),{name:"Sys.ParameterCountException"});if(t&&!o.callback)throw G("callback");return o.options&&o.options.asyncContext&&(o.asyncContext=o.options.asyncContext),o}!function(e){e[e.to=0]="to",e[e.cc=1]="cc",e[e.bcc=2]="bcc",e[e.requiredAttendees=0]="requiredAttendees",e[e.optionalAttendees=1]="optionalAttendees"}(U||(U={}));var Y=255,Z=100,$=571,Q=255,ee=32768,te=255,ne=100,oe=255,re=2048,ie=200,ae=200;function se(e,t,n,o){if(e<t||e>n)throw q(String(o))}var ce={EntityType:{MeetingSuggestion:"meetingSuggestion",TaskSuggestion:"taskSuggestion",Address:"address",EmailAddress:"emailAddress",Url:"url",PhoneNumber:"phoneNumber",Contact:"contact",FlightReservations:"flightReservations",ParcelDeliveries:"parcelDeliveries"},ItemType:{Message:"message",Appointment:"appointment"},ResponseType:{None:"none",Organizer:"organizer",Tentative:"tentative",Accepted:"accepted",Declined:"declined"},RecipientType:{Other:"other",DistributionList:"distributionList",User:"user",ExternalUser:"externalUser"},AttachmentType:{File:"file",Item:"item",Cloud:"cloud"},AttachmentStatus:{Added:"added",Removed:"removed"},AttachmentContentFormat:{Base64:"base64",Url:"url",Eml:"eml",ICalendar:"iCalendar"},BodyType:{Text:"text",Html:"html"},ItemNotificationMessageType:{ProgressIndicator:"progressIndicator",InformationalMessage:"informationalMessage",ErrorMessage:"errorMessage",InsightMessage:"insightMessage"},Folder:{Inbox:"inbox",Junk:"junk",DeletedItems:"deletedItems"}},de={Text:"text",Html:"html"};function le(e){if(null==e)throw G(e);if(e!==ce.RestVersion.v1_0&&e!==ce.RestVersion.v2_0&&e!==ce.RestVersion.Beta)throw V(e)}function ue(e,t){if(null==e)throw G(e);return le(t),e.replace(new RegExp("[/]","g"),"-").replace(new RegExp("[+]","g"),"_")}function fe(e,t){if(null==e)throw G(e);return le(t),e.replace(new RegExp("[-]","g"),"/").replace(new RegExp("[_]","g"),"+")}function pe(e,t){if(!Array.isArray(e))throw K("name");se(e.length,0,ne,"{0}.length".replace("{0}",t))}function me(e,t){for(var n=e,o=[],r=0;r<n.length;r++)if("object"==typeof n[r]){if(ge(n[r]),o[r]=n[r].emailAddress,"string"!=typeof o[r])throw V("{0}[{1}]".replace(t,String(r)))}else{if("string"!=typeof n[r])throw V("{0}[{1}]".replace(t,String(r)));o[r]=n[r]}return o}function ge(e){if(!o(e.displayName)&&"string"==typeof e.displayName&&e.displayName.length>Y)throw q("displayName");if(!o(e.emailAddress)&&"string"==typeof e.emailAddress&&e.emailAddress.length>$)throw q("emailAddress");if(!o(e.appointmentResponse)&&"string"==typeof e.appointmentResponse)throw q("appointmentResponse");if(!o(e.recipientType)&&"string"==typeof e.recipientType)throw q("recipientType");throw V("originalAttendee")}function Se(e){if("string"!=typeof e)throw K("itemId");!function(e){if(o(e)||""===e)throw G("itemId")}(e)}function ve(e){return Kr("isRestIdSupported")?ue(e,ce.RestVersion.v1_0):fe(e,ce.RestVersion.v1_0)}function Oe(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(1,"mailbox.displayAppointmentForm");var o=X(t,!1,!1),r={itemId:e};!function(e){Se(e.itemId)}(r),L(9,o.asyncContext,o.callback,{itemId:ve(r.itemId)},void 0)}function Ae(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(1,"mailbox.displayMessageForm");var o=X(t,!1,!1),r={itemId:e};!function(e){Se(e.itemId)}(r),L(8,o.asyncContext,o.callback,{itemId:ve(r.itemId)},void 0)}function De(e,t,n,o){if("string"!=typeof e)throw V(String(o));se(e.length,t,n,o)}function he(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(1,"mailbox.displayNewAppointmentForm");var r=X(t,!1,!1);!function(e){o(e.requiredAttendees)||pe(e.requiredAttendees,"requiredAttendees");o(e.optionalAttendees)||pe(e.optionalAttendees,"optionalAttendees");o(e.location)||De(e.location,0,Q,"location");o(e.body)||De(e.body,0,ee,"body");o(e.subject)||De(e.subject,0,te,"subject");if(!o(e.start)){if(!(e.start instanceof Date))throw V("start");if(!o(e.end)){if(!(e.end instanceof Date))throw V("end");if(e.end<e.start)throw V("end",d("l_InvalidEventDates_Text"))}}}(e);var i=function(e){var t=null,n=null;o(e.requiredAttendees)||(t=me(e.requiredAttendees,"requiredAttendees"));o(e.optionalAttendees)||(n=me(e.optionalAttendees,"optionalAttendees"));if(!o(e.start)){var r=e.start;e.start=r.getTime()}if(!o(e.end)){var i=e.end;e.end=i.getTime()}var a=JSON.parse(JSON.stringify(e));(t||n)&&(o(e.requiredAttendees)||(a.requiredAttendees=t),o(e.optionalAttendees)||(a.optionalAttendees=n));return a}(e);L(7,r.asyncContext,r.callback,i,void 0)}function ye(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(1,"mailbox.displayNewMessageForm");var r=X(t,!1,!1);!function(e){null!==e&&null!==e&&(o(e.toRecipients)||pe(e.toRecipients,"toRecipients"),o(e.ccRecipients)||pe(e.ccRecipients,"ccRecipients"),o(e.bccRecipients)||pe(e.bccRecipients,"bccRecipients"),o(e.htmlBody)||De(e.htmlBody,0,ee,"htmlBody"),o(e.subject)||De(e.subject,0,te,"subject"))}(e);var i=function(e){var t=JSON.parse(JSON.stringify(e));if(!o(e)){e.toRecipients&&(t.toRecipients=me(e.toRecipients,"toRecipients")),e.ccRecipients&&(t.ccRecipients=me(e.ccRecipients,"ccRecipients")),e.bccRecipients&&(t.bccRecipients=me(e.bccRecipients,"bccRecipients"));var n=function(e){var t=[];e.attachments&&Ce(t=e.attachments);return t}(e);e.attachments&&(t.attachments=Fe(n))}return t}(e);L(44,r.asyncContext,r.callback,null==i?e:i,void 0)}function Ce(e){if(!o(e)&&!Array.isArray(e))throw V("attachments")}function Fe(e){for(var t=[],n=0;n<e.length;n++){if("object"!=typeof e[n])throw V("attachments");var o=e[n];Ee(o),t.push(Me(o))}return t}function Ee(e){if("object"!=typeof e)throw V("attachments");if(!e.type||!e.name)throw V("attachments");if(!e.url&&!e.itemId)throw V("attachments")}function Me(e){var t=null;if(e.type===ce.AttachmentType.File){var n=e.url,o=e.name,r=!!e.isInline;!function(e,t){if("string"!=typeof e&&"string"!=typeof t)throw V("attachments");if(e.length>re)throw q("attachments",e.length,d("l_AttachmentUrlTooLong_Text"));be(t)}(n,o),t=[ce.AttachmentType.File,o,n,r]}else{if(e.type!==ce.AttachmentType.Item)throw V("attachments");var i=ve(e.itemId),a=e.name;!function(e,t){if("string"!=typeof e||"string"!=typeof t)throw V("attachments");if(e.length>ie)throw q("attachments",e.length,d("l_AttachmentItemIdTooLong_Text"));be(t)}(i,a),t=[ce.AttachmentType.Item,a,i]}return t}function be(e){if(e.length>oe)throw q("attachments",e.length,d("l_AttachmentNameTooLong_Text"))}ce.UserProfileType={Office365:"office365",OutlookCom:"outlookCom",Enterprise:"enterprise"},ce.RestVersion={v1_0:"v1.0",v2_0:"v2.0",Beta:"beta"},ce.ModuleType={Addins:"addins"},ce.ActionType={ShowTaskPane:"showTaskPane"},ce.Days={Mon:"mon",Tue:"tue",Wed:"wed",Thu:"thu",Fri:"fri",Sat:"sat",Sun:"sun",Weekday:"weekday",WeekendDay:"weekendDay",Day:"day"},ce.WeekNumber={First:"first",Second:"second",Third:"third",Fourth:"fourth",Last:"last"},ce.RecurrenceType={Daily:"daily",Weekday:"weekday",Weekly:"weekly",Monthly:"monthly",Yearly:"yearly"},ce.Month={Jan:"jan",Feb:"feb",Mar:"mar",Apr:"apr",May:"may",Jun:"jun",Jul:"jul",Aug:"aug",Sep:"sep",Oct:"oct",Nov:"nov",Dec:"dec"},ce.DelegatePermissions={Read:1,Write:2,DeleteOwn:4,DeleteAll:8,EditOwn:16,EditAll:32},ce.TimeZone={AfghanistanStandardTime:"Afghanistan Standard Time",AlaskanStandardTime:"Alaskan Standard Time",AleutianStandardTime:"Aleutian Standard Time",AltaiStandardTime:"Altai Standard Time",ArabStandardTime:"Arab Standard Time",ArabianStandardTime:"Arabian Standard Time",ArabicStandardTime:"Arabic Standard Time",ArgentinaStandardTime:"Argentina Standard Time",AstrakhanStandardTime:"Astrakhan Standard Time",AtlanticStandardTime:"Atlantic Standard Time",AUSCentralStandardTime:"AUS Central Standard Time",AusCentralWStandardTime:"Aus Central W. Standard Time",AUSEasternStandardTime:"AUS Eastern Standard Time",AzerbaijanStandardTime:"Azerbaijan Standard Time",AzoresStandardTime:"Azores Standard Time",BahiaStandardTime:"Bahia Standard Time",BangladeshStandardTime:"Bangladesh Standard Time",BelarusStandardTime:"Belarus Standard Time",BougainvilleStandardTime:"Bougainville Standard Time",CanadaCentralStandardTime:"Canada Central Standard Time",CapeVerdeStandardTime:"Cape Verde Standard Time",CaucasusStandardTime:"Caucasus Standard Time",CenAustraliaStandardTime:"Cen. Australia Standard Time",CentralAmericaStandardTime:"Central America Standard Time",CentralAsiaStandardTime:"Central Asia Standard Time",CentralBrazilianStandardTime:"Central Brazilian Standard Time",CentralEuropeStandardTime:"Central Europe Standard Time",CentralEuropeanStandardTime:"Central European Standard Time",CentralPacificStandardTime:"Central Pacific Standard Time",CentralStandardTime:"Central Standard Time",CentralStandardTime_Mexico:"Central Standard Time (Mexico)",ChathamIslandsStandardTime:"Chatham Islands Standard Time",ChinaStandardTime:"China Standard Time",CubaStandardTime:"Cuba Standard Time",DatelineStandardTime:"Dateline Standard Time",EAfricaStandardTime:"E. Africa Standard Time",EAustraliaStandardTime:"E. Australia Standard Time",EEuropeStandardTime:"E. Europe Standard Time",ESouthAmericaStandardTime:"E. South America Standard Time",EasterIslandStandardTime:"Easter Island Standard Time",EasternStandardTime:"Eastern Standard Time",EasternStandardTime_Mexico:"Eastern Standard Time (Mexico)",EgyptStandardTime:"Egypt Standard Time",EkaterinburgStandardTime:"Ekaterinburg Standard Time",FijiStandardTime:"Fiji Standard Time",FLEStandardTime:"FLE Standard Time",GeorgianStandardTime:"Georgian Standard Time",GMTStandardTime:"GMT Standard Time",GreenlandStandardTime:"Greenland Standard Time",GreenwichStandardTime:"Greenwich Standard Time",GTBStandardTime:"GTB Standard Time",HaitiStandardTime:"Haiti Standard Time",HawaiianStandardTime:"Hawaiian Standard Time",IndiaStandardTime:"India Standard Time",IranStandardTime:"Iran Standard Time",IsraelStandardTime:"Israel Standard Time",JordanStandardTime:"Jordan Standard Time",KaliningradStandardTime:"Kaliningrad Standard Time",KamchatkaStandardTime:"Kamchatka Standard Time",KoreaStandardTime:"Korea Standard Time",LibyaStandardTime:"Libya Standard Time",LineIslandsStandardTime:"Line Islands Standard Time",LordHoweStandardTime:"Lord Howe Standard Time",MagadanStandardTime:"Magadan Standard Time",MagallanesStandardTime:"Magallanes Standard Time",MarquesasStandardTime:"Marquesas Standard Time",MauritiusStandardTime:"Mauritius Standard Time",MidAtlanticStandardTime:"Mid-Atlantic Standard Time",MiddleEastStandardTime:"Middle East Standard Time",MontevideoStandardTime:"Montevideo Standard Time",MoroccoStandardTime:"Morocco Standard Time",MountainStandardTime:"Mountain Standard Time",MountainStandardTime_Mexico:"Mountain Standard Time (Mexico)",MyanmarStandardTime:"Myanmar Standard Time",NCentralAsiaStandardTime:"N. Central Asia Standard Time",NamibiaStandardTime:"Namibia Standard Time",NepalStandardTime:"Nepal Standard Time",NewZealandStandardTime:"New Zealand Standard Time",NewfoundlandStandardTime:"Newfoundland Standard Time",NorfolkStandardTime:"Norfolk Standard Time",NorthAsiaEastStandardTime:"North Asia East Standard Time",NorthAsiaStandardTime:"North Asia Standard Time",NorthKoreaStandardTime:"North Korea Standard Time",OmskStandardTime:"Omsk Standard Time",PacificSAStandardTime:"Pacific SA Standard Time",PacificStandardTime:"Pacific Standard Time",PacificStandardTime_Mexico:"Pacific Standard Time (Mexico)",PakistanStandardTime:"Pakistan Standard Time",ParaguayStandardTime:"Paraguay Standard Time",RomanceStandardTime:"Romance Standard Time",RussiaTimeZone10:"Russia Time Zone 10",RussiaTimeZone11:"Russia Time Zone 11",RussiaTimeZone3:"Russia Time Zone 3",RussianStandardTime:"Russian Standard Time",SAEasternStandardTime:"SA Eastern Standard Time",SAPacificStandardTime:"SA Pacific Standard Time",SAWesternStandardTime:"SA Western Standard Time",SaintPierreStandardTime:"Saint Pierre Standard Time",SakhalinStandardTime:"Sakhalin Standard Time",SamoaStandardTime:"Samoa Standard Time",SaratovStandardTime:"Saratov Standard Time",SEAsiaStandardTime:"SE Asia Standard Time",SingaporeStandardTime:"Singapore Standard Time",SouthAfricaStandardTime:"South Africa Standard Time",SriLankaStandardTime:"Sri Lanka Standard Time",SudanStandardTime:"Sudan Standard Time",SyriaStandardTime:"Syria Standard Time",TaipeiStandardTime:"Taipei Standard Time",TasmaniaStandardTime:"Tasmania Standard Time",TocantinsStandardTime:"Tocantins Standard Time",TokyoStandardTime:"Tokyo Standard Time",TomskStandardTime:"Tomsk Standard Time",TongaStandardTime:"Tonga Standard Time",TransbaikalStandardTime:"Transbaikal Standard Time",TurkeyStandardTime:"Turkey Standard Time",TurksAndCaicosStandardTime:"Turks And Caicos Standard Time",UlaanbaatarStandardTime:"Ulaanbaatar Standard Time",USEasternStandardTime:"US Eastern Standard Time",USMountainStandardTime:"US Mountain Standard Time",UTC:"UTC",UTCPLUS12:"UTC+12",UTCPLUS13:"UTC+13",UTCMINUS02:"UTC-02",UTCMINUS08:"UTC-08",UTCMINUS09:"UTC-09",UTCMINUS11:"UTC-11",VenezuelaStandardTime:"Venezuela Standard Time",VladivostokStandardTime:"Vladivostok Standard Time",WAustraliaStandardTime:"W. Australia Standard Time",WCentralAfricaStandardTime:"W. Central Africa Standard Time",WEuropeStandardTime:"W. Europe Standard Time",WMongoliaStandardTime:"W. Mongolia Standard Time",WestAsiaStandardTime:"West Asia Standard Time",WestBankStandardTime:"West Bank Standard Time",WestPacificStandardTime:"West Pacific Standard Time",YakutskStandardTime:"Yakutsk Standard Time"},ce.LocationType={Custom:"custom",Room:"room"},ce.CategoryColor={None:"None",Preset0:"Preset0",Preset1:"Preset1",Preset2:"Preset2",Preset3:"Preset3",Preset4:"Preset4",Preset5:"Preset5",Preset6:"Preset6",Preset7:"Preset7",Preset8:"Preset8",Preset9:"Preset9",Preset10:"Preset10",Preset11:"Preset11",Preset12:"Preset12",Preset13:"Preset13",Preset14:"Preset14",Preset15:"Preset15",Preset16:"Preset16",Preset17:"Preset17",Preset18:"Preset18",Preset19:"Preset19",Preset20:"Preset20",Preset21:"Preset21",Preset22:"Preset22",Preset23:"Preset23",Preset24:"Preset24"};var Te=n(0);function _e(e,t,n){var o=void 0;return n&&n!==A.noError?o=H(void 0,Te.DDA.AsyncResultEnum.ErrorCode.Failed,9017,t,d("l_InternalProtocolError_Text").replace("{0}",n)):(o=Jr()===Te.AppName.Outlook&&void 0!==e.error&&void 0!==e.errorCode&&e.error&&9030===e.errorCode?H(void 0,Te.DDA.AsyncResultEnum.ErrorCode.Failed,e.errorCode,t,e.errorMessage):e.wasSuccessful?H(e.token,Te.DDA.AsyncResultEnum.ErrorCode.Success,0,t):H(void 0,Te.DDA.AsyncResultEnum.ErrorCode.Failed,e.errorCode,t,e.errorMessage),e.diagnostics&&(o.diagnostics=e.diagnostics)),o}function we(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"mailbox.getCallbackTokenAsync");var n=X(e,!0,!0),o=!1;n.options&&n.options.isRest&&(o=!0),L(12,n.asyncContext,n.callback,{isRest:o},void 0,_e)}function Ie(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"mailbox.getUserIdentityToken");var n=X(e,!0,!0);L(2,n.asyncContext,n.callback,void 0,void 0,_e)}var xe=n(0),Pe=1e6;function Ne(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(3,"mailbox.makeEwsRequest");var o=X(t,!0,!0);if(null==e)throw G("data");if("string"!=typeof e)throw K("data",typeof e,"string");if(e.length>Pe)throw V("data",d("l_EwsRequestOversized_Text"));L(5,o.asyncContext,o.callback,{body:e},void 0,ke)}function ke(e,t,n){return n&&n!==A.noError?H(void 0,xe.DDA.AsyncResultEnum.ErrorCode.Failed,9017,t,d("l_InternalProtocolError_Text").replace("{0}",n)):!1===e.wasProxySuccessful?H(void 0,xe.DDA.AsyncResultEnum.ErrorCode.Failed,9020,t,e.errorMessage):H(e.body,xe.DDA.AsyncResultEnum.ErrorCode.Success,0,t)}var Re=function(e,t){var n=Object.keys(t),o=n.map(function(e){return{value:t[e],writable:!1}}),r={};return n.forEach(function(e,t){r[e]=o[t]}),Object.defineProperties(e,r)},We=n(0),Le=function(){switch(Jr()){case We.AppName.Outlook:return"Outlook";case We.AppName.OutlookWebApp:return"OutlookWebApp";case We.AppName.OutlookIOSApp:return"OutlookIOS";case We.AppName.OutlookAndroidApp:return"OutlookAndroid";default:return}};var He=ce.CategoryColor,Ue=255,je=[He.None,He.Preset0,He.Preset1,He.Preset2,He.Preset3,He.Preset4,He.Preset5,He.Preset6,He.Preset7,He.Preset8,He.Preset9,He.Preset10,He.Preset11,He.Preset12,He.Preset13,He.Preset14,He.Preset15,He.Preset16,He.Preset17,He.Preset18,He.Preset19,He.Preset20,He.Preset21,He.Preset22,He.Preset23,He.Preset24];function Be(e){if(!e)throw V("categoryDetails");if(!e.color||!e.displayName)throw V("categoryDetails");if("string"!=typeof e.color)throw K("categoryDetails.color",typeof e.color,"string");if("string"!=typeof e.displayName)throw K("categoryDetails.displayName",typeof e.displayName,"string");if(e.displayName.length>Ue)throw q("categoryDetails.displayName",e.displayName.length);if(-1===je.indexOf(e.color))throw V("categoryDetails.color")}function ze(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(3,"masterCategories.addAsync");var o=X(t,!1,!1),r={categoryDetails:e};!function(e){if(!e)throw V("categoryDetails");if(!Array.isArray(e))throw K("categoryDetails",typeof e,typeof[]);if(0===e.length)throw V("categoryDetails");e.forEach(Be)}(e),L(161,o.asyncContext,o.callback,r,void 0)}function Ve(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(3,"masterCategories.getAsync");var n=X(e,!0,!1);L(160,n.asyncContext,n.callback,void 0,void 0)}function Ge(e){if(!e)throw V("categories");if(!Array.isArray(e))throw K("categories",typeof e,typeof Array);if(0===e.length)throw V("categories");e.forEach(qe)}function qe(e){if(!e)throw V("categories");if("string"!=typeof e)throw K("categories",typeof e,"string");if(e.length>Ue)throw q("categories",e.length)}function Ke(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(3,"masterCategories.removeAsync");var o=X(t,!1,!1),r={categories:e};Ge(e),L(162,o.asyncContext,o.callback,r,void 0)}function Je(){L(42,void 0,void 0,void 0,void 0)}var Xe,Ye=function(){return Kr("itemType")};function Ze(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"item.getInitializationContext");var n=X(e,!0,!1);L(99,n.asyncContext,n.callback,void 0,void 0)}!function(e){e[e.Message=1]="Message",e[e.Appointment=2]="Appointment",e[e.MeetingRequest=3]="MeetingRequest",e[e.MessageCompose=4]="MessageCompose",e[e.AppointmentCompose=5]="AppointmentCompose",e[e.ItemLess=6]="ItemLess"}(Xe||(Xe={}));var $e,Qe=2500;function et(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"item.saveCustomProperties");var o=X(t,!1,!0);!function(e){if(JSON.stringify(e).length>Qe)throw q("customProperties")}(e),L(4,o.asyncContext,o.callback,{customProperties:e},void 0)}!function(e){e[e.NonTransmittable=0]="NonTransmittable"}($e||($e={}));var tt=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o},nt=function(){function e(e){if(o(e)&&G("data"),Array.isArray(e)){var t=e;if(!(t.length>$e.NonTransmittable))throw V("data");e=t[$e.NonTransmittable]}else this.rawData=e}return e.prototype.get=function(e){var t=this.rawData[e];if("string"==typeof t){var n=t;if(n.length>"Date(".length+")".length&&n.startsWith("Date(")&&n.endsWith(")")){var r=n.substring("Date(".length,n.length-1),i=parseInt(r);if(!isNaN(i)){var a=new Date(i);o(a)||(t=a)}}}return t},e.prototype.set=function(e,t){t instanceof Date&&(t="Date("+t.getTime()+")"),this.rawData[e]=t},e.prototype.remove=function(e){delete this.rawData[e]},e.prototype.saveAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];et.apply(void 0,tt([this.rawData],e))},e}(),ot=n(0);function rt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=X(e,!0,!0);L(3,n.asyncContext,n.callback,void 0,void 0,it)}function it(e,t,n){if(void 0!==n&&n!==A.noError)return H(void 0,ot.DDA.AsyncResultEnum.ErrorCode.Failed,9017,t,d("l_InternalProtocolError_Text").replace("{0}",n));if(e.wasSuccessful){var o=JSON.parse(e.customProperties);return H(new nt(o),ot.DDA.AsyncResultEnum.ErrorCode.Success,0,t)}return H(void 0,ot.DDA.AsyncResultEnum.ErrorCode.Failed,9020,t,e.errorMessage)}var at,st=n(0);function ct(e,t){t.options&&"string"==typeof t.options.coercionType?e.coercionType=dt(t.options.coercionType):e.coercionType=at.Text}function dt(e){return e===de.Html?at.Html:e===de.Text?at.Text:void 0}function lt(e){e.callback&&e.callback(H(void 0,st.DDA.AsyncResultEnum.ErrorCode.Failed,1e3,e.asyncContext))}function ut(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(1,"body.getAsync");var o=X(t,!0,!1),r={coercionType:dt(e)};if(void 0===r.coercionType)throw V("coercionType");L(37,o.asyncContext,o.callback,r,void 0)}function ft(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"body.getTypeAsync");var n=X(e,!0,!1);L(14,n.asyncContext,n.callback,void 0,void 0)}!function(e){e[e.Text=0]="Text",e[e.Html=3]="Html"}(at||(at={}));var pt,mt=1e6,gt=5e3;function St(e){if("string"!=typeof e.data)throw K("data",typeof e.data,"string");if(e.data.length>mt)throw q("data",e.data.length)}function vt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"body.setAsync");var o=X(t,!1,!1),r={data:e};St(r),ct(r,o),void 0!==r.coercionType?L(38,o.asyncContext,o.callback,r,void 0):lt(o)}function Ot(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"body.prependAsync");var o=X(t,!1,!1),r={data:e};St(r),ct(r,o),void 0!==r.coercionType?L(23,o.asyncContext,o.callback,r,void 0):lt(o)}function At(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"body.appendOnSendAsync");var o=X(t,!1,!1),r={appendTxt:e};if(function(e){if("string"!=typeof e.appendTxt)throw K("data",typeof e.data,"string");if(e.appendTxt.length>gt)throw q("data",e.appendTxt.length)}(r),r.data&&r.data.length>gt)throw q("data",e.length);ct(r,o),void 0!==r.coercionType?L(100,o.asyncContext,o.callback,r,void 0):lt(o)}function Dt(e){return function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];J(2,"body.setSelectedDataAsync");var r=X(n,!1,!1),i={data:t};St(i),ct(i,r),void 0!==i.coercionType?L(e,r.asyncContext,r.callback,i,void 0):lt(r)}}function ht(e){var t=Re({},{getAsync:ut});return e&&Re(t,{appendOnSendAsync:At,getTypeAsync:ft,prependAsync:Ot,setAsync:vt,setSelectedDataAsync:Dt(13)}),t}function yt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"item.getAllInternetHeadersAsync");var n=X(e,!0,!1);L(168,n.asyncContext,n.callback,void 0,void 0)}function Ct(e,t){if(o(t)||""===t)throw G(e);if("string"!=typeof t)throw K(e,typeof t,"string")}!function(e){e[e.informationalMessage=0]="informationalMessage",e[e.progressIndicator=1]="progressIndicator",e[e.errorMessage=2]="errorMessage",e[e.insightMessage=3]="insightMessage"}(pt||(pt={}));var Ft=32,Et=32,Mt=150,bt=30,Tt="key",_t="type",wt="icon",It="message",xt="persistent",Pt="actions",Nt="actionType",kt="actionText",Rt="commandId",Wt="showTaskPane";function Lt(e){if(Ct(Tt,e),e.length>Ft)throw q(Tt,e.length)}function Ht(e){if(Ct(_t,e.type),e.type===ce.ItemNotificationMessageType.InformationalMessage){if(Ct(wt,e.icon),e.icon.length>Et)throw q(wt,e.icon.length);if(o(e.persistent))throw G(xt);if("boolean"!=typeof e.persistent)throw K(xt,typeof e.persistent,"boolean");if(!o(e.actions))throw V(Pt,d("l_ActionsDefinitionWrongNotificationMessageError_Text"))}else if(e.type===ce.ItemNotificationMessageType.InsightMessage){if(Ct(wt,e.icon),e.icon.length>Et)throw q(wt,e.icon.length);if(!o(e.persistent))throw G(xt);o(e.actions)||function(e){var t=function(e){var t=null;if(!Array.isArray(e))throw V(Pt);if(1===e.length)t=e[0];else if(e.length>1)throw V(Pt,d("l_ActionsDefinitionMultipleActionsError_Text"));return t}(e);if(o(t))return;(function(e){if(o(e.actionType))throw G(Nt);if(Wt!==e.actionType)throw V(Nt,d("l_InvalidActionType_Text"));if(o(e.commandId)||"string"!=typeof e.commandId||""===e.commandId)throw V(Rt,d("l_InvalidCommandIdError_Text"))})(t),function(e){if(o(e.actionText)||""===e.actionText||"string"!=typeof e.actionText)throw G(kt);if(e.actionText.length>bt)throw q(kt,e.actionText.length)}(t)}(e.actions)}else{if(!o(e.icon))throw V(wt);if(!o(e.persistent))throw V(xt);if(!o(e.actions))throw V(Pt,d("l_ActionsDefinitionWrongNotificationMessageError_Text"))}if(Ct(It,e.message),e.message.length>Mt)throw q(It,e.message.length)}function Ut(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];J(1,"notificationMessages.addAsync");var i=X(n,!1,!1);Lt(e),Ht(t);var a=pt[t.type];if(o(a))throw V("type");var s={key:e,message:t.message,type:a,icon:t.icon,persistent:t.persistent,actions:t.actions};L(33,i.asyncContext,i.callback,s,void 0)}function jt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"notificationMessages.getAsync");var n=X(e,!0,!1);L(34,n.asyncContext,n.callback,void 0,void 0)}function Bt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(1,"notificationMessages.removeAsync");var o=X(t,!1,!1);Lt(e);var r={key:e};L(36,o.asyncContext,o.callback,r,void 0)}function zt(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];J(1,"notificationMessages.replaceAsync");var i=X(n,!1,!1);Lt(e),Ht(t);var a=pt[t.type];if(o(a))throw V("type");var s={key:e,message:t.message,type:a,icon:t.icon,persistent:t.persistent,actions:t.actions};L(35,i.asyncContext,i.callback,s,void 0)}function Vt(){return Re({},{addAsync:Ut,getAllAsync:jt,removeAsync:Bt,replaceAsync:zt})}function Gt(e){o(e)||se(e.length,0,ee,"htmlBody")}function qt(e){var t="";return e.htmlBody&&(!function(e){if("string"!=typeof e)throw K("htmlBody",typeof e,"string");if(o(e))throw G("htmlBody");se(e.length,0,ee,"htmlBody")}(e.htmlBody),t=e.htmlBody),t}function Kt(e){var t=[];return e.attachments&&Ce(t=e.attachments),t}function Jt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(1,"mailbox.displayReplyForm");var o=X(t,!1,!1),r={formData:e},i=null,a=null;if("string"==typeof r.formData)Gt(r.formData),L(10,o.asyncContext,o.callback,{htmlBody:r.formData},void 0);else{if("object"!=typeof r.formData)throw V();i=qt(r.formData),a=Fe(Kt(r.formData)),L(30,o.asyncContext,o.callback,{htmlBody:i,attachments:a},void 0)}}function Xt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(1,"mailbox.displayReplyAllForm");var o=X(t,!1,!1),r={formData:e},i=null,a=null;if("string"==typeof r.formData)Gt(r.formData),L(11,o.asyncContext,o.callback,{htmlBody:r.formData},void 0);else{if("object"!=typeof r.formData)throw V();i=qt(r.formData),a=Fe(Kt(r.formData)),L(31,o.asyncContext,o.callback,{htmlBody:i,attachments:a},void 0)}}function Yt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"categories.addAsync");var o=X(t,!1,!1),r={categories:e};Ge(e),L(158,o.asyncContext,o.callback,r,void 0)}function Zt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"categories.getAsync");var n=X(e,!0,!1);L(157,n.asyncContext,n.callback,void 0,void 0)}function $t(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"categories.removeAsync");var o=X(t,!1,!1),r={categories:e};Ge(e),L(159,o.asyncContext,o.callback,r,void 0)}function Qt(){return Re({},{addAsync:Yt,getAsync:Zt,removeAsync:$t})}function en(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(1,"item.getAttachmentContentAsync");var o=X(t,!0,!1),r={id:e};!function(e){Ct("attachmentId",e.id)}(r),L(150,o.asyncContext,o.callback,r,void 0)}var tn=ce.Folder;function nn(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(3,"item.move");var o=X(t,!1,!1),r={destinationFolder:e};!function(e){if(e!==tn.Inbox&&e!==tn.Junk&&e!==tn.DeletedItems)throw V("destinationFolder")}(e),L(101,o.asyncContext,o.callback,r,void 0)}var on=ce.ResponseType,rn=ce.RecipientType,an=[on.None,on.Organizer,on.Tentative,on.Accepted,on.Declined],sn=[rn.Other,rn.DistributionList,rn.User,rn.ExternalUser],cn=function(e){var t=e.appointmentResponse,n=e.recipientType,o={emailAddress:e.address,displayName:e.name};return"number"==typeof e.appointmentResponse&&(o.appointmentResponse=t<an.length?an[t]:on.None),"number"==typeof e.recipientType&&(o.recipientType=n<sn.length?sn[t]:rn.Other),o};function dn(e){return cn({name:e.Name||"",address:e.UserId||""})}function ln(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"delayDeliveryTime.getAsync");var n=X(e,!0,!1);L(166,n.asyncContext,n.callback,void 0,void 0)}function un(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"delayDeliveryTime.setAsync");var r=X(t,!1,!1);!function(e){if(o(e))throw G("dateTime","You cannot conduct to a null dateTime");if(!(e instanceof Date))throw K("dateTime",typeof e,typeof Date);if(isNaN(e.getTime()))throw V("dateTime");se(e.getTime(),-864e13,864e13,"dateTime")}(e),L(167,r.asyncContext,r.callback,{time:e.getTime()},void 0)}function fn(e){var t=Re({},{getAsync:ln});return e&&Re(t,{setAsync:un}),t}function pn(e,t){for(var n=e.length-1;n>=0;n--){for(var o=!1,r=n-1;r>=0;r--)if(t(e[n],e[r])){o=!0;break}o&&e.splice(n,1)}return e}var mn=function(e,t){return e===t},gn=function(e,t){return e===t||!(!e||!t)&&e.meetingString===t.meetingString},Sn=function(e,t){return e===t||!(!e||!t)&&e.taskString===t.taskString},vn=function(e,t){return e===t||!(!e||!t)&&e.contactString===t.contactString};function On(){return!!Kr("entities")&&void 0!==Kr("entities").IsLegacyExtraction&&Kr("entities").IsLegacyExtraction}var An,Dn=18,hn=3,yn=3,Cn=7,Fn=4,En=5,Mn=2,bn=3,Tn=6,_n=4,wn=0,In=1,xn=864e5,Pn=new Date("0001-01-01T00:00:00Z");function Nn(e,t){if(!t)return e;var n=null;try{var r=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),i=function(e){var t=(1<<Dn-hn)-1,n=0;if(null==e)return;n=On()?Rn(e):kn(e);var o=(e.getTime()-n-Pn.getTime())/xn;if(o<0)return;if(o>=1<<Dn)return;var r=o>>Dn-hn;switch(o&=t,r){case wn:return function(e){var t=(1<<Fn)-1,n=(1<<En)-1,o=(1<<Cn)-1,r=0,i=0,a=0,s=e>>Dn-hn-yn&(1<<yn)-1;if(4==(4&s)){if(r=e>>Dn-hn-yn-Cn&o,2==(2&s)){if(1==(1&s))return;i=e>>Dn-hn-yn-Cn-Fn&t}}else 2==(2&s)&&(i=e>>Dn-hn-yn-Fn&t),1==(1&s)&&(a=e>>Dn-hn-yn-Fn-En&n);return function(e,t,n){return{day:e,month:t,year:n%100}}(a,i,r)}(o);case In:return function(e){var t=(1<<bn)-1,n=(1<<Mn)-1,o=e&(1<<_n)-1,r=function(e,t){var n=1<<t-1,o=(1<<t)-1;return(e&n)==n?-(1+(e^o)):e}((e>>=_n)&(1<<Tn)-1,Tn),i=(e>>=Tn)&t,a=(e>>=bn)&n;try{return function(e,t,n,o){return{modifier:e,offset:t,unit:n,tag:o}}(a,r,i,o)}catch(e){return}}(o);default:return}}(e);if(!i)return e;var a=i;if(a.day&&a.month&&void 0!==a.year)n=function(e,t){var n,r=t.year,i=0==t.month?e.getMonth():t.month-1,a=t.day;if(0==a)return e;o(r)?(n=new Date(e.getFullYear(),i,a)).getTime()<e.getTime()&&(n=new Date(e.getFullYear()+1,i,a)):n=new Date(r<50?2e3+r:1900+r,i,a);if(n.getMonth()!=i)return e;return n}(r,i);else{var s=i;n=void 0!==s.modifier&&void 0!==s.offset&&void 0!==s.tag&&void 0!==s.unit?function(e,t){var n;switch(t.unit){case 0:return(n=new Date(e.getFullYear(),e.getMonth(),e.getDate())).setDate(n.getDate()+t.offset),n;case 5:return function(e,t,n){if(t>-5&&t<5){var o=7*t+((n+6)%7+1-e.getDay());return e.setDate(e.getDate()+o),e}return(o=(n-e.getDay())%7)<0&&(o+=7),e.setDate(e.getDate()+o),e}(e,t.offset,t.tag);case 2:var o=1;switch(t.modifier){case 1:break;case 2:o=16;break;default:0==t.offset&&(o=e.getDate())}return(n=new Date(e.getFullYear(),e.getMonth(),o)).setMonth(n.getMonth()+t.offset),n.getTime()<e.getTime()&&n.setDate(n.getDate()+e.getDate()-1),n;case 1:if((n=new Date(e.getFullYear(),e.getMonth(),e.getDate())).setDate(e.getDate()+7*t.offset),1==t.modifier||0==t.modifier)return n.setDate(n.getDate()+1-n.getDay()),n.getTime()<e.getTime()?e:n;if(2==t.modifier)return n.setDate(n.getDate()+5-n.getDay()),n;break;case 4:return function(e,t){var n,o,r;if(n=e,t.tag<=0||t.tag>12||t.offset<=0||t.offset>5)return e;var i=(12+t.tag-n.getMonth()-1)%12;if(o=new Date(n.getFullYear(),n.getMonth()+i,1),1==t.modifier)return 1==t.offset&&6!=o.getDay()&&0!=o.getDay()?o:((r=new Date(o.getFullYear(),o.getMonth(),o.getDate())).setDate(r.getDate()+(1-o.getDay()+7)%7),6!=o.getDay()&&0!=o.getDay()&&1!=o.getDay()&&r.setDate(r.getDate()-7),r.setDate(r.getDate()+7*(t.offset-1)),r.getMonth()+1!=t.tag?e:r);var a=1-(r=new Date(o.getFullYear(),o.getMonth(),(s=o.getMonth(),c=o.getFullYear(),32-new Date(c,s,32).getDate()))).getDay();return a>0&&(a-=7),r.setDate(r.getDate()+a),r.setDate(r.getDate()+7*(1-t.offset)),r.getMonth()+1!=t.tag?6!=o.getDay()&&0!=o.getDay()?o:e:r;var s,c}(e,t);case 3:if(t.offset>0)return new Date(e.getFullYear()+t.offset,0,1)}return e}(r,i):r}return Number.isNaN(n.getTime())?t:(n.setMilliseconds(n.getMilliseconds()+(On()?Rn(e):kn(e))),n)}catch(e){return t}}function kn(e){var t=0;return t+=3600*e.getHours(),t+=60*e.getMinutes(),t+=e.getSeconds(),t*=1e3,t+=e.getMilliseconds()}function Rn(e){var t=0;return t+=3600*e.getUTCHours(),t+=60*e.getUTCMinutes(),t+=e.getUTCSeconds(),t*=1e3,t+=e.getUTCMilliseconds()}function Wn(e){for(var t=Kr("timeZoneOffsets"),n=0;n<t.length;n++){var o=t[n],r=parseInt(o.start),i=parseInt(o.end);if(e.getTime()-r>=0&&e.getTime()-i<0)return parseInt(o.offset)}throw V("input",d("l_InvalidDate_Text"))}function Ln(e){var t=function(e){var t=new Date(e.year,e.month,e.date,e.hours,e.minutes,e.seconds,null===e.milliseconds?0:e.milliseconds);if(isNaN(t.getTime()))throw V("input",d("l_InvalidDate_Text"));return t}(e);if(!o(Kr("timeZoneOffsets"))){var n=Wn(t);t.setUTCMinutes(t.getUTCMinutes()-n),n=e.timezoneOffset?e.timezoneOffset:-1*t.getTimezoneOffset(),t.setUTCMinutes(t.getUTCMinutes()+n)}return t}function Hn(e){return{month:e.getMonth(),date:e.getDate(),year:e.getFullYear(),hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds(),milliseconds:e.getMilliseconds()}}function Un(e){return{addresses:jn(e[An.address]),emailAddresses:Bn(e[An.emailAddress]),urls:zn(e[An.url]),taskSuggestions:Vn(e[An.taskSuggestion]),meetingSuggestions:Gn(e[An.meetingSuggestion]),phoneNumbers:Kn(e[An.phoneNumber]),contacts:Jn(e[An.contact]),flightReservations:Xn(e[An.flightReservations]),parcelDelivery:Xn(e[An.parcelDeliveries])}}!function(e){e.meetingSuggestion="MeetingSuggestions",e.taskSuggestion="TaskSuggestions",e.address="Addresses",e.emailAddress="EmailAddresses",e.url="Urls",e.phoneNumber="PhoneNumbers",e.contact="Contacts",e.flightReservations="FlightReservations",e.parcelDeliveries="ParcelDeliveries"}(An||(An={}));var jn=function(e){return pn(e||[],mn)},Bn=function(e){return 0===B()?[]:e||[]},zn=function(e){return e||[]},Vn=function(e){if(0===B())return[];var t=e||[];return pn(t=t.map(function(e){return{assignees:(e.Assignees||[]).map(dn),taskString:e.TaskString}}),Sn)},Gn=function(e){if(0===B())return[];var t=e||[];return pn(t=t.map(function(e){var t=qn(e.StartTime),n=qn(e.EndTime);return{meetingString:e.MeetingString,attendees:(e.Attendees||[]).map(dn),location:e.Location,subject:e.Subject,start:void 0!==e.StartTime?t:void 0,end:void 0!==e.EndTime?n:void 0}}),gn)};function qn(e){var t=Nn(new Date(e),new Date(Kr("dateTimeSent")));return t.getTime()!==new Date(e).getTime()?Ln(Hn(t)):new Date(e)}var Kn=function(e){return(e||[]).map(function(e){return{phoneString:e.PhoneString,originalPhoneString:e.OriginalPhoneString,type:e.Type}})},Jn=function(e){if(0===B())return[];var t=e||[];return pn(t=t.map(function(e){return{personName:e.PersonName,businessName:e.BusinessName,phoneNumbers:Kn(e.PhoneNumbers||[]),emailAddresses:e.EmailAddresses||[],urls:e.Urls||[],addresses:e.Addresses||[],contactString:e.ContactString}}),vn)},Xn=function(e){return 0===B()?[]:e||[]},Yn={meetingSuggestion:1,taskSuggestion:1,address:0,emailAddress:1,url:0,phoneNumber:0,contact:1,flightReservations:1,parcelDeliveries:1},Zn={meetingSuggestion:"meetingSuggestions",taskSuggestion:"taskSuggestions",address:"addresses",emailAddress:"emailAddresses",url:"urls",phoneNumber:"phoneNumbers",contact:"contacts",flightReservations:"flightReservations",parcelDeliveries:"parcelDeliveries"},$n=function(){return Un(Kr("entities"))},Qn=function(e){var t=Un(Kr("entities"));J(void 0!==Yn[e]?Yn[e]:1,e);var n=Zn[e];return void 0===n?null:t[n]},eo=function(e){return function(e,t){J(1,"item.getFilteredEntitiesByName");var n=Object.keys(e).map(function(n){return e[n][t]?{entityType:n,name:t,entities:e[n][t]}:void 0}).filter(function(e){return void 0!==e});if(0===n.length)return null;var o=n[0];switch(o.entityType){case An.meetingSuggestion:return Gn(o.entities);case An.address:return jn(o.entities);case An.contact:return Jn(o.entities);case An.emailAddress:return Bn(o.entities);case An.phoneNumber:return Kn(o.entities);case An.taskSuggestion:return Vn(o.entities);case An.url:return zn(o.entities);default:return Xn(o.entities)}}(Kr("filteredEntities"),e)},to=function(){return Kr("regExMatches")},no=function(e){return(Kr("regExMatches")||{})[e]},oo=function(){return Un(Kr("selectedEntities"))},ro=function(){return Kr("selectedRegExMatches")};function io(e){var t=[];if(0===B())return[];if(e)for(var n=0;n<e.length;n++)if(e[n]){var o=ao(e[n]);t.push(o)}return t}function ao(e){if(null!==e.attachmentType||void 0!==e.attachmentType)switch(e.attachmentType){case 0:e.attachmentType=ce.AttachmentType.File;break;case 1:e.attachmentType=ce.AttachmentType.Item;break;case 2:e.attachmentType=ce.AttachmentType.Cloud}return e}function so(){var e=Kr("sender"),t=Kr("from"),n=Kr("dateTimeCreated"),o=Kr("dateTimeModified"),r=Kr("end"),i=Kr("start");return Re({},{attachments:io(Kr("attachments")),bcc:(Kr("bcc")||[]).map(cn),body:ht(!1),categories:Qt(),cc:(Kr("cc")||[]).map(cn),conversationId:Kr("conversationId"),dateTimeCreated:n?new Date(n):void 0,dateTimeModified:o?new Date(o):void 0,end:r?new Date(r):void 0,from:t?cn(t):void 0,getAllInternetHeadersAsync:yt,internetMessageId:Kr("internetMessageId"),itemClass:Kr("itemClass"),itemId:Kr("id"),itemType:"message",location:Kr("location"),move:nn,normalizedSubject:Kr("normalizedSubject"),notificationMessages:Vt(),seriesId:Kr("seriesId"),sender:e?cn(e):void 0,start:i?new Date(i):void 0,subject:Kr("subject"),to:(Kr("to")||[]).map(cn),displayReplyForm:Jt,displayReplyAllForm:Xt,getAttachmentContentAsync:en,getEntities:$n,getEntitiesByType:Qn,getFilteredEntitiesByName:eo,getInitializationContextAsync:Ze,getRegExMatches:to,getRegExMatchesByName:no,getSelectedEntities:oo,getSelectedRegExMatches:ro,loadCustomPropertiesAsync:rt,delayDeliveryTime:fn(!1)})}function co(e){if(o(e)||""===e||"string"!=typeof e)throw V("attachmentName");se(e.length,0,oe,"attachmentName")}var lo=6e5;function uo(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];J(2,"item.addFileAttachmentAsync");var r=X(n,!1,!1),i=!1;r.options&&(i=!!r.options.isInline);var a={uri:e,name:t,isInline:i,__timeout__:lo};!function(e){Ct("uri",e.uri),se(e.uri.length,0,re,"uri"),co(e.name)}(a),L(16,r.asyncContext,r.callback,a,void 0)}function fo(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];J(2,"item.addBase64FileAttachmentAsync");var r=X(n,!1,!1),i=!1;r.options&&(i=!!r.options.isInline);var a={base64String:e,name:t,isInline:i,__timeout__:lo};!function(e){Ct("base64Encoded",e.base64String),co(e.name)}(a),L(148,r.asyncContext,r.callback,a,void 0)}function po(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];J(2,"item.addItemAttachmentAsync");var r=X(n,!1,!1),i={itemId:e,name:t};!function(e){Ct("itemId",e.itemId),Ct("attachmentName",e.name),se(e.itemId.length,0,ie,"itemId"),se(e.name.length,0,oe,"attachmentName")}(i),L(19,r.asyncContext,r.callback,{itemId:ve(i.itemId),name:i.name,__timeout__:lo},void 0)}function mo(){L(41,void 0,void 0,void 0,void 0)}function go(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"item.getAttachmentsAsync");var n=X(e,!0,!1);L(149,n.asyncContext,n.callback,void 0,io)}function So(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"item.getSelectedDataAsync");var o=X(t,!0,!1),r={coercionType:dt(e)};if(void 0===r.coercionType)throw V("coercionType");L(28,o.asyncContext,o.callback,r,void 0)}function vo(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"item.removeAttachmentAsync");var o=X(t,!1,!1),r={attachmentIndex:e};!function(e){Ct("attachmentId",e.attachmentIndex),se(e.attachmentIndex.length,0,ae,"attachmentId")}(r),L(20,o.asyncContext,o.callback,r,void 0)}function Oo(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(2,"item.saveAsync");var n=X(e,!1,!1);L(32,n.asyncContext,n.callback,void 0,void 0)}function Ao(e){if(!Array.isArray(e.recipientArray))throw V("recipients");if(e.recipientArray.length>Z)throw q("recipients",e.recipientArray.length);var t=e.recipientArray.map(function(e){if(o(e))throw V("recipients");if("string"==typeof e)return Do(e,e),ho(e,e);if("object"==typeof e)return Do(e.displayName,e.emailAddress),ho(e.displayName,e.emailAddress);throw V("recipients")});e.recipientArray=t}function Do(e,t){if(!e&&!t)throw V("recipients");if("string"==typeof e&&e.length>Y)throw q("recipients",e.length,d("l_DisplayNameTooLong_Text"));if("string"==typeof t&&t.length>$)throw q("recipients",t.length,d("l_EmailAddressTooLong_Text"));if("string"!=typeof e&&"string"!=typeof t)throw V("recipients")}function ho(e,t){return{address:t,name:e}}function yo(e){return function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];J(2,e+".addAsync");var r=X(n,!1,!1),i={recipientField:U[e],recipientArray:t};Ao(i),L(22,r.asyncContext,r.callback,i,void 0)}}function Co(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];J(1,e+".getAsync");var o=X(t,!0,!1);L(15,o.asyncContext,o.callback,{recipientField:U[e]},Fo)}}function Fo(e){return null==e?[]:e.map(function(e){return cn(e)})}function Eo(e){return function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];J(2,e+".setAsync");var r=X(n,!1,!1),i={recipientField:U[e],recipientArray:t};Ao(i),L(21,r.asyncContext,r.callback,i,void 0)}}function Mo(e){return Re({},{addAsync:yo(e),getAsync:Co(e),setAsync:Eo(e)})}function bo(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];J(1,e+".getAsync");var o=X(t,!0,!1);L(107,o.asyncContext,o.callback,void 0,void 0)}}function To(e){return Re({},{getAsync:bo(e)})}function _o(e){if(o(e))throw V("internetHeaders");if(!Array.isArray(e))throw K("internetHeaders",typeof e,"Array");if(0===e.length)throw V("internetHeaders");for(var t=0,n=e;t<n.length;t++){Ct("internetHeaders",n[t])}}function wo(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"internetHeaders.removeAsync");var o=X(t,!1,!1),r={internetHeaderKeys:e};!function(e){_o(e.internetHeaderKeys)}(r),L(153,o.asyncContext,o.callback,r,void 0)}function Io(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(1,"internetHeaders.getAsync");var o=X(t,!0,!1),r={internetHeaderKeys:e};!function(e){_o(e.internetHeaderKeys)}(r),L(151,o.asyncContext,o.callback,r,void 0)}var xo=998;function Po(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"internetHeaders.setAsync");var r=X(t,!1,!1),i={internetHeaderNameValuePairs:e};!function(e){if(o(e.internetHeaderNameValuePairs))throw G("internetHeaders");var t=Object.keys(e.internetHeaderNameValuePairs);if(0===t.length)throw V("internetHeaders");for(var n=0,r=t;n<r.length;n++){var i=r[n],a=e.internetHeaderNameValuePairs[i];if(Ct("internetHeaders",i),"string"!=typeof a)throw K("internetHeaders",typeof a,"string");se(i.length+a.length,0,xo,i)}}(i),L(152,r.asyncContext,r.callback,i,void 0)}function No(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"subject.getAsync");var n=X(e,!0,!1);L(18,n.asyncContext,n.callback,void 0,void 0)}var ko=255;function Ro(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"subject.setAsync");var o=X(t,!1,!1),r={subject:e};!function(e){if("string"!=typeof e.subject)throw K("subject",typeof e.subject,"string");se(e.subject.length,0,ko,"subject")}(r),L(17,o.asyncContext,o.callback,r,void 0)}function Wo(){return Re({},{getAsync:No,setAsync:Ro})}function Lo(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"item.getItemIdAsync");var n=X(e,!0,!1);L(164,n.asyncContext,n.callback,void 0,void 0)}function Ho(e){if(o(e))throw G("locationIdentifier");if(!Array.isArray(e))throw K("locationIdentifier",typeof e,"Array");if(0===e.length)throw V("locationIdentifier");for(var t=0,n=e;t<n.length;t++){Uo(n[t])}}function Uo(e){if(o(e)||o(e.id)||o(e.type))throw G("locationIdentifier");if(e.type!==ce.LocationType.Room&&e.type!==ce.LocationType.Custom)throw V("type");!function(e,t){if(""===e)throw V("id");if(t===ce.LocationType.Room&&e.length>$)throw V("id")}(e.id,e.type)}function jo(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"enhancedLocations.addAsync");var o=X(t,!1,!1),r={enhancedLocations:e};!function(e){Ho(e.enhancedLocations)}(r),L(155,o.asyncContext,o.callback,r,void 0)}function Bo(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"enhancedLocations.getAsync");var n=X(e,!0,!1);L(154,n.asyncContext,n.callback,void 0,void 0)}function zo(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"enhancedLocations.removeAsync");var o=X(t,!1,!1),r={enhancedLocations:e};!function(e){Ho(e.enhancedLocations)}(r),L(156,o.asyncContext,o.callback,r,void 0)}function Vo(e){var t=Re({},{getAsync:Bo});return e&&Re(t,{addAsync:jo,removeAsync:zo}),t}var Go="recurrenceType",qo="seriesTime",Ko="name",Jo="interval",Xo="days",Yo="dayOfMonth",Zo="dayOfWeek",$o="weekNumber",Qo="month",er="firstDayOfWeek";function tr(e){return e<0&&(e=1),e<10?"0"+e.toString():e.toString()}function nr(e,t,n){if(!or(e,t,n))throw V(qo,d("l_InvalidDate_Text"))}function or(e,t,n){return!(e<1601||t<1||t>12||n<1||n>31)}var rr,ir=function(){function e(){this.startYear=0,this.startMonth=0,this.startDay=0,this.endYear=0,this.endMonth=0,this.endDay=0,this.startTimeMinutes=0,this.durationMinutes=0}return e.prototype.getDuration=function(){return this.durationMinutes},e.prototype.getEndTime=function(){var e=this.startTimeMinutes+this.durationMinutes,t=e%60;return"T"+tr(Math.floor(e/60)%24)+":"+tr(t)+":00.000"},e.prototype.getEndDate=function(){return 0===this.endYear&&0===this.endMonth&&0===this.endDay?null:this.endYear.toString()+"-"+tr(this.endMonth)+"-"+tr(this.endDay)},e.prototype.getStartDate=function(){return this.startYear.toString()+"-"+tr(this.startMonth)+"-"+tr(this.startDay)},e.prototype.getStartTime=function(){var e=this.startTimeMinutes%60;return"T"+tr(Math.floor(this.startTimeMinutes/60))+":"+tr(e)+":00.000"},e.prototype.setDuration=function(e){if(!(e>=0))throw V(void 0,d("l_InvalidTime_Text"));this.durationMinutes=e},e.prototype.setEndDate=function(e,t,n){null===e||o(t)||null===n?null!==e?this.setDateHelper(!1,e):null==e&&(this.endYear=0,this.endMonth=0,this.endDay=0):this.setDateHelper(!1,e,t,n)},e.prototype.setStartDate=function(e,t,n){null===e||o(t)||null===n?null!==e&&this.setDateHelper(!0,e):this.setDateHelper(!0,e,t,n)},e.prototype.setStartTime=function(e,t){if(o(e)||o(t)){if(!o(e)){var n=e,r="2017-01-15"+n+"Z";if(!new RegExp("^T[0-2]\\d:[0-5]\\d:[0-5]\\d\\.\\d{3}$").test(n))throw V(void 0,d("l_InvalidTime_Text"));var i=new Date(r);if(o(i)||isNaN(i.getUTCHours())||isNaN(i.getUTCMinutes()))throw V(void 0,d("l_InvalidTime_Text"));this.startTimeMinutes=60*i.getUTCHours()+i.getUTCMinutes()}}else{var a=60*e+t;if(!(a>=0))throw V(void 0,d("l_InvalidTime_Text"));this.startTimeMinutes=a}},e.prototype.isValid=function(){return!!or(this.startYear,this.startMonth,this.startDay)&&(!(0!==this.endDay&&0!==this.endMonth&&0!==this.endYear&&!or(this.endYear,this.endMonth,this.endDay))&&!(this.startTimeMinutes<0||this.durationMinutes<=0))},e.prototype.exportToSeriesTimeJson=function(){var e={};return e.startYear=this.startYear,e.startMonth=this.startMonth,e.startDay=this.startDay,0===this.endYear&&0===this.endMonth&&0===this.endDay?e.noEndDate=!0:(e.endYear=this.endYear,e.endMonth=this.endMonth,e.endDay=this.endDay),e.startTimeMin=this.startTimeMinutes,this.durationMinutes>0&&(e.durationMin=this.durationMinutes),e},e.prototype.importFromSeriesTimeJsonObject=function(e){this.startYear=e.startYear,this.startMonth=e.startMonth,this.startDay=e.startDay,null!=e.noEndDate&&"boolean"==typeof e.noEndDate?(this.endYear=0,this.endMonth=0,this.endDay=0):(this.endYear=e.endYear,this.endMonth=e.endMonth,this.endDay=e.endDay),this.startTimeMinutes=e.startTimeMin,this.durationMinutes=e.durationMin},e.prototype.setDateHelper=function(e,t,n,r){var i=0,a=0,s=0;if(null===t||o(n)||null===r){if(null!==t){var c=t;!function(e){if(!new RegExp("^\\d{4}-(?:[0]\\d|1[0-2])-(?:[0-2]\\d|3[01])$").test(e))throw V(qo,d("l_InvalidDate_Text"))}(c);var l=new Date(c);null===l||isNaN(l.getUTCFullYear())||isNaN(l.getUTCMonth())||isNaN(l.getUTCDate())||(nr(l.getUTCFullYear(),l.getUTCMonth()+1,l.getUTCDate()),i=l.getUTCFullYear(),a=l.getUTCMonth()+1,s=l.getUTCDate())}}else nr(t,n+1,r),i=t,a=n+1,s=r;0!==i&&0!==a&&0!==s&&(e?(this.startYear=i,this.startMonth=a,this.startDay=s):(this.endYear=i,this.endMonth=a,this.endDay=s))},e.prototype.isEndAfterStart=function(){if(0===this.endYear&&0===this.endMonth&&0===this.endDay)return!0;var e=new Date;e.setFullYear(this.startYear),e.setMonth(this.startMonth-1),e.setDate(this.startDay);var t=new Date;return t.setFullYear(this.endYear),t.setMonth(this.endMonth-1),t.setDate(this.endDay),t>=e},e}();function ar(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"recurrenceProperties.getAsync");var n=X(e,!0,!1);L(103,n.asyncContext,n.callback,void 0,sr)}function sr(e){if(null!==e&&null!==e.seriesTimeJson){var t=new ir;t.importFromSeriesTimeJsonObject(e.seriesTimeJson),delete e.seriesTimeJson,e.seriesTime=t}return e}function cr(e){if(!o(e)){if(o((e=e).recurrenceType))throw G(Go);if(o(e.seriesTime))throw G(qo);if(!(e.seriesTime instanceof ir&&e.seriesTime.isValid()))throw V(qo);if(!e.seriesTime.isEndAfterStart())throw V(qo,d("l_InvalidEventDates_Text"));if(function(e){if(e!==ce.RecurrenceType.Daily&&e!==ce.RecurrenceType.Weekly&&e!==ce.RecurrenceType.Weekday&&e!==ce.RecurrenceType.Yearly&&e!==ce.RecurrenceType.Monthly)throw V(Go)}(e.recurrenceType),e.recurrenceType!==ce.RecurrenceType.Weekday&&o(e.recurrenceProperties))throw G(Go);if(!o(e.recurrenceTimeZone)){if(o(e.recurrenceTimeZone.name))throw G(Ko);if("string"!=typeof e.recurrenceTimeZone.name)throw K(Ko,typeof e.recurrenceTimeZone.name,"string")}e.recurrenceType===ce.RecurrenceType.Daily?dr(e.recurrenceProperties):e.recurrenceType===ce.RecurrenceType.Weekly?function(e){if(dr(e),o(e.days))throw K(Xo);if(!Array.isArray(e.days))throw K(Xo);if(function(e){for(var t=0;t<e.length;t++)if(!lr(e[t],!1))throw V(Xo)}(e.days),!o(e.firstDayOfWeek)){if("string"!=typeof e.firstDayOfWeek)throw K(er);if(!lr(e.firstDayOfWeek,!1))throw V(er)}}(e.recurrenceProperties):e.recurrenceType===ce.RecurrenceType.Monthly?function(e){if(o(e.interval))throw G(Jo);if("number"!=typeof e.interval)throw K(Jo,typeof e.interval,"number");if(o(e.dayOfMonth)){if(o(e.dayOfWeek)||o(e.weekNumber))throw V(void 0,d("l_Recurrence_Error_Properties_Invalid_Text"));if("string"!=typeof e.dayOfWeek)throw K(Zo,typeof e.dayOfWeek,"string");if(!lr(e.dayOfWeek,!0))throw V(Zo);if("string"!=typeof e.weekNumber)throw K($o,typeof e.weekNumber,"string");ur(e.weekNumber)}else{if("number"!=typeof e.dayOfMonth)throw K(Yo,typeof e.dayOfMonth,"number");fr(e.dayOfMonth)}}(e.recurrenceProperties):e.recurrenceType===ce.RecurrenceType.Yearly&&function(e){if(o(e.interval))throw G(Jo);if("number"!=typeof e.interval)throw K(Jo,typeof e.interval,"number");if(o(e.month))throw G(Qo);if("string"!=typeof e.month)throw K(Qo,typeof e.month,"string");if(function(e){if(e!==ce.Month.Jan&&e!==ce.Month.Feb&&e!==ce.Month.Mar&&e!==ce.Month.Apr&&e!==ce.Month.May&&e!==ce.Month.Jun&&e!==ce.Month.Jul&&e!==ce.Month.Aug&&e!==ce.Month.Sep&&e!==ce.Month.Oct&&e!==ce.Month.Nov&&e!==ce.Month.Dec)throw V(Qo)}(e.month),o(e.dayOfMonth)){if(o(e.weekNumber)||o(e.dayOfWeek))throw V(void 0,d("l_Recurrence_Error_Properties_Invalid_Text"));if("string"!=typeof e.dayOfWeek)throw K(Zo,typeof e.dayOfWeek,"string");if(!lr(e.dayOfWeek,!0))throw V(Zo);if("string"!=typeof e.weekNumber)throw K($o,typeof e.weekNumber,"string");ur(e.weekNumber)}else{if("number"!=typeof e.dayOfMonth)throw K(Yo,typeof e.dayOfMonth,"number");fr(e.dayOfMonth)}}(e.recurrenceProperties)}}function dr(e){if(o(e.interval))throw G(Jo);if("number"!=typeof e.interval)throw K(Jo,typeof e.interval,"number");if(e.interval<=0)throw V(Jo)}function lr(e,t){var n=e===ce.Days.Mon||e===ce.Days.Tue||e===ce.Days.Wed||e===ce.Days.Thu||e===ce.Days.Fri||e===ce.Days.Sat||e===ce.Days.Sun;return t&&(e===ce.Days.WeekendDay||e===ce.Days.Weekday||e===ce.Days.Day)||n}function ur(e){if(e!==ce.WeekNumber.First&&e!==ce.WeekNumber.Second&&e!==ce.WeekNumber.Third&&e!==ce.WeekNumber.Fourth&&e!==ce.WeekNumber.Last)throw V($o)}function fr(e){if(e<1||e>31)throw V(Yo)}function pr(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];J(1,e+".getAsync");var o=X(t,!0,!1);L(24,o.asyncContext,o.callback,{TimeProperty:rr[e]},mr)}}function mr(e){return new Date(e)}!function(e){e[e.start=1]="start",e[e.end=2]="end"}(rr||(rr={}));var gr=864e13,Sr=-864e13;function vr(e){return function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];J(2,e+".setAsync");var r=X(n,!1,!1),i={date:t};Or(i),L(25,r.asyncContext,r.callback,{TimeProperty:rr[e],time:i.date.getTime()},void 0)}}function Or(e){if(!(e.date instanceof Date))throw K("dateTime",typeof e.date,typeof Date);if(isNaN(e.date.getTime()))throw V("dateTime");if(e.date.getTime()<Sr||e.date.getTime()>gr)throw q("dateTime")}function Ar(e){return Re({},{getAsync:pr(e),setAsync:vr(e)})}function Dr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"location.getAsync");var n=X(e,!0,!1);L(26,n.asyncContext,n.callback,void 0,void 0)}var hr=255;function yr(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"location.setAsync");var r=X(t,!1,!1),i={location:e};!function(e){if(o(e.location))throw G("location");if("string"!=typeof e.location)throw K("location",typeof e.location,"string");se(e.location.length,0,hr,"location")}(i),L(27,r.asyncContext,r.callback,i,void 0)}function Cr(){return Re({},{body:ht(!0),categories:Qt(),end:Ar("end"),enhancedLocation:Vo(!0),itemType:"appointment",location:Re({},{getAsync:Dr,setAsync:yr}),notificationMessages:Vt(),optionalAttendees:Mo("optionalAttendees"),organizer:To("organizer"),recurrence:Er(!0),requiredAttendees:Mo("requiredAttendees"),seriesId:Kr("seriesId"),start:Ar("start"),subject:Wo(),addFileAttachmentAsync:uo,addFileAttachmentFromBase64Async:fo,addItemAttachmentAsync:po,close:mo,getAttachmentsAsync:go,getAttachmentContentAsync:en,getInitializationContextAsync:Ze,getItemIdAsync:Lo,getSelectedDataAsync:So,loadCustomPropertiesAsync:rt,removeAttachmentAsync:vo,saveAsync:Oo,setSelectedDataAsync:Dt(29)})}function Fr(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];J(2,"recurrenceProperties.setAsync");var r=Cr().seriesId;if(!o(r)&&r.length>0)throw V(void 0,d("l_Recurrence_Error_Instance_SetAsync_Text"));cr(e);var i=X(t,!1,!1),a={recurrenceData:function(e){if(null!==e&&null!==e.seriesTime){if(e.seriesTime instanceof ir)return{recurrenceProperties:e.recurrenceProperties,recurrenceTimeZone:e.recurrenceTimeZone,recurrenceType:e.recurrenceType,seriesTimeJson:e.seriesTime.exportToSeriesTimeJson()}}return e}(e)};L(104,i.asyncContext,i.callback,a,void 0)}function Er(e){var t=Re({},{getAsync:ar});return e&&Re(t,{setAsync:Fr}),t}var Mr,br=n(0),Tr=n(1);function _r(e){var t={consentState:e,extensionId:Kr("extensionId")};!function(e){if(e!==Mr.Consented&&e!==Mr.NotConsented&&e!==Mr.NotResponded)throw q("consentState")}(e),L(40,void 0,void 0,t,void 0)}function wr(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=X(t,!1,!1),i={module:e};!function(e){if(o(e))throw G("module");if(""===e)throw V("module");if(e!==ce.ModuleType.Addins)throw V("module")}(e),e===ce.ModuleType.Addins&&(r.options&&r.options.queryString?i.queryString=r.options.queryString:i.queryString=""),L(45,r.asyncContext,r.callback,i,void 0)}function Ir(e){if(o(e))throw G("data");L(402,void 0,void 0,e,void 0)}function xr(e){if(o(e))throw G("data");L(401,void 0,void 0,e,void 0)}function Pr(e){if(o(e))throw G("data");L(400,void 0,void 0,e,void 0)}function Nr(e,t,n,o){return L(403,void 0,void 0,{launchUrl:e},void 0),window}function kr(e){if(o(e))throw G("data");L(163,void 0,void 0,{telemetryData:e},void 0)}!function(e){e[e.NotResponded=0]="NotResponded",e[e.NotConsented=1]="NotConsented",e[e.Consented=2]="Consented"}(Mr||(Mr={}));var Rr=function(){return(Rr=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function Wr(e){if(!(e instanceof Date))throw V("timeValue");var t=new Date(e.getTime()),n=-1*t.getTimezoneOffset();return o(Kr("timeZoneOffsets"))||(t.setUTCMinutes(t.getUTCMinutes()-n),n=Wn(t),t.setUTCMinutes(t.getUTCMinutes()+n)),Rr({timezoneOffset:n},Hn(t))}function Lr(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=X(t,!1,!1);!function(e){if(o(e.ewsIdOrEmail))throw G("ewsIdOrEmail");if(function(e){if("string"!=typeof e)throw V("ewsIdOrEmail")}(e.ewsIdOrEmail),""===e.ewsIdOrEmail)throw V("ewsIdOrEmail","ewsIdOrEmail cannot be empty.")}({ewsIdOrEmail:e}),L(43,r.asyncContext,r.callback,{ewsIdOrEmail:e.trim()},void 0)}function Hr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];J(1,"item.getSharedPropertiesAsync");var n=X(e,!0,!1);L(108,n.asyncContext,n.callback,void 0,void 0)}var Ur,jr=n(0),Br=function(e){return Re(e,{ewsUrl:Kr("ewsUrl"),restUrl:Kr("restUrl"),displayAppointmentForm:Oe,displayMessageForm:Ae,displayPersonaCardAsync:Lr,getCallbackTokenAsync:we,getUserIdentityTokenAsync:Ie,logTelemetry:kr,makeEwsRequestAsync:Ne,masterCategories:Re({},{addAsync:ze,getAsync:Ve,removeAsync:Ke}),navigateToModuleAsync:wr,diagnostics:Re({},{hostName:Le(),hostVersion:Kr("hostVersion"),OWAView:Kr("owaView")}),userProfile:Re({},{accountType:Kr("userProfileType"),displayName:Kr("userDisplayName"),emailAddress:Kr("userEmailAddress"),timeZone:Kr("userTimeZone")}),convertToEwsId:fe,convertToLocalClientTime:Wr,convertToRestId:ue,convertToUtcClientTime:Ln,RegisterConsentAsync:_r,GetIsRead:function(){return Kr("isRead")},GetEndPointUrl:function(){return Kr("endNodeUrl")},GetConsentMetaData:function(){return Kr("consentMetadata")},GetMarketplaceContentMarket:function(){return Kr("marketplaceContentMarket")},GetMarketplaceAssetId:function(){return Kr("marketplaceAssetId")},GetExtensionId:function(){return Kr("extensionId")},CloseApp:Je,recordDataPoint:Ir,recordTrace:xr,trackCtq:Pr}),Ye()!==Xe.MessageCompose&&Ye()!==Xe.AppointmentCompose&&Re(e,{displayNewAppointmentForm:he,displayNewMessageForm:ye}),Jr()===jr.AppName.OutlookWebApp&&Kr("openWindowOpen")&&(window.open=Nr),e},zr=function(){var e,t,n,o,r,i,a,s,c=void 0;switch(Ye()){case Xe.Message:c=so();break;case Xe.MessageCompose:c=Re({},{bcc:Mo("bcc"),body:ht(!0),categories:Qt(),cc:Mo("cc"),conversationId:Kr("conversationId"),from:To("from"),internetHeaders:(i=!0,a=Re({},{getAsync:Io}),i&&Re(a,{removeAsync:wo,setAsync:Po}),a),itemType:"message",notificationMessages:Vt(),seriesId:Kr("seriesId"),subject:Wo(),to:Mo("to"),addFileAttachmentAsync:uo,addFileAttachmentFromBase64Async:fo,addItemAttachmentAsync:po,close:mo,getAttachmentsAsync:go,getAttachmentContentAsync:en,getInitializationContextAsync:Ze,getItemIdAsync:Lo,getSelectedDataAsync:So,loadCustomPropertiesAsync:rt,removeAttachmentAsync:vo,saveAsync:Oo,setSelectedDataAsync:Dt(29),delayDeliveryTime:fn(!0)});break;case Xe.Appointment:e=Kr("organizer"),t=Kr("dateTimeCreated"),n=Kr("dateTimeModified"),o=Kr("end"),r=Kr("start"),c=Re({},{attachments:io(Kr("attachments")),body:ht(!1),categories:Qt(),dateTimeCreated:t?new Date(t):void 0,dateTimeModified:n?new Date(n):void 0,end:o?new Date(o):void 0,enhancedLocation:Vo(!1),itemClass:Kr("itemClass"),itemId:Kr("id"),itemType:"appointment",location:Kr("location"),normalizedSubject:Kr("normalizedSubject"),notificationMessages:Vt(),optionalAttendees:(Kr("optionalAttendees")||[]).map(cn),organizer:e?cn(e):void 0,recurrence:Er(!1),requiredAttendees:(Kr("requiredAttendees")||[]).map(cn),start:r?new Date(r):void 0,seriesId:Kr("seriesId"),subject:Kr("subject"),displayReplyForm:Jt,displayReplyAllForm:Xt,getAttachmentContentAsync:en,getEntities:$n,getEntitiesByType:Qn,getFilteredEntitiesByName:eo,getInitializationContextAsync:Ze,getRegExMatches:to,getRegExMatchesByName:no,getSelectedEntities:oo,getSelectedRegExMatches:ro,loadCustomPropertiesAsync:rt});break;case Xe.AppointmentCompose:c=Cr();break;case Xe.MeetingRequest:c=so();break;default:return}return s=c,br.DDA.DispIdHost.addEventSupport(s,new br.EventDispatch([Tr.Office.WebExtension.EventType.RecipientsChanged,Tr.Office.WebExtension.EventType.AppointmentTimeChanged,Tr.Office.WebExtension.EventType.AttachmentsChanged,Tr.Office.WebExtension.EventType.EnhancedLocationsChanged,Tr.Office.WebExtension.EventType.InfobarClicked,Tr.Office.WebExtension.EventType.RecurrenceChanged])),function(e){e&&Kr("isFromSharedFolder")&&Ye()!==Xe.ItemLess&&Re(e,{getSharedPropertiesAsync:Hr})}(c),c},Vr=function(e){var t=0,n=0;return o(e)||(t=e.indexOf("."),n=parseInt(e.substring(0,t))),n>=16},Gr=function(e,t){var n=!1;try{var o=JSON.parse(t.get_requirementMatrix()).Mailbox.split("."),r=e.split(".");(parseInt(o[0])>parseInt(r[0])||parseInt(o[0])===parseInt(r[0])&&parseInt(o[1])>=parseInt(r[1]))&&(n=!0)}catch(e){}return n},qr=n(0),Kr=function(e){return Ur&&Ur.getInitialDataProp(e)},Jr=function(){return Ur&&Ur.getAppName()},Xr=function(){function e(e,t,n){var o=this;this.displayName="mailbox",this.stringLoadedCallback=function(){o.appReadyCallback&&(o.officeAppContext.get_isDialog()?setTimeout(function(){return o.appReadyCallback()},0):j(1,void 0,o.onInitialDataResponse))},this.initialize=function(e){if(null===e)b(!0),o.initialData=null,o.item=null;else{o.initialData=e,o.initialData.permissionLevel=Yr(),o.item=zr();var t=Jr()!==qr.AppName.Outlook||Vr(Kr("hostVersion"))||Gr("1.5",o.officeAppContext);b(t),void 0!==e.itemNumber&&M().setCurrentItemNumber(e.itemNumber)}},this.onInitialDataResponse=function(e,t){e&&e!==A.noError||(o.initialize(t),Br(o),setTimeout(function(){return o.appReadyCallback()},0))},this.officeAppContext=e,this.targetWindow=window,this.appReadyCallback=n,Ur=this,function(e){var t;l=e;for(var n=document.getElementsByTagName("script"),o=0;o<n.length;o++){var r=n.item(o);if(r&&r.src){var c=r.src||"";if(t=(c=c.toLowerCase()).indexOf(i),c&&t>0){u=c.replace(i,s),f=O(f,t,c);break}if(t=c.indexOf(a),c&&t>0){u=c.replace(a,s),f=O(f,t,c);break}}}if(u){var d=document.getElementsByTagName("head")[0];(p=g(u)).onload=S,p.onreadystatechange=S,window.setTimeout(v,2e3),d.appendChild(p)}}(this.stringLoadedCallback)}return e.prototype.getAppName=function(){return this.officeAppContext.get_appName()},e.prototype.getInitialDataProp=function(e){return this.initialData&&this.initialData[e]},e.prototype.setCurrentItemNumber=function(e){M().setCurrentItemNumber(e)},e.addAdditionalArgs=function(e,t){return t},e}(),Yr=function(){var e=Kr("permissionLevel");if(void 0===e)return 0;switch(e){case 1:return 1;case 3:return 2;case 2:return 3;default:return 0}},Zr=n(0),$r=32768;function Qr(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=X(t,!1,!1),r=Zr.DDA.SettingsManager.serializeSettings(e);if(JSON.stringify(r).length>$r){var i=H(void 0,Zr.DDA.AsyncResultEnum.ErrorCode.Failed,9019,o.asyncContext,"");o.callback&&setTimeout(function(){o.callback&&o.callback(i)},0)}else Zr.AppName.OutlookWebApp===Jr()?function(e,t){L(404,e.asyncContext,e.callback,[t],void 0)}(o,r):function(e,t){var n=-1,o=null;try{var r=JSON.stringify(t),i={};i.SettingsKey=r,Zr.DDA.ClientSettingsManager.write(i)}catch(e){o=e}var a=void 0;null!=o?(n=9019,a=H(void 0,Zr.DDA.AsyncResultEnum.ErrorCode.Failed,n,e.asyncContext,o.Message)):(n=0,a=H(void 0,Zr.DDA.AsyncResultEnum.ErrorCode.Success,n,e.asyncContext));e.callback&&e.callback(a)}(o,r)}var ei=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o},ti=n(0),ni=function(){function e(e){this.rawData=e,this.settingsData=null}return e.prototype.getSettingsData=function(){return null==this.settingsData&&(this.settingsData=this.convertFromRawSettings(this.rawData),this.rawData=null),this.settingsData},e.prototype.get=function(e){return this.getSettingsData()[e]},e.prototype.set=function(e,t){this.getSettingsData()[e]=t},e.prototype.remove=function(e){delete this.getSettingsData()[e]},e.prototype.saveAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Qr.apply(void 0,ei([this.getSettingsData()],e))},e.prototype.convertFromRawSettings=function(e){if(null==e)return{};if(Jr()!==ti.AppName.OutlookWebApp){var t=e.SettingsKey;if(t)return ti.DDA.SettingsManager.deserializeSettings(t)}return e},e}(),oi={toItemRead:function(e){var t=Ye();if(t===Xe.Message||t===Xe.Appointment||t===Xe.MeetingRequest)return e;throw K()},toItemCompose:function(e){var t=Ye();if(t===Xe.MessageCompose||t===Xe.AppointmentCompose)return e;throw K()},toMessage:function(e){if(Ye()===Xe.Message)return e;throw K()},toMessageRead:function(e){if(Ye()===Xe.Message)return e;throw K()},toMessageCompose:function(e){if(Ye()===Xe.MessageCompose)return e;throw K()},toMeetingRequest:function(e){if(Ye()===Xe.MeetingRequest)return e;throw K()},toAppointment:function(e){if(Ye()===Xe.Appointment)return e;throw K()},toAppointmentRead:function(e){if(Ye()===Xe.Appointment)return e;throw K()},toAppointmentCompose:function(e){if(Ye()===Xe.AppointmentCompose)return e;throw K()}},ri={SeriesTimeJsonConverter:function(e){if(null!==e&&"object"==typeof e&&null!==e.seriesTimeJson){var t=new ir;t.importFromSeriesTimeJsonObject(e.seriesTimeJson),delete e.seriesTimeJson,e.seriesTime=t}return e},CreateAttachmentDetails:function(e){return ao(e),e}};(OSF="object"==typeof OSF?OSF:{}).DDA=OSF.DDA||{},OSF.DDA.Settings=ni,(OSF="object"==typeof OSF?OSF:{}).DDA=OSF.DDA||{},OSF.DDA.OutlookAppOm=Xr,Office="object"==typeof Office?Office:{},Office.cast=Office.cast||{},Office.cast.item=oi,Microsoft.Office.WebExtension.MailboxEnums=ce,Microsoft.Office.WebExtension.CoercionType=de,Microsoft.Office.WebExtension.SeriesTime=ir,Microsoft.Office.WebExtension.OutlookBase=ri;t.default=Xr;var ii=window;ii.$h="object"==typeof $h?$h:{},ii.$h.Message=$h.Message||{},ii.$h.Appointment=$h.Appointment||{},ii.$h.Message.isInstanceOfType=function(e){return e&&"message"===e.itemType},ii.$h.Appointment.isInstanceOfType=function(e){return e&&"appointment"===e.itemType}}]).default,OSF.DDA.ErrorCodeManager.initializeErrorMessages(Strings.OfficeOM),e.get_appName()==OSF.AppName.Outlook&&OSF.DDA.RichApi&&OSF.DDA.AsyncMethodNames.ExecuteRichApiRequestAsync&&(OSF.DDA.DispIdHost.addAsyncMethods(OSF.DDA.RichApi,[OSF.DDA.AsyncMethodNames.ExecuteRichApiRequestAsync]),OSF.DDA.RichApi.richApiMessageManager=new OfficeExt.RichApiMessageManager),e.get_appName()==OSF.AppName.OutlookWebApp||e.get_appName()==OSF.AppName.OutlookIOS||e.get_appName()==OSF.AppName.OutlookAndroid?this._settings=this._initializeSettings(e,!1):"mac"==OSF._OfficeAppFactory.getHostInfo().hostPlatform&&e.get_appName()==OSF.AppName.Outlook?this._settings=this.initializeMacSettings(e,!1):this._settings=this._initializeSettings(!1),e.appOM=new OSF.DDA.OutlookAppOm(e,this._webAppState.wnd,t),e.get_appName()!=OSF.AppName.Outlook&&e.get_appName()!=OSF.AppName.OutlookWebApp&&e.get_appName()!=OSF.AppName.OutlookIOS&&e.get_appName()!=OSF.AppName.OutlookAndroid||OSF.DDA.DispIdHost.addEventSupport(e.appOM,new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.ItemChanged,Microsoft.Office.WebExtension.EventType.OfficeThemeChanged]))};