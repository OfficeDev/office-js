/* Outlook specific API library */
/* Version: 15.0.4726.1000 */
/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/

/*
	Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.
*/

Type.registerNamespace("Microsoft.Office.WebExtension.MailboxEnums");Microsoft.Office.WebExtension.MailboxEnums.EntityType={MeetingSuggestion:"meetingSuggestion",TaskSuggestion:"taskSuggestion",Address:"address",EmailAddress:"emailAddress",Url:"url",PhoneNumber:"phoneNumber",Contact:"contact"};Microsoft.Office.WebExtension.MailboxEnums.ItemType={Message:"message",Appointment:"appointment"};Microsoft.Office.WebExtension.MailboxEnums.ResponseType={None:"none",Organizer:"organizer",Tentative:"tentative",Accepted:"accepted",Declined:"declined"};Microsoft.Office.WebExtension.MailboxEnums.RecipientType={Other:"other",DistributionList:"distributionList",User:"user",ExternalUser:"externalUser"};Microsoft.Office.WebExtension.MailboxEnums.AttachmentType={File:"file",Item:"item"};Microsoft.Office.WebExtension.MailboxEnums.BodyType={Text:"text",Html:"html"};Microsoft.Office.WebExtension.CoercionType={Text:"text",Html:"html"};Type.registerNamespace("OSF.DDA");OSF.DDA.OutlookAppOm=function(n,t,i){this.$$d_$2i_0=Function.createDelegate(this,this.$2i_0);this.$$d_$34_0=Function.createDelegate(this,this.$34_0);this.$$d_windowOpenOverrideHandler=Function.createDelegate(this,this.windowOpenOverrideHandler);this.$$d_$3k_0=Function.createDelegate(this,this.$3k_0);this.$$d_$3i_0=Function.createDelegate(this,this.$3i_0);this.$$d_$4C_0=Function.createDelegate(this,this.$4C_0);this.$$d_$3t_0=Function.createDelegate(this,this.$3t_0);this.$$d_$3q_0=Function.createDelegate(this,this.$3q_0);OSF.DDA.OutlookAppOm.$2=this;this.$V_0=n;this.$14_0=i;var u=this;var r=function(){i&&u.$E_0(1,"GetInitialData",null,u.$$d_$3q_0)};this.$1p_0()?r():this.$4J_0(r)};OSF.DDA.OutlookAppOm.$N=function(n){if(!n)throw Error.create(_u.ExtensibilityStrings.l_ElevatedPermissionNeeded_Text);};OSF.DDA.OutlookAppOm.$A=function(n,t,i,r){if(n<t||n>i)throw Error.argumentOutOfRange(r);};OSF.DDA.OutlookAppOm.$3o=function(n){var t="";if("htmlBody"in n){OSF.DDA.OutlookAppOm.$4a(n.htmlBody);t=n.htmlBody}return t};OSF.DDA.OutlookAppOm.$2B=function(n){var t=[];if("attachments"in n){t=n.attachments;OSF.DDA.OutlookAppOm.$4Y(t)}return t};OSF.DDA.OutlookAppOm.$3y=function(n){var t=[];"options"in n&&(t[0]=n.options);"callback"in n&&(t[t.length]=n.callback);return t};OSF.DDA.OutlookAppOm.$2q=function(n){var r=new Array(0);if(Array.isInstanceOfType(n))for(var t=0;t<n.length;t++)if(Object.isInstanceOfType(n[t])){var i=n[t];OSF.DDA.OutlookAppOm.$4W(i);r[t]=OSF.DDA.OutlookAppOm.$2o(i)}else throw Error.argument("attachments");return r};OSF.DDA.OutlookAppOm.$4a=function(n){if(!String.isInstanceOfType(n))throw Error.argument("htmlBody");if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argument("htmlBody");OSF.DDA.OutlookAppOm.$A(n.length,0,OSF.DDA.OutlookAppOm.maxBodyLength,"htmlBody")};OSF.DDA.OutlookAppOm.$4Y=function(n){if(!Array.isInstanceOfType(n))throw Error.argument("attachments");};OSF.DDA.OutlookAppOm.$4W=function(n){if(!Object.isInstanceOfType(n))throw Error.argument("attachments");if(!("type"in n)||!("name"in n))throw Error.argument("attachments");if(!("url"in n||"itemId"in n))throw Error.argument("attachments");};OSF.DDA.OutlookAppOm.$2o=function(n){var t=null;if(n.type==="file"){var u=n.url;var f=n.name;OSF.DDA.OutlookAppOm.$4Z(u,f);t=OSF.DDA.OutlookAppOm.$2s(u,f)}else if(n.type==="item"){var i=n.itemId;var r=n.name;OSF.DDA.OutlookAppOm.$4X(i,r);t=OSF.DDA.OutlookAppOm.$2t(i,r)}else throw Error.argument("attachments");return t};OSF.DDA.OutlookAppOm.$2s=function(n,t){return["file",t,n]};OSF.DDA.OutlookAppOm.$2t=function(n,t){return["item",t,n]};OSF.DDA.OutlookAppOm.$4Z=function(n,t){if(!String.isInstanceOfType(n)||!String.isInstanceOfType(t))throw Error.argument("attachments");if(n.length>2048)throw Error.argumentOutOfRange("attachments",n.length,_u.ExtensibilityStrings.l_AttachmentUrlTooLong_Text);OSF.DDA.OutlookAppOm.$2d(t)};OSF.DDA.OutlookAppOm.$4X=function(n,t){if(!String.isInstanceOfType(n)||!String.isInstanceOfType(t))throw Error.argument("attachments");if(n.length>200)throw Error.argumentOutOfRange("attachments",n.length,_u.ExtensibilityStrings.l_AttachmentItemIdTooLong_Text);OSF.DDA.OutlookAppOm.$2d(t)};OSF.DDA.OutlookAppOm.$2d=function(n){if(n.length>255)throw Error.argumentOutOfRange("attachments",n.length,_u.ExtensibilityStrings.l_AttachmentNameTooLong_Text);};OSF.DDA.OutlookAppOm.$P=function(n,t,i){if(Object.getType(n)!==t)throw Error.argumentType(i);};OSF.DDA.OutlookAppOm.$1n=function(n,t,i,r){if(!$h.ScriptHelpers.isNullOrUndefined(n)){OSF.DDA.OutlookAppOm.$P(n,String,r);var u=n;OSF.DDA.OutlookAppOm.$A(u.length,t,i,r)}};OSF.DDA.OutlookAppOm.$2n=function(n,t){var i=null;switch(n){case 1:case 2:case 12:case 3:case 14:case 18:case 26:break;case 4:var r=JSON.stringify(t.customProperties);i=[r];break;case 5:i=[t.body];break;case 8:case 9:i=[t.itemId];break;case 7:i=[OSF.DDA.OutlookAppOm.$18(t.requiredAttendees),OSF.DDA.OutlookAppOm.$18(t.optionalAttendees),t.start,t.end,t.location,OSF.DDA.OutlookAppOm.$18(t.resources),t.subject,t.body];break;case 11:case 10:i=[t.htmlBody];break;case 31:case 30:i=[t.htmlBody,t.attachments];break;case 23:case 13:case 29:i=[t.data,t.coercionType];break;case 28:i=[t.coercionType];break;case 17:i=[t.subject];break;case 15:i=[t.recipientField];break;case 22:case 21:i=[t.recipientField,OSF.DDA.OutlookAppOm.$2l(t.recipientArray)];break;case 19:i=[t.itemId,t.name];break;case 16:i=[t.uri,t.name];break;case 20:i=[t.attachmentIndex];break;case 25:i=[t.TimeProperty,t.time];break;case 24:i=[t.TimeProperty];break;case 27:i=[t.location];break;default:break}return i};OSF.DDA.OutlookAppOm.$18=function(n){return n?n.join(";"):null};OSF.DDA.OutlookAppOm.$2l=function(n){if(!n)return null;for(var i=new Array(n.length),t=0;t<n.length;t++)i[t]=[n[t].address,n[t].name];return i};OSF.DDA.OutlookAppOm.$2f=function(n,t){if($h.ScriptHelpers.isNullOrUndefined(n))return null;OSF.DDA.OutlookAppOm.$P(n,Array,t);var r=n;var u=null;var f=!1;OSF.DDA.OutlookAppOm.$A(r.length,0,OSF.DDA.OutlookAppOm.$2S,String.format("{0}.length",t));for(var e=0;e<r.length;e++)if($h.EmailAddressDetails.isInstanceOfType(r[e])){f=!0;break}f&&(u=[]);for(var i=0;i<r.length;i++)if(f){u[i]=$h.EmailAddressDetails.isInstanceOfType(r[i])?r[i].emailAddress:r[i];OSF.DDA.OutlookAppOm.$P(u[i],String,String.format("{0}[{1}]",t,i))}else OSF.DDA.OutlookAppOm.$P(r[i],String,String.format("{0}[{1}]",t,i));return u};OSF.DDA.OutlookAppOm.prototype={$6_0:null,$I_0:null,$1m_0:null,$1F_0:null,$V_0:null,$14_0:null,$S_0:null,get_clientEndPoint:function(){this.$S_0||(this.$S_0=OSF._OfficeAppFactory.getClientEndPoint());return this.$S_0},set_clientEndPoint:function(n){this.$S_0=n;return n},get_initialData:function(){return this.$6_0},get_$13_0:function(){return this.$V_0.get_appName()},initialize:function(n){var t="itemType";this.$6_0=new $h.InitialData(n);1===n[t]?this.$I_0=new $h.Message(this.$6_0):3===n[t]?this.$I_0=new $h.MeetingRequest(this.$6_0):2===n[t]?this.$I_0=new $h.Appointment(this.$6_0):4===n[t]?this.$I_0=new $h.MessageCompose(this.$6_0):5===n[t]&&(this.$I_0=new $h.AppointmentCompose(this.$6_0));this.$1m_0=new $h.UserProfile(this.$6_0);this.$1F_0=new $h.Diagnostics(this.$6_0,this.$V_0.get_appName());this.$4F_0();$h.InitialData.$1(this,"item",this.$$d_$3t_0);$h.InitialData.$1(this,"userProfile",this.$$d_$4C_0);$h.InitialData.$1(this,"diagnostics",this.$$d_$3i_0);$h.InitialData.$1(this,"ewsUrl",this.$$d_$3k_0);OSF.DDA.OutlookAppOm.$2.get_$13_0()===64&&this.$6_0.get_$4L_0()&&(window.open=this.$$d_windowOpenOverrideHandler)},windowOpenOverrideHandler:function(n,t,i,r){this.$E_0(0,"LaunchPalUrl",{launchUrl:n},null)},makeEwsRequestAsync:function(n){for(var r=[],i=1;i<arguments.length;++i)r[i-1]=arguments[i];if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("data");if(n.length>OSF.DDA.OutlookAppOm.$2Q)throw Error.argument("data",_u.ExtensibilityStrings.l_EwsRequestOversized_Text);this.$5_0(3,"makeEwsRequestAsync");var u=$h.CommonParameters.parse(r,!0,!0);var t=new $h.EwsRequest(u.$4_0);var f=this;t.onreadystatechange=function(){4===t.get_$1c_1()&&u.$3_0(t.$R_0)};t.send(n)},recordDataPoint:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("data");this.$E_0(0,"RecordDataPoint",n,null)},recordTrace:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("data");this.$E_0(0,"RecordTrace",n,null)},trackCtq:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("data");this.$E_0(0,"TrackCtq",n,null)},convertToLocalClientTime:function(n){var t=new Date(n.getTime());var i=t.getTimezoneOffset()*-1;if(this.$6_0&&this.$6_0.get_$1i_0()){t.setUTCMinutes(t.getUTCMinutes()-i);i=this.$22_0(t);t.setUTCMinutes(t.getUTCMinutes()+i)}var r=this.$1D_0(t);r.timezoneOffset=i;return r},convertToUtcClientTime:function(n){var t=this.$33_0(n);if(this.$6_0&&this.$6_0.get_$1i_0()){var i=this.$22_0(t);t.setUTCMinutes(t.getUTCMinutes()-i);i=n.timezoneOffset?n.timezoneOffset:t.getTimezoneOffset()*-1;t.setUTCMinutes(t.getUTCMinutes()+i)}return t},getUserIdentityTokenAsync:function(){for(var i=[],n=0;n<arguments.length;++n)i[n]=arguments[n];this.$5_0(1,"getUserIdentityTokenAsync");var t=$h.CommonParameters.parse(i,!0,!0);this.$2N_0(2,"GetUserIdentityToken",t.$3_0,t.$4_0)},getCallbackTokenAsync:function(){for(var i=[],n=0;n<arguments.length;++n)i[n]=arguments[n];this.$5_0(1,"getCallbackTokenAsync");var t=$h.CommonParameters.parse(i,!0,!0);this.$2N_0(12,"GetCallbackToken",t.$3_0,t.$4_0)},displayMessageForm:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("itemId");this.$E_0(8,"DisplayExistingMessageForm",{itemId:n},null)},displayAppointmentForm:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("itemId");this.$E_0(9,"DisplayExistingAppointmentForm",{itemId:n},null)},createAsyncResult:function(n,t,i,r){var f={};var u=null;f[OSF.DDA.AsyncResultEnum.Properties.Value]=n;f[OSF.DDA.AsyncResultEnum.Properties.Context]=r;if(0!==t){u={};u[OSF.DDA.AsyncResultEnum.ErrorProperties.Name]=t;u[OSF.DDA.AsyncResultEnum.ErrorProperties.Message]=i}return new OSF.DDA.AsyncResult(f,u)},standardCreateAsyncResult:function(n,t,i,r){var f={};var u=null;f[OSF.DDA.AsyncResultEnum.Properties.Value]=n;f[OSF.DDA.AsyncResultEnum.Properties.Context]=r;if(0!==t){u={};var e=$h.OutlookErrorManager.getErrorArgs(i);u[OSF.DDA.AsyncResultEnum.ErrorProperties.Name]=e.name;u[OSF.DDA.AsyncResultEnum.ErrorProperties.Message]=e.message;u[OSF.DDA.AsyncResultEnum.ErrorProperties.Code]=i}return new OSF.DDA.AsyncResult(f,u)},$5_0:function(n,t){if(this.$6_0.$C_0<n)throw Error.create(String.format(_u.ExtensibilityStrings.l_ElevatedPermissionNeededForMethod_Text,t));},$1z_0:function(n){this.$20_0(n,!1)},$1y_0:function(n){this.$20_0(n,!0)},$20_0:function(n,t){if(String.isInstanceOfType(n))this.$35_0(n,t);else if(Object.isInstanceOfType(n)&&Object.getTypeName(n)==="Object"){var i={};i=$.extend(!0,i,n);this.$36_0(i,t)}else throw Error.argumentType();},$35_0:function(n,t){$h.ScriptHelpers.isNullOrUndefined(n)||OSF.DDA.OutlookAppOm.$A(n.length,0,OSF.DDA.OutlookAppOm.maxBodyLength,"htmlBody");this.$E_0(t?11:10,t?"DisplayReplyAllForm":"DisplayReplyForm",{htmlBody:n},null)},$36_0:function(n,t){var u=OSF.DDA.OutlookAppOm.$3o(n);var r=OSF.DDA.OutlookAppOm.$2B(n);var i=$h.CommonParameters.parse(OSF.DDA.OutlookAppOm.$3y(n),!1);var f=this;this.$8_0(t?31:30,t?"DisplayReplyAllForm":"DisplayReplyForm",{htmlBody:u,attachments:OSF.DDA.OutlookAppOm.$2q(r)},function(n){return n},i.$4_0,i.$3_0)},$8_0:function(n,t,i,r,u,f){var e=this;this.$E_0(n,t,i,function(n,t){if(f){var o=null;if(Object.isInstanceOfType(t)){var i=t;if("error"in i||"data"in i||"errorCode"in i)if(i.error){var s=i.errorCode;o=e.standardCreateAsyncResult(null,1,s,u)}else{var h=r?r(i.data):i.data;o=e.standardCreateAsyncResult(h,0,0,u)}}!o&&n&&(o=e.standardCreateAsyncResult(null,1,9002,u));f(o)}})},$E_0:function(n,t,i,r){if(64===this.$V_0.get_appName())this.get_clientEndPoint().invoke(t,r,i);else if(n){var u=OSF.DDA.OutlookAppOm.$2n(n,i);var f=this;window.external.execute(n,u,function(n,t){if(r){var f=n.toArray();var u=JSON.parse(f[0]);if(Object.isInstanceOfType(u)){var i=u;if(f.length>1&&f[1]){i.error=!0;i.errorCode=f[1]}else i.error=!1;r(t,i)}else if(Number.isInstanceOfType(u)){var e={};e.error=!0;e.errorCode=u;r(t,e)}else throw Error.notImplemented("Return data type from host must be Dictionary or int");}})}else r&&r(-2,null)},$33_0:function(n){var t=new Date(n.year,n.month,n.date,n.hours,n.minutes,n.seconds,n.milliseconds?n.milliseconds:0);if(isNaN(t.getTime()))throw Error.format(_u.ExtensibilityStrings.l_InvalidDate_Text);return t},$1D_0:function(n){var t={};t.month=n.getMonth();t.date=n.getDate();t.year=n.getFullYear();t.hours=n.getHours();t.minutes=n.getMinutes();t.seconds=n.getSeconds();t.milliseconds=n.getMilliseconds();return t},$34_0:function(n){var u=OSF.DDA.OutlookAppOm.$2f(n.requiredAttendees,"requiredAttendees");var r=OSF.DDA.OutlookAppOm.$2f(n.optionalAttendees,"optionalAttendees");OSF.DDA.OutlookAppOm.$1n(n.location,0,OSF.DDA.OutlookAppOm.$2R,"location");OSF.DDA.OutlookAppOm.$1n(n.body,0,OSF.DDA.OutlookAppOm.maxBodyLength,"body");OSF.DDA.OutlookAppOm.$1n(n.subject,0,OSF.DDA.OutlookAppOm.$2T,"subject");if(!$h.ScriptHelpers.isNullOrUndefined(n.start)){OSF.DDA.OutlookAppOm.$P(n.start,Date,"start");var o=n.start;n.start=o.getTime();if(!$h.ScriptHelpers.isNullOrUndefined(n.end)){OSF.DDA.OutlookAppOm.$P(n.end,Date,"end");var i=n.end;if(i<o)throw Error.argumentOutOfRange("end",i,_u.ExtensibilityStrings.l_InvalidEventDates_Text);n.end=i.getTime()}}var t=null;if(u||r){t={};var s=n;for(var f in s){var e={key:f,value:s[f]};t[e.key]=e.value}u&&(t.requiredAttendees=u);r&&(t.optionalAttendees=r)}this.$E_0(7,"DisplayNewAppointmentForm",t||n,null)},$4F_0:function(){var n=this;$h.Item.isInstanceOfType(this.$I_0)&&(n.displayNewAppointmentForm=this.$$d_$34_0)},$3q_0:function(n,t){if(!n){this.initialize(t);this.displayName="mailbox";window.setTimeout(this.$$d_$2i_0,0)}},$2i_0:function(){this.$14_0()},$2N_0:function(n,t,i,r){if($h.ScriptHelpers.isNullOrUndefined(i))throw Error.argumentNull("callback");var u=this;this.$E_0(n,t,null,function(n,t){var f;if(n)f=u.createAsyncResult(null,1,String.format(_u.ExtensibilityStrings.l_InternalProtocolError_Text,n),r);else{var e=t;f=e.wasSuccessful?u.createAsyncResult(e.token,0,null,r):u.createAsyncResult(null,1,e.errorMessage,r)}i(f)})},$3t_0:function(){return this.$I_0},$4C_0:function(){OSF.DDA.OutlookAppOm.$N(this.$6_0.$C_0);return this.$1m_0},$3i_0:function(){return this.$1F_0},$3k_0:function(){OSF.DDA.OutlookAppOm.$N(this.$6_0.$C_0);return this.$6_0.get_$38_0()},$22_0:function(n){for(var r=this.$6_0.get_$1i_0(),i=0;i<r.length;i++){var t=r[i];var f=parseInt(t.start);var u=parseInt(t.end);if(n.getTime()-f>=0&&n.getTime()-u<0)return parseInt(t.offset)}throw Error.format(_u.ExtensibilityStrings.l_InvalidDate_Text);},$1p_0:function(){var n=!1;try{n=!$h.ScriptHelpers.isNullOrUndefined(_u.ExtensibilityStrings.l_EwsRequestOversized_Text)}catch(t){}return n},$4J_0:function(n){for(var s=null,l="",a=document.getElementsByTagName("script"),o=a.length-1;o>=0;o--){var i=null;var v=a[o].attributes;if(v){var p=v.getNamedItem("src");p&&(i=p.value);if(i){var y=!1;i=i.toLowerCase();var f=i.indexOf("office_strings.js");if(f<0){f=i.indexOf("office_strings.debug.js");y=!0}if(f>0&&f<i.length){s=i.replace(y?"office_strings.debug.js":"office_strings.js","outlook_strings.js");var r=i.substring(0,f);var u=r.lastIndexOf("/",r.length-2);u===-1&&(u=r.lastIndexOf("\\",r.length-2));u!==-1&&r.length>u+1&&(l=r.substring(0,u+1));break}}}}if(s){var h=document.getElementsByTagName("head")[0];var t=null;var b=this;var e=function(){if(n&&(!t.readyState||t.readyState&&(t.readyState==="loaded"||t.readyState==="complete"))){t.onload=null;t.onreadystatechange=null;n()