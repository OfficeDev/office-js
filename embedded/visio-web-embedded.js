/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/

/*
	Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.
*/

/*
* @overview es6-promise - a tiny implementation of Promises/A+.
* @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
* @license   Licensed under MIT license
*            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
* @version   2.3.0
*/


// Sources:
// osfweb: none
// runtime: 16.0.12510.30004
// core: 16.0\12520.10000
// host: visio 16.0.12521.34950

var __extends=this&&this.__extends||function(){var a=function(c,b){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(c,a){for(var b in a)if(a.hasOwnProperty(b))c[b]=a[b]};return a(c,b)};return function(c,b){a(c,b);function d(){this.constructor=c}c.prototype=b===null?Object.create(b):(d.prototype=b.prototype,new d)}}(),OfficeExtension;(function(a){var b;(function(a){a.OfficeRequire=function(){return null}()})(b=a._Internal||(a._Internal={}));(function(a){var b;(function(b){function c(){return function(){"use strict";function M(a){return typeof a==="function"||typeof a==="object"&&a!==null}function u(a){return typeof a==="function"}function P(a){return typeof a==="object"&&a!==null}var v;if(!Array.isArray)v=function(a){return Object.prototype.toString.call(a)==="[object Array]"};else v=Array.isArray;var z=v,n=0,lb={}.toString,fb,s,h=function(a,b){m[n]=a;m[n+1]=b;n+=2;if(n===2)if(s)s(l);else q()};function Y(a){s=a}function hb(a){h=a}var T=typeof window!=="undefined"?window:undefined,y=T||{},C=y.MutationObserver||y.WebKitMutationObserver,ib=typeof process!=="undefined"&&{}.toString.call(process)==="[object process]",gb=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function ab(){var b=process.nextTick,a=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);if(Array.isArray(a)&&a[1]==="0"&&a[2]==="10")b=window.setImmediate;return function(){b(l)}}function kb(){return function(){fb(l)}}function jb(){var a=0,c=new C(l),b=document.createTextNode("");c.observe(b,{characterData:true});return function(){b.data=a=++a%2}}function K(){var a=new MessageChannel;a.port1.onmessage=l;return function(){a.port2.postMessage(0)}}function U(){return function(){setTimeout(l,1)}}var m=new Array(1e3);function l(){for(var a=0;a<n;a+=2){var b=m[a],c=m[a+1];b(c);m[a]=undefined;m[a+1]=undefined}n=0}var q;if(ib)q=ab();else if(gb)q=K();else q=U();function k(){}var g=void 0,i=1,f=2,o=new x;function G(){return new TypeError("You cannot resolve a promise with itself")}function H(){return new TypeError("A promises callback cannot return that same promise.")}function W(a){try{return a.then}catch(b){o.error=b;return o}}function X(d,c,a,b){try{d.call(c,a,b)}catch(e){return e}}function A(c,a,e){h(function(f){var c=false,g=X(e,a,function(b){if(c)return;c=true;if(a!==b)j(f,b);else d(f,b)},function(a){if(c)return;c=true;b(f,a)},"Settle: "+(f._label||" unknown promise"));if(!c&&g){c=true;b(f,g)}},c)}function D(c,a){if(a._state===i)d(c,a._result);else if(a._state===f)b(c,a._result);else p(a,undefined,function(a){j(c,a)},function(a){b(c,a)})}function B(c,a){if(a.constructor===c.constructor)D(c,a);else{var e=W(a);if(e===o)b(c,o.error);else if(e===undefined)d(c,a);else if(u(e))A(c,a,e);else d(c,a)}}function j(a,c){if(a===c)b(a,G());else if(M(c))B(a,c);else d(a,c)}function F(a){a._onerror&&a._onerror(a._result);t(a)}function d(a,b){if(a._state!==g)return;a._result=b;a._state=i;a._subscribers.length!==0&&h(t,a)}function b(a,b){if(a._state!==g)return;a._state=f;a._result=b;h(F,a)}function p(c,g,d,e){var a=c._subscribers,b=a.length;c._onerror=null;a[b]=g;a[b+i]=d;a[b+f]=e;b===0&&c._state&&h(t,c)}function t(b){var a=b._subscribers,f=b._state;if(a.length===0)return;for(var e,d,g=b._result,c=0;c<a.length;c+=3){e=a[c];d=a[c+f];if(e)w(f,e,d,g);else d(g)}b._subscribers.length=0}function x(){this.error=null}var r=new x;function S(a,b){try{return a(b)}catch(c){r.error=c;return r}}function w(l,c,k,m){var h=u(k),a,o,e,n;if(h){a=S(k,m);if(a===r){n=true;o=a.error;a=null}else e=true;if(c===a){b(c,H());return}}else{a=m;e=true}if(c._state===g)if(h&&e)j(c,a);else if(n)b(c,o);else if(l===i)d(c,a);else l===f&&b(c,a)}function E(a,c){try{c(function(b){j(a,b)},function(c){b(a,c)})}catch(d){b(a,d)}}function e(e,c){var a=this;a._instanceConstructor=e;a.promise=new e(k);if(a._validateInput(c)){a._input=c;a.length=c.length;a._remaining=c.length;a._init();if(a.length===0)d(a.promise,a._result);else{a.length=a.length||0;a._enumerate();a._remaining===0&&d(a.promise,a._result)}}else b(a.promise,a._validationError())}e.prototype._validateInput=function(a){return z(a)};e.prototype._validationError=function(){return new a.Error("Array Methods must be provided an Array")};e.prototype._init=function(){this._result=new Array(this.length)};var V=e;e.prototype._enumerate=function(){for(var a=this,d=a.length,c=a.promise,e=a._input,b=0;c._state===g&&b<d;b++)a._eachEntry(e[b],b)};e.prototype._eachEntry=function(a,c){var b=this,d=b._instanceConstructor;if(P(a))if(a.constructor===d&&a._state!==g){a._onerror=null;b._settledAt(a._state,c,a._result)}else b._willSettleAt(d.resolve(a),c);else{b._remaining--;b._result[c]=a}};e.prototype._settledAt=function(h,i,e){var a=this,c=a.promise;if(c._state===g){a._remaining--;if(h===f)b(c,e);else a._result[i]=e}a._remaining===0&&d(c,a._result)};e.prototype._willSettleAt=function(c,b){var a=this;p(c,undefined,function(c){a._settledAt(i,b,c)},function(c){a._settledAt(f,b,c)})};function eb(a){return new V(this,a).promise}var R=eb;function Z(c){var e=this,a=new e(k);if(!z(c)){b(a,new TypeError("You must pass an array to race."));return a}var i=c.length;function f(b){j(a,b)}function h(c){b(a,c)}for(var d=0;a._state===g&&d<i;d++)p(e.resolve(c[d]),undefined,f,h);return a}var Q=Z;function J(a){var b=this;if(a&&typeof a==="object"&&a.constructor===b)return a;var c=new b(k);j(c,a);return c}var I=J;function O(d){var c=this,a=new c(k);b(a,d);return a}var L=O,cb=0;function N(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}function bb(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}var db=c;function c(a){this._id=cb++;this._state=undefined;this._result=undefined;this._subscribers=[];if(k!==a){!u(a)&&N();!(this instanceof c)&&bb();E(this,a)}}c.all=R;c.race=Q;c.resolve=I;c.reject=L;c._setScheduler=Y;c._setAsap=hb;c._asap=h;c.prototype={constructor:c,then:function(d,e){var b=this,a=b._state;if(a===i&&!d||a===f&&!e)return this;var c=new this.constructor(k),j=b._result;if(a){var g=arguments[a-1];h(function(){w(a,c,g,j)})}else p(b,c,d,e);return c},"catch":function(a){return this.then(null,a)}};return db}.call(this)}b.Init=c})(b=a.PromiseImpl||(a.PromiseImpl={}))})(b=a._Internal||(a._Internal={}));(function(a){function c(){var a=window.navigator.userAgent,b=a.indexOf("Edge/");if(b>=0){a=a.substring(b+5,a.length);if(a<"14.14393")return true;else return false}return false}function b(){if(typeof window==="undefined"&&typeof Promise==="function")return Promise;if(typeof window!=="undefined"&&window.Promise)if(c())return a.PromiseImpl.Init();else return window.Promise;else return a.PromiseImpl.Init()}a.OfficePromise=b()})(b=a._Internal||(a._Internal={}));var c=b.OfficePromise;a.Promise=c})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(c){var s=function(){function b(){}b.prototype._resolveRequestUrlAndHeaderInfo=function(){return a._createPromiseFromResult(null)};b.prototype._createRequestExecutorOrNull=function(){return null};Object.defineProperty(b.prototype,"eventRegistration",{"get":function(){return null},enumerable:true,configurable:true});return b}();c.SessionBase=s;var G=function(){function b(){}b.setCustomSendRequestFunc=function(a){b.s_customSendRequestFunc=a};b.xhrSendRequestFunc=function(b){return a.createPromise(function(f,h){var c=new XMLHttpRequest;c.open(b.method,b.url);c.onload=function(){var b={statusCode:c.status,headers:a._parseHttpResponseHeaders(c.getAllResponseHeaders()),body:c.responseText};f(b)};c.onerror=function(){h(new d.RuntimeError({code:g.connectionFailure,message:a._getResourceString(i.connectionFailureWithStatus,c.statusText)}))};if(b.headers)for(var e in b.headers)c.setRequestHeader(e,b.headers[e]);c.send(a._getRequestBodyText(b))})};b.sendRequest=function(c){b.validateAndNormalizeRequest(c);var a=b.s_customSendRequestFunc;if(!a)a=b.xhrSendRequestFunc;return a(c)};b.setCustomSendLocalDocumentRequestFunc=function(a){b.s_customSendLocalDocumentRequestFunc=a};b.sendLocalDocumentRequest=function(a){b.validateAndNormalizeRequest(a);var c;c=b.s_customSendLocalDocumentRequestFunc||b.officeJsSendLocalDocumentRequestFunc;return c(a)};b.officeJsSendLocalDocumentRequestFunc=function(b){b=a._validateLocalDocumentRequest(b);var c=a._buildRequestMessageSafeArray(b);return a.createPromise(function(b,d){OSF.DDA.RichApi.executeRichApiRequestAsync(c,function(c){var d;if(c.status=="succeeded")d={statusCode:k.getResponseStatusCode(c),headers:k.getResponseHeaders(c),body:k.getResponseBody(c)};else d=k.buildHttpResponseFromOfficeJsError(c.error.code,c.error.message);a.log("Response:");a.log(JSON.stringify(d));b(d)})})};b.validateAndNormalizeRequest=function(b){if(a.isNullOrUndefined(b))throw d.RuntimeError._createInvalidArgError({argumentName:"request"});if(a.isNullOrEmptyString(b.method))b.method="GET";b.method=b.method.toUpperCase()};b.logRequest=function(c){if(a._logEnabled){a.log("---HTTP Request---");a.log(c.method+" "+c.url);if(c.headers)for(var d in c.headers)a.log(d+": "+c.headers[d]);b._logBodyEnabled&&a.log(a._getRequestBodyText(c))}};b.logResponse=function(c){if(a._logEnabled){a.log("---HTTP Response---");a.log(""+c.statusCode);if(c.headers)for(var d in c.headers)a.log(d+": "+c.headers[d]);b._logBodyEnabled&&a.log(c.body)}};b._logBodyEnabled=false;return b}();c.HttpUtility=G;var v=function(){function b(a){var b=this;this.m_bridge=a;this.m_promiseResolver={};this.m_handlers=[];this.m_bridge.onMessageFromHost=function(f){var e=JSON.parse(f);if(e.type==3){var c=e.message;if(c&&c.entries)for(var d=0;d<c.entries.length;d++){var a=c.entries[d];if(Array.isArray(a)){var g={messageCategory:a[0],messageType:a[1],targetId:a[2],message:a[3],id:a[4]};c.entries[d]=g}}}b.dispatchMessage(e)}}b.init=function(d){if(typeof d!=="object"||!d)return;var c=new b(d);b.s_instance=c;G.setCustomSendLocalDocumentRequestFunc(function(d){d=a._validateLocalDocumentRequest(d);var e=0;if(!a.isReadonlyRestRequest(d.method))e=1;var g=d.url.indexOf("?");if(g>=0){var i=d.url.substr(g+1),f=a._parseRequestFlagsAndCustomDataFromQueryStringIfAny(i);if(f.flags>=0)e=f.flags}var h={id:b.nextId(),type:1,flags:e,message:d};return c.sendMessageToHostAndExpectResponse(h).then(function(a){var b=a.message;return b})});for(var e=0;e<b.s_onInitedHandlers.length;e++)b.s_onInitedHandlers[e](c)};Object.defineProperty(b,"instance",{"get":function(){return b.s_instance},enumerable:true,configurable:true});b.prototype.sendMessageToHost=function(a){this.m_bridge.sendMessageToHost(JSON.stringify(a))};b.prototype.sendMessageToHostAndExpectResponse=function(b){var c=this,d=a.createPromise(function(a,d){c.m_promiseResolver[b.id]=a});this.m_bridge.sendMessageToHost(JSON.stringify(b));return d};b.prototype.addHostMessageHandler=function(a){this.m_handlers.push(a)};b.prototype.removeHostMessageHandler=function(b){var a=this.m_handlers.indexOf(b);a>=0&&this.m_handlers.splice(a,1)};b.onInited=function(a){b.s_onInitedHandlers.push(a);b.s_instance&&a(b.s_instance)};b.prototype.dispatchMessage=function(a){if(typeof a.id==="number"){var c=this.m_promiseResolver[a.id];if(c){c(a);delete this.m_promiseResolver[a.id];return}}for(var b=0;b<this.m_handlers.length;b++)this.m_handlers[b](a)};b.nextId=function(){return b.s_nextId++};b.s_onInitedHandlers=[];b.s_nextId=1;return b}();c.HostBridge=v;typeof _richApiNativeBridge==="object"&&_richApiNativeBridge&&v.init(_richApiNativeBridge);var d;(function(b){var c=function(d){__extends(c,d);function c(a){var b=d.call(this,typeof a==="string"?a:a.message)||this;Object.setPrototypeOf(b,c.prototype);b.name="RichApi.Error";if(typeof a==="string")b.message=a;else{b.code=a.code;b.message=a.message;b.traceMessages=a.traceMessages||[];b.innerError=a.innerError||null;b.debugInfo=b._createDebugInfo(a.debugInfo||{})}return b}c.prototype.toString=function(){return this.code+": "+this.message};c.prototype._createDebugInfo=function(c){var a={code:this.code,message:this.message};a.toString=function(){return JSON.stringify(this)};for(var d in c)a[d]=c[d];if(this.innerError)if(this.innerError instanceof b.RuntimeError)a.innerError=this.innerError.debugInfo;else a.innerError=this.innerError;return a};c._createInvalidArgError=function(c){return new b.RuntimeError({code:g.invalidArgument,message:a.isNullOrEmptyString(c.argumentName)?a._getResourceString(i.invalidArgumentGeneric):a._getResourceString(i.invalidArgument,c.argumentName),debugInfo:c.errorLocation?{errorLocation:c.errorLocation}:{},innerError:c.innerError})};return c}(Error);b.RuntimeError=c})(d=c._Internal||(c._Internal={}));c.Error=d.RuntimeError;var g=function(){function a(){}a.apiNotFound="ApiNotFound";a.accessDenied="AccessDenied";a.generalException="GeneralException";a.activityLimitReached="ActivityLimitReached";a.invalidArgument="InvalidArgument";a.connectionFailure="ConnectionFailure";a.timeout="Timeout";a.invalidOrTimedOutSession="InvalidOrTimedOutSession";a.invalidObjectPath="InvalidObjectPath";a.invalidRequestContext="InvalidRequestContext";a.valueNotLoaded="ValueNotLoaded";return a}();c.CoreErrorCodes=g;var i=function(){function a(){}a.apiNotFoundDetails="ApiNotFoundDetails";a.connectionFailureWithStatus="ConnectionFailureWithStatus";a.connectionFailureWithDetails="ConnectionFailureWithDetails";a.invalidArgument="InvalidArgument";a.invalidArgumentGeneric="InvalidArgumentGeneric";a.timeout="Timeout";a.invalidOrTimedOutSessionMessage="InvalidOrTimedOutSessionMessage";a.invalidObjectPath="InvalidObjectPath";a.invalidRequestContext="InvalidRequestContext";a.valueNotLoaded="ValueNotLoaded";return a}();c.CoreResourceStrings=i;var l=function(){function a(){}a.flags="flags";a.sourceLibHeader="SdkVersion";a.processQuery="ProcessQuery";a.localDocument="http://document.localhost/";a.localDocumentApiPrefix="http://document.localhost/_api/";a.customData="customdata";return a}();c.CoreConstants=l;var k=function(){function b(){}b.buildMessageArrayForIRequestExecutor=function(i,h,e,f){var d=JSON.stringify(e.Body);a.log("Request:");a.log(d);var c={};a._copyHeaders(e.Headers,c);c[l.sourceLibHeader]=f;var g=b.buildRequestMessageSafeArray(i,h,"POST",l.processQuery,c,d);return g};b.buildResponseOnSuccess=function(c,b){var a={ErrorCode:"",ErrorMessage:"",Headers:null,Body:null};a.Body=JSON.parse(c);a.Headers=b;return a};b.buildResponseOnError=function(d,e){var c={ErrorCode:"",ErrorMessage:"",Headers:null,Body:null};c.ErrorCode=g.generalException;c.ErrorMessage=e;if(d==b.OfficeJsErrorCode_ooeNoCapability)c.ErrorCode=g.accessDenied;else if(d==b.OfficeJsErrorCode_ooeActivityLimitReached)c.ErrorCode=g.activityLimitReached;else if(d==b.OfficeJsErrorCode_ooeInvalidOrTimedOutSession){c.ErrorCode=g.invalidOrTimedOutSession;c.ErrorMessage=a._getResourceString(i.invalidOrTimedOutSessionMessage)}return c};b.buildHttpResponseFromOfficeJsError=function(d,e){var c=500,a={};a.error={};a.error.code=g.generalException;a.error.message=e;if(d===b.OfficeJsErrorCode_ooeNoCapability){c=403;a.error.code=g.accessDenied}else if(d===b.OfficeJsErrorCode_ooeActivityLimitReached){c=429;a.error.code=g.activityLimitReached}return{statusCode:c,headers:{},body:JSON.stringify(a)}};b.buildRequestMessageSafeArray=function(g,f,j,l,b,k){var a=[];if(b)for(var c in b){a.push(c);a.push(b[c])}var e=0,i="",h="",d="";return[g,j,l,a,k,e,f,i,h,d]};b.getResponseBody=function(a){return b.getResponseBodyFromSafeArray(a.value.data)};b.getResponseHeaders=function(a){return b.getResponseHeadersFromSafeArray(a.value.data)};b.getResponseBodyFromSafeArray=function(b){var a=b[2];if(typeof a==="string")return a;var c=a;return c.join("")};b.getResponseHeadersFromSafeArray=function(d){var a=d[1];if(!a)return null;for(var c={},b=0;b<a.length-1;b+=2)c[a[b]]=a[b+1];return c};b.getResponseStatusCode=function(a){return b.getResponseStatusCodeFromSafeArray(a.value.data)};b.getResponseStatusCodeFromSafeArray=function(a){return a[0]};b.OfficeJsErrorCode_ooeInvalidOrTimedOutSession=5012;b.OfficeJsErrorCode_ooeActivityLimitReached=5102;b.OfficeJsErrorCode_ooeNoCapability=7e3;return b}();c.RichApiMessageUtility=k;(function(a){function b(){if(typeof Promise!=="undefined")return Promise;if(typeof Office!=="undefined")if(Office.Promise)return Office.Promise;if(typeof OfficeExtension!=="undefined")if(OfficeExtension.Promise)return OfficeExtension.Promise;throw new a.Error("No Promise implementation found");}a.getPromiseType=b})(d=c._Internal||(c._Internal={}));var a=function(){function a(){}a.log=function(b){a._logEnabled&&typeof console!=="undefined"&&console.log&&console.log(b)};a.checkArgumentNull=function(b,c){if(a.isNullOrUndefined(b))throw d.RuntimeError._createInvalidArgError({argumentName:c});};a.isNullOrUndefined=function(a){if(a===null)return true;if(typeof a==="undefined")return true;return false};a.isUndefined=function(a){if(typeof a==="undefined")return true;return false};a.isNullOrEmptyString=function(a){if(a===null)return true;if(typeof a==="undefined")return true;if(a.length==0)return true;return false};a.isPlainJsonObject=function(b){if(a.isNullOrUndefined(b))return false;if(typeof b!=="object")return false;if(Object.prototype.toString.apply(b)!=="[object Object]")return false;if(b.constructor&&!Object.prototype.hasOwnProperty.call(b,"constructor")&&!Object.prototype.hasOwnProperty.call(b.constructor.prototype,"hasOwnProperty"))return false;for(var c in b)if(!Object.prototype.hasOwnProperty.call(b,c))return false;return true};a.trim=function(a){return a.replace(new RegExp("^\\s+|\\s+$","g"),"")};a.caseInsensitiveCompareString=function(c,b){if(a.isNullOrUndefined(c))return a.isNullOrUndefined(b);else if(a.isNullOrUndefined(b))return false;else return c.toUpperCase()==b.toUpperCase()};a.isReadonlyRestRequest=function(b){return a.caseInsensitiveCompareString(b,"GET")};a._getResourceString=function(d,c){var b;if(typeof window!=="undefined"&&window.Strings&&window.Strings.OfficeOM){var f="L_"+d,e=window.Strings.OfficeOM[f];if(e)b=e}if(!b)b=a.s_resourceStringValues[d];if(!b)b=d;if(!a.isNullOrUndefined(c))if(Array.isArray(c)){var g=c;b=a._formatString(b,g)}else b=b.replace("{0}",c);return b};a._formatString=function(b,a){return b.replace(/\{\d\}/g,function(c){var b=parseInt(c.substr(1,c.length-2));if(b<a.length)return a[b];else throw d.RuntimeError._createInvalidArgError({argumentName:"format"});})};Object.defineProperty(a,"Promise",{"get":function(){return d.getPromiseType()},enumerable:true,configurable:true});a.createPromise=function(b){var c=new a.Promise(b);return c};a._createPromiseFromResult=function(b){return a.createPromise(function(a,c){a(b)})};a._createPromiseFromException=function(b){return a.createPromise(function(c,a){a(b)})};a._createTimeoutPromise=function(b){return a.createPromise(function(a,c){setTimeout(function(){a(null)},b)})};a._createInvalidArgError=function(a){return d.RuntimeError._createInvalidArgError(a)};a._isLocalDocumentUrl=function(b){return a._getLocalDocumentUrlPrefixLength(b)>0};a._getLocalDocumentUrlPrefixLength=function(d){for(var b=["http://document.localhost","https://document.localhost","//document.localhost"],c=d.toLowerCase().trim(),a=0;a<b.length;a++)if(c===b[a])return b[a].length;else if(c.substr(0,b[a].length+1)===b[a]+"/")return b[a].length+1;return 0};a._validateLocalDocumentRequest=function(b){var f=a._getLocalDocumentUrlPrefixLength(b.url);if(f<=0)throw d.RuntimeError._createInvalidArgError({argumentName:"request"});var c=b.url.substr(f),e=c.toLowerCase();if(e==="_api")c="";else if(e.substr(0,"_api/".length)==="_api/")c=c.substr("_api/".length);return{method:b.method,url:c,headers:b.headers,body:b.body}};a._parseRequestFlagsAndCustomDataFromQueryStringIfAny=function(f){for(var c={flags:-1,customData:""},e=f.split("&"),d=0;d<e.length;d++){var a=e[d].split("=");if(a[0].toLowerCase()===l.flags){var b=parseInt(a[1]);b=b&4095;c.flags=b}else if(a[0].toLowerCase()===l.customData)c.customData=decodeURIComponent(a[1])}return c};a._getRequestBodyText=function(a){var b="";if(typeof a.body==="string")b=a.body;else if(a.body&&typeof a.body==="object")b=JSON.stringify(a.body);return b};a._parseResponseBody=function(b){if(typeof b.body==="string"){var c=a.trim(b.body);return JSON.parse(c)}else return b.body};a._buildRequestMessageSafeArray=function(b){var d=0;if(!a.isReadonlyRestRequest(b.method))d=1;var e="";if(b.url.substr(0,l.processQuery.length).toLowerCase()===l.processQuery.toLowerCase()){var f=b.url.indexOf("?");if(f>0){var g=b.url.substr(f+1),c=a._parseRequestFlagsAndCustomDataFromQueryStringIfAny(g);if(c.flags>=0)d=c.flags;e=c.customData}}return k.buildRequestMessageSafeArray(e,d,b.method,b.url,b.headers,a._getRequestBodyText(b))};a._parseHttpResponseHeaders=function(g){var h={};if(!a.isNullOrEmptyString(g))for(var j=new RegExp("\x0d?\x0a"),i=g.split(j),f=0;f<i.length;f++){var b=i[f];if(b!=null){var c=b.indexOf(":");if(c>0){var e=b.substr(0,c),d=b.substr(c+1);e=a.trim(e);d=a.trim(d);h[e.toUpperCase()]=d}}}return h};a._parseErrorResponse=function(c){var b=null;if(a.isPlainJsonObject(c.body))b=c.body;else if(!a.isNullOrEmptyString(c.body)){var f=a.trim(c.body);try{b=JSON.parse(f)}catch(h){a.log("Error when parse "+f)}}var e,d;if(!a.isNullOrUndefined(b)&&typeof b==="object"&&b.error){d=b.error.code;e=a._getResourceString(i.connectionFailureWithDetails,[c.statusCode.toString(),b.error.code,b.error.message])}else e=a._getResourceString(i.connectionFailureWithStatus,c.statusCode.toString());if(a.isNullOrEmptyString(d))d=g.connectionFailure;return{errorCode:d,errorMessage:e}};a._copyHeaders=function(a,b){if(a&&b)for(var c in a)b[c]=a[c]};a.addResourceStringValues=function(b){for(var c in b)a.s_resourceStringValues[c]=b[c]};a._logEnabled=false;a.s_resourceStringValues={ApiNotFoundDetails:"The method or property {0} is part of the {1} requirement set, which is not available in your version of {2}.",ConnectionFailureWithStatus:"The request failed with status code of {0}.",ConnectionFailureWithDetails:"The request failed with status code of {0}, error code {1} and the following error message: {2}",InvalidArgument:"The argument '{0}' doesn't work for this situation, is missing, or isn't in the right format.",InvalidObjectPath:'The object path \'{0}\' isn\'t working for what you\'re trying to do. If you\'re using the object across multiple "context.sync" calls and outside the sequential execution of a ".run" batch, please use the "context.trackedObjects.add()" and "context.trackedObjects.remove()" methods to manage the object\'s lifetime.',InvalidRequestContext:"Cannot use the object across different request contexts.",Timeout:"The operation has timed out.",ValueNotLoaded:'The value of the result object has not been loaded yet. Before reading the value property, call "context.sync()" on the associated request context.'};return a}();c.CoreUtility=a;var A=function(){function a(){}a.setMock=function(b){a.s_isMock=b};a.isMock=function(){return a.s_isMock};return a}();c.TestUtility=A;c._internalConfig={showDisposeInfoInDebugInfo:false,showInternalApiInDebugInfo:false,enableEarlyDispose:true,alwaysPolyfillClientObjectUpdateMethod:false,alwaysPolyfillClientObjectRetrieveMethod:false,enableConcurrentFlag:true,enableUndoableFlag:true};c.config={extendedErrorLogging:false};var t=function(){function a(){}a.createSetPropertyAction=function(e,a,g,i,h){f.validateObjectPath(a);var d={Id:e._nextId(),ActionType:4,Name:g,ObjectPathId:a._objectPath.objectPathInfo.Id,ArgumentInfo:{}},j=[i],c=f.setMethodArguments(e,d.ArgumentInfo,j);f.validateReferencedObjectPaths(c);var b=new n(d,0,h);b.referencedObjectPath=a._objectPath;b.referencedArgumentObjectPaths=c;return a._addAction(b)};a.createQueryAction=function(g,a,d,c){f.validateObjectPath(a);var e={Id:g._nextId(),ActionType:2,Name:"",ObjectPathId:a._objectPath.objectPathInfo.Id,QueryInfo:d},b=new n(e,1,4);b.referencedObjectPath=a._objectPath;return a._addAction(b,c)};a.createQueryAsJsonAction=function(g,a,d,c){f.validateObjectPath(a);var e={Id:g._nextId(),ActionType:7,Name:"",ObjectPathId:a._objectPath.objectPathInfo.Id,QueryInfo:d},b=new n(e,1,4);b.referencedObjectPath=a._objectPath;return a._addAction(b,c)};a.createUpdateAction=function(e,a,c){f.validateObjectPath(a);var d={Id:e._nextId(),ActionType:9,Name:"",ObjectPathId:a._objectPath.objectPathInfo.Id,ObjectState:c},b=new n(d,0,0);b.referencedObjectPath=a._objectPath;return a._addAction(b)};return a}();c.CommonActionFactory=t;var z=function(){function b(a,b){this.m_contextBase=a;this.m_objectPath=b}Object.defineProperty(b.prototype,"_objectPath",{"get":function(){return this.m_objectPath},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_context",{"get":function(){return this.m_contextBase},enumerable:true,configurable:true});b.prototype._addAction=function(c,b){var d=this;if(b===void 0)b=null;return a.createPromise(function(a,e){d._context._addServiceApiAction(c,b,a,e)})};b.prototype._retrieve=function(e,b){var a=c._internalConfig.alwaysPolyfillClientObjectRetrieveMethod;if(!a)a=!f.isSetSupported("RichApiRuntime","1.1");var d=D._parseQueryOption(e);if(a)return t.createQueryAction(this._context,this,d,b);return t.createQueryAsJsonAction(this._context,this,d,b)};b.prototype._recursivelyUpdate=function(p){var n=c._internalConfig.alwaysPolyfillClientObjectUpdateMethod;if(!n)n=!f.isSetSupported("RichApiRuntime","1.2");try{var e=this[j.scalarPropertyNames];if(!e)e=[];var k=this[j.scalarPropertyUpdateable];if(!k){k=[];for(var h=0;h<e.length;h++)k.push(false)}var l=this[j.navigationPropertyNames];if(!l)l=[];var o={},m={},q=0;for(var b in p){var s=e.indexOf(b);if(s>=0){if(!k[s])throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(w.attemptingToSetReadOnlyProperty,b),debugInfo:{errorLocation:b}});o[b]=p[b];++q}else if(l.indexOf(b)>=0)m[b]=p[b];else throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(w.propertyDoesNotExist,b),debugInfo:{errorLocation:b}});}if(q>0)if(n)for(var h=0;h<e.length;h++){var b=e[h],r=o[b];!f.isUndefined(r)&&t.createSetPropertyAction(this._context,this,b,r)}else t.createUpdateAction(this._context,this,o);for(var b in m){var u=this[b],v=m[b];u._recursivelyUpdate(v)}}catch(x){throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(i.invalidArgument,"properties"),debugInfo:{errorLocation:this._className+".update"},innerError:x});}};return b}();c.ClientObjectBase=z;var n=function(){function a(b,a,c){this.m_actionInfo=b;this.m_operationType=a;this.m_flags=c}Object.defineProperty(a.prototype,"actionInfo",{"get":function(){return this.m_actionInfo},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"operationType",{"get":function(){return this.m_operationType},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"flags",{"get":function(){return this.m_flags},enumerable:true,configurable:true});return a}();c.Action=n;var m=function(){function b(c,b,e,a,d,f){this.m_objectPathInfo=c;this.m_parentObjectPath=b;this.m_isCollection=e;this.m_isInvalidAfterRequest=a;this.m_isValid=true;this.m_operationType=d;this.m_flags=f}Object.defineProperty(b.prototype,"id",{"get":function(){var a=this.m_objectPathInfo.ArgumentInfo;if(!a)return undefined;var b=a.Arguments;if(!b)return undefined;return b[0]},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"parent",{"get":function(){var a=this.m_parentObjectPath;if(!a)return undefined;return a},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"parentId",{"get":function(){return this.parent?this.parent.id:undefined},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"objectPathInfo",{"get":function(){return this.m_objectPathInfo},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"operationType",{"get":function(){return this.m_operationType},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"flags",{"get":function(){return this.m_flags},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"isCollection",{"get":function(){return this.m_isCollection},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"isInvalidAfterRequest",{"get":function(){return this.m_isInvalidAfterRequest},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"parentObjectPath",{"get":function(){return this.m_parentObjectPath},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"argumentObjectPaths",{"get":function(){return this.m_argumentObjectPaths},"set":function(a){this.m_argumentObjectPaths=a},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"isValid",{"get":function(){return this.m_isValid},"set":function(a){this.m_isValid=a;if(!a&&this.m_objectPathInfo.ObjectPathType===6&&this.m_savedObjectPathInfo){b.copyObjectPathInfo(this.m_savedObjectPathInfo.pathInfo,this.m_objectPathInfo);this.m_parentObjectPath=this.m_savedObjectPathInfo.parent;this.m_isValid=true;this.m_savedObjectPathInfo=null}},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"originalObjectPathInfo",{"get":function(){return this.m_originalObjectPathInfo},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"getByIdMethodName",{"get":function(){return this.m_getByIdMethodName},"set":function(a){this.m_getByIdMethodName=a},enumerable:true,configurable:true});b.prototype._updateAsNullObject=function(){this.resetForUpdateUsingObjectData();this.m_objectPathInfo.ObjectPathType=7;this.m_objectPathInfo.Name="";this.m_parentObjectPath=null};b.prototype.saveOriginalObjectPathInfo=function(){if(c.config.extendedErrorLogging&&!this.m_originalObjectPathInfo){this.m_originalObjectPathInfo={};b.copyObjectPathInfo(this.m_objectPathInfo,this.m_originalObjectPathInfo)}};b.prototype.updateUsingObjectData=function(i,c){var m=i[j.referenceId];if(!a.isNullOrEmptyString(m)){if(!this.m_savedObjectPathInfo&&!this.isInvalidAfterRequest&&b.isRestorableObjectPath(this.m_objectPathInfo.ObjectPathType)){var n={};b.copyObjectPathInfo(this.m_objectPathInfo,n);this.m_savedObjectPathInfo={pathInfo:n,parent:this.m_parentObjectPath}}this.saveOriginalObjectPathInfo();this.resetForUpdateUsingObjectData();this.m_objectPathInfo.ObjectPathType=6;this.m_objectPathInfo.Name=m;delete this.m_objectPathInfo.ParentObjectPathId;this.m_parentObjectPath=null;return}if(c){var l=c[j.collectionPropertyPath];if(!a.isNullOrEmptyString(l)&&c.context){var d=f.tryGetObjectIdFromLoadOrRetrieveResult(i);if(!a.isNullOrUndefined(d)){for(var g=l.split("."),h=c.context[g[0]],k=1;k<g.length;k++)h=h[g[k]];this.saveOriginalObjectPathInfo();this.resetForUpdateUsingObjectData();this.m_parentObjectPath=h._objectPath;this.m_objectPathInfo.ParentObjectPathId=this.m_parentObjectPath.objectPathInfo.Id;this.m_objectPathInfo.ObjectPathType=5;this.m_objectPathInfo.Name="";this.m_objectPathInfo.ArgumentInfo.Arguments=[d];return}}}var o=this.parentObjectPath&&this.parentObjectPath.isCollection,e=this.getByIdMethodName;if(o||!a.isNullOrEmptyString(e)){var d=f.tryGetObjectIdFromLoadOrRetrieveResult(i);if(!a.isNullOrUndefined(d)){this.saveOriginalObjectPathInfo();this.resetForUpdateUsingObjectData();if(!a.isNullOrEmptyString(e)){this.m_objectPathInfo.ObjectPathType=3;this.m_objectPathInfo.Name=e}else{this.m_objectPathInfo.ObjectPathType=5;this.m_objectPathInfo.Name=""}this.m_objectPathInfo.ArgumentInfo.Arguments=[d];return}}};b.prototype.resetForUpdateUsingObjectData=function(){this.m_isInvalidAfterRequest=false;this.m_isValid=true;this.m_operationType=1;this.m_flags=4;this.m_objectPathInfo.ArgumentInfo={};this.m_argumentObjectPaths=null;this.m_getByIdMethodName=null};b.isRestorableObjectPath=function(a){return a===1||a===5||a===3||a===4};b.copyObjectPathInfo=function(b,a){a.Id=b.Id;a.ArgumentInfo=b.ArgumentInfo;a.Name=b.Name;a.ObjectPathType=b.ObjectPathType;a.ParentObjectPathId=b.ParentObjectPathId};return b}();c.ObjectPath=m;var D=function(){function a(){this.m_nextId=0}a.prototype._nextId=function(){return++this.m_nextId};a.prototype._addServiceApiAction=function(c,a,b,d){if(!this.m_serviceApiQueue)this.m_serviceApiQueue=new ib(this);this.m_serviceApiQueue.add(c,a,b,d)};a._parseQueryOption=function(e){var c={};if(typeof e==="string"){var g=e;c.Select=f._parseSelectExpand(g)}else if(Array.isArray(e))c.Select=e;else if(typeof e==="object"){var b=e;if(a.isLoadOption(b)){if(typeof b.select==="string")c.Select=f._parseSelectExpand(b.select);else if(Array.isArray(b.select))c.Select=b.select;else if(!f.isNullOrUndefined(b.select))throw d.RuntimeError._createInvalidArgError({argumentName:"option.select"});if(typeof b.expand==="string")c.Expand=f._parseSelectExpand(b.expand);else if(Array.isArray(b.expand))c.Expand=b.expand;else if(!f.isNullOrUndefined(b.expand))throw d.RuntimeError._createInvalidArgError({argumentName:"option.expand"});if(typeof b.top==="number")c.Top=b.top;else if(!f.isNullOrUndefined(b.top))throw d.RuntimeError._createInvalidArgError({argumentName:"option.top"});if(typeof b.skip==="number")c.Skip=b.skip;else if(!f.isNullOrUndefined(b.skip))throw d.RuntimeError._createInvalidArgError({argumentName:"option.skip"});}else c=a.parseStrictLoadOption(e)}else if(!f.isNullOrUndefined(e))throw d.RuntimeError._createInvalidArgError({argumentName:"option"});return c};a.isLoadOption=function(a){if(!f.isUndefined(a.select)&&(typeof a.select==="string"||Array.isArray(a.select)))return true;if(!f.isUndefined(a.expand)&&(typeof a.expand==="string"||Array.isArray(a.expand)))return true;if(!f.isUndefined(a.top)&&typeof a.top==="number")return true;if(!f.isUndefined(a.skip)&&typeof a.skip==="number")return true;for(var b in a)return false;return true};a.parseStrictLoadOption=function(c){var b={Select:[]};a.parseStrictLoadOptionHelper(b,"","option",c);return b};a.combineQueryPath=function(a,b,c){if(a.length===0)return b;else return a+c+b};a.parseStrictLoadOptionHelper=function(g,e,f,h){for(var b in h){var c=h[b];if(b==="$all"){if(typeof c!=="boolean")throw d.RuntimeError._createInvalidArgError({argumentName:a.combineQueryPath(f,b,".")});c&&g.Select.push(a.combineQueryPath(e,"*","/"))}else if(b==="$top"){if(typeof c!=="number"||e.length>0)throw d.RuntimeError._createInvalidArgError({argumentName:a.combineQueryPath(f,b,".")});g.Top=c}else if(b==="$skip"){if(typeof c!=="number"||e.length>0)throw d.RuntimeError._createInvalidArgError({argumentName:a.combineQueryPath(f,b,".")});g.Skip=c}else if(typeof c==="boolean")c&&g.Select.push(a.combineQueryPath(e,b,"/"));else if(typeof c==="object")a.parseStrictLoadOptionHelper(g,a.combineQueryPath(e,b,"/"),a.combineQueryPath(f,b,"."),c);else throw d.RuntimeError._createInvalidArgError({argumentName:a.combineQueryPath(f,b,".")});}};return a}();c.ClientRequestContextBase=D;var U=function(){function b(a){this.m_objectPath=a}b.prototype._handleResult=function(b){if(a.isNullOrUndefined(b))this.m_objectPath._updateAsNullObject();else this.m_objectPath.updateUsingObjectData(b,null)};return b}(),K=function(){function b(a){this.m_contextBase=a;this.m_actions=[];this.m_actionResultHandler={};this.m_referencedObjectPaths={};this.m_instantiatedObjectPaths={};this.m_preSyncPromises=[]}b.prototype.addAction=function(a){this.m_actions.push(a);if(a.actionInfo.ActionType==1)this.m_instantiatedObjectPaths[a.actionInfo.ObjectPathId]=a};Object.defineProperty(b.prototype,"hasActions",{"get":function(){return this.m_actions.length>0},enumerable:true,configurable:true});b.prototype._getLastAction=function(){return this.m_actions[this.m_actions.length-1]};b.prototype.ensureInstantiateObjectPath=function(a){if(a){if(this.m_instantiatedObjectPaths[a.objectPathInfo.Id])return;this.ensureInstantiateObjectPath(a.parentObjectPath);this.ensureInstantiateObjectPaths(a.argumentObjectPaths);if(!this.m_instantiatedObjectPaths[a.objectPathInfo.Id]){var d={Id:this.m_contextBase._nextId(),ActionType:1,Name:"",ObjectPathId:a.objectPathInfo.Id},b=new n(d,1,4);b.referencedObjectPath=a;this.addReferencedObjectPath(a);this.addAction(b);var c=new U(a);this.addActionResultHandler(b,c)}}};b.prototype.ensureInstantiateObjectPaths=function(a){if(a)for(var b=0;b<a.length;b++)this.ensureInstantiateObjectPath(a[b])};b.prototype.addReferencedObjectPath=function(b){if(!b||this.m_referencedObjectPaths[b.objectPathInfo.Id])return;if(!b.isValid)throw new d.RuntimeError({code:g.invalidObjectPath,message:a._getResourceString(i.invalidObjectPath,f.getObjectPathExpression(b)),debugInfo:{errorLocation:f.getObjectPathExpression(b)}});while(b){this.m_referencedObjectPaths[b.objectPathInfo.Id]=b;b.objectPathInfo.ObjectPathType==3&&this.addReferencedObjectPaths(b.argumentObjectPaths);b=b.parentObjectPath}};b.prototype.addReferencedObjectPaths=function(a){if(a)for(var b=0;b<a.length;b++)this.addReferencedObjectPath(a[b])};b.prototype.addActionResultHandler=function(b,a){this.m_actionResultHandler[b.actionInfo.Id]=a};b.prototype.aggregrateRequestFlags=function(a,c,b){if(c===0){a=a|1;if((b&2)===0)a=a&~16;if((b&8)===0)a=a&~256;a=a&~4}if(b&1)a=a|2;if((b&4)===0)a=a&~4;return a};b.prototype.finallyNormalizeFlags=function(a){if((a&1)===0){a=a&~16;a=a&~256}if(!c._internalConfig.enableConcurrentFlag)a=a&~4;if(!c._internalConfig.enableUndoableFlag)a=a&~16;if(!f.isSetSupported("RichApiRuntimeFlag","1.1")){a=a&~4;a=a&~16}if(!f.isSetSupported("RichApiRuntimeFlag","1.2"))a=a&~256;if(typeof this.m_flagsForTesting==="number")a=this.m_flagsForTesting;return a};b.prototype.buildRequestMessageBodyAndRequestFlags=function(){c._internalConfig.enableEarlyDispose&&b._calculateLastUsedObjectPathIds(this.m_actions);var a=4|16|256,h={};for(var e in this.m_referencedObjectPaths){a=this.aggregrateRequestFlags(a,this.m_referencedObjectPaths[e].operationType,this.m_referencedObjectPaths[e].flags);h[e]=this.m_referencedObjectPaths[e].objectPathInfo}for(var i=[],g=false,f=0;f<this.m_actions.length;f++){var d=this.m_actions[f];if(d.actionInfo.ActionType===3&&d.actionInfo.Name===j.keepReference)g=true;a=this.aggregrateRequestFlags(a,d.operationType,d.flags);i.push(d.actionInfo)}a=this.finallyNormalizeFlags(a);var k={AutoKeepReference:this.m_contextBase._autoCleanup&&g,Actions:i,ObjectPaths:h};return{body:k,flags:a}};b.prototype.processResponse=function(a){if(a)for(var b=0;b<a.length;b++){var c=a[b],d=this.m_actionResultHandler[c.ActionId];d&&d._handleResult(c.Value)}};b.prototype.invalidatePendingInvalidObjectPaths=function(){for(var a in this.m_referencedObjectPaths)if(this.m_referencedObjectPaths[a].isInvalidAfterRequest)this.m_referencedObjectPaths[a].isValid=false};b.prototype._addPreSyncPromise=function(a){this.m_preSyncPromises.push(a)};Object.defineProperty(b.prototype,"_preSyncPromises",{"get":function(){return this.m_preSyncPromises},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_actions",{"get":function(){return this.m_actions},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_objectPaths",{"get":function(){return this.m_referencedObjectPaths},enumerable:true,configurable:true});b.prototype._removeKeepReferenceAction=function(c){for(var a=this.m_actions.length-1;a>=0;a--){var b=this.m_actions[a].actionInfo;if(b.ObjectPathId===c&&b.ActionType===3&&b.Name===j.keepReference){this.m_actions.splice(a,1);break}}};b._updateLastUsedActionIdOfObjectPathId=function(c,a,f){while(a){if(c[a.objectPathInfo.Id])return;c[a.objectPathInfo.Id]=f;var d=a.argumentObjectPaths;if(d)for(var g=d.length,e=0;e<g;e++)b._updateLastUsedActionIdOfObjectPathId(c,d[e],f);a=a.parentObjectPath}};b._calculateLastUsedObjectPathIds=function(k){for(var d={},l=k.length,c=l-1;c>=0;--c){var a=k[c],f=a.actionInfo.Id;a.referencedObjectPath&&b._updateLastUsedActionIdOfObjectPathId(d,a.referencedObjectPath,f);var i=a.referencedArgumentObjectPaths;if(i)for(var n=i.length,j=0;j<n;j++)b._updateLastUsedActionIdOfObjectPathId(d,i[j],f)}var g={};for(var m in d){var f=d[m],e=g[f];if(!e){e=[];g[f]=e}e.push(parseInt(m))}for(var c=0;c<l;c++){var a=k[c],h=g[a.actionInfo.Id];if(h&&h.length>0)a.actionInfo.L=h;else if(a.actionInfo.L)delete a.actionInfo.L}};return b}();c.ClientRequestBase=K;var y=function(){function b(a){this.m_type=a}Object.defineProperty(b.prototype,"value",{"get":function(){if(!this.m_isLoaded)throw new d.RuntimeError({code:g.valueNotLoaded,message:a._getResourceString(i.valueNotLoaded),debugInfo:{errorLocation:"clientResult.value"}});return this.m_value},enumerable:true,configurable:true});b.prototype._handleResult=function(a){this.m_isLoaded=true;if(typeof a==="object"&&a&&a._IsNull)return;if(this.m_type===1)this.m_value=f.adjustToDateTime(a);else this.m_value=a};return b}();c.ClientResult=y;var ib=function(){function b(a){this.m_context=a;this.m_actions=[]}b.prototype.add=function(c,a,b,d){var e=this;this.m_actions.push({action:c,resultHandler:a,resolve:b,reject:d});this.m_actions.length===1&&setTimeout(function(){return e.processActions()},0)};b.prototype.processActions=function(){var k=this;if(this.m_actions.length===0)return;var c=this.m_actions;this.m_actions=[];for(var b=new K(this.m_context),e=0;e<c.length;e++){var d=c[e];b.ensureInstantiateObjectPath(d.action.referencedObjectPath);b.ensureInstantiateObjectPaths(d.action.referencedArgumentObjectPaths);b.addAction(d.action);b.addReferencedObjectPath(d.action.referencedObjectPath);b.addReferencedObjectPaths(d.action.referencedArgumentObjectPaths)}var g=b.buildRequestMessageBodyAndRequestFlags(),f=g.body,j=g.flags,h={Url:l.localDocumentApiPrefix,Headers:null,Body:f};a.log("Request:");a.log(JSON.stringify(f));var i=new I;i.executeAsync(this.m_context._customData,j,h).then(function(a){k.processResponse(b,c,a)})["catch"](function(d){for(var a=0;a<c.length;a++){var b=c[a];b.reject(d)}})};b.prototype.processResponse=function(d,c,a){var e=this.getErrorFromResponse(a),b=null;if(a.Body.Results)b=a.Body.Results;else if(a.Body.ProcessedResults&&a.Body.ProcessedResults.Results)b=a.Body.ProcessedResults.Results;if(!b)b=[];this.processActionResults(d,c,b,e)};b.prototype.getErrorFromResponse=function(b){if(!a.isNullOrEmptyString(b.ErrorCode))return new d.RuntimeError({code:b.ErrorCode,message:b.ErrorMessage});if(b.Body&&b.Body.Error)return new d.RuntimeError({code:b.Body.Error.Code,message:b.Body.Error.Message});return null};b.prototype.processActionResults=function(j,g,b,h){j.processResponse(b);for(var e=0;e<g.length;e++){for(var a=g[e],i=a.action.actionInfo.Id,f=false,c=0;c<b.length;c++)if(i==b[c].ActionId){var d=b[c].Value;if(a.resultHandler){a.resultHandler._handleResult(d);d=a.resultHandler.value}a.resolve&&a.resolve(d);f=true;break}if(!f&&a.reject)if(h)a.reject(h);else a.reject("No response for the action.")}};return b}(),I=function(){function b(){}b.prototype.getRequestUrl=function(a,b){if(a.charAt(a.length-1)!="/")a=a+"/";a=a+l.processQuery;a=a+"?"+l.flags+"="+b.toString();return a};b.prototype.executeAsync=function(i,g,c){var h=this.getRequestUrl(c.Url,g),d={method:"POST",url:h,headers:{},body:c.Body};d.headers[l.sourceLibHeader]=b.SourceLibHeaderValue;d.headers["CONTENT-TYPE"]="application/json";if(c.Headers)for(var e in c.Headers)d.headers[e]=c.Headers[e];var f=a._isLocalDocumentUrl(d.url)?G.sendLocalDocumentRequest:G.sendRequest;return f(d).then(function(b){var c;if(b.statusCode===200)c={ErrorCode:null,ErrorMessage:null,Headers:b.headers,Body:a._parseResponseBody(b)};else{a.log("Error Response:"+b.body);var d=a._parseErrorResponse(b);c={ErrorCode:d.errorCode,ErrorMessage:d.errorMessage,Headers:b.headers,Body:null}}return c})};b.SourceLibHeaderValue="officejs-rest";return b}();c.HttpRequestExecutor=I;var j=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}a.collectionPropertyPath="_collectionPropertyPath";a.id="Id";a.idLowerCase="id";a.idPrivate="_Id";a.keepReference="_KeepReference";a.objectPathIdPrivate="_ObjectPathId";a.referenceId="_ReferenceId";a.items="_Items";a.itemsLowerCase="items";a.scalarPropertyNames="_scalarPropertyNames";a.scalarPropertyOriginalNames="_scalarPropertyOriginalNames";a.navigationPropertyNames="_navigationPropertyNames";a.scalarPropertyUpdateable="_scalarPropertyUpdateable";return a}(l);c.CommonConstants=j;var f=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}b.validateObjectPath=function(e){var c=e._objectPath;while(c){if(!c.isValid)throw new d.RuntimeError({code:g.invalidObjectPath,message:a._getResourceString(i.invalidObjectPath,b.getObjectPathExpression(c)),debugInfo:{errorLocation:b.getObjectPathExpression(c)}});c=c.parentObjectPath}};b.validateReferencedObjectPaths=function(e){if(e)for(var f=0;f<e.length;f++){var c=e[f];while(c){if(!c.isValid)throw new d.RuntimeError({code:g.invalidObjectPath,message:a._getResourceString(i.invalidObjectPath,b.getObjectPathExpression(c))});c=c.parentObjectPath}}};b._toCamelLowerCase=function(b){if(a.isNullOrEmptyString(b))return b;var c=0;while(c<b.length&&b.charCodeAt(c)>=65&&b.charCodeAt(c)<=90)c++;if(c<b.length)return b.substr(0,c).toLowerCase()+b.substr(c);else return b.toLowerCase()};b.adjustToDateTime=function(c){if(a.isNullOrUndefined(c))return null;if(typeof c==="string")return new Date(c);if(Array.isArray(c)){for(var d=c,e=0;e<d.length;e++)d[e]=b.adjustToDateTime(d[e]);return d}throw a._createInvalidArgError({argumentName:"date"});};b.tryGetObjectIdFromLoadOrRetrieveResult=function(c){var b=c[j.id];if(a.isNullOrUndefined(b))b=c[j.idLowerCase];if(a.isNullOrUndefined(b))b=c[j.idPrivate];return b};b.getObjectPathExpression=function(c){var a="";while(c){switch(c.objectPathInfo.ObjectPathType){case 1:a=a;break;case 2:a="new()"+(a.length>0?".":"")+a;break;case 3:a=b.normalizeName(c.objectPathInfo.Name)+"()"+(a.length>0?".":"")+a;break;case 4:a=b.normalizeName(c.objectPathInfo.Name)+(a.length>0?".":"")+a;break;case 5:a="getItem()"+(a.length>0?".":"")+a;break;case 6:a="_reference()"+(a.length>0?".":"")+a;break}c=c.parentObjectPath}return a};b.setMethodArguments=function(g,f,c){if(a.isNullOrUndefined(c))return null;var e=[],d=[],h=b.collectObjectPathInfos(g,c,e,d);f.Arguments=c;if(h)f.ReferencedObjectPathIds=d;return e};b.validateContext=function(b,c){if(b&&c&&c._context!==b)throw new d.RuntimeError({code:g.invalidRequestContext,message:a._getResourceString(i.invalidRequestContext)});};b.isSetSupported=function(b,a){if(typeof window!=="undefined"&&window.Office&&window.Office.context&&window.Office.context.requirements)return window.Office.context.requirements.isSetSupported(b,a);return true};b.throwIfApiNotSupported=function(e,f,c,h){if(!b._doApiNotSupportedCheck)return;if(!b.isSetSupported(f,c)){var j=a._getResourceString(i.apiNotFoundDetails,[e,f+" "+c,h]);throw new d.RuntimeError({code:g.apiNotFound,message:j,debugInfo:{errorLocation:e}});}};b._parseSelectExpand=function(e){var f=[];if(!a.isNullOrEmptyString(e))for(var d=e.split(","),c=0;c<d.length;c++){var b=d[c];b=g(b.trim());b.length>0&&f.push(b)}return f;function g(b){var a=b.toLowerCase();if(a==="items"||a==="items/")return"*";var c=6,d=a.substr(0,c)==="items/"||a.substr(0,c)==="items.";if(d)b=b.substr(c);return b.replace(new RegExp("[/.]items[/.]","gi"),"/")}};b.changePropertyNameToCamelLowerCase=function(a){var h=95;if(Array.isArray(a)){for(var c=[],e=0;e<a.length;e++)c.push(this.changePropertyNameToCamelLowerCase(a[e]));return c}else if(typeof a==="object"&&a!==null){var c={};for(var d in a){var f=a[d];if(d===j.items){c={};c[j.itemsLowerCase]=this.changePropertyNameToCamelLowerCase(f);break}else{var g=b._toCamelLowerCase(d);c[g]=this.changePropertyNameToCamelLowerCase(f)}}return c}else return a};b.purifyJson=function(a){var f=95;if(Array.isArray(a)){for(var c=[],e=0;e<a.length;e++)c.push(this.purifyJson(a[e]));return c}else if(typeof a==="object"&&a!==null){var c={};for(var d in a)if(d.charCodeAt(0)!==f){var b=a[d];if(typeof b==="object"&&b!==null&&Array.isArray(b.items))b=b.items;c[d]=this.purifyJson(b)}return c}else return a};b.collectObjectPathInfos=function(j,d,g,e){for(var h=false,c=0;c<d.length;c++)if(d[c]instanceof z){var f=d[c];b.validateContext(j,f);d[c]=f._objectPath.objectPathInfo.Id;e.push(f._objectPath.objectPathInfo.Id);g.push(f._objectPath);h=true}else if(Array.isArray(d[c])){var i=[],k=b.collectObjectPathInfos(j,d[c],g,i);if(k){e.push(i);h=true}else e.push(0)}else if(a.isPlainJsonObject(d[c])){e.push(0);b.replaceClientObjectPropertiesWithObjectPathIds(d[c],g)}else e.push(0);return h};b.replaceClientObjectPropertiesWithObjectPathIds=function(f,e){var g,h;for(var k in f){var c=f[k];if(c instanceof z){e.push(c._objectPath);f[k]=(g={},g[j.objectPathIdPrivate]=c._objectPath.objectPathInfo.Id,g)}else if(Array.isArray(c))for(var d=0;d<c.length;d++)if(c[d]instanceof z){var i=c[d];e.push(i._objectPath);c[d]=(h={},h[j.objectPathIdPrivate]=i._objectPath.objectPathInfo.Id,h)}else a.isPlainJsonObject(c[d])&&b.replaceClientObjectPropertiesWithObjectPathIds(c[d],e);else a.isPlainJsonObject(c)&&b.replaceClientObjectPropertiesWithObjectPathIds(c,e)}};b.normalizeName=function(a){return a.substr(0,1).toLowerCase()+a.substr(1)};b._doApiNotSupportedCheck=false;return b}(a);c.CommonUtility=f;var w=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}a.propertyDoesNotExist="PropertyDoesNotExist";a.attemptingToSetReadOnlyProperty="AttemptingToSetReadOnlyProperty";return a}(i);c.CommonResourceStrings=w;var Q=function(b){__extends(a,b);function a(c){var a=b.call(this)||this;a.m_shouldPolyfill=c;return a}a.prototype._handleResult=function(a){b.prototype._handleResult.call(this,a);if(this.m_shouldPolyfill)this.m_value=f.changePropertyNameToCamelLowerCase(this.m_value);this.m_value=this.removeItemNodes(this.m_value)};a.prototype.removeItemNodes=function(a){if(typeof a==="object"&&a!==null&&a[j.itemsLowerCase])a=a[j.itemsLowerCase];return f.purifyJson(a)};return a}(y);c.ClientRetrieveResult=Q;var bb=function(){function a(a){this.callback=a}a.prototype._handleResult=function(a){this.callback&&this.callback()};return a}(),P=function(b){__extends(a,b);function a(c){var a=b.call(this)||this;a.callback=c;return a}a.prototype._handleResult=function(a){b.prototype._handleResult.call(this,a);this.callback()};return a}(y);c.ClientResultCallback=P;var F=function(){function b(){}b.invokeMethod=function(b,h,c,e,d,g){if(c===void 0)c=0;if(e===void 0)e=[];if(d===void 0)d=0;if(g===void 0)g=0;return a.createPromise(function(j,k){var l=new y,g={Id:b._context._nextId(),ActionType:3,Name:h,ObjectPathId:b._objectPath.objectPathInfo.Id,ArgumentInfo:{}},i=f.setMethodArguments(b._context,g.ArgumentInfo,e),a=new n(g,c,d);a.referencedObjectPath=b._objectPath;a.referencedArgumentObjectPaths=i;b._context._addServiceApiAction(a,l,j,k)})};b.invokeMethodWithClientResultCallback=function(e,b,d){var c=0,h=[],g=0;return a.createPromise(function(k,l){var m=new P(e),i={Id:b._context._nextId(),ActionType:3,Name:d,ObjectPathId:b._objectPath.objectPathInfo.Id,ArgumentInfo:{}},j=f.setMethodArguments(b._context,i.ArgumentInfo,h),a=new n(i,c,g);a.referencedObjectPath=b._objectPath;a.referencedArgumentObjectPaths=j;b._context._addServiceApiAction(a,m,k,l)})};b.invokeRetrieve=function(g,a){var d=c._internalConfig.alwaysPolyfillClientObjectRetrieveMethod;if(!d)d=!f.isSetSupported("RichApiRuntime","1.1");var e;if(typeof a[0]==="object"&&a[0].hasOwnProperty("$all")){if(!a[0].$all)throw c.Error._createInvalidArgError({});e=a[0]}else e=b._parseSelectOption(a);return g._retrieve(e,new Q(d))};b._parseSelectOption=function(a){if(!a||!a[0])throw c.Error._createInvalidArgError({});var d=a[0]&&typeof a[0]!=="string"?a[0]:a;return Array.isArray(d)?d:b.parseRecursiveSelect(d)};b.parseRecursiveSelect=function(b){var a=function(b){return Object.keys(b).reduce(function(c,e){var d=b[e];if(typeof d==="object")return c.concat(a(d).map(function(a){return e+"/"+a}));if(d)return c.concat(e);return c},[])};return a(b)};b.invokeRecursiveUpdate=function(b,c){return a.createPromise(function(d,f){b._recursivelyUpdate(c);var a={Id:b._context._nextId(),ActionType:5,Name:"Trace",ObjectPathId:0},e=new n(a,1,4);b._context._addServiceApiAction(e,null,d,f)})};b.createRootServiceObject=function(d,a){var b={Id:a._nextId(),ObjectPathType:1,Name:""},c=new m(b,null,false,false,1,4);return new d(a,c)};b.createTopLevelServiceObject=function(g,a,e,c,f){var b={Id:a._nextId(),ObjectPathType:2,Name:e},d=new m(b,null,c,false,1,f|4);return new g(a,d)};b.createPropertyObject=function(g,a,d,c,f){var b={Id:a._context._nextId(),ObjectPathType:4,Name:d,ParentObjectPathId:a._objectPath.objectPathInfo.Id},e=new m(b,a._objectPath,c,false,1,f|4);return new g(a._context,e)};b.createIndexerObject=function(e,a,d){var b={Id:a._context._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:a._objectPath.objectPathInfo.Id,ArgumentInfo:{}};b.ArgumentInfo.Arguments=d;var c=new m(b,a._objectPath,false,false,1,4);return new e(a._context,c)};b.createMethodObject=function(n,a,j,h,l,i,d,g,k){var o=a._context._nextId(),c={Id:o,ObjectPathType:3,Name:j,ParentObjectPathId:a._objectPath.objectPathInfo.Id,ArgumentInfo:{}},e=f.setMethodArguments(a._context,c.ArgumentInfo,l),b=new m(c,a._objectPath,i,d,h,k);b.argumentObjectPaths=e;b.getByIdMethodName=g;var p=new n(a._context,b);return p};b.createAndInstantiateMethodObject=function(k,b,h,e,j,g,c,d,i){return a.createPromise(function(r,s){var l={Id:b._context._nextId(),ObjectPathType:3,Name:h,ParentObjectPathId:b._objectPath.objectPathInfo.Id,ArgumentInfo:{}},p=f.setMethodArguments(b._context,l.ArgumentInfo,j),a=new m(l,b._objectPath,g,c,e,i);a.argumentObjectPaths=p;a.getByIdMethodName=d;var t=new y,q={Id:b._context._nextId(),ActionType:1,Name:"",ObjectPathId:a.objectPathInfo.Id,QueryInfo:{}},o=new n(q,1,4);o.referencedObjectPath=a;b._context._addServiceApiAction(o,t,function(){return r(new k(b._context,a))},s)})};b.createTraceAction=function(b,c){return a.createPromise(function(d,f){var a={Id:b._nextId(),ActionType:5,Name:"Trace",ObjectPathId:0},e=new n(a,1,4),g=new bb(c);b._addServiceApiAction(e,g,d,f)})};b.localDocumentContext=new D;return b}();c.OperationalApiHelper=F;var O=function(){function b(c,b,a){this.eventId=c;this.targetId=b;this.eventArgumentTransform=a;this.registeredCallbacks=[]}b.prototype.add=function(a){this.hasZero()&&o.getGenericEventRegistration().register(this.eventId,this.targetId,this.registerCallback);this.registeredCallbacks.push(a)};b.prototype.remove=function(b){var a=this.registeredCallbacks.lastIndexOf(b);a!==-1&&this.registeredCallbacks.splice(a,1)};b.prototype.removeAll=function(){this.registeredCallbacks=[];o.getGenericEventRegistration().unregister(this.eventId,this.targetId,this.registerCallback)};b.prototype.hasZero=function(){return this.registeredCallbacks.length===0};Object.defineProperty(b.prototype,"registerCallback",{"get":function(){var a=this;if(!this.outsideCallback)this.outsideCallback=function(b){a.call(b)};return this.outsideCallback},enumerable:true,configurable:true});b.prototype.call=function(c){var d=this;this.eventArgumentTransform(c).then(function(c){var e=d.registeredCallbacks.map(function(a){return b.callCallback(a,c)});a.Promise.all(e)})};b.callCallback=function(d,c){return a._createPromiseFromResult(null).then(b.wrapCallbackInFunction(d,c))["catch"](function(b){a.log("Error when invoke handler: "+JSON.stringify(b))})};b.wrapCallbackInFunction=function(a,b){return function(){return a(b)}};return b}();c.GenericEventRegistryOperational=O;var C=function(){function a(){this.eventToTargetToHandlerMap={}}Object.defineProperty(a,"globalEventRegistry",{"get":function(){if(!a.singleton)a.singleton=new a;return a.singleton},enumerable:true,configurable:true});a.getGlobalEventRegistry=function(c,b,f){var g=a.globalEventRegistry,d=g.eventToTargetToHandlerMap;if(!d.hasOwnProperty(c))d[c]={};var e=d[c];if(!e.hasOwnProperty(b))e[b]=new O(c,b,f);var h=e[b];return h};a.singleton=undefined;return a}();c.GlobalEventRegistryOperational=C;var X=function(){function a(a){this.genericEventInfo=a}a.prototype.add=function(c){var a=this,b=function(){var d=a.genericEventInfo.eventType,b=a.genericEventInfo.getTargetIdFunc(),e=C.getGlobalEventRegistry(d,b,a.genericEventInfo.eventArgsTransformFunc);e.add(c)};this.register();this.createTrace(b)};a.prototype.remove=function(c){var a=this,b=function(){var d=a.genericEventInfo.eventType,b=a.genericEventInfo.getTargetIdFunc(),e=C.getGlobalEventRegistry(d,b,a.genericEventInfo.eventArgsTransformFunc);e.remove(c)};this.register();this.createTrace(b)};a.prototype.removeAll=function(){var a=this,b=function(){var c=a.genericEventInfo.eventType,b=a.genericEventInfo.getTargetIdFunc(),d=C.getGlobalEventRegistry(c,b,a.genericEventInfo.eventArgsTransformFunc);d.removeAll()};this.unregister();this.createTrace(b)};a.prototype.createTrace=function(a){F.createTraceAction(this.genericEventInfo.object._context,a)};a.prototype.register=function(){var a=0,c=[],b=0;F.invokeMethod(this.genericEventInfo.object,this.genericEventInfo.register,a,c,b);!o.getGenericEventRegistration().isReady&&o.getGenericEventRegistration().ready()};a.prototype.unregister=function(){F.invokeMethod(this.genericEventInfo.object,this.genericEventInfo.unregister)};return a}();c.GenericEventHandlerOperational=X;var kb=function(){function b(){}b.invokeOn=function(b,c,d){b.add(c);return a._createPromiseFromResult({})};b.invokeOff=function(e,f,c,d){if(!c&&!d){var g=Object.keys(e).map(function(a){return e[a]});return b.invokeAllOff(g)}if(!c)return a._createPromiseFromException(c+" must be supplied if handler is supplied.");if(d)f.remove(d);else f.removeAll();return a.createPromise(function(a,b){return a()})};b.invokeAllOff=function(b){b.forEach(function(a){a.removeAll()});return a.createPromise(function(a,b){return a()})};return b}();c.EventHelper=kb;var B=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}a.propertyNotLoaded="PropertyNotLoaded";a.runMustReturnPromise="RunMustReturnPromise";a.cannotRegisterEvent="CannotRegisterEvent";a.invalidOrTimedOutSession="InvalidOrTimedOutSession";a.cannotUpdateReadOnlyProperty="CannotUpdateReadOnlyProperty";return a}(g);c.ErrorCodes=B;var Z=function(){function a(a){this.m_callback=a}a.prototype._handleResult=function(a){this.m_callback&&this.m_callback()};return a}(),p=function(c){__extends(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}a.createMethodAction=function(f,c,h,g,j,i){b.validateObjectPath(c);var e={Id:f._nextId(),ActionType:3,Name:h,ObjectPathId:c._objectPath.objectPathInfo.Id,ArgumentInfo:{}},d=b.setMethodArguments(f,e.ArgumentInfo,j);b.validateReferencedObjectPaths(d);var a=new n(e,g,b._fixupApiFlags(i));a.referencedObjectPath=c._objectPath;a.referencedArgumentObjectPaths=d;c._addAction(a);return a};a.createRecursiveQueryAction=function(e,a,f){b.validateObjectPath(a);var d={Id:e._nextId(),ActionType:6,Name:"",ObjectPathId:a._objectPath.objectPathInfo.Id,RecursiveQueryInfo:f},c=new n(d,1,4);c.referencedObjectPath=a._objectPath;a._addAction(c);return c};a.createEnsureUnchangedAction=function(f,a,d){b.validateObjectPath(a);var e={Id:f._nextId(),ActionType:8,Name:"",ObjectPathId:a._objectPath.objectPathInfo.Id,ObjectState:d},c=new n(e,1,4);c.referencedObjectPath=a._objectPath;a._addAction(c);return c};a.createInstantiateAction=function(c,a){b.validateObjectPath(a);c._pendingRequest.ensureInstantiateObjectPath(a._objectPath.parentObjectPath);c._pendingRequest.ensureInstantiateObjectPaths(a._objectPath.argumentObjectPaths);var e={Id:c._nextId(),ActionType:1,Name:"",ObjectPathId:a._objectPath.objectPathInfo.Id},d=new n(e,1,4);d.referencedObjectPath=a._objectPath;a._addAction(d,new Y(a),true);return d};a.createTraceAction=function(a,e,d){var b={Id:a._nextId(),ActionType:5,Name:"Trace",ObjectPathId:0},c=new n(b,1,4);a._pendingRequest.addAction(c);d&&a._pendingRequest.addTrace(b.Id,e);return c};a.createTraceMarkerForCallback=function(b,c){var d=a.createTraceAction(b,null,false);b._pendingRequest.addActionResultHandler(d,new Z(c))};return a}(t);c.ActionFactory=p;var N=function(e){__extends(c,e);function c(a,d){var c=e.call(this,a,d)||this;b.checkArgumentNull(a,"context");c.m_context=a;if(c._objectPath)if(!a._processingResult&&a._pendingRequest){p.createInstantiateAction(a,c);a._autoCleanup&&c._KeepReference&&a.trackedObjects._autoAdd(c)}return c}Object.defineProperty(c.prototype,"context",{"get":function(){return this.m_context},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"isNull",{"get":function(){if(typeof this.m_isNull==="undefined"&&A.isMock())return false;b.throwIfNotLoaded("isNull",this._isNull,null,this._isNull);return this._isNull},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"isNullObject",{"get":function(){if(typeof this.m_isNull==="undefined"&&A.isMock())return false;b.throwIfNotLoaded("isNullObject",this._isNull,null,this._isNull);return this._isNull},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"_isNull",{"get":function(){return this.m_isNull},"set":function(a){this.m_isNull=a;a&&this._objectPath&&this._objectPath._updateAsNullObject()},enumerable:true,configurable:true});c.prototype._addAction=function(b,c,d){if(c===void 0)c=null;if(!d){this.context._pendingRequest.ensureInstantiateObjectPath(this._objectPath);this.context._pendingRequest.ensureInstantiateObjectPaths(b.referencedArgumentObjectPaths)}this.context._pendingRequest.addAction(b);this.context._pendingRequest.addReferencedObjectPath(this._objectPath);this.context._pendingRequest.addReferencedObjectPaths(b.referencedArgumentObjectPaths);this.context._pendingRequest.addActionResultHandler(b,c);return a._createPromiseFromResult(null)};c.prototype._handleResult=function(a){this._isNull=b.isNullOrUndefined(a);this.context.trackedObjects._autoTrackIfNecessaryWhenHandleObjectResultValue(this,a)};c.prototype._handleIdResult=function(a){this._isNull=b.isNullOrUndefined(a);b.fixObjectPathIfNecessary(this,a);this.context.trackedObjects._autoTrackIfNecessaryWhenHandleObjectResultValue(this,a)};c.prototype._handleRetrieveResult=function(a,b){this._handleIdResult(a)};c.prototype._recursivelySet=function(f,n,k,l,o){var m=f instanceof c,s=f;if(m)if(Object.getPrototypeOf(this)===Object.getPrototypeOf(f))f=JSON.parse(JSON.stringify(f));else throw d.RuntimeError._createInvalidArgError({argumentName:"properties",errorLocation:this._className+".set"});try{for(var e,h=0;h<k.length;h++){e=k[h];if(f.hasOwnProperty(e))if(typeof f[e]!=="undefined")this[e]=f[e]}for(var h=0;h<l.length;h++){e=l[h];if(f.hasOwnProperty(e))if(typeof f[e]!=="undefined"){var r=m?s[e]:f[e];this[e].set(r,n)}}var j=!m;if(n&&!b.isNullOrUndefined(j))j=n.throwOnReadOnly;for(var h=0;h<o.length;h++){e=o[h];if(f.hasOwnProperty(e))if(typeof f[e]!=="undefined"&&j)throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(q.cannotApplyPropertyThroughSetMethod,e),debugInfo:{errorLocation:e}});}for(e in f)if(k.indexOf(e)<0&&l.indexOf(e)<0){var p=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),e);if(!p)throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(w.propertyDoesNotExist,e),debugInfo:{errorLocation:e}});if(j&&!p.set)throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(w.attemptingToSetReadOnlyProperty,e),debugInfo:{errorLocation:e}});}}catch(t){throw new d.RuntimeError({code:g.invalidArgument,message:a._getResourceString(i.invalidArgument,"properties"),debugInfo:{errorLocation:this._className+".set"},innerError:t});}};return c}(z);c.ClientObject=N;var ab=function(){function b(a){this.m_session=a}b.prototype.executeAsync=function(f,e,b){var d={url:l.processQuery,method:"POST",headers:b.Headers,body:b.Body},c={id:v.nextId(),type:1,flags:e,message:d};a.log(JSON.stringify(c));return this.m_session.sendMessageToHost(c).then(function(d){a.log("Received response: "+JSON.stringify(d));var b=d.message,c;if(b.statusCode===200)c={ErrorCode:null,ErrorMessage:null,Headers:b.headers,Body:a._parseResponseBody(b)};else{a.log("Error Response:"+b.body);var e=a._parseErrorResponse(b);c={ErrorCode:e.errorCode,ErrorMessage:e.errorMessage,Headers:b.headers,Body:null}}return c})};return b}(),M=function(c){__extends(b,c);function b(b){var a=c.call(this)||this;a.m_bridge=b;a.m_bridge.addHostMessageHandler(function(a){a.type===3&&o.getGenericEventRegistration()._handleRichApiMessage(a.message)});return a}b.getInstanceIfHostBridgeInited=function(){if(v.instance){if(a.isNullOrUndefined(b.s_instance)||b.s_instance.m_bridge!==v.instance)b.s_instance=new b(v.instance);return b.s_instance}return null};b.prototype._resolveRequestUrlAndHeaderInfo=function(){return a._createPromiseFromResult(null)};b.prototype._createRequestExecutorOrNull=function(){a.log("NativeBridgeSession::CreateRequestExecutor");return new ab(this)};Object.defineProperty(b.prototype,"eventRegistration",{"get":function(){return o.getGenericEventRegistration()},enumerable:true,configurable:true});b.prototype.sendMessageToHost=function(a){return this.m_bridge.sendMessageToHostAndExpectResponse(a)};return b}(s);c.HostBridgeSession=M;var eb=function(h){__extends(f,h);function f(g){var c=h.call(this)||this;c.m_customRequestHeaders={};c.m_batchMode=0;c._onRunFinishedNotifiers=[];if(s._overrideSession)c.m_requestUrlAndHeaderInfoResolver=s._overrideSession;else{if(b.isNullOrUndefined(g)||typeof g==="string"&&g.length===0){g=f.defaultRequestUrlAndHeaders;if(!g)g={url:l.localDocument,headers:{}}}if(typeof g==="string")c.m_requestUrlAndHeaderInfo={url:g,headers:{}};else if(f.isRequestUrlAndHeaderInfoResolver(g))c.m_requestUrlAndHeaderInfoResolver=g;else if(f.isRequestUrlAndHeaderInfo(g)){var i=g;c.m_requestUrlAndHeaderInfo={url:i.url,headers:{}};a._copyHeaders(i.headers,c.m_requestUrlAndHeaderInfo.headers)}else throw d.RuntimeError._createInvalidArgError({argumentName:"url"});}if(!c.m_requestUrlAndHeaderInfoResolver&&c.m_requestUrlAndHeaderInfo&&a._isLocalDocumentUrl(c.m_requestUrlAndHeaderInfo.url)&&M.getInstanceIfHostBridgeInited()){c.m_requestUrlAndHeaderInfo=null;c.m_requestUrlAndHeaderInfoResolver=M.getInstanceIfHostBridgeInited()}if(c.m_requestUrlAndHeaderInfoResolver instanceof s)c.m_session=c.m_requestUrlAndHeaderInfoResolver;c._processingResult=false;c._customData=e.iterativeExecutor;c.sync=c.sync.bind(c);return c}Object.defineProperty(f.prototype,"session",{"get":function(){return this.m_session},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"eventRegistration",{"get":function(){if(this.m_session)return this.m_session.eventRegistration;return d.officeJsEventRegistration},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"_url",{"get":function(){if(this.m_requestUrlAndHeaderInfo)return this.m_requestUrlAndHeaderInfo.url;return null},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"_pendingRequest",{"get":function(){if(this.m_pendingRequest==null)this.m_pendingRequest=new x(this);return this.m_pendingRequest},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"debugInfo",{"get":function(){var a=new H(this._rootObjectPropertyName,this._pendingRequest._objectPaths,this._pendingRequest._actions,c._internalConfig.showDisposeInfoInDebugInfo),b=a.process();return{pendingStatements:b}},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"trackedObjects",{"get":function(){if(!this.m_trackedObjects)this.m_trackedObjects=new R(this);return this.m_trackedObjects},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"requestHeaders",{"get":function(){return this.m_customRequestHeaders},enumerable:true,configurable:true});Object.defineProperty(f.prototype,"batchMode",{"get":function(){return this.m_batchMode},enumerable:true,configurable:true});f.prototype.ensureInProgressBatchIfBatchMode=function(){if(this.m_batchMode===1&&!this.m_explicitBatchInProgress)throw b.createRuntimeError(g.generalException,a._getResourceString(q.notInsideBatch),null);};f.prototype.load=function(a,d){b.validateContext(this,a);var c=f._parseQueryOption(d);t.createQueryAction(this,a,c,a)};f.prototype.loadRecursive=function(c,a,h){if(!b.isPlainJsonObject(a))throw d.RuntimeError._createInvalidArgError({argumentName:"options"});var e={};for(var g in a)e[g]=f._parseQueryOption(a[g]);var i=p.createRecursiveQueryAction(this,c,{Queries:e,MaxDepth:h});this._pendingRequest.addActionResultHandler(i,c)};f.prototype.trace=function(a){p.createTraceAction(this,a,true)};f.prototype._processOfficeJsErrorResponse=function(a,b){};f.prototype.ensureRequestUrlAndHeaderInfo=function(){var a=this;return b._createPromiseFromResult(null).then(function(){if(!a.m_requestUrlAndHeaderInfo)return a.m_requestUrlAndHeaderInfoResolver._resolveRequestUrlAndHeaderInfo().then(function(d){a.m_requestUrlAndHeaderInfo=d;if(!a.m_requestUrlAndHeaderInfo)a.m_requestUrlAndHeaderInfo={url:l.localDocument,headers:{}};if(b.isNullOrEmptyString(a.m_requestUrlAndHeaderInfo.url))a.m_requestUrlAndHeaderInfo.url=l.localDocument;if(!a.m_requestUrlAndHeaderInfo.headers)a.m_requestUrlAndHeaderInfo.headers={};if(typeof a.m_requestUrlAndHeaderInfoResolver._createRequestExecutorOrNull==="function"){var c=a.m_requestUrlAndHeaderInfoResolver._createRequestExecutorOrNull();if(c)a._requestExecutor=c}})})};f.prototype.syncPrivateMain=function(){var a=this;return this.ensureRequestUrlAndHeaderInfo().then(function(){var b=a._pendingRequest;a.m_pendingRequest=null;return a.processPreSyncPromises(b).then(function(){return a.syncPrivate(b)})})};f.prototype.syncPrivate=function(f){var j=this;if(A.isMock())return a._createPromiseFromResult(null);if(!f.hasActions)return this.processPendingEventHandlers(f);var k=f.buildRequestMessageBodyAndRequestFlags(),n=k.body,h=k.flags;if(this._requestFlagModifier)h|=this._requestFlagModifier;if(!this._requestExecutor)if(a._isLocalDocumentUrl(this.m_requestUrlAndHeaderInfo.url))this._requestExecutor=new db(this);else this._requestExecutor=new I;var m=this._requestExecutor,i={};a._copyHeaders(this.m_requestUrlAndHeaderInfo.headers,i);a._copyHeaders(this.m_customRequestHeaders,i);delete this.m_customRequestHeaders[e.officeScriptEventId];var l={Url:this.m_requestUrlAndHeaderInfo.url,Headers:i,Body:n};f.invalidatePendingInvalidObjectPaths();var g=null,c=null;this._lastSyncStart=typeof performance==="undefined"?0:performance.now();this._lastRequestFlags=h;return m.executeAsync(this._customData,h,l).then(function(b){j._lastSyncEnd=typeof performance==="undefined"?0:performance.now();g=j.processRequestExecutorResponseMessage(f,b);return j.processPendingEventHandlers(f)["catch"](function(b){a.log("Error in processPendingEventHandlers");a.log(JSON.stringify(b));c=b})}).then(function(){if(g){a.log("Throw error from response: "+JSON.stringify(g));throw g;}if(c){a.log("Throw error from ProcessEventHandler: "+JSON.stringify(c));var h=null;if(c instanceof d.RuntimeError){h=c;h.traceMessages=f._responseTraceMessages}else{var e=null;if(typeof c==="string")e=c;else e=c.message;if(b.isNullOrEmptyString(e))e=a._getResourceString(q.cannotRegisterEvent);h=new d.RuntimeError({code:B.cannotRegisterEvent,message:e,traceMessages:f._responseTraceMessages})}throw h;}})};f.prototype.processRequestExecutorResponseMessage=function(e,a){a.Body&&a.Body.TraceIds&&e._setResponseTraceIds(a.Body.TraceIds);var k=e._responseTraceMessages,f=null;if(a.Body){if(a.Body.Error&&a.Body.Error.ActionIndex>=0){var i=new H(this._rootObjectPropertyName,e._objectPaths,e._actions,false,true),j=i.processForDebugStatementInfo(a.Body.Error.ActionIndex);f={statement:j.statement,surroundingStatements:j.surroundingStatements,fullStatements:["Please enable config.extendedErrorLogging to see full statements."]};if(c.config.extendedErrorLogging){i=new H(this._rootObjectPropertyName,e._objectPaths,e._actions,false,false);f.fullStatements=i.process()}}var g=null;if(a.Body.Results)g=a.Body.Results;else if(a.Body.ProcessedResults&&a.Body.ProcessedResults.Results)g=a.Body.ProcessedResults.Results;if(g){this._processingResult=true;try{e.processResponse(g)}finally{this._processingResult=false}}}if(!b.isNullOrEmptyString(a.ErrorCode))return new d.RuntimeError({code:a.ErrorCode,message:a.ErrorMessage,traceMessages:k});else if(a.Body&&a.Body.Error){var h={errorLocation:a.Body.Error.Location};if(f){h.statement=f.statement;h.surroundingStatements=f.surroundingStatements;h.fullStatements=f.fullStatements}return new d.RuntimeError({code:a.Body.Error.Code,message:a.Body.Error.Message,traceMessages:k,debugInfo:h})}return null};f.prototype.processPendingEventHandlers=function(a){for(var c=b._createPromiseFromResult(null),d=0;d<a._pendingProcessEventHandlers.length;d++){var e=a._pendingProcessEventHandlers[d];c=c.then(this.createProcessOneEventHandlersFunc(e,a))}return c};f.prototype.createProcessOneEventHandlersFunc=function(a,b){return function(){return a._processRegistration(b)}};f.prototype.processPreSyncPromises=function(d){for(var a=b._createPromiseFromResult(null),c=0;c<d._preSyncPromises.length;c++){var e=d._preSyncPromises[c];a=a.then(this.createProcessOneProSyncFunc(e))}return a};f.prototype.createProcessOneProSyncFunc=function(a){return function(){return a}};f.prototype.sync=function(b){if(A.isMock())return a._createPromiseFromResult(b);return this.syncPrivateMain().then(function(){return b})};f.prototype.batch=function(i){var c=this;if(this.m_batchMode!==1)return a._createPromiseFromException(b.createRuntimeError(g.generalException,null,null));if(this.m_explicitBatchInProgress)return a._createPromiseFromException(b.createRuntimeError(g.generalException,a._getResourceString(q.pendingBatchInProgress),null));if(b.isNullOrUndefined(i))return b._createPromiseFromResult(null);this.m_explicitBatchInProgress=true;var e=this.m_pendingRequest;this.m_pendingRequest=new x(this);var d;try{d=i(this._rootObject,this)}catch(j){this.m_explicitBatchInProgress=false;this.m_pendingRequest=e;return a._createPromiseFromException(j)}var f,h;if(typeof d==="object"&&d&&typeof d.then==="function")h=b._createPromiseFromResult(null).then(function(){return d}).then(function(a){c.m_explicitBatchInProgress=false;f=c.m_pendingRequest;c.m_pendingRequest=e;return a})["catch"](function(b){c.m_explicitBatchInProgress=false;f=c.m_pendingRequest;c.m_pendingRequest=e;return a._createPromiseFromException(b)});else{this.m_explicitBatchInProgress=false;f=this.m_pendingRequest;this.m_pendingRequest=e;h=b._createPromiseFromResult(d)}return h.then(function(a){return c.ensureRequestUrlAndHeaderInfo().then(function(){return c.syncPrivate(f)}).then(function(){return a})})};f._run=function(e,g,a,b,d,c){if(a===void 0)a=3;if(b===void 0)b=5e3;return f._runCommon("run",null,e,0,g,a,b,null,d,c)};f.isValidRequestInfo=function(a){return typeof a==="string"||f.isRequestUrlAndHeaderInfo(a)||f.isRequestUrlAndHeaderInfoResolver(a)};f.isRequestUrlAndHeaderInfo=function(a){return typeof a==="object"&&a!==null&&Object.getPrototypeOf(a)===Object.getPrototypeOf({})&&!b.isNullOrUndefined(a.url)};f.isRequestUrlAndHeaderInfoResolver=function(a){return typeof a==="object"&&a!==null&&typeof a._resolveRequestUrlAndHeaderInfo==="function"};f._runBatch=function(h,e,g,i,a,b,d,c){if(a===void 0)a=3;if(b===void 0)b=5e3;return f._runBatchCommon(0,h,e,g,a,b,i,d,c)};f._runExplicitBatch=function(h,e,g,i,a,b,d,c){if(a===void 0)a=3;if(b===void 0)b=5e3;return f._runBatchCommon(1,h,e,g,a,b,i,d,c)};f._runBatchCommon=function(u,d,a,t,l,m,p,s,r){if(l===void 0)l=3;if(m===void 0)m=5e3;var h,n,i=null,c=null,e=0,j=null;if(a.length>0)if(f.isValidRequestInfo(a[0])){i=a[0];e=1}else if(b.isPlainJsonObject(a[0])){j=a[0];i=j.session;if(i!=null&&!f.isValidRequestInfo(i))return f.createErrorPromise(d);c=j.previousObjects;e=1}if(a.length==e+1)n=a[e+0];else if(j==null&&a.length==e+2){c=a[e+0];n=a[e+1]}else return f.createErrorPromise(d);if(c!=null)if(c instanceof N)h=function(){return c.context};else if(c instanceof f)h=function(){return c};else if(Array.isArray(c)){var g=c;if(g.length==0)return f.createErrorPromise(d);for(var k=0;k<g.length;k++){if(!(g[k]instanceof N))return f.createErrorPromise(d);if(g[k].context!=g[0].context)return f.createErrorPromise(d,q.invalidRequestContext)}h=function(){return g[0].context}}else return f.createErrorPromise(d);else h=t;var o=null;if(p)o=function(a){return p(j||{},a)};return f._runCommon(d,i,h,u,n,l,m,o,s,r)};f.createErrorPromise=function(d,c){if(c===void 0)c=i.invalidArgument;return a._createPromiseFromException(b.createRuntimeError(c,a._getResourceString(c),d))};f._runCommon=function(t,g,r,h,i,o,u,m,l,k){if(s._overrideSession)g=s._overrideSession;var p=a.createPromise(function(a,b){a()}),d,n=false,e,j;return p.then(function(){d=r(g);if(d._autoCleanup)return new c.Promise(function(a,b){d._onRunFinishedNotifiers.push(function(){d._autoCleanup=true;a()})});else d._autoCleanup=true}).then(function(){if(typeof i!=="function")return f.createErrorPromise(t);j=d.m_batchMode;d.m_batchMode=h;m&&m(d);var a;if(h==1)a=i(d.batch.bind(d));else a=i(d);(b.isNullOrUndefined(a)||typeof a.then!=="function")&&b.throwError(q.runMustReturnPromise);return a}).then(function(a){if(h===1)return a;else return d.sync(a)}).then(function(a){n=true;e=a})["catch"](function(a){e=a}).then(function(){var c=d.trackedObjects._retrieveAndClearAutoCleanupList();d._autoCleanup=false;d.m_batchMode=j;for(var h in c)c[h]._objectPath.isValid=false;var a=0;if(b._synchronousCleanup||f.isRequestUrlAndHeaderInfoResolver(g))return e();else e();function e(){a++;var f=d.m_pendingRequest,g=d.m_batchMode,b=new x(d);d.m_pendingRequest=b;d.m_batchMode=0;try{for(var h in c)d.trackedObjects.remove(c[h])}finally{d.m_batchMode=g;d.m_pendingRequest=f}return d.syncPrivate(b).then(function(){l&&l(a)})["catch"](function(){k&&k(a);a<o&&setTimeout(function(){e()},u)})}}).then(function(){if(d._onRunFinishedNotifiers&&d._onRunFinishedNotifiers.length>0){var a=d._onRunFinishedNotifiers.shift();a()}if(n)return e;else throw e;})};return f}(D);c.ClientRequestContext=eb;var gb=function(){function c(c,h){this.m_proxy=c;this.m_shouldPolyfill=h;var f=c[e.scalarPropertyNames],d=c[e.navigationPropertyNames],g=c[e.className],i=c[e.isCollection];if(f)for(var a=0;a<f.length;a++)b.definePropertyThrowUnloadedException(this,g,f[a]);if(d)for(var a=0;a<d.length;a++)b.definePropertyThrowUnloadedException(this,g,d[a]);i&&b.definePropertyThrowUnloadedException(this,g,e.itemsLowerCase)}Object.defineProperty(c.prototype,"$proxy",{"get":function(){return this.m_proxy},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"$isNullObject",{"get":function(){if(!this.m_isLoaded)throw new d.RuntimeError({code:B.valueNotLoaded,message:a._getResourceString(q.valueNotLoaded),debugInfo:{errorLocation:"retrieveResult.$isNullObject"}});return this.m_isNullObject},enumerable:true,configurable:true});c.prototype.toJSON=function(){if(!this.m_isLoaded)return undefined;if(this.m_isNullObject)return null;if(b.isUndefined(this.m_json))this.m_json=b.purifyJson(this.m_value);return this.m_json};c.prototype.toString=function(){return JSON.stringify(this.toJSON())};c.prototype._handleResult=function(a){this.m_isLoaded=true;if(a===null||typeof a==="object"&&a&&a._IsNull){this.m_isNullObject=true;a=null}else this.m_isNullObject=false;if(this.m_shouldPolyfill)a=b.changePropertyNameToCamelLowerCase(a);this.m_value=a;this.m_proxy._handleRetrieveResult(a,this)};return c}(),e=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}a.getItemAt="GetItemAt";a.index="_Index";a.iterativeExecutor="IterativeExecutor";a.isTracked="_IsTracked";a.eventMessageCategory=65536;a.eventWorkbookId="Workbook";a.eventSourceRemote="Remote";a.proxy="$proxy";a.className="_className";a.isCollection="_isCollection";a.collectionPropertyPath="_collectionPropertyPath";a.objectPathInfoDoNotKeepReferenceFieldName="D";a.officeScriptEventId="X-OfficeScriptEventId";return a}(j);c.Constants=e;var x=function(c){__extends(b,c);function b(b){var a=c.call(this,b)||this;a.m_context=b;a.m_pendingProcessEventHandlers=[];a.m_pendingEventHandlerActions={};a.m_traceInfos={};a.m_responseTraceIds={};a.m_responseTraceMessages=[];return a}Object.defineProperty(b.prototype,"traceInfos",{"get":function(){return this.m_traceInfos},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_responseTraceMessages",{"get":function(){return this.m_responseTraceMessages},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_responseTraceIds",{"get":function(){return this.m_responseTraceIds},enumerable:true,configurable:true});b.prototype._setResponseTraceIds=function(c){if(c)for(var d=0;d<c.length;d++){var b=c[d];this.m_responseTraceIds[b]=b;var e=this.m_traceInfos[b];!a.isNullOrUndefined(e)&&this.m_responseTraceMessages.push(e)}};b.prototype.addTrace=function(a,b){this.m_traceInfos[a]=b};b.prototype._addPendingEventHandlerAction=function(a,b){if(!this.m_pendingEventHandlerActions[a._id]){this.m_pendingEventHandlerActions[a._id]=[];this.m_pendingProcessEventHandlers.push(a)}this.m_pendingEventHandlerActions[a._id].push(b)};Object.defineProperty(b.prototype,"_pendingProcessEventHandlers",{"get":function(){return this.m_pendingProcessEventHandlers},enumerable:true,configurable:true});b.prototype._getPendingEventHandlerActions=function(a){return this.m_pendingEventHandlerActions[a._id]};return b}(K);c.ClientRequest=x;var S=function(){function b(a,e,d,c){var b=this;this.m_id=a._nextId();this.m_context=a;this.m_name=d;this.m_handlers=[];this.m_registered=false;this.m_eventInfo=c;this.m_callback=function(a){b.m_eventInfo.eventArgsTransformFunc(a).then(function(a){return b.fireEvent(a)})}}Object.defineProperty(b.prototype,"_registered",{"get":function(){return this.m_registered},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_id",{"get":function(){return this.m_id},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_handlers",{"get":function(){return this.m_handlers},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_context",{"get":function(){return this.m_context},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_callback",{"get":function(){return this.m_callback},enumerable:true,configurable:true});b.prototype.add=function(a){var b=p.createTraceAction(this.m_context,null,false);this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:b.actionInfo.Id,handler:a,operation:0});return new J(this.m_context,this,a)};b.prototype.remove=function(a){var b=p.createTraceAction(this.m_context,null,false);this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:b.actionInfo.Id,handler:a,operation:1})};b.prototype.removeAll=function(){var a=p.createTraceAction(this.m_context,null,false);this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:a.actionInfo.Id,handler:null,operation:2})};b.prototype._processRegistration=function(i){var e=this,d=a._createPromiseFromResult(null),f=i._getPendingEventHandlerActions(this);if(!f)return d;for(var b=[],c=0;c<this.m_handlers.length;c++)b.push(this.m_handlers[c]);for(var h=false,c=0;c<f.length;c++)if(i._responseTraceIds[f[c].id]){h=true;switch(f[c].operation){case 0:b.push(f[c].handler);break;case 1:for(var g=b.length-1;g>=0;g--)if(b[g]===f[c].handler){b.splice(g,1);break}break;case 2:b=[];break}}if(h){if(!this.m_registered&&b.length>0)d=d.then(function(){return e.m_eventInfo.registerFunc(e.m_callback)}).then(function(){return e.m_registered=true});else if(this.m_registered&&b.length==0)d=d.then(function(){return e.m_eventInfo.unregisterFunc(e.m_callback)})["catch"](function(b){a.log("Error when unregister event: "+JSON.stringify(b))}).then(function(){return e.m_registered=false});d=d.then(function(){return e.m_handlers=b})}return d};b.prototype.fireEvent=function(e){for(var c=[],b=0;b<this.m_handlers.length;b++){var d=this.m_handlers[b],f=a._createPromiseFromResult(null).then(this.createFireOneEventHandlerFunc(d,e))["catch"](function(b){a.log("Error when invoke handler: "+JSON.stringify(b))});c.push(f)}a.Promise.all(c)};b.prototype.createFireOneEventHandlerFunc=function(a,b){return function(){return a(b)}};return b}();c.EventHandlers=S;var J=function(){function a(b,a,c){this.m_context=b;this.m_allHandlers=a;this.m_handler=c}Object.defineProperty(a.prototype,"context",{"get":function(){return this.m_context},enumerable:true,configurable:true});a.prototype.remove=function(){if(this.m_allHandlers&&this.m_handler){this.m_allHandlers.remove(this.m_handler);this.m_allHandlers=null;this.m_handler=null}};return a}();c.EventHandlerResult=J;(function(a){var c=function(){function c(){}c.prototype.register=function(e,d,c){switch(e){case 4:return b.promisify(function(a){return Office.context.document.bindings.getByIdAsync(d,a)}).then(function(a){return b.promisify(function(b){return a.addHandlerAsync(Office.EventType.BindingDataChanged,c,b)})});case 3:return b.promisify(function(a){return Office.context.document.bindings.getByIdAsync(d,a)}).then(function(a){return b.promisify(function(b){return a.addHandlerAsync(Office.EventType.BindingSelectionChanged,c,b)})});case 2:return b.promisify(function(a){return Office.context.document.addHandlerAsync(Office.EventType.DocumentSelectionChanged,c,a)});case 1:return b.promisify(function(a){return Office.context.document.settings.addHandlerAsync(Office.EventType.SettingsChanged,c,a)});case 5:return b.promisify(function(a){return OSF.DDA.RichApi.richApiMessageManager.addHandlerAsync("richApiMessage",c,a)});case 13:return b.promisify(function(a){return Office.context.document.addHandlerAsync(Office.EventType.ObjectDeleted,c,{id:d},a)});case 14:return b.promisify(function(a){return Office.context.document.addHandlerAsync(Office.EventType.ObjectSelectionChanged,c,{id:d},a)});case 15:return b.promisify(function(a){return Office.context.document.addHandlerAsync(Office.EventType.ObjectDataChanged,c,{id:d},a)});case 16:return b.promisify(function(a){return Office.context.document.addHandlerAsync(Office.EventType.ContentControlAdded,c,{id:d},a)});default:throw a.RuntimeError._createInvalidArgError({argumentName:"eventId"});}};c.prototype.unregister=function(e,d,c){switch(e){case 4:return b.promisify(function(a){return Office.context.document.bindings.getByIdAsync(d,a)}).then(function(a){return b.promisify(function(b){return a.removeHandlerAsync(Office.EventType.BindingDataChanged,{handler:c},b)})});case 3:return b.promisify(function(a){return Office.context.document.bindings.getByIdAsync(d,a)}).then(function(a){return b.promisify(function(b){return a.removeHandlerAsync(Office.EventType.BindingSelectionChanged,{handler:c},b)})});case 2:return b.promisify(function(a){return Office.context.document.removeHandlerAsync(Office.EventType.DocumentSelectionChanged,{handler:c},a)});case 1:return b.promisify(function(a){return Office.context.document.settings.removeHandlerAsync(Office.EventType.SettingsChanged,{handler:c},a)});case 5:return b.promisify(function(a){return OSF.DDA.RichApi.richApiMessageManager.removeHandlerAsync("richApiMessage",{handler:c},a)});case 13:return b.promisify(function(a){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectDeleted,{id:d,handler:c},a)});case 14:return b.promisify(function(a){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectSelectionChanged,{id:d,handler:c},a)});case 15:return b.promisify(function(a){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectDataChanged,{id:d,handler:c},a)});case 16:return b.promisify(function(a){return Office.context.document.removeHandlerAsync(Office.EventType.ContentControlAdded,{id:d,handler:c},a)});default:throw a.RuntimeError._createInvalidArgError({argumentName:"eventId"});}};return c}();a.officeJsEventRegistration=new c})(d=c._Internal||(c._Internal={}));var L=function(){function a(b,a){this.m_handlersByEventByTarget={};this.m_registerEventImpl=b;this.m_unregisterEventImpl=a}a.getTargetIdOrDefault=function(a){if(b.isNullOrUndefined(a))return"";return a};a.prototype.getHandlers=function(e,d){d=a.getTargetIdOrDefault(d);var b=this.m_handlersByEventByTarget[e];if(!b){b={};this.m_handlersByEventByTarget[e]=b}var c=b[d];if(!c){c=[];b[d]=c}return c};a.prototype.callHandlers=function(e,d,c){for(var b=this.getHandlers(e,d),a=0;a<b.length;a++)b[a](c)};a.prototype.hasHandlers=function(b,a){return this.getHandlers(b,a).length>0};a.prototype.register=function(e,c,f){if(!f)throw d.RuntimeError._createInvalidArgError({argumentName:"handler"});var a=this.getHandlers(e,c);a.push(f);if(a.length===1)return this.m_registerEventImpl(e,c);return b._createPromiseFromResult(null)};a.prototype.unregister=function(f,e,g){if(!g)throw d.RuntimeError._createInvalidArgError({argumentName:"handler"});for(var a=this.getHandlers(f,e),c=a.length-1;c>=0;c--)if(a[c]===g){a.splice(c,1);break}if(a.length===0)return this.m_unregisterEventImpl(f,e);return b._createPromiseFromResult(null)};return a}();c.EventRegistration=L;var o=function(){function c(){this.m_eventRegistration=new L(this._registerEventImpl.bind(this),this._unregisterEventImpl.bind(this));this.m_richApiMessageHandler=this._handleRichApiMessage.bind(this)}c.prototype.ready=function(){var a=this;if(!this.m_ready)if(c._testReadyImpl)this.m_ready=c._testReadyImpl().then(function(){a.m_isReady=true});else if(v.instance)this.m_ready=b._createPromiseFromResult(null).then(function(){a.m_isReady=true});else this.m_ready=d.officeJsEventRegistration.register(5,"",this.m_richApiMessageHandler).then(function(){a.m_isReady=true});return this.m_ready};Object.defineProperty(c.prototype,"isReady",{"get":function(){return this.m_isReady},enumerable:true,configurable:true});c.prototype.register=function(b,a,c){var d=this;return this.ready().then(function(){return d.m_eventRegistration.register(b,a,c)})};c.prototype.unregister=function(b,a,c){var d=this;return this.ready().then(function(){return d.m_eventRegistration.unregister(b,a,c)})};c.prototype._registerEventImpl=function(c,a){return b._createPromiseFromResult(null)};c.prototype._unregisterEventImpl=function(c,a){return b._createPromiseFromResult(null)};c.prototype._handleRichApiMessage=function(c){if(c&&c.entries)for(var d=0;d<c.entries.length;d++){var b=c.entries[d];if(b.messageCategory==e.eventMessageCategory){a._logEnabled&&a.log(JSON.stringify(b));var g=b.messageType,f=b.targetId,i=this.m_eventRegistration.hasHandlers(g,f);if(i){var h=JSON.parse(b.message);if(b.isRemoteOverride)h.source=e.eventSourceRemote;this.m_eventRegistration.callHandlers(g,f,h)}}}};c.getGenericEventRegistration=function(){if(!c.s_genericEventRegistration)c.s_genericEventRegistration=new c;return c.s_genericEventRegistration};c.richApiMessageEventCategory=65536;return c}();c.GenericEventRegistration=o;function V(a){o._testReadyImpl=a}c._testSetRichApiMessageReadyImpl=V;function W(a){o.getGenericEventRegistration()._handleRichApiMessage(a)}c._testTriggerRichApiMessageEvent=W;var fb=function(b){__extends(a,b);function a(e,d,f,a){var c=b.call(this,e,d,f,a)||this;c.m_genericEventInfo=a;return c}a.prototype.add=function(b){var a=this;this._handlers.length==0&&this.m_genericEventInfo.registerFunc&&this.m_genericEventInfo.registerFunc();!o.getGenericEventRegistration().isReady&&this._context._pendingRequest._addPreSyncPromise(o.getGenericEventRegistration().ready());p.createTraceMarkerForCallback(this._context,function(){a._handlers.push(b);a._handlers.length==1&&o.getGenericEventRegistration().register(a.m_genericEventInfo.eventType,a.m_genericEventInfo.getTargetIdFunc(),a._callback)});return new J(this._context,this,b)};a.prototype.remove=function(b){var a=this;this._handlers.length==1&&this.m_genericEventInfo.unregisterFunc&&this.m_genericEventInfo.unregisterFunc();p.createTraceMarkerForCallback(this._context,function(){for(var c=a._handlers,d=c.length-1;d>=0;d--)if(c[d]===b){c.splice(d,1);break}c.length==0&&o.getGenericEventRegistration().unregister(a.m_genericEventInfo.eventType,a.m_genericEventInfo.getTargetIdFunc(),a._callback)})};a.prototype.removeAll=function(){};return a}(S);c.GenericEventHandlers=fb;var Y=function(){function a(a){this.m_clientObject=a}a.prototype._handleResult=function(a){this.m_clientObject._handleIdResult(a)};return a}(),r=function(){function a(){}a.createGlobalObjectObjectPath=function(b){var a={Id:b._nextId(),ObjectPathType:1,Name:""};return new m(a,null,false,false,1,4)};a.createNewObjectObjectPath=function(e,d,c,f){var a={Id:e._nextId(),ObjectPathType:2,Name:d},g=new m(a,null,c,false,1,b._fixupApiFlags(f));return g};a.createPropertyObjectPath=function(g,a,f,e,c,h){var d={Id:g._nextId(),ObjectPathType:4,Name:f,ParentObjectPathId:a._objectPath.objectPathInfo.Id},i=new m(d,a._objectPath,e,c,1,b._fixupApiFlags(h));return i};a.createIndexerObjectPath=function(c,b,d){var a={Id:c._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:b._objectPath.objectPathInfo.Id,ArgumentInfo:{}};a.ArgumentInfo.Arguments=d;return new m(a,b._objectPath,false,false,1,4)};a.createIndexerObjectPathUsingParentPath=function(c,a,d){var b={Id:c._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:a.objectPathInfo.Id,ArgumentInfo:{}};b.ArgumentInfo.Arguments=d;return new m(b,a,false,false,1,4)};a.createMethodObjectPath=function(d,e,k,i,n,j,f,h,l){var c={Id:d._nextId(),ObjectPathType:3,Name:k,ParentObjectPathId:e._objectPath.objectPathInfo.Id,ArgumentInfo:{}},g=b.setMethodArguments(d,c.ArgumentInfo,n),a=new m(c,e._objectPath,j,f,i,b._fixupApiFlags(l));a.argumentObjectPaths=g;a.getByIdMethodName=h;return a};a.createReferenceIdObjectPath=function(c,b){var a={Id:c._nextId(),ObjectPathType:6,Name:b,ArgumentInfo:{}},d=new m(a,null,false,false,1,4);return d};a.createChildItemObjectPathUsingIndexerOrGetItemAt=function(f,d,e,c,g){var h=b.tryGetObjectIdFromLoadOrRetrieveResult(c);if(f&&!b.isNullOrUndefined(h))return a.createChildItemObjectPathUsingIndexer(d,e,c);else return a.createChildItemObjectPathUsingGetItemAt(d,e,c,g)};a.createChildItemObjectPathUsingIndexer=function(e,c,d){var f=b.tryGetObjectIdFromLoadOrRetrieveResult(d),a=a={Id:e._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:c._objectPath.objectPathInfo.Id,ArgumentInfo:{}};a.ArgumentInfo.Arguments=[f];return new m(a,c._objectPath,false,false,1,4)};a.createChildItemObjectPathUsingGetItemAt=function(g,c,f,d){var a=f[e.index];if(a)d=a;var b={Id:g._nextId(),ObjectPathType:3,Name:e.getItemAt,ParentObjectPathId:c._objectPath.objectPathInfo.Id,ArgumentInfo:{}};b.ArgumentInfo.Arguments=[d];return new m(b,c._objectPath,false,false,1,4)};return a}();c.ObjectPathFactory=r;var db=function(){function b(a){this.m_context=a}b.prototype.executeAsync=function(g,f,e){var h=this,d=k.buildMessageArrayForIRequestExecutor(g,f,e,b.SourceLibHeaderValue);return new c.Promise(function(b,c){OSF.DDA.RichApi.executeRichApiRequestAsync(d,function(c){a.log("Response:");a.log(JSON.stringify(c));var d;if(c.status=="succeeded")d=k.buildResponseOnSuccess(k.getResponseBody(c),k.getResponseHeaders(c));else{d=k.buildResponseOnError(c.error.code,c.error.message);h.m_context._processOfficeJsErrorResponse(c.error.code,d)}b(d)})})};b.SourceLibHeaderValue="officejs";return b}(),R=function(){function c(a){this._autoCleanupList={};this.m_context=a}c.prototype.add=function(a){var b=this;if(Array.isArray(a))a.forEach(function(a){return b._addCommon(a,true)});else this._addCommon(a,true)};c.prototype._autoAdd=function(a){this._addCommon(a,false);this._autoCleanupList[a._objectPath.objectPathInfo.Id]=a};c.prototype._autoTrackIfNecessaryWhenHandleObjectResultValue=function(a,c){var d=this.m_context._autoCleanup&&!a[e.isTracked]&&a!==this.m_context._rootObject&&c&&!b.isNullOrEmptyString(c[e.referenceId]);if(d){this._autoCleanupList[a._objectPath.objectPathInfo.Id]=a;a[e.isTracked]=true}};c.prototype._addCommon=function(c,d){if(c[e.isTracked]){if(d&&this.m_context._autoCleanup)delete this._autoCleanupList[c._objectPath.objectPathInfo.Id];return}var h=c[e.referenceId],f=c._objectPath.objectPathInfo[e.objectPathInfoDoNotKeepReferenceFieldName];if(f)throw b.createRuntimeError(g.generalException,a._getResourceString(q.objectIsUntracked),null);if(b.isNullOrEmptyString(h)&&c._KeepReference){c._KeepReference();p.createInstantiateAction(this.m_context,c);if(d&&this.m_context._autoCleanup)delete this._autoCleanupList[c._objectPath.objectPathInfo.Id];c[e.isTracked]=true}};c.prototype.remove=function(a){var b=this;if(Array.isArray(a))a.forEach(function(a){return b._removeCommon(a)});else this._removeCommon(a)};c.prototype._removeCommon=function(a){a._objectPath.objectPathInfo[e.objectPathInfoDoNotKeepReferenceFieldName]=true;a.context._pendingRequest._removeKeepReferenceAction(a._objectPath.objectPathInfo.Id);var c=a[e.referenceId];if(!b.isNullOrEmptyString(c)){var d=this.m_context._rootObject;d._RemoveReference&&d._RemoveReference(c)}delete a[e.isTracked]};c.prototype._retrieveAndClearAutoCleanupList=function(){var a=this._autoCleanupList;this._autoCleanupList={};return a};return c}();c.TrackedObjects=R;var H=function(){function a(a,b,e,c,d){if(!a)a="root";this.m_globalObjName=a;this.m_referencedObjectPaths=b;this.m_actions=e;this.m_statements=[];this.m_variableNameForObjectPathMap={};this.m_variableNameToObjectPathMap={};this.m_declaredObjectPathMap={};this.m_showDispose=c;this.m_removePII=d}a.prototype.process=function(){this.m_showDispose&&x._calculateLastUsedObjectPathIds(this.m_actions);for(var a=0;a<this.m_actions.length;a++)this.processOneAction(this.m_actions[a]);return this.m_statements};a.prototype.processForDebugStatementInfo=function(i){this.m_showDispose&&x._calculateLastUsedObjectPathIds(this.m_actions);var f=5;this.m_statements=[];for(var j="",a=-1,e=0;e<this.m_actions.length;e++){this.processOneAction(this.m_actions[e]);if(i==e)a=this.m_statements.length-1;if(a>=0&&this.m_statements.length>a+f+1)break}if(a<0)return null;var c=a-f;if(c<0)c=0;var d=a+1+f;if(d>this.m_statements.length)d=this.m_statements.length;var b=[];c!=0&&b.push("...");for(var g=c;g<a;g++)b.push(this.m_statements[g]);b.push("// >>>>>");b.push(this.m_statements[a]);b.push("// <<<<<");for(var h=a+1;h<d;h++)b.push(this.m_statements[h]);d<this.m_statements.length&&b.push("...");return{statement:this.m_statements[a],surroundingStatements:b}};a.prototype.processOneAction=function(a){var b=a.actionInfo;switch(b.ActionType){case 1:this.processInstantiateAction(a);break;case 3:this.processMethodAction(a);break;case 2:this.processQueryAction(a);break;case 7:this.processQueryAsJsonAction(a);break;case 6:this.processRecursiveQueryAction(a);break;case 4:this.processSetPropertyAction(a);break;case 5:this.processTraceAction(a);break;case 8:this.processEnsureUnchangedAction(a);break;case 9:this.processUpdateAction(a);break}};a.prototype.processInstantiateAction=function(d){var b=d.actionInfo.ObjectPathId,e=this.m_referencedObjectPaths[b],c=this.getObjVarName(b);if(!this.m_declaredObjectPathMap[b]){var a="var "+c+"="+this.buildObjectPathExpressionWithParent(e)+";";a=this.appendDisposeCommentIfRelevant(a,d);this.m_statements.push(a);this.m_declaredObjectPathMap[b]=c}else{var a="// Instantiate {"+c+"}";a=this.appendDisposeCommentIfRelevant(a,d);this.m_statements.push(a)}};a.prototype.processMethodAction=function(a){var d=a.actionInfo.Name;if(d==="_KeepReference"){if(!c._internalConfig.showInternalApiInDebugInfo)return;d="track"}var e=this.getObjVarName(a.actionInfo.ObjectPathId)+"."+b._toCamelLowerCase(d)+"("+this.buildArgumentsExpression(a.actionInfo.ArgumentInfo)+");";e=this.appendDisposeCommentIfRelevant(e,a);this.m_statements.push(e)};a.prototype.processQueryAction=function(b){var c=this.buildQueryExpression(b),a=this.getObjVarName(b.actionInfo.ObjectPathId)+".load("+c+");";a=this.appendDisposeCommentIfRelevant(a,b);this.m_statements.push(a)};a.prototype.processQueryAsJsonAction=function(b){var c=this.buildQueryExpression(b),a=this.getObjVarName(b.actionInfo.ObjectPathId)+".retrieve("+c+");";a=this.appendDisposeCommentIfRelevant(a,b);this.m_statements.push(a)};a.prototype.processRecursiveQueryAction=function(a){var c="";if(a.actionInfo.RecursiveQueryInfo)c=JSON.stringify(a.actionInfo.RecursiveQueryInfo);var b=this.getObjVarName(a.actionInfo.ObjectPathId)+".loadRecursive("+c+");";b=this.appendDisposeCommentIfRelevant(b,a);this.m_statements.push(b)};a.prototype.processSetPropertyAction=function(a){var c=this.getObjVarName(a.actionInfo.ObjectPathId)+"."+b._toCamelLowerCase(a.actionInfo.Name)+"="+this.buildArgumentsExpression(a.actionInfo.ArgumentInfo)+";";c=this.appendDisposeCommentIfRelevant(c,a);this.m_statements.push(c)};a.prototype.processTraceAction=function(b){var a="context.trace();";a=this.appendDisposeCommentIfRelevant(a,b);this.m_statements.push(a)};a.prototype.processEnsureUnchangedAction=function(b){var a=this.getObjVarName(b.actionInfo.ObjectPathId)+".ensureUnchanged("+JSON.stringify(b.actionInfo.ObjectState)+");";a=this.appendDisposeCommentIfRelevant(a,b);this.m_statements.push(a)};a.prototype.processUpdateAction=function(b){var a=this.getObjVarName(b.actionInfo.ObjectPathId)+".update("+JSON.stringify(b.actionInfo.ObjectState)+");";a=this.appendDisposeCommentIfRelevant(a,b);this.m_statements.push(a)};a.prototype.appendDisposeCommentIfRelevant=function(b,d){var e=this;if(this.m_showDispose){var a=d.actionInfo.L;if(a&&a.length>0){var c=a.map(function(a){return e.getObjVarName(a)}).join(", ");return b+" // And then dispose {"+c+"}"}}return b};a.prototype.buildQueryExpression=function(b){if(b.actionInfo.QueryInfo){var a={};a.select=b.actionInfo.QueryInfo.Select;a.expand=b.actionInfo.QueryInfo.Expand;a.skip=b.actionInfo.QueryInfo.Skip;a.top=b.actionInfo.QueryInfo.Top;if(typeof a.top==="undefined"&&typeof a.skip==="undefined"&&typeof a.expand==="undefined")if(typeof a.select==="undefined")return"";else return JSON.stringify(a.select);else return JSON.stringify(a)}return""};a.prototype.buildObjectPathExpressionWithParent=function(a){var b=a.objectPathInfo.ObjectPathType==5||a.objectPathInfo.ObjectPathType==3||a.objectPathInfo.ObjectPathType==4;if(b&&a.objectPathInfo.ParentObjectPathId)return this.getObjVarName(a.objectPathInfo.ParentObjectPathId)+"."+this.buildObjectPathExpression(a);return this.buildObjectPathExpression(a)};a.prototype.buildObjectPathExpression=function(c){var a=this.buildObjectPathInfoExpression(c.objectPathInfo),b=c.originalObjectPathInfo;if(b)a=a+" /* originally "+this.buildObjectPathInfoExpression(b)+" */";return a};a.prototype.buildObjectPathInfoExpression=function(a){switch(a.ObjectPathType){case 1:return"context."+this.m_globalObjName;case 5:return"getItem("+this.buildArgumentsExpression(a.ArgumentInfo)+")";case 3:return b._toCamelLowerCase(a.Name)+"("+this.buildArgumentsExpression(a.ArgumentInfo)+")";case 2:return a.Name+".newObject()";case 7:return"null";case 4:return b._toCamelLowerCase(a.Name);case 6:return"context."+this.m_globalObjName+"._getObjectByReferenceId("+JSON.stringify(a.Name)+")"}};a.prototype.buildArgumentsExpression=function(b){var a="";if(!b.Arguments||b.Arguments.length===0)return a;if(this.m_removePII){if(typeof b.Arguments[0]==="undefined")return a;return"..."}for(var c=0;c<b.Arguments.length;c++){if(c>0)a=a+", ";a=a+this.buildArgumentLiteral(b.Arguments[c],b.ReferencedObjectPathIds?b.ReferencedObjectPathIds[c]:null)}if(a==="undefined")a="";return a};a.prototype.buildArgumentLiteral=function(a,b){if(typeof a=="number"&&a===b)return this.getObjVarName(b);else return JSON.stringify(a)};a.prototype.getObjVarNameBase=function(f){var a="v",e=this.m_referencedObjectPaths[f];if(e)switch(e.objectPathInfo.ObjectPathType){case 1:a=this.m_globalObjName;break;case 4:a=b._toCamelLowerCase(e.objectPathInfo.Name);break;case 3:var c=e.objectPathInfo.Name;if(c.length>3&&c.substr(0,3)==="Get")c=c.substr(3);a=b._toCamelLowerCase(c);break;case 5:var d=this.getObjVarNameBase(e.objectPathInfo.ParentObjectPathId);if(d.charAt(d.length-1)==="s")a=d.substr(0,d.length-1);else a=d+"Item";break}return a};a.prototype.getObjVarName=function(b){if(this.m_variableNameForObjectPathMap[b])return this.m_variableNameForObjectPathMap[b];var a=this.getObjVarNameBase(b);if(!this.m_variableNameToObjectPathMap[a]){this.m_variableNameForObjectPathMap[b]=a;this.m_variableNameToObjectPathMap[a]=b;return a}var c=1;while(this.m_variableNameToObjectPathMap[a+c.toString()])c++;a=a+c.toString();this.m_variableNameForObjectPathMap[b]=a;this.m_variableNameToObjectPathMap[a]=b;return a};return a}(),q=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}a.cannotRegisterEvent="CannotRegisterEvent";a.connectionFailureWithStatus="ConnectionFailureWithStatus";a.connectionFailureWithDetails="ConnectionFailureWithDetails";a.propertyNotLoaded="PropertyNotLoaded";a.runMustReturnPromise="RunMustReturnPromise";a.moreInfoInnerError="MoreInfoInnerError";a.cannotApplyPropertyThroughSetMethod="CannotApplyPropertyThroughSetMethod";a.invalidOperationInCellEditMode="InvalidOperationInCellEditMode";a.objectIsUntracked="ObjectIsUntracked";a.customFunctionDefintionMissing="CustomFunctionDefintionMissing";a.customFunctionImplementationMissing="CustomFunctionImplementationMissing";a.customFunctionNameContainsBadChars="CustomFunctionNameContainsBadChars";a.customFunctionNameCannotSplit="CustomFunctionNameCannotSplit";a.customFunctionUnexpectedNumberOfEntriesInResultBatch="CustomFunctionUnexpectedNumberOfEntriesInResultBatch";a.customFunctionCancellationHandlerMissing="CustomFunctionCancellationHandlerMissing";a.customFunctionInvalidFunction="CustomFunctionInvalidFunction";a.customFunctionInvalidFunctionMapping="CustomFunctionInvalidFunctionMapping";a.customFunctionWindowMissing="CustomFunctionWindowMissing";a.customFunctionDefintionMissingOnWindow="CustomFunctionDefintionMissingOnWindow";a.pendingBatchInProgress="PendingBatchInProgress";a.notInsideBatch="NotInsideBatch";a.cannotUpdateReadOnlyProperty="CannotUpdateReadOnlyProperty";return a}(w);c.ResourceStrings=q;a.addResourceStringValues({CannotRegisterEvent:"The event handler cannot be registered.",PropertyNotLoaded:"The property '{0}' is not available. Before reading the property's value, call the load method on the containing object and call \"context.sync()\" on the associated request context.",RunMustReturnPromise:'The batch function passed to the ".run" method didn\'t return a promise. The function must return a promise, so that any automatically-tracked objects can be released at the completion of the batch operation. Typically, you return a promise by returning the response from "context.sync()".',InvalidOrTimedOutSessionMessage:"Your Office Online session has expired or is invalid. To continue, refresh the page.",InvalidOperationInCellEditMode:"Excel is in cell-editing mode. Please exit the edit mode by pressing ENTER or TAB or selecting another cell, and then try again.",CustomFunctionDefintionMissing:"A property with the name '{0}' that represents the function's definition must exist on Excel.Script.CustomFunctions.",CustomFunctionDefintionMissingOnWindow:"A property with the name '{0}' that represents the function's definition must exist on the window object.",CustomFunctionImplementationMissing:"The property with the name '{0}' on Excel.Script.CustomFunctions that represents the function's definition must contain a 'call' property that implements the function.",CustomFunctionNameContainsBadChars:"The function name may only contain letters, digits, underscores, and periods.",CustomFunctionNameCannotSplit:"The function name must contain a non-empty namespace and a non-empty short name.",CustomFunctionUnexpectedNumberOfEntriesInResultBatch:"The batching function returned a number of results that doesn't match the number of parameter value sets that were passed into it.",CustomFunctionCancellationHandlerMissing:"The cancellation handler onCanceled is missing in the function. The handler must be present as the function is defined as cancelable.",CustomFunctionInvalidFunction:"The property with the name '{0}' that represents the function's definition is not a valid function.",CustomFunctionInvalidFunctionMapping:"The property with the name '{0}' on CustomFunctionMappings that represents the function's definition is not a valid function.",CustomFunctionWindowMissing:"The window object was not found.",PendingBatchInProgress:"There is a pending batch in progress. The batch method may not be called inside another batch, or simultaneously with another batch.",NotInsideBatch:"Operations may not be invoked outside of a batch method.",CannotUpdateReadOnlyProperty:"The property '{0}' is read-only and it cannot be updated.",ObjectIsUntracked:"The object is untracked."});var b=function(f){__extends(b,f);function b(){return f!==null&&f.apply(this,arguments)||this}b.fixObjectPathIfNecessary=function(a,b){a&&a._objectPath&&b&&a._objectPath.updateUsingObjectData(b,a)};b.load=function(a,b){a.context.load(a,b);return a};b.loadAndSync=function(a,b){a.context.load(a,b);return a.context.sync().then(function(){return a})};b.retrieve=function(d,f){var a=c._internalConfig.alwaysPolyfillClientObjectRetrieveMethod;if(!a)a=!b.isSetSupported("RichApiRuntime","1.1");var e=new gb(d,a);d._retrieve(f,e);return e};b.retrieveAndSync=function(a,c){var d=b.retrieve(a,c);return a.context.sync().then(function(){return d})};b.toJson=function(h,g,f,e){var c={};for(var d in g){var a=g[d];if(typeof a!=="undefined")c[d]=a}for(var d in f){var a=f[d];if(typeof a!=="undefined")if(a[b.fieldName_isCollection]&&typeof a[b.fieldName_m__items]!=="undefined")c[d]=a.toJSON().items;else c[d]=a.toJSON()}if(e)c.items=e.map(function(a){return a.toJSON()});return c};b.throwError=function(c,e,b){throw new d.RuntimeError({code:c,message:a._getResourceString(c,e),debugInfo:b?{errorLocation:b}:undefined});};b.createRuntimeError=function(c,b,a){return new d.RuntimeError({code:c,message:b,debugInfo:{errorLocation:a}})};b.throwIfNotLoaded=function(c,e,d,f){if(!f&&a.isUndefined(e)&&c.charCodeAt(0)!=b.s_underscoreCharCode)throw b.createPropertyNotLoadedException(d,c);};b.createPropertyNotLoadedException=function(c,b){return new d.RuntimeError({code:B.propertyNotLoaded,message:a._getResourceString(q.propertyNotLoaded,b),debugInfo:c?{errorLocation:c+"."+b}:undefined})};b.createCannotUpdateReadOnlyPropertyException=function(c,b){return new d.RuntimeError({code:B.cannotUpdateReadOnlyProperty,message:a._getResourceString(q.cannotUpdateReadOnlyProperty,b),debugInfo:c?{errorLocation:c+"."+b}:undefined})};b.promisify=function(a){return new c.Promise(function(c,d){var b=function(a){if(a.status=="failed")d(a.error);else c(a.value)};a(b)})};b._addActionResultHandler=function(b,c,a){b.context._pendingRequest.addActionResultHandler(c,a)};b._handleNavigationPropertyResults=function(e,d,c){for(var b=0;b<c.length-1;b+=2)!a.isUndefined(d[c[b+1]])&&e[c[b]]._handleResult(d[c[b+1]])};b._fixupApiFlags=function(a){if(typeof a==="boolean")if(a)a=1;else a=0;return a};b.definePropertyThrowUnloadedException=function(d,c,a){Object.defineProperty(d,a,{configurable:true,enumerable:true,"get":function(){throw b.createPropertyNotLoadedException(c,a);},"set":function(){throw b.createCannotUpdateReadOnlyPropertyException(c,a);}})};b.defineReadOnlyPropertyWithValue=function(d,a,c){Object.defineProperty(d,a,{configurable:true,enumerable:true,"get":function(){return c},"set":function(){throw b.createCannotUpdateReadOnlyPropertyException(null,a);}})};b.processRetrieveResult=function(i,j,g,o){if(a.isNullOrUndefined(j))return;if(o){var k=j[e.itemsLowerCase];if(Array.isArray(k)){for(var p=[],c=0;c<k.length;c++){var q=o(k[c],c),n={};n[e.proxy]=q;q._handleRetrieveResult(k[c],n);p.push(n)}b.defineReadOnlyPropertyWithValue(g,e.itemsLowerCase,p)}}else{var m=i[e.scalarPropertyNames],l=i[e.navigationPropertyNames],s=i[e.className];if(m)for(var c=0;c<m.length;c++){var d=m[c],h=j[d];if(a.isUndefined(h))b.definePropertyThrowUnloadedException(g,s,d);else b.defineReadOnlyPropertyWithValue(g,d,h)}if(l)for(var c=0;c<l.length;c++){var d=l[c],h=j[d];if(a.isUndefined(h))b.definePropertyThrowUnloadedException(g,s,d);else{var r=i[d],f={};r._handleRetrieveResult(h,f);f[e.proxy]=r;if(Array.isArray(f[e.itemsLowerCase]))f=f[e.itemsLowerCase];b.defineReadOnlyPropertyWithValue(g,d,f)}}}};b.setMockData=function(d,f,j,p){if(a.isNullOrUndefined(f)){d._handleResult(f);return}if(d[e.scalarPropertyOriginalNames]){for(var l={},o=d[e.scalarPropertyOriginalNames],i=d[e.scalarPropertyNames],c=0;c<i.length;c++)if(typeof f[i[c]]!=="undefined")l[o[c]]=f[i[c]];d._handleResult(l)}if(d[e.navigationPropertyNames])for(var g=d[e.navigationPropertyNames],c=0;c<g.length;c++)if(typeof f[g[c]]!=="undefined"){var k=d[g[c]];k.setMockData&&k.setMockData(f[g[c]])}if(d[e.isCollection]&&j){var h=Array.isArray(f)?f:f[e.itemsLowerCase];if(Array.isArray(h)){for(var m=[],c=0;c<h.length;c++){var n=j(h,c);b.setMockData(n,h[c]);m.push(n)}p(m)}}};b.fieldName_m__items="m__items";b.fieldName_isCollection="_isCollection";b._synchronousCleanup=false;b.s_underscoreCharCode="_".charCodeAt(0);return b}(f);c.Utility=b;var jb=function(){function a(){}a.invokeMethod=function(a,f,e,i,h,d){var g=p.createMethodAction(a.context,a,f,e,i,h),c=new y(d);b._addActionResultHandler(a,g,c);return c};a.invokeEnsureUnchanged=function(a,b){p.createEnsureUnchangedAction(a.context,a,b)};a.invokeSetProperty=function(a,c,b,d){p.createSetPropertyAction(a.context,a,c,b,d)};a.createRootServiceObject=function(c,a){var b=r.createGlobalObjectObjectPath(a);return new c(a,b)};a.createObjectFromReferenceId=function(d,a,b){var c=r.createReferenceIdObjectPath(a,b);return new d(a,c)};a.createTopLevelServiceObject=function(f,a,d,b,e){var c=r.createNewObjectObjectPath(a,d,b,e);return new f(a,c)};a.createPropertyObject=function(f,a,c,b,e){var d=r.createPropertyObjectPath(a.context,a,c,b,false,e);return new f(a.context,d)};a.createIndexerObject=function(d,a,c){var b=r.createIndexerObjectPath(a.context,a,c);return new d(a.context,b)};a.createMethodObject=function(j,a,f,d,i,e,b,c,h){var g=r.createMethodObjectPath(a.context,a,f,d,i,e,b,c,h);return new j(a.context,g)};a.createChildItemObject=function(f,b,a,d,e){var c=r.createChildItemObjectPathUsingIndexerOrGetItemAt(b,a.context,a,d,e);return new f(a.context,c)};return a}();c.BatchApiHelper=jb;var T=1,E={invokeRequestModifier:function(a){a.DdaMethod.Version=T;return a},invokeResponseModifier:function(a){T=a.Version;if(a.Error){a.error={};a.error.Code=a.Error}return a}},h;(function(a){a.SendingId="sId";a.RespondingId="rId";a.CommandKey="command";a.SessionInfoKey="sessionInfo";a.ParamsKey="params";a.ApiReadyCommand="apiready";a.ExecuteMethodCommand="executeMethod";a.GetAppContextCommand="getAppContext";a.RegisterEventCommand="registerEvent";a.UnregisterEventCommand="unregisterEvent";a.FireEventCommand="fireEvent"})(h||(h={}));var u=function(){function a(){}a.sessionContext="sc";a.embeddingPageOrigin="EmbeddingPageOrigin";a.embeddingPageSessionInfo="EmbeddingPageSessionInfo";return a}();c.EmbeddedConstants=u;var hb=function(d){__extends(c,d);function c(c,b){var a=d.call(this)||this;a.m_chosenWindow=null;a.m_chosenOrigin=null;a.m_enabled=true;a.m_onMessageHandler=a._onMessage.bind(a);a.m_callbackList={};a.m_id=0;a.m_timeoutId=-1;a.m_appContext=null;a.m_url=c;a.m_options=b;if(!a.m_options)a.m_options={sessionKey:Math.random().toString()};if(!a.m_options.sessionKey)a.m_options.sessionKey=Math.random().toString();if(!a.m_options.container)a.m_options.container=document.body;if(!a.m_options.timeoutInMilliseconds)a.m_options.timeoutInMilliseconds=6e4;if(!a.m_options.height)a.m_options.height="400px";if(!a.m_options.width)a.m_options.width="100%";if(!(a.m_options.webApplication&&a.m_options.webApplication.accessToken&&a.m_options.webApplication.accessTokenTtl))a.m_options.webApplication=null;return a}c.prototype._getIFrameSrc=function(){var e=window.location.protocol+"//"+window.location.host,b=u.embeddingPageOrigin+"="+encodeURIComponent(e)+"&"+u.embeddingPageSessionInfo+"="+encodeURIComponent(this.m_options.sessionKey),d=false;if(this.m_url.toLowerCase().indexOf("/_layouts/preauth.aspx")>0||this.m_url.toLowerCase().indexOf("/_layouts/15/preauth.aspx")>0)d=true;var a=document.createElement("a");a.href=this.m_url;if(this.m_options.webApplication){var c=u.embeddingPageOrigin+"="+e+"&"+u.embeddingPageSessionInfo+"="+this.m_options.sessionKey;if(a.search.length===0||a.search==="?")a.search="?"+u.sessionContext+"="+encodeURIComponent(c);else a.search=a.search+"&"+u.sessionContext+"="+encodeURIComponent(c)}else if(d)if(a.hash.length===0||a.hash==="#")a.hash="#"+b;else a.hash=a.hash+"&"+b;else if(a.search.length===0||a.search==="?")a.search="?"+b;else a.search=a.search+"&"+b;var f=a.href;return f};c.prototype.init=function(){var c=this;window.addEventListener("message",this.m_onMessageHandler);var d=this._getIFrameSrc();return a.createPromise(function(k,l){var e=document.createElement("iframe");if(c.m_options.id){e.id=c.m_options.id;e.name=c.m_options.id}e.style.height=c.m_options.height;e.style.width=c.m_options.width;if(!c.m_options.webApplication){e.src=d;c.m_options.container.appendChild(e)}else{var f=document.createElement("form");f.setAttribute("action",d);f.setAttribute("method","post");f.setAttribute("target",e.name);c.m_options.container.appendChild(f);var j=document.createElement("input");j.setAttribute("type","hidden");j.setAttribute("name","access_token");j.setAttribute("value",c.m_options.webApplication.accessToken);f.appendChild(j);var h=document.createElement("input");h.setAttribute("type","hidden");h.setAttribute("name","access_token_ttl");h.setAttribute("value",c.m_options.webApplication.accessTokenTtl);f.appendChild(h);c.m_options.container.appendChild(e);f.submit()}c.m_timeoutId=window.setTimeout(function(){c.close();var d=b.createRuntimeError(g.timeout,a._getResourceString(i.timeout),"EmbeddedSession.init");l(d)},c.m_options.timeoutInMilliseconds);c.m_promiseResolver=k})};c.prototype._invoke=function(c,b,a){if(!this.m_enabled){b(5001,null);return}if(E.invokeRequestModifier)a=E.invokeRequestModifier(a);this._sendMessageWithCallback(this.m_id++,c,a,function(a){if(E.invokeResponseModifier)a=E.invokeResponseModifier(a);var c=a.Error;delete a.Error;b(c||0,a)})};c.prototype.close=function(){window.removeEventListener("message",this.m_onMessageHandler);window.clearTimeout(this.m_timeoutId);this.m_enabled=false};Object.defineProperty(c.prototype,"eventRegistration",{"get":function(){if(!this.m_sessionEventManager)this.m_sessionEventManager=new L(this._registerEventImpl.bind(this),this._unregisterEventImpl.bind(this));return this.m_sessionEventManager},enumerable:true,configurable:true});c.prototype._createRequestExecutorOrNull=function(){return new cb(this)};c.prototype._resolveRequestUrlAndHeaderInfo=function(){return a._createPromiseFromResult(null)};c.prototype._registerEventImpl=function(d,c){var b=this;return a.createPromise(function(a,e){b._sendMessageWithCallback(b.m_id++,h.RegisterEventCommand,{EventId:d,TargetId:c},function(){a(null)})})};c.prototype._unregisterEventImpl=function(d,c){var b=this;return a.createPromise(function(a,e){b._sendMessageWithCallback(b.m_id++,h.UnregisterEventCommand,{EventId:d,TargetId:c},function(){a()})})};c.prototype._onMessage=function(b){var c=this;if(!this.m_enabled)return;if(this.m_chosenWindow&&(this.m_chosenWindow!==b.source||this.m_chosenOrigin!==b.origin))return;var a=b.data;if(a&&a[h.CommandKey]===h.ApiReadyCommand){if(!this.m_chosenWindow&&this._isValidDescendant(b.source)&&a[h.SessionInfoKey]===this.m_options.sessionKey){this.m_chosenWindow=b.source;this.m_chosenOrigin=b.origin;this._sendMessageWithCallback(this.m_id++,h.GetAppContextCommand,null,function(a){c._setupContext(a);window.clearTimeout(c.m_timeoutId);c.m_promiseResolver()})}return}if(a&&a[h.CommandKey]===h.FireEventCommand){var d=a[h.ParamsKey],k=d.EventId,j=d.TargetId,l=d.Data;if(this.m_sessionEventManager)for(var g=this.m_sessionEventManager.getHandlers(k,j),e=0;e<g.length;e++)g[e](l);return}if(a&&a.hasOwnProperty(h.RespondingId)){var i=a[h.RespondingId],f=this.m_callbackList[i];typeof f==="function"&&f(a[h.ParamsKey]);delete this.m_callbackList[i]}};c.prototype._sendMessageWithCallback=function(b,d,e,c){this.m_callbackList[b]=c;var a={};a[h.SendingId]=b;a[h.CommandKey]=d;a[h.ParamsKey]=e;this.m_chosenWindow.postMessage(JSON.stringify(a),this.m_chosenOrigin)};c.prototype._isValidDescendant=function(f){var d=this.m_options.container||document.body;function b(a){if(a===f)return true;for(var c=0,d=a.frames.length;c<d;c++)if(b(a.frames[c]))return true;return false}for(var c=d.getElementsByTagName("iframe"),a=0,e=c.length;a<e;a++)if(b(c[a].contentWindow))return true;return false};c.prototype._setupContext=function(a){if(!(this.m_appContext=a))return};return c}(s);c.EmbeddedSession=hb;var cb=function(){function b(a){this.m_session=a}b.prototype.executeAsync=function(f,e,d){var g=this,c=k.buildMessageArrayForIRequestExecutor(f,e,d,b.SourceLibHeaderValue);return a.createPromise(function(d,e){g.m_session._invoke(h.ExecuteMethodCommand,function(e,b){a.log("Response:");a.log(JSON.stringify(b));var c;if(e==0)c=k.buildResponseOnSuccess(k.getResponseBodyFromSafeArray(b.Data),k.getResponseHeadersFromSafeArray(b.Data));else c=k.buildResponseOnError(b.error.Code,b.error.Message);d(c)},b._transformMessageArrayIntoParams(c))})};b._transformMessageArrayIntoParams=function(a){return{ArrayData:a,DdaMethod:{DispatchId:b.DispidExecuteRichApiRequestMethod}}};b.DispidExecuteRichApiRequestMethod=93;b.SourceLibHeaderValue="Embedded";return b}()})(OfficeExtension||(OfficeExtension={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(c,a){for(var b in a)if(a.hasOwnProperty(b))c[b]=a[b]};return function(c,b){a(c,b);function d(){this.constructor=c}c.prototype=b===null?Object.create(b):(d.prototype=b.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(d,c,b,a){return new(b||(b=Promise))(function(i,f){function g(b){try{e(a.next(b))}catch(c){f(c)}}function h(b){try{e(a["throw"](b))}catch(c){f(c)}}function e(a){a.done?i(a.value):new b(function(b){b(a.value)}).then(g,h)}e((a=a.apply(d,c||[])).next())})},__generator=this&&this.__generator||function(g,h){var b={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},e,c,a,f;return f={next:d(0),"throw":d(1),"return":d(2)},typeof Symbol==="function"&&(f[Symbol.iterator]=function(){return this}),f;function d(a){return function(b){return i([a,b])}}function i(d){if(e)throw new TypeError("Generator is already executing.");while(b)try{if(e=1,c&&(a=c[d[0]&2?"return":d[0]?"throw":"next"])&&!(a=a.call(c,d[1])).done)return a;if(c=0,a)d=[0,a.value];switch(d[0]){case 0:case 1:a=d;break;case 4:b.label++;return{value:d[1],done:false};case 5:b.label++;c=d[1];d=[0];continue;case 7:d=b.ops.pop();b.trys.pop();continue;default:if(!(a=b.trys,a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){b=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){b.label=d[1];break}if(d[0]===6&&b.label<a[1]){b.label=a[1];a=d;break}if(a&&b.label<a[2]){b.label=a[2];b.ops.push(d);break}a[2]&&b.ops.pop();b.trys.pop();continue}d=h.call(g,b)}catch(f){d=[6,f];c=0}finally{e=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:true}}},OfficeCore;(function(b){var x="OfficeCore",r="AgaveVisualApi",o=OfficeExtension.BatchApiHelper.createPropertyObject,q=OfficeExtension.BatchApiHelper.createMethodObject,p=OfficeExtension.BatchApiHelper.createIndexerObject,k=OfficeExtension.BatchApiHelper.createRootServiceObject,c=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,m=OfficeExtension.BatchApiHelper.createChildItemObject,a=OfficeExtension.BatchApiHelper.invokeMethod,n=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,s=OfficeExtension.BatchApiHelper.invokeSetProperty,g=OfficeExtension.Utility.isNullOrUndefined,v=OfficeExtension.Utility.isUndefined,u=OfficeExtension.Utility.throwIfNotLoaded,l=OfficeExtension.Utility.throwIfApiNotSupported,z=OfficeExtension.Utility.load,y=OfficeExtension.Utility.retrieve,h=OfficeExtension.Utility.toJson,d=OfficeExtension.Utility.fixObjectPathIfNecessary,j=OfficeExtension.Utility._handleNavigationPropertyResults,t=OfficeExtension.Utility.adjustToDateTime,e=OfficeExtension.Utility.processRetrieveResult,w="BiShim",i=function(i){__extends(f,i);function f(){return i!==null&&i.apply(this,arguments)||this}Object.defineProperty(f.prototype,"_className",{"get":function(){return"BiShim"},enumerable:true,configurable:true});f.prototype.initialize=function(b){a(this,"Initialize",0,[b],0,0)};f.prototype.getData=function(){return a(this,"getData",1,[],4,0)};f.prototype.setVisualObjects=function(b){a(this,"setVisualObjects",0,[b],2,0)};f.prototype.setVisualObjectsToPersist=function(b){a(this,"setVisualObjectsToPersist",0,[b],2,0)};f.prototype._handleResult=function(a){i.prototype._handleResult.call(this,a);if(g(a))return;var b=a;d(this,b)};f.prototype._handleRetrieveResult=function(b,a){i.prototype._handleRetrieveResult.call(this,b,a);e(this,b,a)};f.newObject=function(a){return c(b.BiShim,a,"Microsoft.AgaveVisual.BiShim",false,4)};f.prototype.toJSON=function(){return h(this,{},{})};return f}(OfficeExtension.ClientObject);b.BiShim=i;var f;(function(a){a.generalException1="GeneralException"})(f=b.AgaveVisualErrorCodes||(b.AgaveVisualErrorCodes={}))})(OfficeCore||(OfficeCore={}));var OfficeCore;(function(a){var C="OfficeCore",z="ExperimentApi",w=OfficeExtension.BatchApiHelper.createPropertyObject,e=OfficeExtension.BatchApiHelper.createMethodObject,y=OfficeExtension.BatchApiHelper.createIndexerObject,t=OfficeExtension.BatchApiHelper.createRootServiceObject,h=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,v=OfficeExtension.BatchApiHelper.createChildItemObject,b=OfficeExtension.BatchApiHelper.invokeMethod,i=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,A=OfficeExtension.BatchApiHelper.invokeSetProperty,f=OfficeExtension.Utility.isNullOrUndefined,m=OfficeExtension.Utility.isUndefined,k=OfficeExtension.Utility.throwIfNotLoaded,u=OfficeExtension.Utility.throwIfApiNotSupported,r=OfficeExtension.Utility.load,p=OfficeExtension.Utility.retrieve,g=OfficeExtension.Utility.toJson,c=OfficeExtension.Utility.fixObjectPathIfNecessary,s=OfficeExtension.Utility._handleNavigationPropertyResults,B=OfficeExtension.Utility.adjustToDateTime,d=OfficeExtension.Utility.processRetrieveResult,x="FlightingService",l=function(j){__extends(i,j);function i(){return j!==null&&j.apply(this,arguments)||this}Object.defineProperty(i.prototype,"_className",{"get":function(){return"FlightingService"},enumerable:true,configurable:true});i.prototype.getClientSessionId=function(){return b(this,"GetClientSessionId",1,[],4,0)};i.prototype.getDeferredFlights=function(){return b(this,"GetDeferredFlights",1,[],4,0)};i.prototype.getFeature=function(d,f,c,b){return e(a.ABType,this,"GetFeature",1,[d,f,c,b],false,false,null,4)};i.prototype.getFeatureGate=function(b,c){return e(a.ABType,this,"GetFeatureGate",1,[b,c],false,false,null,4)};i.prototype.resetOverride=function(a){b(this,"ResetOverride",0,[a],0,0)};i.prototype.setOverride=function(a,d,c){b(this,"SetOverride",0,[a,d,c],0,0)};i.prototype._handleResult=function(a){j.prototype._handleResult.call(this,a);if(f(a))return;var b=a;c(this,b)};i.prototype._handleRetrieveResult=function(b,a){j.prototype._handleRetrieveResult.call(this,b,a);d(this,b,a)};i.newObject=function(b){return h(a.FlightingService,b,"Microsoft.Experiment.FlightingService",false,4)};i.prototype.toJSON=function(){return g(this,{},{})};return i}(OfficeExtension.ClientObject);a.FlightingService=l;var o="ABType",q=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"ABType"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["value"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"value",{"get":function(){k("value",this._V,o,this._isNull);return this._V},enumerable:true,configurable:true});a.prototype._handleResult=function(a){b.prototype._handleResult.call(this,a);if(f(a))return;var d=a;c(this,d);if(!m(d.Value))this._V=d.Value};a.prototype.load=function(a){return r(this,a)};a.prototype.retrieve=function(a){return p(this,a)};a.prototype._handleRetrieveResult=function(c,a){b.prototype._handleRetrieveResult.call(this,c,a);d(this,c,a)};a.prototype.toJSON=function(){return g(this,{value:this._V},{})};a.prototype.ensureUnchanged=function(a){i(this,a);return};return a}(OfficeExtension.ClientObject);a.ABType=q;var n;(function(a){a["boolean"]="Boolean";a.integer="Integer";a.string="String"})(n=a.FeatureType||(a.FeatureType={}));var j;(function(a){a.generalException="GeneralException"})(j=a.ExperimentErrorCodes||(a.ExperimentErrorCodes={}))})(OfficeCore||(OfficeCore={}));var OfficeCore;(function(a){a.OfficeOnlineDomainList=["*.dod.online.office365.us","*.gov.online.office365.us","*.officeapps-df.live.com","*.officeapps.live.com","*.online.office.de","*.partner.officewebapps.cn"];function b(){if(typeof window.external==="undefined"||typeof window.external.GetContext==="undefined"){var d=OSF.getClientEndPoint()._targetUrl,b=c(d);if(d.indexOf("https:")!=0)return false;a.OfficeOnlineDomainList.forEach(function(a){if(a.indexOf("*.")==0)a=a.substring(2);if(b.indexOf(a)==b.length-a.length)return true});return false}return true}a.isHostOriginTrusted=b;function c(b){var a="";a=b.split("/")[2];a=a.split(":")[0];a=a.split("?")[0];return a}})(OfficeCore||(OfficeCore={}));var OfficeCore;(function(a){var b=function(){function b(a){this.context=a}Object.defineProperty(b.prototype,"roamingSettings",{"get":function(){if(!this.m_roamingSettings)this.m_roamingSettings=a.AuthenticationService.newObject(this.context).roamingSettings;return this.m_roamingSettings},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"tap",{"get":function(){if(!this.m_tap)this.m_tap=a.Tap.newObject(this.context);return this.m_tap},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"skill",{"get":function(){if(!this.m_skill)this.m_skill=a.Skill.newObject(this.context);return this.m_skill},enumerable:true,configurable:true});return b}();a.FirstPartyApis=b;var c=function(d){__extends(c,d);function c(a){return d.call(this,a)||this}Object.defineProperty(c.prototype,"firstParty",{"get":function(){if(!this.m_firstPartyApis)this.m_firstPartyApis=new b(this);return this.m_firstPartyApis},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"flighting",{"get":function(){return this.flightingService},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"telemetry",{"get":function(){if(!this.m_telemetry)this.m_telemetry=a.TelemetryService.newObject(this);return this.m_telemetry},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"ribbon",{"get":function(){if(!this.m_ribbon)this.m_ribbon=a.DynamicRibbon.newObject(this);return this.m_ribbon},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"bi",{"get":function(){if(!this.m_biShim)this.m_biShim=a.BiShim.newObject(this);return this.m_biShim},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"flightingService",{"get":function(){if(!this.m_flightingService)this.m_flightingService=a.FlightingService.newObject(this);return this.m_flightingService},enumerable:true,configurable:true});return c}(OfficeExtension.ClientRequestContext);a.RequestContext=c;function d(b,c){return OfficeExtension.ClientRequestContext._runBatch("OfficeCore.run",arguments,function(b){return new a.RequestContext(b)})}a.run=d})(OfficeCore||(OfficeCore={}));var OfficeCore;(function(b){var y="Office",r="OfficeSharedApi",o=OfficeExtension.BatchApiHelper.createPropertyObject,q=OfficeExtension.BatchApiHelper.createMethodObject,p=OfficeExtension.BatchApiHelper.createIndexerObject,k=OfficeExtension.BatchApiHelper.createRootServiceObject,c=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,m=OfficeExtension.BatchApiHelper.createChildItemObject,a=OfficeExtension.BatchApiHelper.invokeMethod,n=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,s=OfficeExtension.BatchApiHelper.invokeSetProperty,f=OfficeExtension.Utility.isNullOrUndefined,v=OfficeExtension.Utility.isUndefined,u=OfficeExtension.Utility.throwIfNotLoaded,l=OfficeExtension.Utility.throwIfApiNotSupported,A=OfficeExtension.Utility.load,z=OfficeExtension.Utility.retrieve,h=OfficeExtension.Utility.toJson,d=OfficeExtension.Utility.fixObjectPathIfNecessary,j=OfficeExtension.Utility._handleNavigationPropertyResults,t=OfficeExtension.Utility.adjustToDateTime,e=OfficeExtension.Utility.processRetrieveResult,w=OfficeExtension.Utility.setMockData,x="Skill",i=function(i){__extends(g,i);function g(){return i!==null&&i.apply(this,arguments)||this}Object.defineProperty(g.prototype,"_className",{"get":function(){return"Skill"},enumerable:true,configurable:true});g.prototype.executeAction=function(d,c,b){return a(this,"ExecuteAction",1,[d,c,b],4|1,0)};g.prototype.notifyPaneEvent=function(c,b){a(this,"NotifyPaneEvent",1,[c,b],4|1,0)};g.prototype.registerHostSkillEvent=function(){a(this,"RegisterHostSkillEvent",0,[],1,0)};g.prototype.testFireEvent=function(){a(this,"TestFireEvent",0,[],1,0)};g.prototype.unregisterHostSkillEvent=function(){a(this,"UnregisterHostSkillEvent",0,[],1,0)};g.prototype._handleResult=function(a){i.prototype._handleResult.call(this,a);if(f(a))return;var b=a;d(this,b)};g.prototype._handleRetrieveResult=function(b,a){i.prototype._handleRetrieveResult.call(this,b,a);e(this,b,a)};g.newObject=function(a){return c(b.Skill,a,"Microsoft.SkillApi.Skill",false,4)};Object.defineProperty(g.prototype,"onHostSkillEvent",{"get":function(){var a=this;if(!this.m_hostSkillEvent)this.m_hostSkillEvent=new OfficeExtension.GenericEventHandlers(this.context,this,"HostSkillEvent",{eventType:65538,registerFunc:function(){return a.registerHostSkillEvent()},unregisterFunc:function(){return a.unregisterHostSkillEvent()},getTargetIdFunc:function(){return null},eventArgsTransformFunc:function(a){var b={type:a.type,data:a.data};return OfficeExtension.Utility._createPromiseFromResult(b)}});return this.m_hostSkillEvent},enumerable:true,configurable:true});g.prototype.toJSON=function(){return h(this,{},{})};return g}(OfficeExtension.ClientObject);b.Skill=i;var g;(function(a){a.generalException="GeneralException"})(g=b.SkillErrorCodes||(b.SkillErrorCodes={}))})(OfficeCore||(OfficeCore={}));var OfficeCore;(function(a){var y="OfficeCore",t="TelemetryApi",p=OfficeExtension.BatchApiHelper.createPropertyObject,s=OfficeExtension.BatchApiHelper.createMethodObject,r=OfficeExtension.BatchApiHelper.createIndexerObject,l=OfficeExtension.BatchApiHelper.createRootServiceObject,b=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,n=OfficeExtension.BatchApiHelper.createChildItemObject,i=OfficeExtension.BatchApiHelper.invokeMethod,o=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,u=OfficeExtension.BatchApiHelper.invokeSetProperty,f=OfficeExtension.Utility.isNullOrUndefined,x=OfficeExtension.Utility.isUndefined,w=OfficeExtension.Utility.throwIfNotLoaded,m=OfficeExtension.Utility.throwIfApiNotSupported,A=OfficeExtension.Utility.load,z=OfficeExtension.Utility.retrieve,j=OfficeExtension.Utility.toJson,c=OfficeExtension.Utility.fixObjectPathIfNecessary,k=OfficeExtension.Utility._handleNavigationPropertyResults,v=OfficeExtension.Utility.adjustToDateTime,d=OfficeExtension.Utility.processRetrieveResult,q="TelemetryService",g=function(g){__extends(e,g);function e(){return g!==null&&g.apply(this,arguments)||this}Object.defineProperty(e.prototype,"_className",{"get":function(){return"TelemetryService"},enumerable:true,configurable:true});e.prototype.sendTelemetryEvent=function(a,d,b,c,e){i(this,"SendTelemetryEvent",1,[a,d,b,c,e],4,0)};e.prototype._handleResult=function(a){g.prototype._handleResult.call(this,a);if(f(a))return;var b=a;c(this,b)};e.prototype._handleRetrieveResult=function(b,a){g.prototype._handleRetrieveResult.call(this,b,a);d(this,b,a)};e.newObject=function(c){return b(a.TelemetryService,c,"Microsoft.Telemetry.TelemetryService",false,4)};e.prototype.toJSON=function(){return j(this,{},{})};return e}(OfficeExtension.ClientObject);a.TelemetryService=g;var h;(function(a){a.unset="Unset";a.string="String";a["boolean"]="Boolean";a.int64="Int64";a["double"]="Double"})(h=a.DataFieldType||(a.DataFieldType={}));var e;(function(a){a.generalException="GeneralException"})(e=a.TelemetryErrorCodes||(a.TelemetryErrorCodes={}))})(OfficeCore||(OfficeCore={}));var OfficeFirstPartyAuth;(function(a){var c=function(){function a(){}a.GetAuthContextAsyncMissing="GetAuthContextAsyncMissing";a.CannotGetAuthContext="CannotGetAuthContext";a.PackageNotLoaded="PackageNotLoaded";a.FailedToLoad="FailedToLoad";return a}(),d="officeWebAuthReplyUrls",e=false,b;a.debugging=false;function g(f){return new OfficeExtension.CoreUtility.Promise(function(h,g){if(OSF.WebAuth&&OSF._OfficeAppFactory.getHostInfo().hostPlatform=="web")try{(!Office||!Office.context||!Office.context.webAuth)&&g({code:c.GetAuthContextAsyncMissing,message:Strings&&Strings.OfficeOM.L_ImplicitGetAuthContextMissing?Strings.OfficeOM.L_ImplicitGetAuthContextMissing:""});Office.context.webAuth.getAuthContextAsync(function(k){if(k.status==="succeeded"){e=true;var i=k.value;if(!i||i.isAnonymous)return false;var p=i.authorityType.toLowerCase()==="msa";OSF.WebAuth.config={idp:i.authorityType.toLowerCase(),appIds:[p?i.msaAppId?i.msaAppId:i.appId:i.appId],authority:a.authorityOverride&&a.debugging?a.authorityOverride:i.authority,redirectUri:f?f:null,upn:i.upn,enableConsoleLogging:a.debugging,telemetryInstance:"otel",telemetry:{HashedUserId:i.userId}};var n=false,o=OSF.WebAuth.load(function(a){if(a){n=true;h()}g({code:c.PackageNotLoaded,message:Strings&&Strings.OfficeOM.L_ImplicitNotLoaded?Strings.OfficeOM.L_ImplicitNotLoaded:""})});l(o,n);var m=f?f:window.location.href.split("?")[0],j=sessionStorage.getItem(d);if(j||j==="")j=m;else j+=", "+m;sessionStorage.setItem(d,j)}else{e=false;OSF.WebAuth.config=null;b=JSON.stringify(k);g({code:c.FailedToLoad,message:b})}})}catch(i){e=false;OSF.WebAuth.config=null;b=i;OSF.WebAuth.load(function(a){a&&h();g({code:c.FailedToLoad,message:b})})}else h()})}a.load=g;function j(c,a){if(OSF.WebAuth&&OSF.WebAuth.loaded&&OSF._OfficeAppFactory.getHostInfo().hostPlatform=="web")return new OfficeExtension.CoreUtility.Promise(function(d,e){a&&a.forceRefresh&&OSF.WebAuth.clearCache();var b=OSF.WebAuth.config.idp.toLowerCase()=="msa"?OfficeCore.IdentityType.microsoftAccount:OfficeCore.IdentityType.organizationAccount;OSF.WebAuth.config.appIds[0]&&OSF.WebAuth.getToken(c.resource,OSF.WebAuth.config.appIds[0],OSF._OfficeAppFactory.getHostInfo().osfControlAppCorrelationId,a&&a.popup?a.popup:null).then(function(e){f(e,true,c.resource,a&&a.popup?a.popup:null);d({accessToken:e.Token,tokenIdenityType:b})})["catch"](function(b){f(b,false,c.resource,a&&a.popup?a.popup:null,b.ErrorCode);e({code:b.ErrorCode,message:b.ErrorMessage})})});var b=new OfficeCore.RequestContext,d=OfficeCore.AuthenticationService.newObject(b);b._customData="WacPartition";if(OSF._OfficeAppFactory.getHostInfo().hostPlatform=="web"&&OSF._OfficeAppFactory.getHostInfo().hostType=="word"){var e=d.getAccessToken(c,null);return b.sync().then(function(){return e.value})}else return new OfficeExtension.CoreUtility.Promise(function(e,a){var f=d.onTokenReceived.add(function(c){if(!OfficeExtension.CoreUtility.isNullOrUndefined(c)){f.remove();b.sync()["catch"](function(){});if(c.code==0)e(c.tokenValue);else if(OfficeExtension.CoreUtility.isNullOrUndefined(c.errorInfo))a({code:c.code});else try{a(JSON.parse(c.errorInfo))}catch(d){a({code:c.code,message:c.errorInfo})}}return null});b.sync().then(function(){var a=d.getAccessToken(c,d._targetId);return b.sync().then(function(){if(OfficeExtension.CoreUtility.isNullOrUndefined(a.value))return null;var b=a.value.accessToken;!OfficeExtension.CoreUtility.isNullOrUndefined(b)&&e(a.value)})})["catch"](function(b){a(b)})})}a.getAccessToken=j;function i(){var a=new OfficeCore.RequestContext,c=OfficeCore.AuthenticationService.newObject(a);a._customData="WacPartition";var b=c.getPrimaryIdentityInfo();return a.sync().then(function(){return b.value})}a.getPrimaryIdentityInfo=i;function k(){var a=new OfficeCore.RequestContext,b=OfficeCore.AuthenticationService.newObject(a),c=b.getIdentities();return a.sync().then(function(){return c.value})}a.getIdentities=k;function l(b,c){a.debugging&&console.log("Logging Implicit load event");if(typeof OTel!=="undefined")OTel.OTelLogger.onTelemetryLoaded(function(){var d=[oteljs.makeStringDataField("IdentityProvider",OSF.WebAuth.config.idp),oteljs.makeStringDataField("AppId",OSF.WebAuth.config.appIds[0]),oteljs.makeBooleanDataField("Js",typeof Implicit!=="undefined"?true:false),oteljs.makeBooleanDataField("Result",c)];if(OSF.WebAuth.config.telemetry)for(var a in OSF.WebAuth.config.telemetry)d.push(oteljs.makeStringDataField(a,OSF.WebAuth.config.telemetry[a]));if(b&&b.Telemetry)for(var a in b.Telemetry){if(!b.Telemetry[a])continue;switch(a){case"succeeded":d.push(oteljs.makeBooleanDataField(a,b.Telemetry[a]));break;case"loadedApplicationCount":d.push(oteljs.makeInt64DataField(a,b.Telemetry[a]));break;case"timeToLoad":d.push(oteljs.makeInt64DataField(a,b.Telemetry[a]));break;default:d.push(oteljs.makeStringDataField(a,b.Telemetry[a]))}}OTel.OTelLogger.sendTelemetryEvent({eventName:"Office.Extensibility.OfficeJs.OfficeFirstPartyAuth.Load",dataFields:d,eventFlags:{dataCategories:oteljs.DataCategories.ProductServiceUsage}})})}function f(b,d,f,c,e){a.debugging&&console.log("Logging Implicit acquire event");if(typeof OTel!=="undefined")OTel.OTelLogger.onTelemetryLoaded(function(){var g=[oteljs.makeStringDataField("IdentityProvider",OSF.WebAuth.config.idp),oteljs.makeStringDataField("AppId",OSF.WebAuth.config.appIds[0]),oteljs.makeStringDataField("Target",f),oteljs.makeBooleanDataField("Popup",typeof c==="boolean"?c:false),oteljs.makeBooleanDataField("Result",d),oteljs.makeStringDataField("Error",e)];if(OSF.WebAuth.config.telemetry)for(var a in OSF.WebAuth.config.telemetry)g.push(oteljs.makeStringDataField(a,OSF.WebAuth.config.telemetry[a]));if(b&&b.Telemetry)for(var a in b.Telemetry){if(!b.Telemetry[a])continue;switch(a){case"succeeded":g.push(oteljs.makeBooleanDataField(a,b.Telemetry[a]));break;case"timeToGetToken":g.push(oteljs.makeInt64DataField(a,b.Telemetry[a]));break;default:g.push(oteljs.makeStringDataField(a,b.Telemetry[a]))}}OTel.OTelLogger.sendTelemetryEvent({eventName:"Office.Extensibility.OfficeJs.OfficeFirstPartyAuth.GetAccessToken",dataFields:g,eventFlags:{dataCategories:oteljs.DataCategories.ProductServiceUsage}})})}function h(){if(!window.sessionStorage)return;var a=sessionStorage.getItem(d);a!==null&&a.indexOf(window.location.origin+window.location.pathname)!==-1&&g()}window.OSF&&h()})(OfficeFirstPartyAuth||(OfficeFirstPartyAuth={}));var OfficeCore;(function(a){var D="Office",Rb="OfficeSharedApi",q=OfficeExtension.BatchApiHelper.createPropertyObject,n=OfficeExtension.BatchApiHelper.createMethodObject,B=OfficeExtension.BatchApiHelper.createIndexerObject,Mb=OfficeExtension.BatchApiHelper.createRootServiceObject,u=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,v=OfficeExtension.BatchApiHelper.createChildItemObject,d=OfficeExtension.BatchApiHelper.invokeMethod,s=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,k=OfficeExtension.BatchApiHelper.invokeSetProperty,e=OfficeExtension.Utility.isNullOrUndefined,b=OfficeExtension.Utility.isUndefined,c=OfficeExtension.Utility.throwIfNotLoaded,A=OfficeExtension.Utility.throwIfApiNotSupported,m=OfficeExtension.Utility.load,l=OfficeExtension.Utility.retrieve,h=OfficeExtension.Utility.toJson,f=OfficeExtension.Utility.fixObjectPathIfNecessary,y=OfficeExtension.Utility._handleNavigationPropertyResults,w=OfficeExtension.Utility.adjustToDateTime,g=OfficeExtension.Utility.processRetrieveResult,p=OfficeExtension.Utility.setMockData,rb;(function(a){a.organizationAccount="OrganizationAccount";a.microsoftAccount="MicrosoftAccount";a.unsupported="Unsupported"})(rb=a.IdentityType||(a.IdentityType={}));var Lb="AuthenticationService",W=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"AuthenticationService"},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_navigationPropertyNames",{"get":function(){return["roamingSettings"]},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_targetId",{"get":function(){if(this.m_targetId==undefined)if(typeof OSF!=="undefined"&&OSF.OUtil)this.m_targetId=OSF.OUtil.Guid.generateNewGuid();else this.m_targetId=""+this.context._nextId();return this.m_targetId},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"roamingSettings",{"get":function(){if(!this._R)this._R=q(a.RoamingSettingCollection,this,"RoamingSettings",false,4);return this._R},enumerable:true,configurable:true});b.prototype.getAccessToken=function(a,b){return d(this,"GetAccessToken",1,[a,b],4|1,0)};b.prototype.getIdentities=function(){A("AuthenticationService.getIdentities","FirstPartyAuthentication","1.3",D);return d(this,"GetIdentities",1,[],4|1,0)};b.prototype.getPrimaryIdentityInfo=function(){A("AuthenticationService.getPrimaryIdentityInfo","FirstPartyAuthentication","1.2",D);return d(this,"GetPrimaryIdentityInfo",1,[],4|1,0)};b.prototype._handleResult=function(a){c.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b);y(this,b,["roamingSettings","RoamingSettings"])};b.prototype.load=function(a){return m(this,a)};b.prototype.retrieve=function(a){return l(this,a)};b.prototype._handleRetrieveResult=function(b,a){c.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};b.newObject=function(b){return u(a.AuthenticationService,b,"Microsoft.Authentication.AuthenticationService",false,4)};Object.defineProperty(b.prototype,"onTokenReceived",{"get":function(){var a=this;A("AuthenticationService.onTokenReceived","FirstPartyAuthentication","1.2",D);if(!this.m_tokenReceived)this.m_tokenReceived=new OfficeExtension.GenericEventHandlers(this.context,this,"TokenReceived",{eventType:3001,registerFunc:function(){},unregisterFunc:function(){},getTargetIdFunc:function(){return a._targetId},eventArgsTransformFunc:function(a){var b={tokenValue:a.tokenValue,code:a.code,errorInfo:a.errorInfo};return OfficeExtension.Utility._createPromiseFromResult(b)}});return this.m_tokenReceived},enumerable:true,configurable:true});b.prototype.toJSON=function(){return h(this,{},{})};return b}(OfficeExtension.ClientObject);a.AuthenticationService=W;var I="RoamingSetting",nb=function(d){__extends(a,d);function a(){return d!==null&&d.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"RoamingSetting"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["id","value"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["Id","Value"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyUpdateable",{"get":function(){return[false,true]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"id",{"get":function(){c("id",this._I,I,this._isNull);return this._I},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"value",{"get":function(){c("value",this._V,I,this._isNull);return this._V},"set":function(a){this._V=a;k(this,"Value",a,0)},enumerable:true,configurable:true});a.prototype.set=function(a,b){this._recursivelySet(a,b,["value"],[],[])};a.prototype.update=function(a){this._recursivelyUpdate(a)};a.prototype._handleResult=function(c){d.prototype._handleResult.call(this,c);if(e(c))return;var a=c;f(this,a);if(!b(a.Id))this._I=a.Id;if(!b(a.Value))this._V=a.Value};a.prototype.load=function(a){return m(this,a)};a.prototype.retrieve=function(a){return l(this,a)};a.prototype._handleIdResult=function(a){d.prototype._handleIdResult.call(this,a);if(e(a))return;if(!b(a.Id))this._I=a.Id};a.prototype._handleRetrieveResult=function(b,a){d.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};a.prototype.toJSON=function(){return h(this,{id:this._I,value:this._V},{})};a.prototype.setMockData=function(a){p(this,a)};a.prototype.ensureUnchanged=function(a){s(this,a);return};return a}(OfficeExtension.ClientObject);a.RoamingSetting=nb;var Kb="RoamingSettingCollection",R=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"RoamingSettingCollection"},enumerable:true,configurable:true});b.prototype.getItem=function(b){return n(a.RoamingSetting,this,"GetItem",1,[b],false,false,null,4)};b.prototype.getItemOrNullObject=function(b){return n(a.RoamingSetting,this,"GetItemOrNullObject",1,[b],false,false,null,4)};b.prototype._handleResult=function(a){c.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b)};b.prototype._handleRetrieveResult=function(b,a){c.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};b.prototype.toJSON=function(){return h(this,{},{})};return b}(OfficeExtension.ClientObject);a.RoamingSettingCollection=R;var Ub="LinkedIn",Eb=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"LinkedIn"},enumerable:true,configurable:true});b.prototype.isEnabledForOffice=function(){return d(this,"IsEnabledForOffice",0,[],0,0)};b.prototype.recordLinkedInSettingsCompliance=function(a,b){d(this,"RecordLinkedInSettingsCompliance",0,[a,b],0,0)};b.prototype._handleResult=function(a){c.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b)};b.prototype._handleRetrieveResult=function(b,a){c.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};b.newObject=function(b){return u(a.LinkedIn,b,"Microsoft.DesktopCompliance.LinkedIn",false,4)};b.prototype.toJSON=function(){return h(this,{},{})};return b}(OfficeExtension.ClientObject);a.LinkedIn=Eb;var Tb="NetworkUsage",sb=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"NetworkUsage"},enumerable:true,configurable:true});b.prototype.isInOnlineMode=function(){return d(this,"IsInOnlineMode",0,[],0,0)};b.prototype._handleResult=function(a){c.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b)};b.prototype._handleRetrieveResult=function(b,a){c.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};b.newObject=function(b){return u(a.NetworkUsage,b,"Microsoft.DesktopCompliance.NetworkUsage",false,4)};b.prototype.toJSON=function(){return h(this,{},{})};return b}(OfficeExtension.ClientObject);a.NetworkUsage=sb;var Sb="DynamicRibbon",qb=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"DynamicRibbon"},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_navigationPropertyNames",{"get":function(){return["buttons"]},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"buttons",{"get":function(){if(!this._B)this._B=q(a.RibbonButtonCollection,this,"Buttons",true,4);return this._B},enumerable:true,configurable:true});b.prototype.executeRequestUpdate=function(b){return n(a.RibbonButton,this,"ExecuteRequestUpdate",0,[b],false,false,null,0)};b.prototype.getButton=function(b){return n(a.RibbonButton,this,"GetButton",0,[b],false,false,null,0)};b.prototype.getTab=function(b){return n(a.RibbonTab,this,"GetTab",0,[b],false,false,null,0)};b.prototype._handleResult=function(a){c.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b);y(this,b,["buttons","Buttons"])};b.prototype.load=function(a){return m(this,a)};b.prototype.retrieve=function(a){return l(this,a)};b.prototype._handleRetrieveResult=function(b,a){c.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};b.newObject=function(b){return u(a.DynamicRibbon,b,"Microsoft.DynamicRibbon.DynamicRibbon",false,4)};b.prototype.toJSON=function(){return h(this,{},{buttons:this._B})};return b}(OfficeExtension.ClientObject);a.DynamicRibbon=qb;var pb="RibbonTab",Db=function(i){__extends(a,i);function a(){return i!==null&&i.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"RibbonTab"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["id"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["Id"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"id",{"get":function(){c("id",this._I,pb,this._isNull);return this._I},enumerable:true,configurable:true});a.prototype.setVisibility=function(a){d(this,"SetVisibility",0,[a],0,0)};a.prototype._handleResult=function(a){i.prototype._handleResult.call(this,a);if(e(a))return;var c=a;f(this,c);if(!b(c.Id))this._I=c.Id};a.prototype.load=function(a){return m(this,a)};a.prototype.retrieve=function(a){return l(this,a)};a.prototype._handleIdResult=function(a){i.prototype._handleIdResult.call(this,a);if(e(a))return;if(!b(a.Id))this._I=a.Id};a.prototype._handleRetrieveResult=function(b,a){i.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};a.prototype.toJSON=function(){return h(this,{id:this._I},{})};a.prototype.setMockData=function(a){p(this,a)};a.prototype.ensureUnchanged=function(a){s(this,a);return};return a}(OfficeExtension.ClientObject);a.RibbonTab=Db;var C="RibbonButton",tb=function(i){__extends(a,i);function a(){return i!==null&&i.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"RibbonButton"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["id","enabled","label"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["Id","Enabled","Label"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyUpdateable",{"get":function(){return[false,true,false]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"enabled",{"get":function(){c("enabled",this._E,C,this._isNull);return this._E},"set":function(a){this._E=a;k(this,"Enabled",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"id",{"get":function(){c("id",this._I,C,this._isNull);return this._I},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"label",{"get":function(){c("label",this._L,C,this._isNull);return this._L},enumerable:true,configurable:true});a.prototype.set=function(a,b){this._recursivelySet(a,b,["enabled"],[],[])};a.prototype.update=function(a){this._recursivelyUpdate(a)};a.prototype.setEnabled=function(a){d(this,"SetEnabled",0,[a],0,0)};a.prototype._handleResult=function(c){i.prototype._handleResult.call(this,c);if(e(c))return;var a=c;f(this,a);if(!b(a.Enabled))this._E=a.Enabled;if(!b(a.Id))this._I=a.Id;if(!b(a.Label))this._L=a.Label};a.prototype.load=function(a){return m(this,a)};a.prototype.retrieve=function(a){return l(this,a)};a.prototype._handleIdResult=function(a){i.prototype._handleIdResult.call(this,a);if(e(a))return;if(!b(a.Id))this._I=a.Id};a.prototype._handleRetrieveResult=function(b,a){i.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};a.prototype.toJSON=function(){return h(this,{enabled:this._E,id:this._I,label:this._L},{})};a.prototype.setMockData=function(a){p(this,a)};a.prototype.ensureUnchanged=function(a){s(this,a);return};return a}(OfficeExtension.ClientObject);a.RibbonButton=tb;var O="RibbonButtonCollection",T=function(i){__extends(b,i);function b(){return i!==null&&i.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"RibbonButtonCollection"},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_isCollection",{"get":function(){return true},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"items",{"get":function(){c("items",this.m__items,O,this._isNull);return this.m__items},enumerable:true,configurable:true});b.prototype.getCount=function(){return d(this,"GetCount",1,[],4,0)};b.prototype.getItem=function(b){return B(a.RibbonButton,this,[b])};b.prototype._handleResult=function(c){i.prototype._handleResult.call(this,c);if(e(c))return;var g=c;f(this,g);if(!e(g[OfficeExtension.Constants.items])){this.m__items=[];for(var d=g[OfficeExtension.Constants.items],b=0;b<d.length;b++){var h=v(a.RibbonButton,true,this,d[b],b);h._handleResult(d[b]);this.m__items.push(h)}}};b.prototype.load=function(a){return m(this,a)};b.prototype.retrieve=function(a){return l(this,a)};b.prototype._handleRetrieveResult=function(c,b){var d=this;i.prototype._handleRetrieveResult.call(this,c,b);g(this,c,b,function(b,c){return v(a.RibbonButton,true,d,b,c)})};b.prototype.toJSON=function(){return h(this,{},{},this.m__items)};b.prototype.setMockData=function(c){var b=this;p(this,c,function(c,d){return v(a.RibbonButton,true,b,c,d)},function(a){return b.m__items=a})};return b}(OfficeExtension.ClientObject);a.RibbonButtonCollection=T;var x="Comment",Fb=function(j){__extends(i,j);function i(){return j!==null&&j.apply(this,arguments)||this}Object.defineProperty(i.prototype,"_className",{"get":function(){return"Comment"},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_scalarPropertyNames",{"get":function(){return["id","text","created","level","resolved","author","mentions"]},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["Id","Text","Created","Level","Resolved","Author","Mentions"]},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_scalarPropertyUpdateable",{"get":function(){return[false,true,false,false,true,false,false]},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_navigationPropertyNames",{"get":function(){return["parent","parentOrNullObject","replies"]},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"parent",{"get":function(){if(!this._P)this._P=q(a.Comment,this,"Parent",false,4);return this._P},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"parentOrNullObject",{"get":function(){if(!this._Pa)this._Pa=q(a.Comment,this,"ParentOrNullObject",false,4);return this._Pa},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"replies",{"get":function(){if(!this._R)this._R=q(a.CommentCollection,this,"Replies",true,4);return this._R},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"author",{"get":function(){c("author",this._A,x,this._isNull);return this._A},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"created",{"get":function(){c("created",this._C,x,this._isNull);return this._C},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"id",{"get":function(){c("id",this._I,x,this._isNull);return this._I},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"level",{"get":function(){c("level",this._L,x,this._isNull);return this._L},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"mentions",{"get":function(){c("mentions",this._M,x,this._isNull);return this._M},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"resolved",{"get":function(){c("resolved",this._Re,x,this._isNull);return this._Re},"set":function(a){this._Re=a;k(this,"Resolved",a,0)},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"text",{"get":function(){c("text",this._T,x,this._isNull);return this._T},"set":function(a){this._T=a;k(this,"Text",a,0)},enumerable:true,configurable:true});i.prototype.set=function(a,b){this._recursivelySet(a,b,["text","resolved"],[],["parent","parentOrNullObject","replies"])};i.prototype.update=function(a){this._recursivelyUpdate(a)};i.prototype["delete"]=function(){d(this,"Delete",0,[],0,0)};i.prototype.getParentOrSelf=function(){return n(a.Comment,this,"GetParentOrSelf",1,[],false,false,null,4)};i.prototype.getRichText=function(a){return d(this,"GetRichText",1,[a],4,0)};i.prototype.reply=function(c,b){return n(a.Comment,this,"Reply",0,[c,b],false,false,null,0)};i.prototype.setRichText=function(b,a){return d(this,"SetRichText",0,[b,a],0,0)};i.prototype._handleResult=function(c){j.prototype._handleResult.call(this,c);if(e(c))return;var a=c;f(this,a);if(!b(a.Author))this._A=a.Author;if(!b(a.Created))this._C=w(a.Created);if(!b(a.Id))this._I=a.Id;if(!b(a.Level))this._L=a.Level;if(!b(a.Mentions))this._M=a.Mentions;if(!b(a.Resolved))this._Re=a.Resolved;if(!b(a.Text))this._T=a.Text;y(this,a,["parent","Parent","parentOrNullObject","ParentOrNullObject","replies","Replies"])};i.prototype.load=function(a){return m(this,a)};i.prototype.retrieve=function(a){return l(this,a)};i.prototype._handleIdResult=function(a){j.prototype._handleIdResult.call(this,a);if(e(a))return;if(!b(a.Id))this._I=a.Id};i.prototype._handleRetrieveResult=function(a,d){j.prototype._handleRetrieveResult.call(this,a,d);if(e(a))return;var c=a;if(!b(c.Created))c.created=w(c.created);g(this,a,d)};i.prototype.toJSON=function(){return h(this,{author:this._A,created:this._C,id:this._I,level:this._L,mentions:this._M,resolved:this._Re,text:this._T},{replies:this._R})};i.prototype.setMockData=function(a){p(this,a)};i.prototype.ensureUnchanged=function(a){s(this,a);return};return i}(OfficeExtension.ClientObject);a.Comment=Fb;var U="CommentCollection",bb=function(i){__extends(b,i);function b(){return i!==null&&i.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"CommentCollection"},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_isCollection",{"get":function(){return true},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"items",{"get":function(){c("items",this.m__items,U,this._isNull);return this.m__items},enumerable:true,configurable:true});b.prototype.getCount=function(){return d(this,"GetCount",1,[],4,0)};b.prototype.getItem=function(b){return B(a.Comment,this,[b])};b.prototype._handleResult=function(c){i.prototype._handleResult.call(this,c);if(e(c))return;var g=c;f(this,g);if(!e(g[OfficeExtension.Constants.items])){this.m__items=[];for(var d=g[OfficeExtension.Constants.items],b=0;b<d.length;b++){var h=v(a.Comment,true,this,d[b],b);h._handleResult(d[b]);this.m__items.push(h)}}};b.prototype.load=function(a){return m(this,a)};b.prototype.retrieve=function(a){return l(this,a)};b.prototype._handleRetrieveResult=function(c,b){var d=this;i.prototype._handleRetrieveResult.call(this,c,b);g(this,c,b,function(b,c){return v(a.Comment,true,d,b,c)})};b.prototype.toJSON=function(){return h(this,{},{},this.m__items)};b.prototype.setMockData=function(c){var b=this;p(this,c,function(c,d){return v(a.Comment,true,b,c,d)},function(a){return b.m__items=a})};return b}(OfficeExtension.ClientObject);a.CommentCollection=bb;var cb;(function(a){a.plain="Plain";a.markdown="Markdown";a.delta="Delta"})(cb=a.CommentTextFormat||(a.CommentTextFormat={}));var Y;(function(a){a.placeHolderRendered="PlaceHolderRendered";a.initialCardRendered="InitialCardRendered"})(Y=a.PersonaCardPerfPoint||(a.PersonaCardPerfPoint={}));var L;(function(a){a.notSet="NotSet";a.free="Free";a.idle="Idle";a.busy="Busy";a.idleBusy="IdleBusy";a.doNotDisturb="DoNotDisturb";a.unalertable="Unalertable";a.unavailable="Unavailable"})(L=a.UnifiedCommunicationAvailability||(a.UnifiedCommunicationAvailability={}));var P;(function(a){a.online="Online";a.notOnline="NotOnline";a.away="Away";a.busy="Busy";a.beRightBack="BeRightBack";a.onThePhone="OnThePhone";a.outToLunch="OutToLunch";a.inAMeeting="InAMeeting";a.outOfOffice="OutOfOffice";a.doNotDisturb="DoNotDisturb";a.inAConference="InAConference";a.getting="Getting";a.notABuddy="NotABuddy";a.disconnected="Disconnected";a.notInstalled="NotInstalled";a.urgentInterruptionsOnly="UrgentInterruptionsOnly";a.mayBeAvailable="MayBeAvailable";a.idle="Idle";a.inPresentation="InPresentation"})(P=a.UnifiedCommunicationStatus||(a.UnifiedCommunicationStatus={}));var X;(function(a){a.unknown="Unknown";a.free="Free";a.busy="Busy";a.elsewhere="Elsewhere";a.tentative="Tentative";a.outOfOffice="OutOfOffice"})(X=a.FreeBusyCalendarState||(a.FreeBusyCalendarState={}));var wb;(function(a){a.unknown="Unknown";a.enterprise="Enterprise";a.contact="Contact";a.bot="Bot";a.phoneOnly="PhoneOnly";a.oneOff="OneOff";a.distributionList="DistributionList";a.personalDistributionList="PersonalDistributionList";a.anonymous="Anonymous";a.unifiedGroup="UnifiedGroup"})(wb=a.PersonaType||(a.PersonaType={}));var Cb;(function(a){a.workPhone="WorkPhone";a.homePhone="HomePhone";a.mobilePhone="MobilePhone";a.businessFax="BusinessFax";a.otherPhone="OtherPhone"})(Cb=a.PhoneType||(a.PhoneType={}));var ub;(function(a){a.workAddress="WorkAddress";a.homeAddress="HomeAddress";a.otherAddress="OtherAddress"})(ub=a.AddressType||(a.AddressType={}));var zb;(function(a){a.unknown="Unknown";a.individual="Individual";a.group="Group"})(zb=a.MemberType||(a.MemberType={}));var H="MemberInfoList",lb=function(j){__extends(i,j);function i(){return j!==null&&j.apply(this,arguments)||this}Object.defineProperty(i.prototype,"_className",{"get":function(){return"MemberInfoList"},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_scalarPropertyNames",{"get":function(){return["isWarmedUp","isWarmingUp"]},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["IsWarmedUp","IsWarmingUp"]},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"isWarmedUp",{"get":function(){c("isWarmedUp",this._I,H,this._isNull);return this._I},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"isWarmingUp",{"get":function(){c("isWarmingUp",this._Is,H,this._isNull);return this._Is},enumerable:true,configurable:true});i.prototype.getPersonaForMember=function(b){return n(a.Persona,this,"GetPersonaForMember",0,[b],false,false,null,0)};i.prototype.items=function(){return d(this,"Items",0,[],0,0)};i.prototype._handleResult=function(c){j.prototype._handleResult.call(this,c);if(e(c))return;var a=c;f(this,a);if(!b(a.IsWarmedUp))this._I=a.IsWarmedUp;if(!b(a.IsWarmingUp))this._Is=a.IsWarmingUp};i.prototype.load=function(a){return m(this,a)};i.prototype.retrieve=function(a){return l(this,a)};i.prototype._handleRetrieveResult=function(b,a){j.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};i.prototype.toJSON=function(){return h(this,{isWarmedUp:this._I,isWarmingUp:this._Is},{})};i.prototype.setMockData=function(a){p(this,a)};i.prototype.ensureUnchanged=function(a){s(this,a);return};return i}(OfficeExtension.ClientObject);a.MemberInfoList=lb;var t;(function(a){a.hostId="HostId";a.type="Type";a.photo="Photo";a.personaInfo="PersonaInfo";a.unifiedCommunicationInfo="UnifiedCommunicationInfo";a.organization="Organization";a.unifiedGroupInfo="UnifiedGroupInfo";a.members="Members";a.membership="Membership";a.capabilities="Capabilities";a.customizations="Customizations";a.viewableSources="ViewableSources"})(t=a.PersonaDataUpdated||(a.PersonaDataUpdated={}));var Pb="PersonaActions",mb=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"PersonaActions"},enumerable:true,configurable:true});a.prototype.addContact=function(){d(this,"AddContact",0,[],0,0)};a.prototype.callPhoneNumber=function(a){d(this,"CallPhoneNumber",0,[a],0,0)};a.prototype.composeEmail=function(a){d(this,"ComposeEmail",0,[a],0,0)};a.prototype.composeInstantMessage=function(a){d(this,"ComposeInstantMessage",0,[a],0,0)};a.prototype.editContact=function(){d(this,"EditContact",0,[],0,0)};a.prototype.editContactByIdentifier=function(a){d(this,"EditContactByIdentifier",0,[a],0,0)};a.prototype.hideHoverCardForPersona=function(){d(this,"HideHoverCardForPersona",0,[],0,0)};a.prototype.openLinkContactUx=function(){d(this,"OpenLinkContactUx",0,[],0,0)};a.prototype.pinPersonaToQuickContacts=function(){d(this,"PinPersonaToQuickContacts",0,[],0,0)};a.prototype.scheduleMeeting=function(){d(this,"ScheduleMeeting",0,[],0,0)};a.prototype.showContactCard=function(f,g,e,c,b,a){d(this,"ShowContactCard",0,[f,g,e,c,b,a],0,0)};a.prototype.showContextMenu=function(f,g,e,c,b,a){d(this,"ShowContextMenu",0,[f,g,e,c,b,a],0,0)};a.prototype.showExpandedCard=function(f,g,e,c,b,a){d(this,"ShowExpandedCard",0,[f,g,e,c,b,a],0,0)};a.prototype.showHoverCardForPersona=function(f,g,e,c,b,a){d(this,"ShowHoverCardForPersona",0,[f,g,e,c,b,a],0,0)};a.prototype.toggleTagForAlerts=function(){d(this,"ToggleTagForAlerts",0,[],0,0)};a.prototype._handleResult=function(a){b.prototype._handleResult.call(this,a);if(e(a))return;var c=a;f(this,c)};a.prototype._handleRetrieveResult=function(c,a){b.prototype._handleRetrieveResult.call(this,c,a);g(this,c,a)};a.prototype.toJSON=function(){return h(this,{},{})};return a}(OfficeExtension.ClientObject);a.PersonaActions=mb;var j="PersonaInfoSource",fb=function(d){__extends(a,d);function a(){return d!==null&&d.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"PersonaInfoSource"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["displayName","email","emailAddresses","sipAddresses","birthday","birthdays","title","jobInfoDepartment","companyName","office","linkedTitles","linkedDepartments","linkedCompanyNames","linkedOffices","phones","addresses","webSites","notes"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["DisplayName","Email","EmailAddresses","SipAddresses","Birthday","Birthdays","Title","JobInfoDepartment","CompanyName","Office","LinkedTitles","LinkedDepartments","LinkedCompanyNames","LinkedOffices","Phones","Addresses","WebSites","Notes"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"addresses",{"get":function(){c("addresses",this._A,j,this._isNull);return this._A},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"birthday",{"get":function(){c("birthday",this._B,j,this._isNull);return this._B},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"birthdays",{"get":function(){c("birthdays",this._Bi,j,this._isNull);return this._Bi},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"companyName",{"get":function(){c("companyName",this._C,j,this._isNull);return this._C},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"displayName",{"get":function(){c("displayName",this._D,j,this._isNull);return this._D},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"email",{"get":function(){c("email",this._E,j,this._isNull);return this._E},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"emailAddresses",{"get":function(){c("emailAddresses",this._Em,j,this._isNull);return this._Em},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"jobInfoDepartment",{"get":function(){c("jobInfoDepartment",this._J,j,this._isNull);return this._J},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"linkedCompanyNames",{"get":function(){c("linkedCompanyNames",this._L,j,this._isNull);return this._L},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"linkedDepartments",{"get":function(){c("linkedDepartments",this._Li,j,this._isNull);return this._Li},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"linkedOffices",{"get":function(){c("linkedOffices",this._Lin,j,this._isNull);return this._Lin},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"linkedTitles",{"get":function(){c("linkedTitles",this._Link,j,this._isNull);return this._Link},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"notes",{"get":function(){c("notes",this._N,j,this._isNull);return this._N},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"office",{"get":function(){c("office",this._O,j,this._isNull);return this._O},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"phones",{"get":function(){c("phones",this._P,j,this._isNull);return this._P},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"sipAddresses",{"get":function(){c("sipAddresses",this._S,j,this._isNull);return this._S},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"title",{"get":function(){c("title",this._T,j,this._isNull);return this._T},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"webSites",{"get":function(){c("webSites",this._W,j,this._isNull);return this._W},enumerable:true,configurable:true});a.prototype._handleResult=function(c){d.prototype._handleResult.call(this,c);if(e(c))return;var a=c;f(this,a);if(!b(a.Addresses))this._A=a.Addresses;if(!b(a.Birthday))this._B=a.Birthday;if(!b(a.Birthdays))this._Bi=a.Birthdays;if(!b(a.CompanyName))this._C=a.CompanyName;if(!b(a.DisplayName))this._D=a.DisplayName;if(!b(a.Email))this._E=a.Email;if(!b(a.EmailAddresses))this._Em=a.EmailAddresses;if(!b(a.JobInfoDepartment))this._J=a.JobInfoDepartment;if(!b(a.LinkedCompanyNames))this._L=a.LinkedCompanyNames;if(!b(a.LinkedDepartments))this._Li=a.LinkedDepartments;if(!b(a.LinkedOffices))this._Lin=a.LinkedOffices;if(!b(a.LinkedTitles))this._Link=a.LinkedTitles;if(!b(a.Notes))this._N=a.Notes;if(!b(a.Office))this._O=a.Office;if(!b(a.Phones))this._P=a.Phones;if(!b(a.SipAddresses))this._S=a.SipAddresses;if(!b(a.Title))this._T=a.Title;if(!b(a.WebSites))this._W=a.WebSites};a.prototype.load=function(a){return m(this,a)};a.prototype.retrieve=function(a){return l(this,a)};a.prototype._handleRetrieveResult=function(b,a){d.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};a.prototype.toJSON=function(){return h(this,{addresses:this._A,birthday:this._B,birthdays:this._Bi,companyName:this._C,displayName:this._D,email:this._E,emailAddresses:this._Em,jobInfoDepartment:this._J,linkedCompanyNames:this._L,linkedDepartments:this._Li,linkedOffices:this._Lin,linkedTitles:this._Link,notes:this._N,office:this._O,phones:this._P,sipAddresses:this._S,title:this._T,webSites:this._W},{})};a.prototype.setMockData=function(a){p(this,a)};a.prototype.ensureUnchanged=function(a){s(this,a);return};return a}(OfficeExtension.ClientObject);a.PersonaInfoSource=fb;var o="PersonaInfo",vb=function(j){__extends(i,j);function i(){return j!==null&&j.apply(this,arguments)||this}Object.defineProperty(i.prototype,"_className",{"get":function(){return"PersonaInfo"},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_scalarPropertyNames",{"get":function(){return["displayName","email","emailAddresses","sipAddresses","birthday","birthdays","title","jobInfoDepartment","companyName","office","linkedTitles","linkedDepartments","linkedCompanyNames","linkedOffices","webSites","notes","isPersonResolved"]},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["DisplayName","Email","EmailAddresses","SipAddresses","Birthday","Birthdays","Title","JobInfoDepartment","CompanyName","Office","LinkedTitles","LinkedDepartments","LinkedCompanyNames","LinkedOffices","WebSites","Notes","IsPersonResolved"]},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_navigationPropertyNames",{"get":function(){return["sources"]},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"sources",{"get":function(){if(!this._So)this._So=q(a.PersonaInfoSource,this,"Sources",false,4);return this._So},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"birthday",{"get":function(){c("birthday",this._B,o,this._isNull);return this._B},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"birthdays",{"get":function(){c("birthdays",this._Bi,o,this._isNull);return this._Bi},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"companyName",{"get":function(){c("companyName",this._C,o,this._isNull);return this._C},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"displayName",{"get":function(){c("displayName",this._D,o,this._isNull);return this._D},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"email",{"get":function(){c("email",this._E,o,this._isNull);return this._E},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"emailAddresses",{"get":function(){c("emailAddresses",this._Em,o,this._isNull);return this._Em},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"isPersonResolved",{"get":function(){c("isPersonResolved",this._I,o,this._isNull);return this._I},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"jobInfoDepartment",{"get":function(){c("jobInfoDepartment",this._J,o,this._isNull);return this._J},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"linkedCompanyNames",{"get":function(){c("linkedCompanyNames",this._L,o,this._isNull);return this._L},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"linkedDepartments",{"get":function(){c("linkedDepartments",this._Li,o,this._isNull);return this._Li},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"linkedOffices",{"get":function(){c("linkedOffices",this._Lin,o,this._isNull);return this._Lin},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"linkedTitles",{"get":function(){c("linkedTitles",this._Link,o,this._isNull);return this._Link},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"notes",{"get":function(){c("notes",this._N,o,this._isNull);return this._N},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"office",{"get":function(){c("office",this._O,o,this._isNull);return this._O},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"sipAddresses",{"get":function(){c("sipAddresses",this._S,o,this._isNull);return this._S},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"title",{"get":function(){c("title",this._T,o,this._isNull);return this._T},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"webSites",{"get":function(){c("webSites",this._W,o,this._isNull);return this._W},enumerable:true,configurable:true});i.prototype.getAddresses=function(){return d(this,"GetAddresses",1,[],4,0)};i.prototype.getPhones=function(){return d(this,"GetPhones",1,[],4,0)};i.prototype._handleResult=function(c){j.prototype._handleResult.call(this,c);if(e(c))return;var a=c;f(this,a);if(!b(a.Birthday))this._B=w(a.Birthday);if(!b(a.Birthdays))this._Bi=w(a.Birthdays);if(!b(a.CompanyName))this._C=a.CompanyName;if(!b(a.DisplayName))this._D=a.DisplayName;if(!b(a.Email))this._E=a.Email;if(!b(a.EmailAddresses))this._Em=a.EmailAddresses;if(!b(a.IsPersonResolved))this._I=a.IsPersonResolved;if(!b(a.JobInfoDepartment))this._J=a.JobInfoDepartment;if(!b(a.LinkedCompanyNames))this._L=a.LinkedCompanyNames;if(!b(a.LinkedDepartments))this._Li=a.LinkedDepartments;if(!b(a.LinkedOffices))this._Lin=a.LinkedOffices;if(!b(a.LinkedTitles))this._Link=a.LinkedTitles;if(!b(a.Notes))this._N=a.Notes;if(!b(a.Office))this._O=a.Office;if(!b(a.SipAddresses))this._S=a.SipAddresses;if(!b(a.Title))this._T=a.Title;if(!b(a.WebSites))this._W=a.WebSites;y(this,a,["sources","Sources"])};i.prototype.load=function(a){return m(this,a)};i.prototype.retrieve=function(a){return l(this,a)};i.prototype._handleRetrieveResult=function(c,d){j.prototype._handleRetrieveResult.call(this,c,d);if(e(c))return;var a=c;if(!b(a.Birthday))a.birthday=w(a.birthday);if(!b(a.Birthdays))a.birthdays=w(a.birthdays);g(this,c,d)};i.prototype.toJSON=function(){return h(this,{birthday:this._B,birthdays:this._Bi,companyName:this._C,displayName:this._D,email:this._E,emailAddresses:this._Em,isPersonResolved:this._I,jobInfoDepartment:this._J,linkedCompanyNames:this._L,linkedDepartments:this._Li,linkedOffices:this._Lin,linkedTitles:this._Link,notes:this._N,office:this._O,sipAddresses:this._S,title:this._T,webSites:this._W},{sources:this._So})};i.prototype.setMockData=function(a){p(this,a)};i.prototype.ensureUnchanged=function(a){s(this,a);return};return i}(OfficeExtension.ClientObject);a.PersonaInfo=vb;var i="PersonaUnifiedCommunicationInfo",M=function(d){__extends(a,d);function a(){return d!==null&&d.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"PersonaUnifiedCommunicationInfo"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["availability","status","isSelf","isTagged","customStatusString","isBlocked","presenceTooltip","isOutOfOffice","outOfOfficeNote","timezone","meetingLocation","meetingSubject","timezoneBias","idleStartTime","overallCapability","isOnBuddyList","presenceNote","voiceMailUri","availabilityText","availabilityTooltip","isDurationInAvailabilityText","freeBusyStatus","calendarState"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["Availability","Status","IsSelf","IsTagged","CustomStatusString","IsBlocked","PresenceTooltip","IsOutOfOffice","OutOfOfficeNote","Timezone","MeetingLocation","MeetingSubject","TimezoneBias","IdleStartTime","OverallCapability","IsOnBuddyList","PresenceNote","VoiceMailUri","AvailabilityText","AvailabilityTooltip","IsDurationInAvailabilityText","FreeBusyStatus","CalendarState"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"availability",{"get":function(){c("availability",this._A,i,this._isNull);return this._A},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"availabilityText",{"get":function(){c("availabilityText",this._Av,i,this._isNull);return this._Av},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"availabilityTooltip",{"get":function(){c("availabilityTooltip",this._Ava,i,this._isNull);return this._Ava},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"calendarState",{"get":function(){c("calendarState",this._C,i,this._isNull);return this._C},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"customStatusString",{"get":function(){c("customStatusString",this._Cu,i,this._isNull);return this._Cu},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"freeBusyStatus",{"get":function(){c("freeBusyStatus",this._F,i,this._isNull);return this._F},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"idleStartTime",{"get":function(){c("idleStartTime",this._I,i,this._isNull);return this._I},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"isBlocked",{"get":function(){c("isBlocked",this._Is,i,this._isNull);return this._Is},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"isDurationInAvailabilityText",{"get":function(){c("isDurationInAvailabilityText",this._IsD,i,this._isNull);return this._IsD},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"isOnBuddyList",{"get":function(){c("isOnBuddyList",this._IsO,i,this._isNull);return this._IsO},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"isOutOfOffice",{"get":function(){c("isOutOfOffice",this._IsOu,i,this._isNull);return this._IsOu},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"isSelf",{"get":function(){c("isSelf",this._IsS,i,this._isNull);return this._IsS},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"isTagged",{"get":function(){c("isTagged",this._IsT,i,this._isNull);return this._IsT},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"meetingLocation",{"get":function(){c("meetingLocation",this._M,i,this._isNull);return this._M},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"meetingSubject",{"get":function(){c("meetingSubject",this._Me,i,this._isNull);return this._Me},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"outOfOfficeNote",{"get":function(){c("outOfOfficeNote",this._O,i,this._isNull);return this._O},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"overallCapability",{"get":function(){c("overallCapability",this._Ov,i,this._isNull);return this._Ov},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"presenceNote",{"get":function(){c("presenceNote",this._P,i,this._isNull);return this._P},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"presenceTooltip",{"get":function(){c("presenceTooltip",this._Pr,i,this._isNull);return this._Pr},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"status",{"get":function(){c("status",this._S,i,this._isNull);return this._S},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"timezone",{"get":function(){c("timezone",this._T,i,this._isNull);return this._T},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"timezoneBias",{"get":function(){c("timezoneBias",this._Ti,i,this._isNull);return this._Ti},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"voiceMailUri",{"get":function(){c("voiceMailUri",this._V,i,this._isNull);return this._V},enumerable:true,configurable:true});a.prototype._handleResult=function(c){d.prototype._handleResult.call(this,c);if(e(c))return;var a=c;f(this,a);if(!b(a.Availability))this._A=a.Availability;if(!b(a.AvailabilityText))this._Av=a.AvailabilityText;if(!b(a.AvailabilityTooltip))this._Ava=a.AvailabilityTooltip;if(!b(a.CalendarState))this._C=a.CalendarState;if(!b(a.CustomStatusString))this._Cu=a.CustomStatusString;if(!b(a.FreeBusyStatus))this._F=a.FreeBusyStatus;if(!b(a.IdleStartTime))this._I=w(a.IdleStartTime);if(!b(a.IsBlocked))this._Is=a.IsBlocked;if(!b(a.IsDurationInAvailabilityText))this._IsD=a.IsDurationInAvailabilityText;if(!b(a.IsOnBuddyList))this._IsO=a.IsOnBuddyList;if(!b(a.IsOutOfOffice))this._IsOu=a.IsOutOfOffice;if(!b(a.IsSelf))this._IsS=a.IsSelf;if(!b(a.IsTagged))this._IsT=a.IsTagged;if(!b(a.MeetingLocation))this._M=a.MeetingLocation;if(!b(a.MeetingSubject))this._Me=a.MeetingSubject;if(!b(a.OutOfOfficeNote))this._O=a.OutOfOfficeNote;if(!b(a.OverallCapability))this._Ov=a.OverallCapability;if(!b(a.PresenceNote))this._P=a.PresenceNote;if(!b(a.PresenceTooltip))this._Pr=a.PresenceTooltip;if(!b(a.Status))this._S=a.Status;if(!b(a.Timezone))this._T=a.Timezone;if(!b(a.TimezoneBias))this._Ti=a.TimezoneBias;if(!b(a.VoiceMailUri))this._V=a.VoiceMailUri};a.prototype.load=function(a){return m(this,a)};a.prototype.retrieve=function(a){return l(this,a)};a.prototype._handleRetrieveResult=function(a,f){d.prototype._handleRetrieveResult.call(this,a,f);if(e(a))return;var c=a;if(!b(c.IdleStartTime))c.idleStartTime=w(c.idleStartTime);g(this,a,f)};a.prototype.toJSON=function(){return h(this,{availability:this._A,availabilityText:this._Av,availabilityTooltip:this._Ava,calendarState:this._C,customStatusString:this._Cu,freeBusyStatus:this._F,idleStartTime:this._I,isBlocked:this._Is,isDurationInAvailabilityText:this._IsD,isOnBuddyList:this._IsO,isOutOfOffice:this._IsOu,isSelf:this._IsS,isTagged:this._IsT,meetingLocation:this._M,meetingSubject:this._Me,outOfOfficeNote:this._O,overallCapability:this._Ov,presenceNote:this._P,presenceTooltip:this._Pr,status:this._S,timezone:this._T,timezoneBias:this._Ti,voiceMailUri:this._V},{})};a.prototype.setMockData=function(a){p(this,a)};a.prototype.ensureUnchanged=function(a){s(this,a);return};return a}(OfficeExtension.ClientObject);a.PersonaUnifiedCommunicationInfo=M;var Ob="PersonaPhotoInfo",gb=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"PersonaPhotoInfo"},enumerable:true,configurable:true});a.prototype.getImageUri=function(a){return d(this,"getImageUri",0,[a],0,0)};a.prototype._handleResult=function(a){b.prototype._handleResult.call(this,a);if(e(a))return;var c=a;f(this,c)};a.prototype._handleRetrieveResult=function(c,a){b.prototype._handleRetrieveResult.call(this,c,a);g(this,c,a)};a.prototype.toJSON=function(){return h(this,{},{})};return a}(OfficeExtension.ClientObject);a.PersonaPhotoInfo=gb;var V="PersonaCollection",eb=function(i){__extends(b,i);function b(){return i!==null&&i.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"PersonaCollection"},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_isCollection",{"get":function(){return true},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"items",{"get":function(){c("items",this.m__items,V,this._isNull);return this.m__items},enumerable:true,configurable:true});b.prototype.getCount=function(){return d(this,"GetCount",1,[],4,0)};b.prototype.getItem=function(b){return B(a.Persona,this,[b])};b.prototype._handleResult=function(c){i.prototype._handleResult.call(this,c);if(e(c))return;var g=c;f(this,g);if(!e(g[OfficeExtension.Constants.items])){this.m__items=[];for(var d=g[OfficeExtension.Constants.items],b=0;b<d.length;b++){var h=v(a.Persona,true,this,d[b],b);h._handleResult(d[b]);this.m__items.push(h)}}};b.prototype.load=function(a){return m(this,a)};b.prototype.retrieve=function(a){return l(this,a)};b.prototype._handleRetrieveResult=function(c,b){var d=this;i.prototype._handleRetrieveResult.call(this,c,b);g(this,c,b,function(b,c){return v(a.Persona,true,d,b,c)})};b.prototype.toJSON=function(){return h(this,{},{},this.m__items)};b.prototype.setMockData=function(c){var b=this;p(this,c,function(c,d){return v(a.Persona,true,b,c,d)},function(a){return b.m__items=a})};return b}(OfficeExtension.ClientObject);a.PersonaCollection=eb;var E="PersonaOrganizationInfo",S=function(i){__extends(d,i);function d(){return i!==null&&i.apply(this,arguments)||this}Object.defineProperty(d.prototype,"_className",{"get":function(){return"PersonaOrganizationInfo"},enumerable:true,configurable:true});Object.defineProperty(d.prototype,"_scalarPropertyNames",{"get":function(){return["isWarmedUp","isWarmingUp"]},enumerable:true,configurable:true});Object.defineProperty(d.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["IsWarmedUp","IsWarmingUp"]},enumerable:true,configurable:true});Object.defineProperty(d.prototype,"_navigationPropertyNames",{"get":function(){return["hierarchy","manager","directReports"]},enumerable:true,configurable:true});Object.defineProperty(d.prototype,"directReports",{"get":function(){if(!this._D)this._D=q(a.PersonaCollection,this,"DirectReports",true,4);return this._D},enumerable:true,configurable:true});Object.defineProperty(d.prototype,"hierarchy",{"get":function(){if(!this._H)this._H=q(a.PersonaCollection,this,"Hierarchy",true,4);return this._H},enumerable:true,configurable:true});Object.defineProperty(d.prototype,"manager",{"get":function(){if(!this._M)this._M=q(a.Persona,this,"Manager",false,4);return this._M},enumerable:true,configurable:true});Object.defineProperty(d.prototype,"isWarmedUp",{"get":function(){c("isWarmedUp",this._I,E,this._isNull);return this._I},enumerable:true,configurable:true});Object.defineProperty(d.prototype,"isWarmingUp",{"get":function(){c("isWarmingUp",this._Is,E,this._isNull);return this._Is},enumerable:true,configurable:true});d.prototype._handleResult=function(c){i.prototype._handleResult.call(this,c);if(e(c))return;var a=c;f(this,a);if(!b(a.IsWarmedUp))this._I=a.IsWarmedUp;if(!b(a.IsWarmingUp))this._Is=a.IsWarmingUp;y(this,a,["directReports","DirectReports","hierarchy","Hierarchy","manager","Manager"])};d.prototype.load=function(a){return m(this,a)};d.prototype.retrieve=function(a){return l(this,a)};d.prototype._handleRetrieveResult=function(b,a){i.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};d.prototype.toJSON=function(){return h(this,{isWarmedUp:this._I,isWarmingUp:this._Is},{})};d.prototype.setMockData=function(a){p(this,a)};d.prototype.ensureUnchanged=function(a){s(this,a);return};return d}(OfficeExtension.ClientObject);a.PersonaOrganizationInfo=S;var kb;(function(a){a.email="Email";a.workPhone="WorkPhone";a.workPhone2="WorkPhone2";a.workFax="WorkFax";a.mobilePhone="MobilePhone";a.homePhone="HomePhone";a.homePhone2="HomePhone2";a.otherPhone="OtherPhone";a.sipAddress="SipAddress";a.profile="Profile";a.office="Office";a.company="Company";a.workAddress="WorkAddress";a.homeAddress="HomeAddress";a.otherAddress="OtherAddress";a.birthday="Birthday"})(kb=a.CustomizedData||(a.CustomizedData={}));var r="UnifiedGroupInfo",hb=function(d){__extends(a,d);function a(){return d!==null&&d.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"UnifiedGroupInfo"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["description","oneDrive","oneNote","isPublic","amIOwner","amIMember","amISubscribed","memberCount","ownerCount","hasGuests","site","planner","classification","subscriptionEnabled"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["Description","OneDrive","OneNote","IsPublic","AmIOwner","AmIMember","AmISubscribed","MemberCount","OwnerCount","HasGuests","Site","Planner","Classification","SubscriptionEnabled"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyUpdateable",{"get":function(){return[true,true,true,true,true,true,true,true,true,true,true,true,true,true]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"amIMember",{"get":function(){c("amIMember",this._A,r,this._isNull);return this._A},"set":function(a){this._A=a;k(this,"AmIMember",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"amIOwner",{"get":function(){c("amIOwner",this._Am,r,this._isNull);return this._Am},"set":function(a){this._Am=a;k(this,"AmIOwner",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"amISubscribed",{"get":function(){c("amISubscribed",this._AmI,r,this._isNull);return this._AmI},"set":function(a){this._AmI=a;k(this,"AmISubscribed",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"classification",{"get":function(){c("classification",this._C,r,this._isNull);return this._C},"set":function(a){this._C=a;k(this,"Classification",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"description",{"get":function(){c("description",this._D,r,this._isNull);return this._D},"set":function(a){this._D=a;k(this,"Description",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"hasGuests",{"get":function(){c("hasGuests",this._H,r,this._isNull);return this._H},"set":function(a){this._H=a;k(this,"HasGuests",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"isPublic",{"get":function(){c("isPublic",this._I,r,this._isNull);return this._I},"set":function(a){this._I=a;k(this,"IsPublic",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"memberCount",{"get":function(){c("memberCount",this._M,r,this._isNull);return this._M},"set":function(a){this._M=a;k(this,"MemberCount",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"oneDrive",{"get":function(){c("oneDrive",this._O,r,this._isNull);return this._O},"set":function(a){this._O=a;k(this,"OneDrive",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"oneNote",{"get":function(){c("oneNote",this._On,r,this._isNull);return this._On},"set":function(a){this._On=a;k(this,"OneNote",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"ownerCount",{"get":function(){c("ownerCount",this._Ow,r,this._isNull);return this._Ow},"set":function(a){this._Ow=a;k(this,"OwnerCount",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"planner",{"get":function(){c("planner",this._P,r,this._isNull);return this._P},"set":function(a){this._P=a;k(this,"Planner",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"site",{"get":function(){c("site",this._S,r,this._isNull);return this._S},"set":function(a){this._S=a;k(this,"Site",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"subscriptionEnabled",{"get":function(){c("subscriptionEnabled",this._Su,r,this._isNull);return this._Su},"set":function(a){this._Su=a;k(this,"SubscriptionEnabled",a,0)},enumerable:true,configurable:true});a.prototype.set=function(a,b){this._recursivelySet(a,b,["description","oneDrive","oneNote","isPublic","amIOwner","amIMember","amISubscribed","memberCount","ownerCount","hasGuests","site","planner","classification","subscriptionEnabled"],[],[])};a.prototype.update=function(a){this._recursivelyUpdate(a)};a.prototype._handleResult=function(c){d.prototype._handleResult.call(this,c);if(e(c))return;var a=c;f(this,a);if(!b(a.AmIMember))this._A=a.AmIMember;if(!b(a.AmIOwner))this._Am=a.AmIOwner;if(!b(a.AmISubscribed))this._AmI=a.AmISubscribed;if(!b(a.Classification))this._C=a.Classification;if(!b(a.Description))this._D=a.Description;if(!b(a.HasGuests))this._H=a.HasGuests;if(!b(a.IsPublic))this._I=a.IsPublic;if(!b(a.MemberCount))this._M=a.MemberCount;if(!b(a.OneDrive))this._O=a.OneDrive;if(!b(a.OneNote))this._On=a.OneNote;if(!b(a.OwnerCount))this._Ow=a.OwnerCount;if(!b(a.Planner))this._P=a.Planner;if(!b(a.Site))this._S=a.Site;if(!b(a.SubscriptionEnabled))this._Su=a.SubscriptionEnabled};a.prototype.load=function(a){return m(this,a)};a.prototype.retrieve=function(a){return l(this,a)};a.prototype._handleRetrieveResult=function(b,a){d.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};a.prototype.toJSON=function(){return h(this,{amIMember:this._A,amIOwner:this._Am,amISubscribed:this._AmI,classification:this._C,description:this._D,hasGuests:this._H,isPublic:this._I,memberCount:this._M,oneDrive:this._O,oneNote:this._On,ownerCount:this._Ow,planner:this._P,site:this._S,subscriptionEnabled:this._Su},{})};a.prototype.setMockData=function(a){p(this,a)};a.prototype.ensureUnchanged=function(a){s(this,a);return};return a}(OfficeExtension.ClientObject);a.UnifiedGroupInfo=hb;var z="Persona",J;(function(a){a[a.immediate=0]="immediate";a[a.load=3]="load"})(J=a.PersonaPromiseType||(a.PersonaPromiseType={}));var G=function(){function a(){}return a}();a.PersonaInfoAndSource=G;var Gb=function(j){__extends(i,j);function i(){return j!==null&&j.apply(this,arguments)||this}Object.defineProperty(i.prototype,"_className",{"get":function(){return"Persona"},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_scalarPropertyNames",{"get":function(){return["hostId","type","capabilities","diagnosticId","instanceId"]},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["HostId","Type","Capabilities","DiagnosticId","InstanceId"]},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_navigationPropertyNames",{"get":function(){return["photo","personaInfo","unifiedCommunicationInfo","organization","unifiedGroupInfo","actions"]},enumerable:true,configurable:true});i.prototype.performAsyncOperation=function(e,d,b,c){var a=this;if(e==J.immediate){b();return}c().then(function(e){if(e)b();else{a.load("hostId");a.context.sync().then(function(){var e=a.hostId;a.getPersonaLifetime().then(function(f){var g=function(h){return new OfficeExtension.CoreUtility.Promise(function(j,l){if(h.sendingPersonaHostId==e)for(var i=0;i<h.dataUpdated.length;++i){var k=h.dataUpdated[i];if(d==k){c().then(function(c){if(c){b();f.onPersonaUpdated.remove(g);a.context.sync()}j(c)});return}}j(false)})};f.onPersonaUpdated.add(g);a.context.sync()})})}})};i.prototype.getOrganizationAsync=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,f){var d=function(){var b=a.organization;b.load("*");a.context.sync().then(function(){c(b)})},e=function(){return new OfficeExtension.CoreUtility.Promise(function(c,d){var b=a.organization;b.load("isWarmedUp");a.context.sync().then(function(){c(b.isWarmedUp)})})};a.performAsyncOperation(b,t.organization,d,e)})};i.prototype.getIsPersonaInfoResolvedCheck=function(){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,d){var b=a.personaInfo;b.load("isPersonResolved");a.context.sync().then(function(){c(b.isPersonResolved)})})};i.prototype.getPersonaInfoAsync=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,f){var d=function(){var b=a.personaInfo;b.load();a.context.sync().then(function(){c(b)})},e=function(){return a.getIsPersonaInfoResolvedCheck()};a.performAsyncOperation(b,t.personaInfo,d,e)})};i.prototype.getPersonaInfoWithSourceAsync=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,f){var d=function(){var b=new G;b.info=a.personaInfo;b.info.load();b.source=a.personaInfo.sources;b.source.load();a.context.sync().then(function(){c(b)})},e=function(){return a.getIsPersonaInfoResolvedCheck()};a.performAsyncOperation(b,t.personaInfo,d,e)})};i.prototype.getUnifiedCommunicationInfo=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,f){var d=function(){var b=a.unifiedCommunicationInfo;b.load("*");a.context.sync().then(function(){c(b)})},e=function(){return a.getIsPersonaInfoResolvedCheck()};a.performAsyncOperation(b,t.personaInfo,d,e)})};i.prototype.getUnifiedGroupInfoAsync=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,f){var d=function(){var b=a.unifiedGroupInfo;b.load("*");a.context.sync().then(function(){c(b)})},e=function(){return a.getIsPersonaInfoResolvedCheck()};a.performAsyncOperation(b,t.personaInfo,d,e)})};i.prototype.getTypeAsync=function(c){var b=this;return new OfficeExtension.CoreUtility.Promise(function(d,g){var e=function(){b.load("type");b.context.sync().then(function(){d(a.PersonaType[b.type.valueOf()])})},f=function(){return b.getIsPersonaInfoResolvedCheck()};b.performAsyncOperation(c,t.personaInfo,e,f)})};i.prototype.getCustomizationsAsync=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,f){var d=function(){var b=a.getCustomizations();a.context.sync().then(function(){c(b.value)})},e=function(){return a.getIsPersonaInfoResolvedCheck()};a.performAsyncOperation(b,t.personaInfo,d,e)})};i.prototype.getMembersAsync=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,f){var d=function(){var b=a.getMembers();b.load("isWarmedUp");a.context.sync().then(function(){c(b)})},e=function(){return new OfficeExtension.CoreUtility.Promise(function(c,d){var b=a.getMembers();b.load("isWarmedUp");a.context.sync().then(function(){c(b.isWarmedUp)})})};a.performAsyncOperation(b,t.members,d,e)})};i.prototype.getMembershipAsync=function(b){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,f){var d=function(){var b=a.getMembership();b.load("*");a.context.sync().then(function(){c(b)})},e=function(){return new OfficeExtension.CoreUtility.Promise(function(c){var b=a.getMembership();b.load("isWarmedUp");a.context.sync().then(function(){c(b.isWarmedUp)})})};a.performAsyncOperation(b,t.membership,d,e)})};i.prototype.getPersonaLifetime=function(){var a=this;return new OfficeExtension.CoreUtility.Promise(function(b,c){a.load("instanceId");a.context.sync().then(function(){var c=new K(a.context,a.instanceId);c.getPersonaLifetime().then(function(a){b(a)})})})};Object.defineProperty(i.prototype,"actions",{"get":function(){if(!this._A)this._A=q(a.PersonaActions,this,"Actions",false,4);return this._A},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"organization",{"get":function(){if(!this._O)this._O=q(a.PersonaOrganizationInfo,this,"Organization",false,4);return this._O},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"personaInfo",{"get":function(){if(!this._P)this._P=q(a.PersonaInfo,this,"PersonaInfo",false,4);return this._P},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"photo",{"get":function(){if(!this._Ph)this._Ph=q(a.PersonaPhotoInfo,this,"Photo",false,4);return this._Ph},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"unifiedCommunicationInfo",{"get":function(){if(!this._U)this._U=q(a.PersonaUnifiedCommunicationInfo,this,"UnifiedCommunicationInfo",false,4);return this._U},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"unifiedGroupInfo",{"get":function(){if(!this._Un)this._Un=q(a.UnifiedGroupInfo,this,"UnifiedGroupInfo",false,4);return this._Un},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"capabilities",{"get":function(){c("capabilities",this._C,z,this._isNull);return this._C},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"diagnosticId",{"get":function(){c("diagnosticId",this._D,z,this._isNull);return this._D},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"hostId",{"get":function(){c("hostId",this._H,z,this._isNull);return this._H},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"instanceId",{"get":function(){c("instanceId",this._I,z,this._isNull);return this._I},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"type",{"get":function(){c("type",this._T,z,this._isNull);return this._T},enumerable:true,configurable:true});i.prototype.set=function(a,b){this._recursivelySet(a,b,[],["unifiedGroupInfo"],["actions","organization","personaInfo","photo","unifiedCommunicationInfo"])};i.prototype.update=function(a){this._recursivelyUpdate(a)};i.prototype.dispose=function(){d(this,"Dispose",0,[],0,0)};i.prototype.getCustomizations=function(){return d(this,"GetCustomizations",0,[],0,0)};i.prototype.getMembers=function(){return n(a.MemberInfoList,this,"GetMembers",0,[],false,false,null,0)};i.prototype.getMembership=function(){return n(a.MemberInfoList,this,"GetMembership",0,[],false,false,null,0)};i.prototype.getViewableSources=function(){return d(this,"GetViewableSources",0,[],0,0)};i.prototype.reportTimeForRender=function(b,a){d(this,"ReportTimeForRender",0,[b,a],0,0)};i.prototype.warmup=function(a){d(this,"Warmup",0,[a],0,0)};i.prototype._handleResult=function(c){j.prototype._handleResult.call(this,c);if(e(c))return;var a=c;f(this,a);if(!b(a.Capabilities))this._C=a.Capabilities;if(!b(a.DiagnosticId))this._D=a.DiagnosticId;if(!b(a.HostId))this._H=a.HostId;if(!b(a.InstanceId))this._I=a.InstanceId;if(!b(a.Type))this._T=a.Type;y(this,a,["actions","Actions","organization","Organization","personaInfo","PersonaInfo","photo","Photo","unifiedCommunicationInfo","UnifiedCommunicationInfo","unifiedGroupInfo","UnifiedGroupInfo"])};i.prototype.load=function(a){return m(this,a)};i.prototype.retrieve=function(a){return l(this,a)};i.prototype._handleRetrieveResult=function(b,a){j.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};i.prototype.toJSON=function(){return h(this,{capabilities:this._C,diagnosticId:this._D,hostId:this._H,instanceId:this._I,type:this._T},{organization:this._O,personaInfo:this._P,unifiedCommunicationInfo:this._U,unifiedGroupInfo:this._Un})};i.prototype.setMockData=function(a){p(this,a)};i.prototype.ensureUnchanged=function(a){s(this,a);return};return i}(OfficeExtension.ClientObject);a.Persona=Gb;var Z="PersonaLifetime",jb=function(j){__extends(i,j);function i(){return j!==null&&j.apply(this,arguments)||this}Object.defineProperty(i.prototype,"_className",{"get":function(){return"PersonaLifetime"},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_scalarPropertyNames",{"get":function(){return["instanceId"]},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["InstanceId"]},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"instanceId",{"get":function(){c("instanceId",this._I,Z,this._isNull);return this._I},enumerable:true,configurable:true});i.prototype.getPersona=function(b){return n(a.Persona,this,"GetPersona",0,[b],false,false,null,0)};i.prototype.getPersonaForOrgByEntryId=function(b,c,e,d){return n(a.Persona,this,"GetPersonaForOrgByEntryId",0,[b,c,e,d],false,false,null,0)};i.prototype.getPersonaForOrgEntry=function(c,e,d,b){return n(a.Persona,this,"GetPersonaForOrgEntry",0,[c,e,d,b],false,false,null,0)};i.prototype.getPolicies=function(){return d(this,"GetPolicies",0,[],0,0)};i.prototype._RegisterPersonaUpdatedEvent=function(){d(this,"_RegisterPersonaUpdatedEvent",0,[],0,0)};i.prototype._UnregisterPersonaUpdatedEvent=function(){d(this,"_UnregisterPersonaUpdatedEvent",0,[],0,0)};i.prototype._handleResult=function(a){j.prototype._handleResult.call(this,a);if(e(a))return;var c=a;f(this,c);if(!b(c.InstanceId))this._I=c.InstanceId};i.prototype.load=function(a){return m(this,a)};i.prototype.retrieve=function(a){return l(this,a)};i.prototype._handleRetrieveResult=function(b,a){j.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};Object.defineProperty(i.prototype,"onPersonaUpdated",{"get":function(){var a=this;if(!this.m_personaUpdated)this.m_personaUpdated=new OfficeExtension.GenericEventHandlers(this.context,this,"PersonaUpdated",{eventType:3502,registerFunc:function(){return a._RegisterPersonaUpdatedEvent()},unregisterFunc:function(){return a._UnregisterPersonaUpdatedEvent()},getTargetIdFunc:function(){return a.instanceId},eventArgsTransformFunc:function(a){var b={dataUpdated:a.dataUpdated,sendingPersonaHostId:a.sendingPersonaHostId};return OfficeExtension.Utility._createPromiseFromResult(b)}});return this.m_personaUpdated},enumerable:true,configurable:true});i.prototype.toJSON=function(){return h(this,{instanceId:this._I},{})};i.prototype.setMockData=function(a){p(this,a)};i.prototype.ensureUnchanged=function(a){s(this,a);return};return i}(OfficeExtension.ClientObject);a.PersonaLifetime=jb;var F="LokiTokenProvider",db=function(i){__extends(a,i);function a(){return i!==null&&i.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"LokiTokenProvider"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["emailOrUpn","instanceId"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["EmailOrUpn","InstanceId"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"emailOrUpn",{"get":function(){c("emailOrUpn",this._E,F,this._isNull);return this._E},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"instanceId",{"get":function(){c("instanceId",this._I,F,this._isNull);return this._I},enumerable:true,configurable:true});a.prototype.requestIdentityUniqueId=function(){d(this,"RequestIdentityUniqueId",0,[],0,0)};a.prototype.requestToken=function(){d(this,"RequestToken",0,[],0,0)};a.prototype._RegisterIdentityUniqueIdAvailableEvent=function(){d(this,"_RegisterIdentityUniqueIdAvailableEvent",0,[],0,0)};a.prototype._RegisterLokiTokenAvailableEvent=function(){d(this,"_RegisterLokiTokenAvailableEvent",0,[],0,0)};a.prototype._UnregisterIdentityUniqueIdAvailableEvent=function(){d(this,"_UnregisterIdentityUniqueIdAvailableEvent",0,[],0,0)};a.prototype._UnregisterLokiTokenAvailableEvent=function(){d(this,"_UnregisterLokiTokenAvailableEvent",0,[],0,0)};a.prototype._handleResult=function(c){i.prototype._handleResult.call(this,c);if(e(c))return;var a=c;f(this,a);if(!b(a.EmailOrUpn))this._E=a.EmailOrUpn;if(!b(a.InstanceId))this._I=a.InstanceId};a.prototype.load=function(a){return m(this,a)};a.prototype.retrieve=function(a){return l(this,a)};a.prototype._handleRetrieveResult=function(b,a){i.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};Object.defineProperty(a.prototype,"onIdentityUniqueIdAvailable",{"get":function(){var a=this;if(!this.m_identityUniqueIdAvailable)this.m_identityUniqueIdAvailable=new OfficeExtension.GenericEventHandlers(this.context,this,"IdentityUniqueIdAvailable",{eventType:3504,registerFunc:function(){return a._RegisterIdentityUniqueIdAvailableEvent()},unregisterFunc:function(){return a._UnregisterIdentityUniqueIdAvailableEvent()},getTargetIdFunc:function(){return a.instanceId},eventArgsTransformFunc:function(a){var b={isAvailable:a.isAvailable,uniqueId:a.uniqueId};return OfficeExtension.Utility._createPromiseFromResult(b)}});return this.m_identityUniqueIdAvailable},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"onLokiTokenAvailable",{"get":function(){var a=this;if(!this.m_lokiTokenAvailable)this.m_lokiTokenAvailable=new OfficeExtension.GenericEventHandlers(this.context,this,"LokiTokenAvailable",{eventType:3503,registerFunc:function(){return a._RegisterLokiTokenAvailableEvent()},unregisterFunc:function(){return a._UnregisterLokiTokenAvailableEvent()},getTargetIdFunc:function(){return a.instanceId},eventArgsTransformFunc:function(a){var b={isAvailable:a.isAvailable,lokiAutoDiscoverUrl:a.lokiAutoDiscoverUrl,lokiToken:a.lokiToken};return OfficeExtension.Utility._createPromiseFromResult(b)}});return this.m_lokiTokenAvailable},enumerable:true,configurable:true});a.prototype.toJSON=function(){return h(this,{emailOrUpn:this._E,instanceId:this._I},{})};a.prototype.setMockData=function(a){p(this,a)};a.prototype.ensureUnchanged=function(a){s(this,a);return};return a}(OfficeExtension.ClientObject);a.LokiTokenProvider=db;var Jb="LokiTokenProviderFactory",Q=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"LokiTokenProviderFactory"},enumerable:true,configurable:true});b.prototype.getLokiTokenProvider=function(b){return n(a.LokiTokenProvider,this,"GetLokiTokenProvider",0,[b],false,false,null,0)};b.prototype._handleResult=function(a){c.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b)};b.prototype._handleRetrieveResult=function(b,a){c.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};b.newObject=function(b){return u(a.LokiTokenProviderFactory,b,"Microsoft.People.LokiTokenProviderFactory",false,4)};b.prototype.toJSON=function(){return h(this,{},{})};return b}(OfficeExtension.ClientObject);a.LokiTokenProviderFactory=Q;var Qb="ServiceContext",K=function(){function b(b,a){this.context=b;this.instanceId=a}Object.defineProperty(b.prototype,"serviceContext",{"get":function(){if(!this.m_serviceConext)this.m_serviceConext=a.ServiceContext.newObject(this.context);return this.m_serviceConext},enumerable:true,configurable:true});b.prototype.getPersonaLifetime=function(){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,d){var b=a.serviceContext.getPersonaLifetime(a.instanceId);a.context.sync().then(function(){b.load("instanceId");a.context.sync().then(function(){c(b)})})})};b.prototype.getInitialPersona=function(){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,d){var b=a.serviceContext.getInitialPersona(a.instanceId);a.context.sync().then(function(){c(b)})})};b.prototype.getLokiTokenProvider=function(){var a=this;return new OfficeExtension.CoreUtility.Promise(function(c,d){var b=a.serviceContext.getLokiTokenProvider(a.instanceId);a.context.sync().then(function(){b.load("instanceId");a.context.sync().then(function(){c(b)})})})};return b}();a.PeopleApiContext=K;var ob=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"ServiceContext"},enumerable:true,configurable:true});b.prototype.accountEmailOrUpn=function(a){return d(this,"AccountEmailOrUpn",0,[a],0,0)};b.prototype.dispose=function(a){d(this,"Dispose",0,[a],0,0)};b.prototype.getInitialPersona=function(b){return n(a.Persona,this,"GetInitialPersona",0,[b],false,false,null,0)};b.prototype.getLokiTokenProvider=function(b){return n(a.LokiTokenProvider,this,"GetLokiTokenProvider",0,[b],false,false,null,0)};b.prototype.getPersonaLifetime=function(b){return n(a.PersonaLifetime,this,"GetPersonaLifetime",0,[b],false,false,null,0)};b.prototype.getPersonaPolicies=function(){return d(this,"GetPersonaPolicies",0,[],0,0)};b.prototype._handleResult=function(a){c.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b)};b.prototype._handleRetrieveResult=function(b,a){c.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};b.newObject=function(b){return u(a.ServiceContext,b,"Microsoft.People.ServiceContext",false,4)};b.prototype.toJSON=function(){return h(this,{},{})};return b}(OfficeExtension.ClientObject);a.ServiceContext=ob;var Vb="Tap",Hb=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"Tap"},enumerable:true,configurable:true});b.prototype.getEnterpriseUserInfo=function(){return d(this,"GetEnterpriseUserInfo",1,[],4|1,0)};b.prototype.getMruFriendlyPath=function(a){return d(this,"GetMruFriendlyPath",1,[a],4|1,0)};b.prototype.launchFileUrlInOfficeApp=function(b,a){return d(this,"LaunchFileUrlInOfficeApp",1,[b,a],4|1,0)};b.prototype.performLocalSearch=function(e,c,a,b){return d(this,"PerformLocalSearch",1,[e,c,a,b],4|1,0)};b.prototype.readSearchCache=function(c,b,a){return d(this,"ReadSearchCache",1,[c,b,a],4|1,0)};b.prototype.writeSearchCache=function(b,c,a){return d(this,"WriteSearchCache",1,[b,c,a],4|1,0)};b.prototype._handleResult=function(a){c.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b)};b.prototype._handleRetrieveResult=function(b,a){c.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};b.newObject=function(b){return u(a.Tap,b,"Microsoft.TapRichApi.Tap",false,4)};b.prototype.toJSON=function(){return h(this,{},{})};return b}(OfficeExtension.ClientObject);a.Tap=Hb;var Ab;(function(a){a.unknown="Unknown";a.chart="Chart";a.smartArt="SmartArt";a.table="Table";a.image="Image";a.slide="Slide";a.ole="OLE";a.text="Text"})(Ab=a.ObjectType||(a.ObjectType={}));var Ib="AppRuntimePersistenceService",N=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"AppRuntimePersistenceService"},enumerable:true,configurable:true});b.prototype.getAppRuntimeStartState=function(){return d(this,"GetAppRuntimeStartState",1,[],4,0)};b.prototype.setAppRuntimeStartState=function(a){d(this,"SetAppRuntimeStartState",0,[a],0,0)};b.prototype._handleResult=function(a){c.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b)};b.prototype._handleRetrieveResult=function(b,a){c.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};b.newObject=function(b){return u(a.AppRuntimePersistenceService,b,"Microsoft.AppRuntime.AppRuntimePersistenceService",false,4)};b.prototype.toJSON=function(){return h(this,{},{})};return b}(OfficeExtension.ClientObject);a.AppRuntimePersistenceService=N;var Nb="AppRuntimeService",ab=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"AppRuntimeService"},enumerable:true,configurable:true});b.prototype.getAppRuntimeState=function(){return d(this,"GetAppRuntimeState",1,[],4,0)};b.prototype.setAppRuntimeState=function(a){d(this,"SetAppRuntimeState",0,[a],0,0)};b.prototype._handleResult=function(a){c.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b)};b.prototype._handleRetrieveResult=function(b,a){c.prototype._handleRetrieveResult.call(this,b,a);g(this,b,a)};b.newObject=function(b){return u(a.AppRuntimeService,b,"Microsoft.AppRuntime.AppRuntimeService",false,4)};Object.defineProperty(b.prototype,"onVisibilityChanged",{"get":function(){if(!this.m_visibilityChanged)this.m_visibilityChanged=new OfficeExtension.GenericEventHandlers(this.context,this,"VisibilityChanged",{eventType:65539,registerFunc:function(){},unregisterFunc:function(){},getTargetIdFunc:function(){return""},eventArgsTransformFunc:function(a){if(a&&a.message)a.visibility=a.message;return OfficeExtension.Utility._createPromiseFromResult(a)}});return this.m_visibilityChanged},enumerable:true,configurable:true});b.prototype.toJSON=function(){return h(this,{},{})};return b}(OfficeExtension.ClientObject);a.AppRuntimeService=ab;var ib;(function(a){a.inactive="Inactive";a.background="Background";a.visible="Visible"})(ib=a.AppRuntimeState||(a.AppRuntimeState={}));var Bb;(function(a){a.hidden="Hidden";a.visible="Visible"})(Bb=a.Visibility||(a.Visibility={}));var xb;(function(a){a.apiNotAvailable="ApiNotAvailable";a.clientError="ClientError";a.controlIdNotFound="ControlIdNotFound";a.entryIdRequired="EntryIdRequired";a.generalException="GeneralException";a.instanceNotFound="InstanceNotFound";a.interactiveFlowAborted="InteractiveFlowAborted";a.invalidArgument="InvalidArgument";a.invalidGrant="InvalidGrant";a.invalidResourceUrl="InvalidResourceUrl";a.noPhoto="NoPhoto";a.objectNotFound="ObjectNotFound";a.resourceNotSupported="ResourceNotSupported";a.serverError="ServerError";a.ticketInvalidParams="TicketInvalidParams";a.ticketNetworkError="TicketNetworkError";a.ticketUnauthorized="TicketUnauthorized";a.ticketUninitialized="TicketUninitialized";a.ticketUnknownError="TicketUnknownError";a.unexpectedError="UnexpectedError";a.unsupportedUserIdentity="UnsupportedUserIdentity";a.userNotSignedIn="UserNotSignedIn"})(xb=a.ErrorCodes||(a.ErrorCodes={}));var yb;(function(a){})(yb=a.Interfaces||(a.Interfaces={}))})(OfficeCore||(OfficeCore={}));var Office;(function(b){b.Visibility=OfficeCore.Visibility;var a;(function(a){a.none="None";a.load="Load"})(a=b.StartupBehavior||(b.StartupBehavior={}));var c;(function(b){var k=this;function c(b){var a=new OfficeCore.RequestContext;a._requestFlagModifier|=64;if(b)a._customData="WacPartition";return a}function h(b){return __awaiter(this,void 0,void 0,function(){var f,d,e;return __generator(this,function(g){switch(g.label){case 0:if(b!==a.load&&b!==a.none)throw OfficeExtension.Utility.createRuntimeError(OfficeExtension.ErrorCodes.invalidArgument,null,null);f=b==a.load?OfficeCore.AppRuntimeState.background:OfficeCore.AppRuntimeState.inactive;d=c(false);e=OfficeCore.AppRuntimePersistenceService.newObject(d);e.setAppRuntimeStartState(f);return[4,d.sync()];case 1:g.sent();return[2]}})})}b.setStartupBehavior=h;function g(){return __awaiter(this,void 0,void 0,function(){var b,d,e,f,g;return __generator(this,function(h){switch(h.label){case 0:b=c(false);d=OfficeCore.AppRuntimePersistenceService.newObject(b);e=d.getAppRuntimeStartState();return[4,b.sync()];case 1:h.sent();f=e.value;g=f==OfficeCore.AppRuntimeState.inactive?a.none:a.load;return[2,g]}})})}b.getStartupBehavior=g;function e(a){return __awaiter(this,void 0,void 0,function(){var b,d;return __generator(this,function(e){switch(e.label){case 0:b=c(true);d=OfficeCore.AppRuntimeService.newObject(b);d.setAppRuntimeState(a);return[4,b.sync()];case 1:e.sent();return[2]}})})}function j(){return __awaiter(this,void 0,void 0,function(){var a,b,d;return __generator(this,function(e){switch(e.label){case 0:a=c(true);b=OfficeCore.AppRuntimeService.newObject(a);d=b.getAppRuntimeState();return[4,a.sync()];case 1:e.sent();return[2,d.value]}})})}b._getState=j;function i(){return e(OfficeCore.AppRuntimeState.visible)}b.showAsTaskpane=i;function l(){return e(OfficeCore.AppRuntimeState.background)}b.hide=l;var d;function f(){if(!d){var a=c(true);d=OfficeCore.AppRuntimeService.newObject(a)}return d}b.onVisibilityChanged={add:function(a){return __awaiter(k,void 0,void 0,function(){var d=this,b,c;return __generator(this,function(e){switch(e.label){case 0:b=f();c=b.onVisibilityChanged.add(a);return[4,b.context.sync()];case 1:e.sent();return[2,{remove:function(){return __awaiter(d,void 0,void 0,function(){return __generator(this,function(a){switch(a.label){case 0:c.remove();return[4,b.context.sync()];case 1:a.sent();return[2]}})})}}]}})})}}})(c=b.addin||(b.addin={}))})(Office||(Office={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(c,a){for(var b in a)if(a.hasOwnProperty(b))c[b]=a[b]};return function(c,b){a(c,b);function d(){this.constructor=c}c.prototype=b===null?Object.create(b):(d.prototype=b.prototype,new d)}}(),Visio;(function(a){var yb="Visio",ub="",m=OfficeExtension.BatchApiHelper.createPropertyObject,q=OfficeExtension.BatchApiHelper.createMethodObject,p=OfficeExtension.BatchApiHelper.createIndexerObject,sb=OfficeExtension.BatchApiHelper.createRootServiceObject,rb=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,g=OfficeExtension.BatchApiHelper.createChildItemObject,d=OfficeExtension.BatchApiHelper.invokeMethod,o=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,n=OfficeExtension.BatchApiHelper.invokeSetProperty,e=OfficeExtension.Utility.isNullOrUndefined,c=OfficeExtension.Utility.isUndefined,b=OfficeExtension.Utility.throwIfNotLoaded,tb=OfficeExtension.Utility.throwIfApiNotSupported,k=OfficeExtension.Utility.load,i=OfficeExtension.Utility.retrieve,j=OfficeExtension.Utility.toJson,f=OfficeExtension.Utility.fixObjectPathIfNecessary,r=OfficeExtension.Utility._handleNavigationPropertyResults,vb=OfficeExtension.Utility.adjustToDateTime,h=OfficeExtension.Utility.processRetrieveResult,l=OfficeExtension.Utility.setMockData,z="Application",cb=function(g){__extends(a,g);function a(){return g!==null&&g.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"Application"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["showBorders","showToolbars"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["ShowBorders","ShowToolbars"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyUpdateable",{"get":function(){return[true,true]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"showBorders",{"get":function(){b("showBorders",this._S,z,this._isNull);return this._S},"set":function(a){this._S=a;n(this,"ShowBorders",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"showToolbars",{"get":function(){b("showToolbars",this._Sh,z,this._isNull);return this._Sh},"set":function(a){this._Sh=a;n(this,"ShowToolbars",a,0)},enumerable:true,configurable:true});a.prototype.set=function(a,b){this._recursivelySet(a,b,["showBorders","showToolbars"],[],[])};a.prototype.update=function(a){this._recursivelyUpdate(a)};a.prototype.showToolbar=function(b,a){d(this,"ShowToolbar",0,[b,a],0,0)};a.prototype._handleResult=function(b){g.prototype._handleResult.call(this,b);if(e(b))return;var a=b;f(this,a);if(!c(a.ShowBorders))this._S=a.ShowBorders;if(!c(a.ShowToolbars))this._Sh=a.ShowToolbars};a.prototype.load=function(a){return k(this,a)};a.prototype.retrieve=function(a){return i(this,a)};a.prototype._handleRetrieveResult=function(b,a){g.prototype._handleRetrieveResult.call(this,b,a);h(this,b,a)};a.prototype.toJSON=function(){return j(this,{showBorders:this._S,showToolbars:this._Sh},{})};a.prototype.setMockData=function(a){l(this,a)};a.prototype.ensureUnchanged=function(a){o(this,a);return};return a}(OfficeExtension.ClientObject);a.Application=cb;var xb="Document",mb=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"Document"},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_navigationPropertyNames",{"get":function(){return["view","application","pages"]},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"application",{"get":function(){if(!this._A)this._A=m(a.Application,this,"Application",false,4);return this._A},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"pages",{"get":function(){if(!this._P)this._P=m(a.PageCollection,this,"Pages",true,4);return this._P},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"view",{"get":function(){if(!this._V)this._V=m(a.DocumentView,this,"View",false,4);return this._V},enumerable:true,configurable:true});b.prototype.set=function(a,b){this._recursivelySet(a,b,[],["view","application"],["pages"])};b.prototype.update=function(a){this._recursivelyUpdate(a)};b.prototype.getActivePage=function(){return q(a.Page,this,"GetActivePage",1,[],false,false,null,4)};b.prototype.setActivePage=function(a){d(this,"SetActivePage",1,[a],4,0)};b.prototype.showTaskPane=function(b,a,c){d(this,"ShowTaskPane",1,[b,a,c],4,0)};b.prototype.startDataRefresh=function(){d(this,"StartDataRefresh",1,[],4,0)};b.prototype._RegisterDataVisualizerDiagramOperationCompletedEvent=function(){d(this,"_RegisterDataVisualizerDiagramOperationCompletedEvent",0,[],0,0)};b.prototype._UnregisterDataVisualizerDiagramOperationCompletedEvent=function(){d(this,"_UnregisterDataVisualizerDiagramOperationCompletedEvent",0,[],0,0)};b.prototype._handleResult=function(a){c.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b);r(this,b,["application","Application","pages","Pages","view","View"])};b.prototype.load=function(a){return k(this,a)};b.prototype.retrieve=function(a){return i(this,a)};b.prototype._handleRetrieveResult=function(b,a){c.prototype._handleRetrieveResult.call(this,b,a);h(this,b,a)};Object.defineProperty(b.prototype,"onDataRefreshComplete",{"get":function(){var a=this;if(!this.m_dataRefreshComplete)this.m_dataRefreshComplete=new OfficeExtension.EventHandlers(this.context,this,"DataRefreshComplete",{registerFunc:function(b){return a.context.eventRegistration.register(3,"",b)},unregisterFunc:function(b){return a.context.eventRegistration.unregister(3,"",b)},eventArgsTransformFunc:function(a){var b={document:this,success:a.ddaBinding.Object.success};return OfficeExtension.Utility._createPromiseFromResult(b)}});return this.m_dataRefreshComplete},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"onDataVisualizerDiagramOperationCompleted",{"get":function(){if(!this.m_dataVisualizerDiagramOperationCompleted)this.m_dataVisualizerDiagramOperationCompleted=new OfficeExtension.EventHandlers(this.context,this,"DataVisualizerDiagramOperationCompleted",null);return this.m_dataVisualizerDiagramOperationCompleted},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"onDocumentError",{"get":function(){var a=this;if(!this.m_documentError)this.m_documentError=new OfficeExtension.EventHandlers(this.context,this,"DocumentError",{registerFunc:function(b){return a.context.eventRegistration.register(15,"",b)},unregisterFunc:function(b){return a.context.eventRegistration.unregister(15,"",b)},eventArgsTransformFunc:function(a){return OfficeExtension.Utility._createPromiseFromResult(a.ddaBinding.Object)}});return this.m_documentError},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"onDocumentLoadComplete",{"get":function(){var a=this;if(!this.m_documentLoadComplete)this.m_documentLoadComplete=new OfficeExtension.EventHandlers(this.context,this,"DocumentLoadComplete",{registerFunc:function(b){return a.context.eventRegistration.register(7,"",b)},unregisterFunc:function(b){return a.context.eventRegistration.unregister(7,"",b)},eventArgsTransformFunc:function(a){var b={success:a.ddaBinding.Object.success};return OfficeExtension.Utility._createPromiseFromResult(b)}});return this.m_documentLoadComplete},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"onPageLoadComplete",{"get":function(){var a=this;if(!this.m_pageLoadComplete)this.m_pageLoadComplete=new OfficeExtension.EventHandlers(this.context,this,"PageLoadComplete",{registerFunc:function(b){return a.context.eventRegistration.register(1,"",b)},unregisterFunc:function(b){return a.context.eventRegistration.unregister(1,"",b)},eventArgsTransformFunc:function(a){return OfficeExtension.Utility._createPromiseFromResult(a.ddaBinding.Object)}});return this.m_pageLoadComplete},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"onSelectionChanged",{"get":function(){var a=this;if(!this.m_selectionChanged)this.m_selectionChanged=new OfficeExtension.EventHandlers(this.context,this,"SelectionChanged",{registerFunc:function(b){return a.context.eventRegistration.register(2,"",b)},unregisterFunc:function(b){return a.context.eventRegistration.unregister(2,"",b)},eventArgsTransformFunc:function(a){return OfficeExtension.Utility._createPromiseFromResult(a.ddaBinding.Object)}});return this.m_selectionChanged},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"onShapeMouseEnter",{"get":function(){var a=this;if(!this.m_shapeMouseEnter)this.m_shapeMouseEnter=new OfficeExtension.EventHandlers(this.context,this,"ShapeMouseEnter",{registerFunc:function(b){return a.context.eventRegistration.register(4,"",b)},unregisterFunc:function(b){return a.context.eventRegistration.unregister(4,"",b)},eventArgsTransformFunc:function(a){return OfficeExtension.Utility._createPromiseFromResult(a.ddaBinding.Object)}});return this.m_shapeMouseEnter},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"onShapeMouseLeave",{"get":function(){var a=this;if(!this.m_shapeMouseLeave)this.m_shapeMouseLeave=new OfficeExtension.EventHandlers(this.context,this,"ShapeMouseLeave",{registerFunc:function(b){return a.context.eventRegistration.register(5,"",b)},unregisterFunc:function(b){return a.context.eventRegistration.unregister(5,"",b)},eventArgsTransformFunc:function(a){return OfficeExtension.Utility._createPromiseFromResult(a.ddaBinding.Object)}});return this.m_shapeMouseLeave},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"onTaskPaneStateChanged",{"get":function(){var a=this;if(!this.m_taskPaneStateChanged)this.m_taskPaneStateChanged=new OfficeExtension.EventHandlers(this.context,this,"TaskPaneStateChanged",{registerFunc:function(b){return a.context.eventRegistration.register(18,"",b)},unregisterFunc:function(b){return a.context.eventRegistration.unregister(18,"",b)},eventArgsTransformFunc:function(a){return OfficeExtension.Utility._createPromiseFromResult(a.ddaBinding.Object)}});return this.m_taskPaneStateChanged},enumerable:true,configurable:true});b.prototype.toJSON=function(){return j(this,{},{application:this._A,pages:this._P,view:this._V})};b.prototype.setMockData=function(a){l(this,a)};b.prototype.ensureUnchanged=function(a){o(this,a);return};return b}(OfficeExtension.ClientObject);a.Document=mb;var s="DocumentView",ab=function(d){__extends(a,d);function a(){return d!==null&&d.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"DocumentView"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["disableHyperlinks","disableZoom","disablePan","hideDiagramBoundary","disablePanZoomWindow"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["DisableHyperlinks","DisableZoom","DisablePan","HideDiagramBoundary","DisablePanZoomWindow"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyUpdateable",{"get":function(){return[true,true,true,true,true]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"disableHyperlinks",{"get":function(){b("disableHyperlinks",this._D,s,this._isNull);return this._D},"set":function(a){this._D=a;n(this,"DisableHyperlinks",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"disablePan",{"get":function(){b("disablePan",this._Di,s,this._isNull);return this._Di},"set":function(a){this._Di=a;n(this,"DisablePan",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"disablePanZoomWindow",{"get":function(){b("disablePanZoomWindow",this._Dis,s,this._isNull);return this._Dis},"set":function(a){this._Dis=a;n(this,"DisablePanZoomWindow",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"disableZoom",{"get":function(){b("disableZoom",this._Disa,s,this._isNull);return this._Disa},"set":function(a){this._Disa=a;n(this,"DisableZoom",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"hideDiagramBoundary",{"get":function(){b("hideDiagramBoundary",this._H,s,this._isNull);return this._H},"set":function(a){this._H=a;n(this,"HideDiagramBoundary",a,0)},enumerable:true,configurable:true});a.prototype.set=function(a,b){this._recursivelySet(a,b,["disableHyperlinks","disableZoom","disablePan","hideDiagramBoundary","disablePanZoomWindow"],[],[])};a.prototype.update=function(a){this._recursivelyUpdate(a)};a.prototype._handleResult=function(b){d.prototype._handleResult.call(this,b);if(e(b))return;var a=b;f(this,a);if(!c(a.DisableHyperlinks))this._D=a.DisableHyperlinks;if(!c(a.DisablePan))this._Di=a.DisablePan;if(!c(a.DisablePanZoomWindow))this._Dis=a.DisablePanZoomWindow;if(!c(a.DisableZoom))this._Disa=a.DisableZoom;if(!c(a.HideDiagramBoundary))this._H=a.HideDiagramBoundary};a.prototype.load=function(a){return k(this,a)};a.prototype.retrieve=function(a){return i(this,a)};a.prototype._handleRetrieveResult=function(b,a){d.prototype._handleRetrieveResult.call(this,b,a);h(this,b,a)};a.prototype.toJSON=function(){return j(this,{disableHyperlinks:this._D,disablePan:this._Di,disablePanZoomWindow:this._Dis,disableZoom:this._Disa,hideDiagramBoundary:this._H},{})};a.prototype.setMockData=function(a){l(this,a)};a.prototype.ensureUnchanged=function(a){o(this,a);return};return a}(OfficeExtension.ClientObject);a.DocumentView=ab;var u="Page",qb=function(n){__extends(g,n);function g(){return n!==null&&n.apply(this,arguments)||this}Object.defineProperty(g.prototype,"_className",{"get":function(){return"Page"},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"_scalarPropertyNames",{"get":function(){return["index","name","isBackground","width","height"]},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["Index","Name","IsBackground","Width","Height"]},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"_navigationPropertyNames",{"get":function(){return["shapes","view","comments","allShapes","dataVisualizerDiagrams"]},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"allShapes",{"get":function(){if(!this._A)this._A=m(a.ShapeCollection,this,"AllShapes",true,4);return this._A},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"comments",{"get":function(){if(!this._C)this._C=m(a.CommentCollection,this,"Comments",true,4);return this._C},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"dataVisualizerDiagrams",{"get":function(){if(!this._D)this._D=m(a.DataVisualizerDiagramCollection,this,"DataVisualizerDiagrams",true,4);return this._D},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"shapes",{"get":function(){if(!this._S)this._S=m(a.ShapeCollection,this,"Shapes",true,4);return this._S},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"view",{"get":function(){if(!this._V)this._V=m(a.PageView,this,"View",false,4);return this._V},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"height",{"get":function(){b("height",this._H,u,this._isNull);return this._H},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"index",{"get":function(){b("index",this._I,u,this._isNull);return this._I},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"isBackground",{"get":function(){b("isBackground",this._Is,u,this._isNull);return this._Is},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"name",{"get":function(){b("name",this._N,u,this._isNull);return this._N},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"width",{"get":function(){b("width",this._W,u,this._isNull);return this._W},enumerable:true,configurable:true});g.prototype.set=function(a,b){this._recursivelySet(a,b,[],["view"],["allShapes","comments","dataVisualizerDiagrams","shapes"])};g.prototype.update=function(a){this._recursivelyUpdate(a)};g.prototype.activate=function(){d(this,"Activate",1,[],4,0)};g.prototype._handleResult=function(b){n.prototype._handleResult.call(this,b);if(e(b))return;var a=b;f(this,a);if(!c(a.Height))this._H=a.Height;if(!c(a.Index))this._I=a.Index;if(!c(a.IsBackground))this._Is=a.IsBackground;if(!c(a.Name))this._N=a.Name;if(!c(a.Width))this._W=a.Width;r(this,a,["allShapes","AllShapes","comments","Comments","dataVisualizerDiagrams","DataVisualizerDiagrams","shapes","Shapes","view","View"])};g.prototype.load=function(a){return k(this,a)};g.prototype.retrieve=function(a){return i(this,a)};g.prototype._handleRetrieveResult=function(b,a){n.prototype._handleRetrieveResult.call(this,b,a);h(this,b,a)};g.prototype.toJSON=function(){return j(this,{height:this._H,index:this._I,isBackground:this._Is,name:this._N,width:this._W},{allShapes:this._A,comments:this._C,dataVisualizerDiagrams:this._D,shapes:this._S,view:this._V})};g.prototype.setMockData=function(a){l(this,a)};g.prototype.ensureUnchanged=function(a){o(this,a);return};return g}(OfficeExtension.ClientObject);a.Page=qb;var Z="PageView",nb=function(m){__extends(g,m);function g(){return m!==null&&m.apply(this,arguments)||this}Object.defineProperty(g.prototype,"_className",{"get":function(){return"PageView"},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"_scalarPropertyNames",{"get":function(){return["zoom"]},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["Zoom"]},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"_scalarPropertyUpdateable",{"get":function(){return[true]},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"zoom",{"get":function(){b("zoom",this._Z,Z,this._isNull);return this._Z},"set":function(a){this._Z=a;n(this,"Zoom",a,0)},enumerable:true,configurable:true});g.prototype.set=function(a,b){this._recursivelySet(a,b,["zoom"],[],[])};g.prototype.update=function(a){this._recursivelyUpdate(a)};g.prototype.centerViewportOnShape=function(a){d(this,"CenterViewportOnShape",1,[a],4,0)};g.prototype.fitToWindow=function(){d(this,"FitToWindow",1,[],4,0)};g.prototype.getPosition=function(){return d(this,"GetPosition",1,[],4,0)};g.prototype.getSelection=function(){return q(a.Selection,this,"GetSelection",1,[],false,false,null,4)};g.prototype.isShapeInViewport=function(a){return d(this,"IsShapeInViewport",1,[a],4,0)};g.prototype.setPosition=function(a){d(this,"SetPosition",1,[a],4,0)};g.prototype._handleResult=function(a){m.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b);if(!c(b.Zoom))this._Z=b.Zoom};g.prototype.load=function(a){return k(this,a)};g.prototype.retrieve=function(a){return i(this,a)};g.prototype._handleRetrieveResult=function(b,a){m.prototype._handleRetrieveResult.call(this,b,a);h(this,b,a)};g.prototype.toJSON=function(){return j(this,{zoom:this._Z},{})};g.prototype.setMockData=function(a){l(this,a)};g.prototype.ensureUnchanged=function(a){o(this,a);return};return g}(OfficeExtension.ClientObject);a.PageView=nb;var Q="PageCollection",V=function(m){__extends(c,m);function c(){return m!==null&&m.apply(this,arguments)||this}Object.defineProperty(c.prototype,"_className",{"get":function(){return"PageCollection"},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"_isCollection",{"get":function(){return true},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"items",{"get":function(){b("items",this.m__items,Q,this._isNull);return this.m__items},enumerable:true,configurable:true});c.prototype.getCount=function(){return d(this,"GetCount",1,[],4,0)};c.prototype.getItem=function(b){return p(a.Page,this,[b])};c.prototype._handleResult=function(c){m.prototype._handleResult.call(this,c);if(e(c))return;var h=c;f(this,h);if(!e(h[OfficeExtension.Constants.items])){this.m__items=[];for(var d=h[OfficeExtension.Constants.items],b=0;b<d.length;b++){var i=g(a.Page,true,this,d[b],b);i._handleResult(d[b]);this.m__items.push(i)}}};c.prototype.load=function(a){return k(this,a)};c.prototype.retrieve=function(a){return i(this,a)};c.prototype._handleRetrieveResult=function(c,b){var d=this;m.prototype._handleRetrieveResult.call(this,c,b);h(this,c,b,function(b,c){return g(a.Page,true,d,b,c)})};c.prototype.toJSON=function(){return j(this,{},{},this.m__items)};c.prototype.setMockData=function(c){var b=this;l(this,c,function(c,d){return g(a.Page,true,b,c,d)},function(a){return b.m__items=a})};return c}(OfficeExtension.ClientObject);a.PageCollection=V;var O="ShapeCollection",T=function(m){__extends(c,m);function c(){return m!==null&&m.apply(this,arguments)||this}Object.defineProperty(c.prototype,"_className",{"get":function(){return"ShapeCollection"},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"_isCollection",{"get":function(){return true},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"items",{"get":function(){b("items",this.m__items,O,this._isNull);return this.m__items},enumerable:true,configurable:true});c.prototype.getCount=function(){return d(this,"GetCount",1,[],4,0)};c.prototype.getItem=function(b){return p(a.Shape,this,[b])};c.prototype._handleResult=function(c){m.prototype._handleResult.call(this,c);if(e(c))return;var h=c;f(this,h);if(!e(h[OfficeExtension.Constants.items])){this.m__items=[];for(var d=h[OfficeExtension.Constants.items],b=0;b<d.length;b++){var i=g(a.Shape,true,this,d[b],b);i._handleResult(d[b]);this.m__items.push(i)}}};c.prototype.load=function(a){return k(this,a)};c.prototype.retrieve=function(a){return i(this,a)};c.prototype._handleRetrieveResult=function(c,b){var d=this;m.prototype._handleRetrieveResult.call(this,c,b);h(this,c,b,function(b,c){return g(a.Shape,true,d,b,c)})};c.prototype.toJSON=function(){return j(this,{},{},this.m__items)};c.prototype.setMockData=function(c){var b=this;l(this,c,function(c,d){return g(a.Shape,true,b,c,d)},function(a){return b.m__items=a})};return c}(OfficeExtension.ClientObject);a.ShapeCollection=T;var t="Shape",pb=function(p){__extends(g,p);function g(){return p!==null&&p.apply(this,arguments)||this}Object.defineProperty(g.prototype,"_className",{"get":function(){return"Shape"},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"_scalarPropertyNames",{"get":function(){return["name","id","text","select","isBoundToData"]},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["Name","Id","Text","Select","IsBoundToData"]},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"_scalarPropertyUpdateable",{"get":function(){return[false,false,false,true,false]},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"_navigationPropertyNames",{"get":function(){return["hyperlinks","shapeDataItems","view","subShapes","comments"]},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"comments",{"get":function(){if(!this._C)this._C=m(a.CommentCollection,this,"Comments",true,4);return this._C},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"hyperlinks",{"get":function(){if(!this._H)this._H=m(a.HyperlinkCollection,this,"Hyperlinks",true,4);return this._H},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"shapeDataItems",{"get":function(){if(!this._Sh)this._Sh=m(a.ShapeDataItemCollection,this,"ShapeDataItems",true,4);return this._Sh},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"subShapes",{"get":function(){if(!this._Su)this._Su=m(a.ShapeCollection,this,"SubShapes",true,4);return this._Su},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"view",{"get":function(){if(!this._V)this._V=m(a.ShapeView,this,"View",false,4);return this._V},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"id",{"get":function(){b("id",this._I,t,this._isNull);return this._I},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"isBoundToData",{"get":function(){b("isBoundToData",this._Is,t,this._isNull);return this._Is},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"name",{"get":function(){b("name",this._N,t,this._isNull);return this._N},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"select",{"get":function(){b("select",this._S,t,this._isNull);return this._S},"set":function(a){this._S=a;n(this,"Select",a,0)},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"text",{"get":function(){b("text",this._T,t,this._isNull);return this._T},enumerable:true,configurable:true});g.prototype.set=function(a,b){this._recursivelySet(a,b,["select"],["view"],["comments","hyperlinks","shapeDataItems","subShapes"])};g.prototype.update=function(a){this._recursivelyUpdate(a)};g.prototype.getBounds=function(){return d(this,"GetBounds",1,[],4,0)};g.prototype._handleResult=function(b){p.prototype._handleResult.call(this,b);if(e(b))return;var a=b;f(this,a);if(!c(a.Id))this._I=a.Id;if(!c(a.IsBoundToData))this._Is=a.IsBoundToData;if(!c(a.Name))this._N=a.Name;if(!c(a.Select))this._S=a.Select;if(!c(a.Text))this._T=a.Text;r(this,a,["comments","Comments","hyperlinks","Hyperlinks","shapeDataItems","ShapeDataItems","subShapes","SubShapes","view","View"])};g.prototype.load=function(a){return k(this,a)};g.prototype.retrieve=function(a){return i(this,a)};g.prototype._handleIdResult=function(a){p.prototype._handleIdResult.call(this,a);if(e(a))return;if(!c(a.Id))this._I=a.Id};g.prototype._handleRetrieveResult=function(b,a){p.prototype._handleRetrieveResult.call(this,b,a);h(this,b,a)};g.prototype.toJSON=function(){return j(this,{id:this._I,isBoundToData:this._Is,name:this._N,select:this._S,text:this._T},{comments:this._C,hyperlinks:this._H,shapeDataItems:this._Sh,subShapes:this._Su,view:this._V})};g.prototype.setMockData=function(a){l(this,a)};g.prototype.ensureUnchanged=function(a){o(this,a);return};return g}(OfficeExtension.ClientObject);a.Shape=pb;var W="ShapeView",lb=function(g){__extends(a,g);function a(){return g!==null&&g.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"ShapeView"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["highlight"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["Highlight"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyUpdateable",{"get":function(){return[true]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"highlight",{"get":function(){b("highlight",this._H,W,this._isNull);return this._H},"set":function(a){this._H=a;n(this,"Highlight",a,0)},enumerable:true,configurable:true});a.prototype.set=function(a,b){this._recursivelySet(a,b,["highlight"],[],[])};a.prototype.update=function(a){this._recursivelyUpdate(a)};a.prototype.addOverlay=function(c,e,a,b,g,f){return d(this,"AddOverlay",1,[c,e,a,b,g,f],4,0)};a.prototype.removeOverlay=function(a){d(this,"RemoveOverlay",1,[a],4,0)};a.prototype.showOverlay=function(a,b){d(this,"ShowOverlay",1,[a,b],4,0)};a.prototype._handleResult=function(a){g.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b);if(!c(b.Highlight))this._H=b.Highlight};a.prototype.load=function(a){return k(this,a)};a.prototype.retrieve=function(a){return i(this,a)};a.prototype._handleRetrieveResult=function(b,a){g.prototype._handleRetrieveResult.call(this,b,a);h(this,b,a)};a.prototype.toJSON=function(){return j(this,{highlight:this._H},{})};a.prototype.setMockData=function(a){l(this,a)};a.prototype.ensureUnchanged=function(a){o(this,a);return};return a}(OfficeExtension.ClientObject);a.ShapeView=lb;var F="ShapeDataItemCollection",L=function(m){__extends(c,m);function c(){return m!==null&&m.apply(this,arguments)||this}Object.defineProperty(c.prototype,"_className",{"get":function(){return"ShapeDataItemCollection"},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"_isCollection",{"get":function(){return true},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"items",{"get":function(){b("items",this.m__items,F,this._isNull);return this.m__items},enumerable:true,configurable:true});c.prototype.getCount=function(){return d(this,"GetCount",1,[],4,0)};c.prototype.getItem=function(b){return p(a.ShapeDataItem,this,[b])};c.prototype._handleResult=function(c){m.prototype._handleResult.call(this,c);if(e(c))return;var h=c;f(this,h);if(!e(h[OfficeExtension.Constants.items])){this.m__items=[];for(var d=h[OfficeExtension.Constants.items],b=0;b<d.length;b++){var i=g(a.ShapeDataItem,true,this,d[b],b);i._handleResult(d[b]);this.m__items.push(i)}}};c.prototype.load=function(a){return k(this,a)};c.prototype.retrieve=function(a){return i(this,a)};c.prototype._handleRetrieveResult=function(c,b){var d=this;m.prototype._handleRetrieveResult.call(this,c,b);h(this,c,b,function(b,c){return g(a.ShapeDataItem,true,d,b,c)})};c.prototype.toJSON=function(){return j(this,{},{},this.m__items)};c.prototype.setMockData=function(c){var b=this;l(this,c,function(c,d){return g(a.ShapeDataItem,true,b,c,d)},function(a){return b.m__items=a})};return c}(OfficeExtension.ClientObject);a.ShapeDataItemCollection=L;var w="ShapeDataItem",Y=function(d){__extends(a,d);function a(){return d!==null&&d.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"ShapeDataItem"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["label","value","format","formattedValue"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["Label","Value","Format","FormattedValue"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"format",{"get":function(){b("format",this._F,w,this._isNull);return this._F},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"formattedValue",{"get":function(){b("formattedValue",this._Fo,w,this._isNull);return this._Fo},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"label",{"get":function(){b("label",this._L,w,this._isNull);return this._L},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"value",{"get":function(){b("value",this._V,w,this._isNull);return this._V},enumerable:true,configurable:true});a.prototype._handleResult=function(b){d.prototype._handleResult.call(this,b);if(e(b))return;var a=b;f(this,a);if(!c(a.Format))this._F=a.Format;if(!c(a.FormattedValue))this._Fo=a.FormattedValue;if(!c(a.Label))this._L=a.Label;if(!c(a.Value))this._V=a.Value};a.prototype.load=function(a){return k(this,a)};a.prototype.retrieve=function(a){return i(this,a)};a.prototype._handleRetrieveResult=function(b,a){d.prototype._handleRetrieveResult.call(this,b,a);h(this,b,a)};a.prototype.toJSON=function(){return j(this,{format:this._F,formattedValue:this._Fo,label:this._L,value:this._V},{})};a.prototype.setMockData=function(a){l(this,a)};a.prototype.ensureUnchanged=function(a){o(this,a);return};return a}(OfficeExtension.ClientObject);a.ShapeDataItem=Y;var J="HyperlinkCollection",P=function(m){__extends(c,m);function c(){return m!==null&&m.apply(this,arguments)||this}Object.defineProperty(c.prototype,"_className",{"get":function(){return"HyperlinkCollection"},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"_isCollection",{"get":function(){return true},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"items",{"get":function(){b("items",this.m__items,J,this._isNull);return this.m__items},enumerable:true,configurable:true});c.prototype.getCount=function(){return d(this,"GetCount",1,[],4,0)};c.prototype.getItem=function(b){return p(a.Hyperlink,this,[b])};c.prototype._handleResult=function(c){m.prototype._handleResult.call(this,c);if(e(c))return;var h=c;f(this,h);if(!e(h[OfficeExtension.Constants.items])){this.m__items=[];for(var d=h[OfficeExtension.Constants.items],b=0;b<d.length;b++){var i=g(a.Hyperlink,true,this,d[b],b);i._handleResult(d[b]);this.m__items.push(i)}}};c.prototype.load=function(a){return k(this,a)};c.prototype.retrieve=function(a){return i(this,a)};c.prototype._handleRetrieveResult=function(c,b){var d=this;m.prototype._handleRetrieveResult.call(this,c,b);h(this,c,b,function(b,c){return g(a.Hyperlink,true,d,b,c)})};c.prototype.toJSON=function(){return j(this,{},{},this.m__items)};c.prototype.setMockData=function(c){var b=this;l(this,c,function(c,d){return g(a.Hyperlink,true,b,c,d)},function(a){return b.m__items=a})};return c}(OfficeExtension.ClientObject);a.HyperlinkCollection=P;var x="Hyperlink",jb=function(d){__extends(a,d);function a(){return d!==null&&d.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"Hyperlink"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["address","subAddress","description","extraInfo"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["Address","SubAddress","Description","ExtraInfo"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"address",{"get":function(){b("address",this._A,x,this._isNull);return this._A},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"description",{"get":function(){b("description",this._D,x,this._isNull);return this._D},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"extraInfo",{"get":function(){b("extraInfo",this._E,x,this._isNull);return this._E},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"subAddress",{"get":function(){b("subAddress",this._S,x,this._isNull);return this._S},enumerable:true,configurable:true});a.prototype._handleResult=function(b){d.prototype._handleResult.call(this,b);if(e(b))return;var a=b;f(this,a);if(!c(a.Address))this._A=a.Address;if(!c(a.Description))this._D=a.Description;if(!c(a.ExtraInfo))this._E=a.ExtraInfo;if(!c(a.SubAddress))this._S=a.SubAddress};a.prototype.load=function(a){return k(this,a)};a.prototype.retrieve=function(a){return i(this,a)};a.prototype._handleRetrieveResult=function(b,a){d.prototype._handleRetrieveResult.call(this,b,a);h(this,b,a)};a.prototype.toJSON=function(){return j(this,{address:this._A,description:this._D,extraInfo:this._E,subAddress:this._S},{})};a.prototype.setMockData=function(a){l(this,a)};a.prototype.ensureUnchanged=function(a){o(this,a);return};return a}(OfficeExtension.ClientObject);a.Hyperlink=jb;var M="CommentCollection",S=function(m){__extends(c,m);function c(){return m!==null&&m.apply(this,arguments)||this}Object.defineProperty(c.prototype,"_className",{"get":function(){return"CommentCollection"},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"_isCollection",{"get":function(){return true},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"items",{"get":function(){b("items",this.m__items,M,this._isNull);return this.m__items},enumerable:true,configurable:true});c.prototype.getCount=function(){return d(this,"GetCount",1,[],4,0)};c.prototype.getItem=function(b){return p(a.Comment,this,[b])};c.prototype._handleResult=function(c){m.prototype._handleResult.call(this,c);if(e(c))return;var h=c;f(this,h);if(!e(h[OfficeExtension.Constants.items])){this.m__items=[];for(var d=h[OfficeExtension.Constants.items],b=0;b<d.length;b++){var i=g(a.Comment,true,this,d[b],b);i._handleResult(d[b]);this.m__items.push(i)}}};c.prototype.load=function(a){return k(this,a)};c.prototype.retrieve=function(a){return i(this,a)};c.prototype._handleRetrieveResult=function(c,b){var d=this;m.prototype._handleRetrieveResult.call(this,c,b);h(this,c,b,function(b,c){return g(a.Comment,true,d,b,c)})};c.prototype.toJSON=function(){return j(this,{},{},this.m__items)};c.prototype.setMockData=function(c){var b=this;l(this,c,function(c,d){return g(a.Comment,true,b,c,d)},function(a){return b.m__items=a})};return c}(OfficeExtension.ClientObject);a.CommentCollection=S;var y="Comment",ob=function(d){__extends(a,d);function a(){return d!==null&&d.apply(this,arguments)||this}Object.defineProperty(a.prototype,"_className",{"get":function(){return"Comment"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyNames",{"get":function(){return["author","text","date"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["Author","Text","Date"]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"_scalarPropertyUpdateable",{"get":function(){return[true,true,true]},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"author",{"get":function(){b("author",this._A,y,this._isNull);return this._A},"set":function(a){this._A=a;n(this,"Author",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"date",{"get":function(){b("date",this._D,y,this._isNull);return this._D},"set":function(a){this._D=a;n(this,"Date",a,0)},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"text",{"get":function(){b("text",this._T,y,this._isNull);return this._T},"set":function(a){this._T=a;n(this,"Text",a,0)},enumerable:true,configurable:true});a.prototype.set=function(a,b){this._recursivelySet(a,b,["author","text","date"],[],[])};a.prototype.update=function(a){this._recursivelyUpdate(a)};a.prototype._handleResult=function(b){d.prototype._handleResult.call(this,b);if(e(b))return;var a=b;f(this,a);if(!c(a.Author))this._A=a.Author;if(!c(a.Date))this._D=a.Date;if(!c(a.Text))this._T=a.Text};a.prototype.load=function(a){return k(this,a)};a.prototype.retrieve=function(a){return i(this,a)};a.prototype._handleRetrieveResult=function(b,a){d.prototype._handleRetrieveResult.call(this,b,a);h(this,b,a)};a.prototype.toJSON=function(){return j(this,{author:this._A,date:this._D,text:this._T},{})};a.prototype.setMockData=function(a){l(this,a)};a.prototype.ensureUnchanged=function(a){o(this,a);return};return a}(OfficeExtension.ClientObject);a.Comment=ob;var wb="Selection",kb=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}Object.defineProperty(b.prototype,"_className",{"get":function(){return"Selection"},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"_navigationPropertyNames",{"get":function(){return["shapes"]},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"shapes",{"get":function(){if(!this._S)this._S=m(a.ShapeCollection,this,"Shapes",true,4);return this._S},enumerable:true,configurable:true});b.prototype._handleResult=function(a){c.prototype._handleResult.call(this,a);if(e(a))return;var b=a;f(this,b);r(this,b,["shapes","Shapes"])};b.prototype.load=function(a){return k(this,a)};b.prototype.retrieve=function(a){return i(this,a)};b.prototype._handleRetrieveResult=function(b,a){c.prototype._handleRetrieveResult.call(this,b,a);h(this,b,a)};b.prototype.toJSON=function(){return j(this,{},{shapes:this._S})};return b}(OfficeExtension.ClientObject);a.Selection=kb;var A="DataVisualizerDiagramCollection",D=function(m){__extends(c,m);function c(){return m!==null&&m.apply(this,arguments)||this}Object.defineProperty(c.prototype,"_className",{"get":function(){return"DataVisualizerDiagramCollection"},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"_isCollection",{"get":function(){return true},enumerable:true,configurable:true});Object.defineProperty(c.prototype,"items",{"get":function(){b("items",this.m__items,A,this._isNull);return this.m__items},enumerable:true,configurable:true});c.prototype.add=function(c,b){return q(a.DataVisualizerDiagram,this,"Add",1,[c,b],false,true,null,4)};c.prototype.addPreferred=function(c,b){return q(a.DataVisualizerDiagram,this,"AddPreferred",0,[c,b],false,false,null,0)};c.prototype.getCount=function(){return d(this,"GetCount",1,[],4,0)};c.prototype.getItem=function(b){return p(a.DataVisualizerDiagram,this,[b])};c.prototype.getItemAt=function(b){return q(a.DataVisualizerDiagram,this,"GetItemAt",1,[b],false,false,null,4)};c.prototype.getItemOrNullObject=function(b){return q(a.DataVisualizerDiagram,this,"GetItemOrNullObject",1,[b],false,false,null,4)};c.prototype._handleResult=function(c){m.prototype._handleResult.call(this,c);if(e(c))return;var h=c;f(this,h);if(!e(h[OfficeExtension.Constants.items])){this.m__items=[];for(var d=h[OfficeExtension.Constants.items],b=0;b<d.length;b++){var i=g(a.DataVisualizerDiagram,true,this,d[b],b);i._handleResult(d[b]);this.m__items.push(i)}}};c.prototype.load=function(a){return k(this,a)};c.prototype.retrieve=function(a){return i(this,a)};c.prototype._handleRetrieveResult=function(c,b){var d=this;m.prototype._handleRetrieveResult.call(this,c,b);h(this,c,b,function(b,c){return g(a.DataVisualizerDiagram,true,d,b,c)})};c.prototype.toJSON=function(){return j(this,{},{},this.m__items)};c.prototype.setMockData=function(c){var b=this;l(this,c,function(c,d){return g(a.DataVisualizerDiagram,true,b,c,d)},function(a){return b.m__items=a})};return c}(OfficeExtension.ClientObject);a.DataVisualizerDiagramCollection=D;var v="DataVisualizerDiagram",N=function(n){__extends(g,n);function g(){return n!==null&&n.apply(this,arguments)||this}Object.defineProperty(g.prototype,"_className",{"get":function(){return"DataVisualizerDiagram"},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"_scalarPropertyNames",{"get":function(){return["id","mappings","type","dataHeaders"]},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"_scalarPropertyOriginalNames",{"get":function(){return["ID","Mappings","Type","DataHeaders"]},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"_navigationPropertyNames",{"get":function(){return["page"]},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"page",{"get":function(){if(!this._P)this._P=m(a.Page,this,"Page",false,4);return this._P},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"dataHeaders",{"get":function(){b("dataHeaders",this._D,v,this._isNull);return this._D},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"id",{"get":function(){b("id",this._I,v,this._isNull);return this._I},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"mappings",{"get":function(){b("mappings",this._M,v,this._isNull);return this._M},enumerable:true,configurable:true});Object.defineProperty(g.prototype,"type",{"get":function(){b("type",this._T,v,this._isNull);return this._T},enumerable:true,configurable:true});g.prototype.set=function(a,b){this._recursivelySet(a,b,[],["page"],[])};g.prototype["delete"]=function(){d(this,"Delete",1,[],4,0)};g.prototype.getDataColumnValuesAsString=function(a){return d(this,"GetDataColumnValuesAsString",1,[a],4,0)};g.prototype.setConnection=function(a){d(this,"SetConnection",1,[a],4,0)};g.prototype.update=function(c,b,a){d(this,"Update",1,[c,b,a],4,0)};g.prototype.updateMappings=function(a){d(this,"UpdateMappings",1,[a],4,0)};g.prototype._handleResult=function(b){n.prototype._handleResult.call(this,b);if(e(b))return;var a=b;f(this,a);if(!c(a.DataHeaders))this._D=a.DataHeaders;if(!c(a.ID))this._I=a.ID;if(!c(a.Mappings))this._M=a.Mappings;if(!c(a.Type))this._T=a.Type;r(this,a,["page","Page"])};g.prototype.load=function(a){return k(this,a)};g.prototype.retrieve=function(a){return i(this,a)};g.prototype._handleRetrieveResult=function(b,a){n.prototype._handleRetrieveResult.call(this,b,a);h(this,b,a)};g.prototype.toJSON=function(){return j(this,{dataHeaders:this._D,id:this._I,mappings:this._M,type:this._T},{page:this._P})};g.prototype.setMockData=function(a){l(this,a)};g.prototype.ensureUnchanged=function(a){o(this,a);return};return g}(OfficeExtension.ClientObject);a.DataVisualizerDiagram=N;var G;(function(a){a.left="Left";a.center="Center";a.right="Right"})(G=a.OverlayHorizontalAlignment||(a.OverlayHorizontalAlignment={}));var I;(function(a){a.top="Top";a.middle="Middle";a.bottom="Bottom"})(I=a.OverlayVerticalAlignment||(a.OverlayVerticalAlignment={}));var db;(function(a){a.text="Text";a.image="Image";a.html="Html"})(db=a.OverlayType||(a.OverlayType={}));var eb;(function(a){a.commandBar="CommandBar";a.pageNavigationBar="PageNavigationBar";a.statusBar="StatusBar"})(eb=a.ToolBarType||(a.ToolBarType={}));var E;(function(a){a.success="Success";a.unexpected="Unexpected";a.validationError="ValidationError";a.conflictError="ConflictError"})(E=a.DataVisualizerDiagramResultType||(a.DataVisualizerDiagramResultType={}));var C;(function(a){a.unknown="Unknown";a.create="Create";a.updateMappings="UpdateMappings";a.updateData="UpdateData";a.update="Update";a["delete"]="Delete"})(C=a.DataVisualizerDiagramOperationType||(a.DataVisualizerDiagramOperationType={}));var H;(function(a){a.unknown="Unknown";a.basicFlowchart="BasicFlowchart";a.crossFunctionalFlowchart_Horizontal="CrossFunctionalFlowchart_Horizontal";a.crossFunctionalFlowchart_Vertical="CrossFunctionalFlowchart_Vertical";a.audit="Audit";a.orgChart="OrgChart";a.network="Network"})(H=a.DataVisualizerDiagramType||(a.DataVisualizerDiagramType={}));var fb;(function(a){a.unknown="Unknown";a.string="String";a.number="Number";a.date="Date";a.currency="Currency"})(fb=a.ColumnType||(a.ColumnType={}));var U;(function(a){a.unknown="Unknown";a.excel="Excel"})(U=a.DataSourceType||(a.DataSourceType={}));var B;(function(a){a.horizontal="Horizontal";a.vertical="Vertical"})(B=a.CrossFunctionalFlowchartOrientation||(a.CrossFunctionalFlowchartOrientation={}));var X;(function(a){a.unknown="Unknown";a.pageDefault="PageDefault";a.flowchart_TopToBottom="Flowchart_TopToBottom";a.flowchart_BottomToTop="Flowchart_BottomToTop";a.flowchart_LeftToRight="Flowchart_LeftToRight";a.flowchart_RightToLeft="Flowchart_RightToLeft";a.wideTree_DownThenRight="WideTree_DownThenRight";a.wideTree_DownThenLeft="WideTree_DownThenLeft";a.wideTree_RightThenDown="WideTree_RightThenDown";a.wideTree_LeftThenDown="WideTree_LeftThenDown"})(X=a.LayoutVariant||(a.LayoutVariant={}));var K;(function(a){a.none="None";a.columnNotMapped="ColumnNotMapped";a.uniqueIdColumnError="UniqueIdColumnError";a.swimlaneColumnError="SwimlaneColumnError";a.delimiterError="DelimiterError";a.connectorColumnError="ConnectorColumnError";a.connectorColumnMappedElsewhere="ConnectorColumnMappedElsewhere";a.connectorLabelColumnMappedElsewhere="ConnectorLabelColumnMappedElsewhere";a.connectorColumnAndConnectorLabelMappedElsewhere="ConnectorColumnAndConnectorLabelMappedElsewhere"})(K=a.DataValidationErrorType||(a.DataValidationErrorType={}));var R;(function(a){a.fromTarget="FromTarget";a.toTarget="ToTarget"})(R=a.ConnectorDirection||(a.ConnectorDirection={}));var bb;(function(a){a.none="None";a.dataVisualizerProcessMappings="DataVisualizerProcessMappings";a.dataVisualizerOrgChartMappings="DataVisualizerOrgChartMappings"})(bb=a.TaskPaneType||(a.TaskPaneType={}));var ib;(function(a){a.dataVisualizerDiagramOperationCompleted="DataVisualizerDiagramOperationCompleted"})(ib=a.EventType||(a.EventType={}));var gb;(function(a){a.accessDenied="AccessDenied";a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.itemNotFound="ItemNotFound";a.notImplemented="NotImplemented";a.unsupportedOperation="UnsupportedOperation"})(gb=a.ErrorCodes||(a.ErrorCodes={}));var hb;(function(a){})(hb=a.Interfaces||(a.Interfaces={}))})(Visio||(Visio={}));Object.defineProperty(OfficeExtension.SessionBase,"_overrideSession",{"get":function(){if(this._overrideSessionInternal)return this._overrideSessionInternal;if(OfficeExtension.ClientRequestContext)return OfficeExtension.ClientRequestContext._overrideSession;return undefined},"set":function(a){this._overrideSessionInternal=a},enumerable:true,configurable:true});var Visio;(function(a){var b=function(c){__extends(b,c);function b(d){var b=c.call(this,d)||this;b.m_document=new a.Document(b,OfficeExtension.ObjectPathFactory.createGlobalObjectObjectPath(b));b._rootObject=b.m_document;return b}Object.defineProperty(b.prototype,"document",{"get":function(){return this.m_document},enumerable:true,configurable:true});return b}(OfficeCore.RequestContext);a.RequestContext=b;function c(b,c,d){return OfficeExtension.ClientRequestContext._runBatch("Visio.run",arguments,function(b){var c=new a.RequestContext(b);return c})}a.run=c})(Visio||(Visio={}));OfficeExtension.Utility._doApiNotSupportedCheck=true